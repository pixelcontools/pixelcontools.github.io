{"version":3,"mappings":"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","names":["n","p","q","r","t","u","w","x","z","A","a","B","C","D","E","b","e","G","H","I","J","K","L","M","d","c","k","h","g","f","m","N","O","escape","P","Q","R","S","T","U","V","W","X","react_production_min","reactModule","require$$0","l","reactJsxRuntime_production_min","jsxRuntimeModule","exports","v","y","F","schedulerModule","aa","ca","require$$1","da","ea","fa","ha","ia","ja","ka","la","ma","oa","pa","qa","ra","sa","ta","ua","va","wa","ya","za","Aa","Ba","Ca","Da","Ea","Fa","Ga","Ha","Ia","Ja","Ka","La","Ma","Na","Oa","Pa","Qa","Ra","Sa","Ta","Ua","Va","Wa","Xa","Ya","Za","ab","bb","cb","db","eb","fb","gb","hb","ib","jb","kb","lb","mb","nb","ob","pb","qb","rb","sb","tb","ub","vb","wb","xb","yb","zb","Ab","Bb","Cb","Db","Eb","Fb","Gb","Hb","Ib","Jb","Kb","Lb","Mb","Nb","Ob","Pb","Qb","Rb","Sb","Tb","Ub","Vb","Wb","Xb","Yb","Zb","$b","ac","bc","cc","dc","ec","fc","gc","hc","ic","jc","kc","lc","mc","oc","nc","pc","qc","rc","sc","tc","uc","vc","wc","xc","yc","zc","Ac","Bc","Cc","Dc","Ec","Fc","Gc","Hc","Ic","Jc","Kc","Lc","Mc","Nc","Oc","Pc","Qc","Rc","Sc","Tc","Uc","Vc","Wc","Xc","Yc","Zc","$c","ad","bd","cd","dd","ed","fd","gd","hd","id","jd","kd","ld","md","nd","od","pd","qd","rd","sd","td","ud","vd","wd","xd","yd","Ad","zd","Bd","Cd","Dd","Ed","Fd","Gd","Hd","Id","Jd","Kd","Ld","Md","Nd","Od","Pd","Qd","Rd","Sd","Td","Ud","Vd","Wd","Xd","Yd","Zd","$d","ae","be","ce","de","ee","fe","ge","he","ie","je","ke","le","me","ne","oe","pe","qe","re","se","te","ue","ve","we","xe","ye","ze","Ae","Be","Ce","De","Ee","Fe","Ge","He","Ie","Je","Ke","Le","Me","Ne","Oe","Pe","Qe","Re","Se","Te","Ue","Ve","We","Xe","Ye","Ze","$e","af","bf","cf","df","ef","ff","gf","hf","jf","kf","lf","mf","nf","of","pf","qf","rf","sf","tf","uf","vf","wf","na","xa","$a","ba","xf","yf","zf","Af","Bf","Cf","Df","Ef","Ff","Gf","Hf","Jf","If","Kf","Lf","Mf","Nf","Of","Pf","Qf","Rf","Sf","Tf","Uf","Vf","Wf","Xf","Yf","Zf","$f","ag","bg","cg","dg","eg","fg","gg","hg","ig","jg","kg","lg","mg","ng","og","pg","qg","rg","sg","tg","ug","vg","wg","xg","yg","zg","Ag","Bg","Cg","Dg","Eg","Fg","Gg","Hg","Ig","Jg","Kg","Lg","Mg","Ng","Og","Pg","Qg","Rg","Sg","Tg","Ug","Vg","Wg","Xg","Yg","Zg","$g","ah","bh","ch","dh","eh","fh","gh","hh","ih","jh","kh","lh","mh","nh","oh","ph","qh","rh","sh","th","uh","vh","wh","xh","yh","zh","Ah","Bh","Ch","Dh","Eh","Fh","Gh","Hh","Ih","Jh","Kh","Lh","Mh","Nh","Oh","Ph","Qh","Rh","Sh","Th","Uh","Vh","Wh","Xh","Yh","Zh","$h","ai","bi","ci","di","ei","fi","gi","hi","ii","ji","ki","li","mi","ni","oi","pi","qi","ri","si","ti","ui","vi","wi","xi","yi","zi","Ai","Bi","Ci","Di","Ei","Fi","Gi","Hi","Ii","Ji","Ki","Li","Mi","Ni","Oi","Pi","Qi","Ri","Si","Ti","Ui","Vi","Wi","Xi","Yi","Zi","$i","aj","bj","cj","dj","ej","fj","gj","hj","ij","jj","kj","lj","mj","nj","oj","pj","qj","rj","sj","tj","uj","vj","wj","xj","yj","zj","Aj","Bj","Cj","Dj","Ej","Fj","Gj","Hj","Ij","Jj","Kj","Lj","Mj","Nj","Oj","Pj","Qj","Rj","Sj","Tj","Uj","Vj","Wj","Xj","Yj","Zj","ak","bk","ck","dk","ek","fk","gk","hk","ik","jk","kk","lk","mk","nk","ok","Y","Z","pk","qk","rk","sk","tk","uk","vk","wk","xk","yk","zk","Ak","Bk","Ck","Dk","Ek","Fk","Gk","Hk","Ik","Jk","Kk","Lk","Mk","Nk","Ok","Pk","Qk","Rk","Sk","Tk","Uk","Vk","Wk","Xk","Yk","Zk","$k","al","bl","cl","dl","el","fl","gl","hl","il","jl","kl","ll","ml","nl","ol","pl","ql","rl","sl","tl","ul","vl","reactDom_production_min","checkDCE","err","reactDomModule","client","createStoreImpl","createState","state","listeners","setState","partial","replace","nextState","previousState","listener","getState","api","initialState","__vite_import_meta_env__","createStore","React","is","objectIs","useState","useEffect","useLayoutEffect","useDebugValue","useSyncExternalStore$2","subscribe","getSnapshot","value","_useState","inst","forceUpdate","checkIfSnapshotChanged","latestGetSnapshot","nextValue","useSyncExternalStore$1","shim","useSyncExternalStoreShim_production","shimModule","useSyncExternalStore","useRef","useMemo","withSelector_production","getServerSnapshot","selector","isEqual","instRef","memoizedSelector","nextSnapshot","hasMemo","memoizedSnapshot","currentSelection","memoizedSelection","nextSelection","maybeGetServerSnapshot","withSelectorModule","ReactExports","useSyncExternalStoreWithSelector","useSyncExternalStoreExports","didWarnAboutEqualityFn","identity","arg","useStore","equalityFn","slice","createImpl","useBoundStore","create","trackedConnections","getTrackedConnectionState","name","key","api2","extractConnectionInformation","store","extensionConnector","options","existingConnection","newConnection","devtoolsImpl","fn","devtoolsOptions","set","get","enabled","anonymousActionType","connection","connectionInformation","isRecording","nameOrAction","action","setStateFromDevtools","originalIsRecording","store2","didWarnAboutReservedActionType","originalDispatch","message","_a","parseJsonThen","stateFromDevtools","nextLiftedState","lastComputedState","devtools","stringified","parsed","extractOpaqueColorPalette","imageDataObj","data","colorPalette","i","hex","findNearestColor","palette","nearestHex","nearestRGB","minDistance","rgb","distance","applyTransparencyMask","imageData","threshold","useTemplatePalette","resolve","reject","img","canvas","ctx","opaqueColorPalette","alpha","nearest","blobToDataUrl","blob","reader","result","dataUrlToBlob","dataUrl","parts","mimeMatch","mime","bstr","u8arr","removeBackground","tolerance","makeHeatmap","visited","maskBg","pixelIndex","colorAt","colorDistance","c1","c2","dr","seeds","pushSeeds","cx","cy","yy","xx","queue","s","inBounds","base","idx","cur","nbs","nidx","compositeLayersToBlob","layers","minX","minY","maxX","maxY","layer","width","height","loadedCount","hasError","SYSTEM_FONTS","GOOGLE_FONTS","ALL_FONTS","loadedGoogleFonts","loadGoogleFont","fontName","link","getFontByValue","font","HIGH_DPI_SCALE","measureText","text","fontSize","fontFamily","maxWidth","lineHeight","scale","letterSpacing","fontWeight","lines","paragraphs","paragraph","words","currentLine","word","testLine","maxLineWidth","line","lineWidth","lineHeightPx","totalHeight","rasterizeText","color","textAlign","disableTransparency","fontOption","error","measureCtx","padding","scaledPadding","canvasWidth","canvasHeight","finalCanvas","finalCtx","isTextLayer","isShapeLayer","DEFAULT_PROJECT_DATA","DEFAULT_HISTORY","DEFAULT_UI","useCompositorStore","config","viewport","metadata","newId","isFirstLayer","layerId","updates","layerToClone","newLayer","deltaX","deltaY","currentState","newPast","newX","newY","direction","currentZIndex","zIndices","currentPos","newZIndex","otherLayerId","selectedZIndices","minSelectedZ","maxSelectedZ","targetZIndex","maxZIndex","minZIndex","multiSelect","fromId","toId","layerIds","fromIndex","toIndex","start","end","allVisible","startX","startY","currentX","currentY","offsetX","offsetY","layersToMove","layersActuallyMoved","newState","projectWithoutViewport","previousProject","newFuture","nextProject","tool","density","speed","selectedLayers","sortedLayers","clipboardItem","pastedLayers","index","clipboardItems","item","imageTypes","type","imageType","prevState","rasterized","newWidth","newHeight","updatedLayers","projectData","filteredProject","GridOverlay","gridEnabled","gridDensity","canvasBorderEnabled","gridCanvasRef","containerRef","gridCanvas","minZoomForVisibility","zoom","opacity","effectiveGridDensity","densityMultiplier","canvasRect","containerRect","canvasScreenX","canvasScreenY","canvasScreenWidth","canvasScreenHeight","borderInset","pixelWidth","pixelHeight","visibleStartX","visibleEndX","visibleStartY","visibleEndY","firstX","worldX","screenX","firstY","worldY","screenY","jsx","DragInfoTooltip","mouseX","mouseY","jsxs","CanvasRenderer","canvasRef","project","selectedLayerIds","showSelectionBorders","showSelectionTools","borderAnimationSpeed","isDraggingLayer","dragLayerId","dragOffsetX","dragOffsetY","selectLayer","deselectAllLayers","startDraggingLayer","updateDragPosition","stopDraggingLayer","setViewport","removeLayer","updateLayer","loadedImages","setLoadedImages","isPanning","setIsPanning","panStart","setPanStart","hoverCoords","setHoverCoords","mousePos","setMousePos","newImages","prev","container","containerWidth","containerHeight","zoomX","zoomY","zoomToFit","patternCanvas","patternCtx","pattern","borderWidth","offset","isDraggingThisLayer","prevAlpha","getWorldCoordinates","relativeX","relativeY","viewportWidth","viewportHeight","centerX","centerY","offsetFromCenterX","offsetFromCenterY","canvasDistX","canvasDistY","canvasCenterX","canvasCenterY","handleCanvasMouseDown","isMultiSelect","handleCanvasMouseMove","newPanX","newPanY","handleCanvasMouseUp","handleCanvasWheel","currentZoom","zoomLevels","newZoom","showEditIcon","CURRENT_VERSION","MIN_SUPPORTED_VERSION","serializeProject","filteredLayers","serialized","deserializeProject","jsonString","isVersionCompatible","validateProjectData","validateLayerImages","version","major","minor","minMajor","minMinor","requiredFields","field","requiredLayerFields","loadImage","timeout","exportCanvasToPNG","backgroundColor","exportCanvas","Canvas","fileInputRef","addLayer","loadProject","markClean","handleImageUpload","event","files","file","handlePaste","items","globalDraggedLayerId","LayerItem","isSelected","selectLayerRange","reorderLayer","bringLayerToFront","sendLayerToBack","duplicateLayer","isEditingName","setIsEditingName","tempName","setTempName","isDragOver","setIsDragOver","elementRef","handleGlobalMouseUp","handleMouseLeaveWindow","handleSelectLayer","lastSelectedId","handleCheckboxChange","handleMouseDown","handleMouseEnter","draggedLayer","handleMouseLeave","handleMouseUp","handleToggleVisibility","handleToggleLock","handleNameSave","handleKeyDown","handleRemoveLayer","handleDuplicateLayer","handleBringToFront","handleSendToBack","STORAGE_KEY","loadPreferences","stored","savePreferences","preferences","useInitializePreferences","canvasUpdates","CanvasSettings","setCanvasConfig","cropCanvasToLayers","isCollapsed","setIsCollapsed","displayWidth","setDisplayWidth","displayHeight","setDisplayHeight","handleWidthChange","handleHeightChange","handleBackgroundColorChange","handleCommonSizeChange","size","LayerPanel","selectAllLayers","deleteSelectedLayers","handleDeleteSelected","PositionInputs","pushHistory","inputX","setInputX","inputY","setInputY","displayX","displayY","handleXChange","handleYChange","handlePositionFinalized","OpacityControl","handleOpacityChange","ColorAnalysis","colorsRGB","setColorsRGB","colorsRGBA","setColorsRGBA","isAnalyzing","setIsAnalyzing","visibleColorsRGB","setVisibleColorsRGB","visibleColorsRGBA","setVisibleColorsRGBA","scrollContainerRGBRef","scrollContainerRGBARef","itemHeightRef","handleScrollRGB","scrollTop","itemHeight","startIndex","endIndex","newVisibleColors","handleScrollRGBA","rgbContainer","rgbaContainer","analyzeColors","includeAlpha","colorMap","totalPixels","hexWithAlpha","colors","colorKey","pixelCount","copyToClipboard","copyAllColorsToClipboard","clipboardText","renderColorList","visibleIndices","scrollRef","renderedItems","sortedIndices","minIndex","maxIndex","spacerTopHeight","spacerBottomHeight","sum","getShapeBounds","radius","shapeType","stretchX","stretchY","updateBounds","sides","outerRadius","innerRadius","angleStep","startAngle","currentAngle","px","py","rawX","rawY","rasterizeShape","bounds","drawRectangle","drawCircle","drawPolygon","drawStar","angle","ShapeProperties","handleShapeTypeChange","newType","handleSizeChange","newSize","handleStretchXChange","newStretch","handleStretchYChange","handleColorChange","newColor","SHAPE_TYPES","usePortraitMode","isPortrait","setIsPortrait","check","mql","handleChange","DraggableModal","isOpen","onClose","title","children","initialPosition","noPadding","modalId","position","setPosition","isDragging","setIsDragging","setSize","isResizing","setIsResizing","dragStartRef","resizeStartRef","vw","handleMouseMove","dx","dy","handleResizeMouseDown","useCallback","handleResizeMouseMove","sx","sy","startWidth","startHeight","startPosX","startPosY","newW","newH","handleResizeMouseUp","MobileOrDraggable","TransparencyMaskModal","setThreshold","previewImage","setPreviewImage","isProcessing","setIsProcessing","setZoom","imageDimensions","setImageDimensions","setUseTemplatePalette","hasInitialFit","setHasInitialFit","previewContainerRef","imgRef","timer","handleApply","handleZoomIn","handleZoomOut","calculateFitZoom","scaleX","scaleY","handleResetZoom","handleImageLoad","fitZoom","header","b64","bytes","buf","src","canvasToDataUrl","CB_TILE","drawCheckerboard","floodFillRemove","clickX","clickY","imgD","baseIdx","baseR","baseG","baseB","tolSq","qy","qx","buildAlphaMask","cvs","mask","applyAlphaMask","originalSrc","alphaMask","imgData","BgRemovalModal","mode","setMode","statusText","setStatusText","errorText","setErrorText","downloadProgress","setDownloadProgress","workingImage","setWorkingImage","originalImage","setOriginalImage","alphaMaskRef","undoStackRef","redoStackRef","canUndo","setCanUndo","canRedo","setCanRedo","pushUndo","currentImage","handleUndo","handleRedo","next","setTolerance","setMakeHeatmap","brushSize","setBrushSize","brushMode","setBrushMode","isBrushing","setIsBrushing","pan","setPan","panStartRef","imgDim","setImgDim","overlayCanvasRef","lastBrushPosRef","hasInitialFitRef","brushCursorRef","origImageDataRef","isLassoing","setIsLassoing","lassoPointsRef","lassoMode","setLassoMode","handler","drawPreview","cw","fit","handleAiRemove","aiRemoveBackground","__vitePreload","resultBlob","current","total","pct","handleLegacyRemove","legacyRemoveBackground","handleCanvasClick","rect","getImageCoords","paintBrushMask","eraseVal","rSq","x0","y0","x1","y1","compositeRegion","origData","origPx","regionW","regionH","compData","ry","globalY","rowOffset","rx","globalX","paintBrush","interpolateBrush","from","to","dist","step","steps","dirtyX0","dirtyY0","dirtyX1","dirtyY1","handleBrushDown","pos","handleBrushMove","handleBrushUp","commitBrushStrokes","drawLassoOverlay","overlay","pts","handleLassoDown","handleLassoMove","handleLassoUp","polyCvs","polyCtx","polyData","val","handleWheel","mx","my","factor","prevZoom","handlePanStart","handlePanMove","handlePanEnd","handleReset","getCursorClass","label","EyedropperModal","imageDataUrl","onAddColors","pickedColors","setPickedColors","hoverColor","setHoverColor","cursorPos","setCursorPos","imgLoaded","setImgLoaded","imgSize","setImgSize","draw","patternSize","pCanvas","pCtx","drawW","drawH","ox","oy","ro","pixelDataRef","pixelCanvasSizeRef","tctx","getPixelColorFast","clientX","clientY","imgX","imgY","delta","handleRemoveColor","handleSubmit","GEOPIXELS_PROFILE_URL","decimalToHex","dec","formatNumber","GeoPixelsPaletteModal","userId","setUserId","isLoading","setIsLoading","setError","profile","setProfile","parsedColors","setParsedColors","hoveredColor","setHoveredColor","hoverPos","setHoverPos","handleFetch","response","colorInts","seen","hexColors","handleAddPalette","Fragment","GEOPIXELS_PALETTE","WPLACE_PALETTE","WPLACE_FREE_PALETTE","COLOR_MATCH_ALGORITHMS","DITHER_ALGORITHMS","COMMON_HEIGHTS","PixelatorModal","targetHeight","setTargetHeight","originalHeight","setOriginalHeight","resamplingMethod","setResamplingMethod","ditherMethod","setDitherMethod","ditherStrength","setDitherStrength","preprocessingMethod","setPreprocessingMethod","preprocessingStrength","setPreprocessingStrength","paletteMode","setPaletteMode","customPaletteInput","setCustomPaletteInput","resultDimensions","setResultDimensions","isPaletteVisualizationOpen","setIsPaletteVisualizationOpen","useKmeans","setUseKmeans","kmeansColors","setKmeansColors","suggestedColors","setSuggestedColors","suggestCount","setSuggestCount","isSuggesting","setIsSuggesting","preferDistinctColors","setPreferDistinctColors","hasSemiTransparent","setHasSemiTransparent","autoUpdate","setAutoUpdate","colorStats","setColorStats","generatedPalette","setGeneratedPalette","pinFitToScreen","setPinFitToScreen","filterTrivialColors","setFilterTrivialColors","isExtraFeaturesOpen","setIsExtraFeaturesOpen","brightness","setBrightness","contrast","setContrast","saturation","setSaturation","colorMatchAlgorithm","setColorMatchAlgorithm","preserveDetailThreshold","setPreserveDetailThreshold","isEyedropperOpen","setIsEyedropperOpen","isGeoPixelsPaletteOpen","setIsGeoPixelsPaletteOpen","workerRef","jobIdRef","wasKmeansEnabledRef","prevPaletteModeRef","debounceTimeRef","analyzePreviewColors","stats","count","createWorker","PixelatorWorker","suggestions","cached","getPalette","rawInput","customColors","trimmed","decimal","merged","processImage","currentJobId","checkForSemiTransparentPixels","aspectRatio","targetWidth","availableWidth","availableHeight","handleZoomReset","handleFitToScreen","handleHeightReset","handleSuggestColors","handleAddSuggestedToCustom","existingText","newColors","sortedPalette","currentPalette","countA","countB","handleCopyPalette","handleEyedropperColors","existing","handleGeoPixelsColors","handleSendKmeansToCustom","algo","MIN_SIZE","CropModal","cropRect","setCropRect","imgContainerRef","previewBoxRef","stateRef","dims","dragType","startRect","imageDims","moveEvent","newRect","findTransparentBounds","res","applyCrop","cursorStyle","PropertyPanel","isTransparencyModalOpen","setIsTransparencyModalOpen","isPixelatorModalOpen","setIsPixelatorModalOpen","isCropModalOpen","setIsCropModalOpen","isBgRemovalModalOpen","setIsBgRemovalModalOpen","BulkPositionControls","moveSelectedLayers","handleOffset","ZoomControls","ZOOM_LEVELS","nearestZoom","curr","nearestIndex","handleZoom","zoomLevel","nextZoom","DB_NAME","DB_VERSION","STORE_NAME","openDB","req","listSavedProjects","results","savedAt","sizeBytes","thumbnailDataUrl","layerCount","saveProjectLocal","entry","tx","loadProjectLocal","deleteProjectLocal","renameProjectLocal","newName","generateThumbnail","maxSize","sorted","loaded","formatBytes","FileOperations","exportScale","setExportScale","saveOpen","setSaveOpen","loadOpen","setLoadOpen","showSavedProjects","setShowSavedProjects","resetProject","saveRef","loadRef","isCtrlOrCmd","handleSaveProjectFile","projectJson","url","handleExportPNG","handleSaveLocal","thumbnail","handleLoadFile","handleLoadLocal","handleFileInputChange","handleNewProject","handleLoadSavedProject","SavedProjectsModal","onLoad","projects","setProjects","loading","setLoading","renamingId","setRenamingId","renameValue","setRenameValue","refresh","list","handleDelete","handleRenameStart","currentName","handleRenameSubmit","HistoryControls","history","undo","redo","GridToggle","toggleGrid","setGridDensity","Toolbar","onHelpClick","setProjectName","showShortcuts","setShowShortcuts","gridBorderToolsControls","ShortcutSection","Shortcut","keys","desc","DebugHistoryModal","expandedIndex","setExpandedIndex","getProjectSummary","proj","getLayerChanges","proj1","proj2","changes","layer1","layer2","change","changeIdx","CANVAS_PREVIEW_LAYER_ID","TextLayerModal","existingLayer","setText","setFontSize","setFontFamily","setColor","setTextAlign","fontSearch","setFontSearch","isFontDropdownOpen","setIsFontDropdownOpen","previewOnCanvas","setPreviewOnCanvas","setDisableTransparency","setLineHeight","setLetterSpacing","setFontWeight","previewX","setPreviewX","previewY","setPreviewY","dropdownRef","previewUpdateTimeoutRef","originalVisibilityRef","generatePreview","currentLayer","updateCanvasPreview","removeCanvasPreview","unsubscribe","previewLayer","handleClickOutside","currentLayers","handleCreate","layerX","layerY","filteredFonts","filteredSystemFonts","filteredGoogleFonts","selectedFont","row","preset","align","ShapeModal","setShapeType","setStretchX","setStretchY","handleCreateShape","useKeyboardShortcuts","copySelectedLayers","copySelectedLayersToClipboard","pasteSelectedLayers","pasteFromClipboard","reorderSelectedLayers","isPanningRef","panStartXRef","panStartYRef","keysHeldRef","movementIntervalRef","startContinuousMovement","totalDx","totalDy","movements","stopContinuousMovement","isShift","handleKeyUp","panDeltaX","panDeltaY","getProjectWithoutViewport","rest","useAutoHistory","lastHistoryPushAt","lastProjectRef","debounceTimerRef","lastProjectWithoutViewport","useDebugMenu","setIsOpen","KEY","initDB","request","saveToCache","loadFromCache","AUTO_SAVE_DELAY","useAutoSave","timeoutRef","isLoadedRef","cachedProject","filtered","projectToSave","useAutoResetZoom","hadLayersRef","fitCanvasToScreen","hasLayers","DESKTOP_STEPS","MOBILE_STEPS","LOCALSTORAGE_KEY","TutorialOverlay","currentStep","setCurrentStep","spotlightRect","setSpotlightRect","updateSpotlight","handleNext","handleFinish","handlePrev","placement","getTooltipStyle","pad","tooltipW","tooltipH","clampX","clampY","style","idealLeft","left","idealRight","useRight","getOverlayStyle","_","useTutorialFirstVisit","showTutorial","setShowTutorial","isFirstVisit","setIsFirstVisit","App","isDirty","isTextModalOpen","setIsTextModalOpen","editingTextLayer","setEditingTextLayer","isShapeModalOpen","setIsShapeModalOpen","editingShapeLayer","setEditingShapeLayer","showLayersDrawer","setShowLayersDrawer","showPropertiesDrawer","setShowPropertiesDrawer","resp","isDroppingFile","setIsDroppingFile","canvasDropRef","handleDroppedFiles","counter","onDragEnter","onDragOver","onDragLeave","onDrop","isDebugMenuOpen","setIsDebugMenuOpen","handleOpenTextModal","handleCloseTextModal","handleOpenShapeModal","handleCloseShapeModal","handleBeforeUnload","ReactDOM"],"ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"sources":["../../node_modules/react/cjs/react.production.min.js","../../node_modules/react/index.js","../../node_modules/react/cjs/react-jsx-runtime.production.min.js","../../node_modules/react/jsx-runtime.js","../../node_modules/scheduler/cjs/scheduler.production.min.js","../../node_modules/scheduler/index.js","../../node_modules/react-dom/cjs/react-dom.production.min.js","../../node_modules/react-dom/index.js","../../node_modules/react-dom/client.js","../../node_modules/zustand/esm/vanilla.mjs","../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.production.js","../../node_modules/use-sync-external-store/shim/index.js","../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.js","../../node_modules/use-sync-external-store/shim/with-selector.js","../../node_modules/zustand/esm/index.mjs","../../node_modules/zustand/esm/middleware.mjs","../../src/utils/imageProcessing.ts","../../src/utils/fonts.ts","../../src/utils/textRasterizer.ts","../../src/store/compositorStore.ts","../../src/components/Canvas/GridOverlay.tsx","../../src/components/Canvas/DragInfoTooltip.tsx","../../src/components/Canvas/CanvasRenderer.tsx","../../src/utils/projectSerializer.ts","../../src/components/Canvas/Canvas.tsx","../../src/components/LayerPanel/LayerItem.tsx","../../src/hooks/useLocalStorage.ts","../../src/components/PropertyPanel/CanvasSettings.tsx","../../src/components/LayerPanel/LayerPanel.tsx","../../src/components/PropertyPanel/PositionInputs.tsx","../../src/components/PropertyPanel/OpacityControl.tsx","../../src/components/PropertyPanel/ColorAnalysis.tsx","../../src/utils/shapeRasterizer.ts","../../src/components/PropertyPanel/ShapeProperties.tsx","../../src/hooks/usePortraitMode.ts","../../src/components/Modals/DraggableModal.tsx","../../src/components/Modals/TransparencyMaskModal.tsx","../../src/components/Modals/BgRemovalModal.tsx","../../src/components/Modals/EyedropperModal.tsx","../../src/components/Modals/GeoPixelsPaletteModal.tsx","../../src/components/Modals/PixelatorModal.tsx","../../src/components/Modals/CropModal.tsx","../../src/components/PropertyPanel/PropertyPanel.tsx","../../src/components/Toolbar/ZoomControls.tsx","../../src/utils/projectStorage.ts","../../src/components/Toolbar/FileOperations.tsx","../../src/components/Toolbar/HistoryControls.tsx","../../src/components/Toolbar/GridToggle.tsx","../../src/components/Toolbar/Toolbar.tsx","../../src/components/DebugMenu/DebugHistoryModal.tsx","../../src/components/Modals/TextLayerModal.tsx","../../src/components/Modals/ShapeModal.tsx","../../src/hooks/useKeyboardShortcuts.ts","../../src/hooks/useAutoHistory.ts","../../src/hooks/useDebugMenu.ts","../../src/utils/autoSave.ts","../../src/hooks/useAutoSave.ts","../../src/hooks/useAutoResetZoom.ts","../../src/components/Tutorial/TutorialOverlay.tsx","../../src/App.tsx","../../src/main.tsx"],"sourcesContent":["/**\n * @license React\n * react.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var l=Symbol.for(\"react.element\"),n=Symbol.for(\"react.portal\"),p=Symbol.for(\"react.fragment\"),q=Symbol.for(\"react.strict_mode\"),r=Symbol.for(\"react.profiler\"),t=Symbol.for(\"react.provider\"),u=Symbol.for(\"react.context\"),v=Symbol.for(\"react.forward_ref\"),w=Symbol.for(\"react.suspense\"),x=Symbol.for(\"react.memo\"),y=Symbol.for(\"react.lazy\"),z=Symbol.iterator;function A(a){if(null===a||\"object\"!==typeof a)return null;a=z&&a[z]||a[\"@@iterator\"];return\"function\"===typeof a?a:null}\nvar B={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,D={};function E(a,b,e){this.props=a;this.context=b;this.refs=D;this.updater=e||B}E.prototype.isReactComponent={};\nE.prototype.setState=function(a,b){if(\"object\"!==typeof a&&\"function\"!==typeof a&&null!=a)throw Error(\"setState(...): takes an object of state variables to update or a function which returns an object of state variables.\");this.updater.enqueueSetState(this,a,b,\"setState\")};E.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,\"forceUpdate\")};function F(){}F.prototype=E.prototype;function G(a,b,e){this.props=a;this.context=b;this.refs=D;this.updater=e||B}var H=G.prototype=new F;\nH.constructor=G;C(H,E.prototype);H.isPureReactComponent=!0;var I=Array.isArray,J=Object.prototype.hasOwnProperty,K={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};\nfunction M(a,b,e){var d,c={},k=null,h=null;if(null!=b)for(d in void 0!==b.ref&&(h=b.ref),void 0!==b.key&&(k=\"\"+b.key),b)J.call(b,d)&&!L.hasOwnProperty(d)&&(c[d]=b[d]);var g=arguments.length-2;if(1===g)c.children=e;else if(1<g){for(var f=Array(g),m=0;m<g;m++)f[m]=arguments[m+2];c.children=f}if(a&&a.defaultProps)for(d in g=a.defaultProps,g)void 0===c[d]&&(c[d]=g[d]);return{$$typeof:l,type:a,key:k,ref:h,props:c,_owner:K.current}}\nfunction N(a,b){return{$$typeof:l,type:a.type,key:b,ref:a.ref,props:a.props,_owner:a._owner}}function O(a){return\"object\"===typeof a&&null!==a&&a.$$typeof===l}function escape(a){var b={\"=\":\"=0\",\":\":\"=2\"};return\"$\"+a.replace(/[=:]/g,function(a){return b[a]})}var P=/\\/+/g;function Q(a,b){return\"object\"===typeof a&&null!==a&&null!=a.key?escape(\"\"+a.key):b.toString(36)}\nfunction R(a,b,e,d,c){var k=typeof a;if(\"undefined\"===k||\"boolean\"===k)a=null;var h=!1;if(null===a)h=!0;else switch(k){case \"string\":case \"number\":h=!0;break;case \"object\":switch(a.$$typeof){case l:case n:h=!0}}if(h)return h=a,c=c(h),a=\"\"===d?\".\"+Q(h,0):d,I(c)?(e=\"\",null!=a&&(e=a.replace(P,\"$&/\")+\"/\"),R(c,b,e,\"\",function(a){return a})):null!=c&&(O(c)&&(c=N(c,e+(!c.key||h&&h.key===c.key?\"\":(\"\"+c.key).replace(P,\"$&/\")+\"/\")+a)),b.push(c)),1;h=0;d=\"\"===d?\".\":d+\":\";if(I(a))for(var g=0;g<a.length;g++){k=\na[g];var f=d+Q(k,g);h+=R(k,b,e,f,c)}else if(f=A(a),\"function\"===typeof f)for(a=f.call(a),g=0;!(k=a.next()).done;)k=k.value,f=d+Q(k,g++),h+=R(k,b,e,f,c);else if(\"object\"===k)throw b=String(a),Error(\"Objects are not valid as a React child (found: \"+(\"[object Object]\"===b?\"object with keys {\"+Object.keys(a).join(\", \")+\"}\":b)+\"). If you meant to render a collection of children, use an array instead.\");return h}\nfunction S(a,b,e){if(null==a)return a;var d=[],c=0;R(a,d,\"\",\"\",function(a){return b.call(e,a,c++)});return d}function T(a){if(-1===a._status){var b=a._result;b=b();b.then(function(b){if(0===a._status||-1===a._status)a._status=1,a._result=b},function(b){if(0===a._status||-1===a._status)a._status=2,a._result=b});-1===a._status&&(a._status=0,a._result=b)}if(1===a._status)return a._result.default;throw a._result;}\nvar U={current:null},V={transition:null},W={ReactCurrentDispatcher:U,ReactCurrentBatchConfig:V,ReactCurrentOwner:K};function X(){throw Error(\"act(...) is not supported in production builds of React.\");}\nexports.Children={map:S,forEach:function(a,b,e){S(a,function(){b.apply(this,arguments)},e)},count:function(a){var b=0;S(a,function(){b++});return b},toArray:function(a){return S(a,function(a){return a})||[]},only:function(a){if(!O(a))throw Error(\"React.Children.only expected to receive a single React element child.\");return a}};exports.Component=E;exports.Fragment=p;exports.Profiler=r;exports.PureComponent=G;exports.StrictMode=q;exports.Suspense=w;\nexports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W;exports.act=X;\nexports.cloneElement=function(a,b,e){if(null===a||void 0===a)throw Error(\"React.cloneElement(...): The argument must be a React element, but you passed \"+a+\".\");var d=C({},a.props),c=a.key,k=a.ref,h=a._owner;if(null!=b){void 0!==b.ref&&(k=b.ref,h=K.current);void 0!==b.key&&(c=\"\"+b.key);if(a.type&&a.type.defaultProps)var g=a.type.defaultProps;for(f in b)J.call(b,f)&&!L.hasOwnProperty(f)&&(d[f]=void 0===b[f]&&void 0!==g?g[f]:b[f])}var f=arguments.length-2;if(1===f)d.children=e;else if(1<f){g=Array(f);\nfor(var m=0;m<f;m++)g[m]=arguments[m+2];d.children=g}return{$$typeof:l,type:a.type,key:c,ref:k,props:d,_owner:h}};exports.createContext=function(a){a={$$typeof:u,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null};a.Provider={$$typeof:t,_context:a};return a.Consumer=a};exports.createElement=M;exports.createFactory=function(a){var b=M.bind(null,a);b.type=a;return b};exports.createRef=function(){return{current:null}};\nexports.forwardRef=function(a){return{$$typeof:v,render:a}};exports.isValidElement=O;exports.lazy=function(a){return{$$typeof:y,_payload:{_status:-1,_result:a},_init:T}};exports.memo=function(a,b){return{$$typeof:x,type:a,compare:void 0===b?null:b}};exports.startTransition=function(a){var b=V.transition;V.transition={};try{a()}finally{V.transition=b}};exports.unstable_act=X;exports.useCallback=function(a,b){return U.current.useCallback(a,b)};exports.useContext=function(a){return U.current.useContext(a)};\nexports.useDebugValue=function(){};exports.useDeferredValue=function(a){return U.current.useDeferredValue(a)};exports.useEffect=function(a,b){return U.current.useEffect(a,b)};exports.useId=function(){return U.current.useId()};exports.useImperativeHandle=function(a,b,e){return U.current.useImperativeHandle(a,b,e)};exports.useInsertionEffect=function(a,b){return U.current.useInsertionEffect(a,b)};exports.useLayoutEffect=function(a,b){return U.current.useLayoutEffect(a,b)};\nexports.useMemo=function(a,b){return U.current.useMemo(a,b)};exports.useReducer=function(a,b,e){return U.current.useReducer(a,b,e)};exports.useRef=function(a){return U.current.useRef(a)};exports.useState=function(a){return U.current.useState(a)};exports.useSyncExternalStore=function(a,b,e){return U.current.useSyncExternalStore(a,b,e)};exports.useTransition=function(){return U.current.useTransition()};exports.version=\"18.3.1\";\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react.production.min.js');\n} else {\n  module.exports = require('./cjs/react.development.js');\n}\n","/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f=require(\"react\"),k=Symbol.for(\"react.element\"),l=Symbol.for(\"react.fragment\"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,g){var b,d={},e=null,h=null;void 0!==g&&(e=\"\"+g);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(h=a.ref);for(b in a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l;exports.jsx=q;exports.jsxs=q;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","/**\n * @license React\n * scheduler.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';function f(a,b){var c=a.length;a.push(b);a:for(;0<c;){var d=c-1>>>1,e=a[d];if(0<g(e,b))a[d]=b,a[c]=e,c=d;else break a}}function h(a){return 0===a.length?null:a[0]}function k(a){if(0===a.length)return null;var b=a[0],c=a.pop();if(c!==b){a[0]=c;a:for(var d=0,e=a.length,w=e>>>1;d<w;){var m=2*(d+1)-1,C=a[m],n=m+1,x=a[n];if(0>g(C,c))n<e&&0>g(x,C)?(a[d]=x,a[n]=c,d=n):(a[d]=C,a[m]=c,d=m);else if(n<e&&0>g(x,c))a[d]=x,a[n]=c,d=n;else break a}}return b}\nfunction g(a,b){var c=a.sortIndex-b.sortIndex;return 0!==c?c:a.id-b.id}if(\"object\"===typeof performance&&\"function\"===typeof performance.now){var l=performance;exports.unstable_now=function(){return l.now()}}else{var p=Date,q=p.now();exports.unstable_now=function(){return p.now()-q}}var r=[],t=[],u=1,v=null,y=3,z=!1,A=!1,B=!1,D=\"function\"===typeof setTimeout?setTimeout:null,E=\"function\"===typeof clearTimeout?clearTimeout:null,F=\"undefined\"!==typeof setImmediate?setImmediate:null;\n\"undefined\"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function G(a){for(var b=h(t);null!==b;){if(null===b.callback)k(t);else if(b.startTime<=a)k(t),b.sortIndex=b.expirationTime,f(r,b);else break;b=h(t)}}function H(a){B=!1;G(a);if(!A)if(null!==h(r))A=!0,I(J);else{var b=h(t);null!==b&&K(H,b.startTime-a)}}\nfunction J(a,b){A=!1;B&&(B=!1,E(L),L=-1);z=!0;var c=y;try{G(b);for(v=h(r);null!==v&&(!(v.expirationTime>b)||a&&!M());){var d=v.callback;if(\"function\"===typeof d){v.callback=null;y=v.priorityLevel;var e=d(v.expirationTime<=b);b=exports.unstable_now();\"function\"===typeof e?v.callback=e:v===h(r)&&k(r);G(b)}else k(r);v=h(r)}if(null!==v)var w=!0;else{var m=h(t);null!==m&&K(H,m.startTime-b);w=!1}return w}finally{v=null,y=c,z=!1}}var N=!1,O=null,L=-1,P=5,Q=-1;\nfunction M(){return exports.unstable_now()-Q<P?!1:!0}function R(){if(null!==O){var a=exports.unstable_now();Q=a;var b=!0;try{b=O(!0,a)}finally{b?S():(N=!1,O=null)}}else N=!1}var S;if(\"function\"===typeof F)S=function(){F(R)};else if(\"undefined\"!==typeof MessageChannel){var T=new MessageChannel,U=T.port2;T.port1.onmessage=R;S=function(){U.postMessage(null)}}else S=function(){D(R,0)};function I(a){O=a;N||(N=!0,S())}function K(a,b){L=D(function(){a(exports.unstable_now())},b)}\nexports.unstable_IdlePriority=5;exports.unstable_ImmediatePriority=1;exports.unstable_LowPriority=4;exports.unstable_NormalPriority=3;exports.unstable_Profiling=null;exports.unstable_UserBlockingPriority=2;exports.unstable_cancelCallback=function(a){a.callback=null};exports.unstable_continueExecution=function(){A||z||(A=!0,I(J))};\nexports.unstable_forceFrameRate=function(a){0>a||125<a?console.error(\"forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported\"):P=0<a?Math.floor(1E3/a):5};exports.unstable_getCurrentPriorityLevel=function(){return y};exports.unstable_getFirstCallbackNode=function(){return h(r)};exports.unstable_next=function(a){switch(y){case 1:case 2:case 3:var b=3;break;default:b=y}var c=y;y=b;try{return a()}finally{y=c}};exports.unstable_pauseExecution=function(){};\nexports.unstable_requestPaint=function(){};exports.unstable_runWithPriority=function(a,b){switch(a){case 1:case 2:case 3:case 4:case 5:break;default:a=3}var c=y;y=a;try{return b()}finally{y=c}};\nexports.unstable_scheduleCallback=function(a,b,c){var d=exports.unstable_now();\"object\"===typeof c&&null!==c?(c=c.delay,c=\"number\"===typeof c&&0<c?d+c:d):c=d;switch(a){case 1:var e=-1;break;case 2:e=250;break;case 5:e=1073741823;break;case 4:e=1E4;break;default:e=5E3}e=c+e;a={id:u++,callback:b,priorityLevel:a,startTime:c,expirationTime:e,sortIndex:-1};c>d?(a.sortIndex=c,f(t,a),null===h(r)&&a===h(t)&&(B?(E(L),L=-1):B=!0,K(H,c-d))):(a.sortIndex=e,f(r,a),A||z||(A=!0,I(J)));return a};\nexports.unstable_shouldYield=M;exports.unstable_wrapCallback=function(a){var b=y;return function(){var c=y;y=b;try{return a.apply(this,arguments)}finally{y=c}}};\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/scheduler.production.min.js');\n} else {\n  module.exports = require('./cjs/scheduler.development.js');\n}\n","/**\n * @license React\n * react-dom.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n/*\n Modernizr 3.0.0pre (Custom Build) | MIT\n*/\n'use strict';var aa=require(\"react\"),ca=require(\"scheduler\");function p(a){for(var b=\"https://reactjs.org/docs/error-decoder.html?invariant=\"+a,c=1;c<arguments.length;c++)b+=\"&args[]=\"+encodeURIComponent(arguments[c]);return\"Minified React error #\"+a+\"; visit \"+b+\" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\"}var da=new Set,ea={};function fa(a,b){ha(a,b);ha(a+\"Capture\",b)}\nfunction ha(a,b){ea[a]=b;for(a=0;a<b.length;a++)da.add(b[a])}\nvar ia=!(\"undefined\"===typeof window||\"undefined\"===typeof window.document||\"undefined\"===typeof window.document.createElement),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$/,la=\n{},ma={};function oa(a){if(ja.call(ma,a))return!0;if(ja.call(la,a))return!1;if(ka.test(a))return ma[a]=!0;la[a]=!0;return!1}function pa(a,b,c,d){if(null!==c&&0===c.type)return!1;switch(typeof b){case \"function\":case \"symbol\":return!0;case \"boolean\":if(d)return!1;if(null!==c)return!c.acceptsBooleans;a=a.toLowerCase().slice(0,5);return\"data-\"!==a&&\"aria-\"!==a;default:return!1}}\nfunction qa(a,b,c,d){if(null===b||\"undefined\"===typeof b||pa(a,b,c,d))return!0;if(d)return!1;if(null!==c)switch(c.type){case 3:return!b;case 4:return!1===b;case 5:return isNaN(b);case 6:return isNaN(b)||1>b}return!1}function v(a,b,c,d,e,f,g){this.acceptsBooleans=2===b||3===b||4===b;this.attributeName=d;this.attributeNamespace=e;this.mustUseProperty=c;this.propertyName=a;this.type=b;this.sanitizeURL=f;this.removeEmptyString=g}var z={};\n\"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style\".split(\" \").forEach(function(a){z[a]=new v(a,0,!1,a,null,!1,!1)});[[\"acceptCharset\",\"accept-charset\"],[\"className\",\"class\"],[\"htmlFor\",\"for\"],[\"httpEquiv\",\"http-equiv\"]].forEach(function(a){var b=a[0];z[b]=new v(b,1,!1,a[1],null,!1,!1)});[\"contentEditable\",\"draggable\",\"spellCheck\",\"value\"].forEach(function(a){z[a]=new v(a,2,!1,a.toLowerCase(),null,!1,!1)});\n[\"autoReverse\",\"externalResourcesRequired\",\"focusable\",\"preserveAlpha\"].forEach(function(a){z[a]=new v(a,2,!1,a,null,!1,!1)});\"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope\".split(\" \").forEach(function(a){z[a]=new v(a,3,!1,a.toLowerCase(),null,!1,!1)});\n[\"checked\",\"multiple\",\"muted\",\"selected\"].forEach(function(a){z[a]=new v(a,3,!0,a,null,!1,!1)});[\"capture\",\"download\"].forEach(function(a){z[a]=new v(a,4,!1,a,null,!1,!1)});[\"cols\",\"rows\",\"size\",\"span\"].forEach(function(a){z[a]=new v(a,6,!1,a,null,!1,!1)});[\"rowSpan\",\"start\"].forEach(function(a){z[a]=new v(a,5,!1,a.toLowerCase(),null,!1,!1)});var ra=/[\\-:]([a-z])/g;function sa(a){return a[1].toUpperCase()}\n\"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height\".split(\" \").forEach(function(a){var b=a.replace(ra,\nsa);z[b]=new v(b,1,!1,a,null,!1,!1)});\"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type\".split(\" \").forEach(function(a){var b=a.replace(ra,sa);z[b]=new v(b,1,!1,a,\"http://www.w3.org/1999/xlink\",!1,!1)});[\"xml:base\",\"xml:lang\",\"xml:space\"].forEach(function(a){var b=a.replace(ra,sa);z[b]=new v(b,1,!1,a,\"http://www.w3.org/XML/1998/namespace\",!1,!1)});[\"tabIndex\",\"crossOrigin\"].forEach(function(a){z[a]=new v(a,1,!1,a.toLowerCase(),null,!1,!1)});\nz.xlinkHref=new v(\"xlinkHref\",1,!1,\"xlink:href\",\"http://www.w3.org/1999/xlink\",!0,!1);[\"src\",\"href\",\"action\",\"formAction\"].forEach(function(a){z[a]=new v(a,1,!1,a.toLowerCase(),null,!0,!0)});\nfunction ta(a,b,c,d){var e=z.hasOwnProperty(b)?z[b]:null;if(null!==e?0!==e.type:d||!(2<b.length)||\"o\"!==b[0]&&\"O\"!==b[0]||\"n\"!==b[1]&&\"N\"!==b[1])qa(b,c,e,d)&&(c=null),d||null===e?oa(b)&&(null===c?a.removeAttribute(b):a.setAttribute(b,\"\"+c)):e.mustUseProperty?a[e.propertyName]=null===c?3===e.type?!1:\"\":c:(b=e.attributeName,d=e.attributeNamespace,null===c?a.removeAttribute(b):(e=e.type,c=3===e||4===e&&!0===c?\"\":\"\"+c,d?a.setAttributeNS(d,b,c):a.setAttribute(b,c)))}\nvar ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for(\"react.element\"),wa=Symbol.for(\"react.portal\"),ya=Symbol.for(\"react.fragment\"),za=Symbol.for(\"react.strict_mode\"),Aa=Symbol.for(\"react.profiler\"),Ba=Symbol.for(\"react.provider\"),Ca=Symbol.for(\"react.context\"),Da=Symbol.for(\"react.forward_ref\"),Ea=Symbol.for(\"react.suspense\"),Fa=Symbol.for(\"react.suspense_list\"),Ga=Symbol.for(\"react.memo\"),Ha=Symbol.for(\"react.lazy\");Symbol.for(\"react.scope\");Symbol.for(\"react.debug_trace_mode\");\nvar Ia=Symbol.for(\"react.offscreen\");Symbol.for(\"react.legacy_hidden\");Symbol.for(\"react.cache\");Symbol.for(\"react.tracing_marker\");var Ja=Symbol.iterator;function Ka(a){if(null===a||\"object\"!==typeof a)return null;a=Ja&&a[Ja]||a[\"@@iterator\"];return\"function\"===typeof a?a:null}var A=Object.assign,La;function Ma(a){if(void 0===La)try{throw Error();}catch(c){var b=c.stack.trim().match(/\\n( *(at )?)/);La=b&&b[1]||\"\"}return\"\\n\"+La+a}var Na=!1;\nfunction Oa(a,b){if(!a||Na)return\"\";Na=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(b)if(b=function(){throw Error();},Object.defineProperty(b.prototype,\"props\",{set:function(){throw Error();}}),\"object\"===typeof Reflect&&Reflect.construct){try{Reflect.construct(b,[])}catch(l){var d=l}Reflect.construct(a,[],b)}else{try{b.call()}catch(l){d=l}a.call(b.prototype)}else{try{throw Error();}catch(l){d=l}a()}}catch(l){if(l&&d&&\"string\"===typeof l.stack){for(var e=l.stack.split(\"\\n\"),\nf=d.stack.split(\"\\n\"),g=e.length-1,h=f.length-1;1<=g&&0<=h&&e[g]!==f[h];)h--;for(;1<=g&&0<=h;g--,h--)if(e[g]!==f[h]){if(1!==g||1!==h){do if(g--,h--,0>h||e[g]!==f[h]){var k=\"\\n\"+e[g].replace(\" at new \",\" at \");a.displayName&&k.includes(\"<anonymous>\")&&(k=k.replace(\"<anonymous>\",a.displayName));return k}while(1<=g&&0<=h)}break}}}finally{Na=!1,Error.prepareStackTrace=c}return(a=a?a.displayName||a.name:\"\")?Ma(a):\"\"}\nfunction Pa(a){switch(a.tag){case 5:return Ma(a.type);case 16:return Ma(\"Lazy\");case 13:return Ma(\"Suspense\");case 19:return Ma(\"SuspenseList\");case 0:case 2:case 15:return a=Oa(a.type,!1),a;case 11:return a=Oa(a.type.render,!1),a;case 1:return a=Oa(a.type,!0),a;default:return\"\"}}\nfunction Qa(a){if(null==a)return null;if(\"function\"===typeof a)return a.displayName||a.name||null;if(\"string\"===typeof a)return a;switch(a){case ya:return\"Fragment\";case wa:return\"Portal\";case Aa:return\"Profiler\";case za:return\"StrictMode\";case Ea:return\"Suspense\";case Fa:return\"SuspenseList\"}if(\"object\"===typeof a)switch(a.$$typeof){case Ca:return(a.displayName||\"Context\")+\".Consumer\";case Ba:return(a._context.displayName||\"Context\")+\".Provider\";case Da:var b=a.render;a=a.displayName;a||(a=b.displayName||\nb.name||\"\",a=\"\"!==a?\"ForwardRef(\"+a+\")\":\"ForwardRef\");return a;case Ga:return b=a.displayName||null,null!==b?b:Qa(a.type)||\"Memo\";case Ha:b=a._payload;a=a._init;try{return Qa(a(b))}catch(c){}}return null}\nfunction Ra(a){var b=a.type;switch(a.tag){case 24:return\"Cache\";case 9:return(b.displayName||\"Context\")+\".Consumer\";case 10:return(b._context.displayName||\"Context\")+\".Provider\";case 18:return\"DehydratedFragment\";case 11:return a=b.render,a=a.displayName||a.name||\"\",b.displayName||(\"\"!==a?\"ForwardRef(\"+a+\")\":\"ForwardRef\");case 7:return\"Fragment\";case 5:return b;case 4:return\"Portal\";case 3:return\"Root\";case 6:return\"Text\";case 16:return Qa(b);case 8:return b===za?\"StrictMode\":\"Mode\";case 22:return\"Offscreen\";\ncase 12:return\"Profiler\";case 21:return\"Scope\";case 13:return\"Suspense\";case 19:return\"SuspenseList\";case 25:return\"TracingMarker\";case 1:case 0:case 17:case 2:case 14:case 15:if(\"function\"===typeof b)return b.displayName||b.name||null;if(\"string\"===typeof b)return b}return null}function Sa(a){switch(typeof a){case \"boolean\":case \"number\":case \"string\":case \"undefined\":return a;case \"object\":return a;default:return\"\"}}\nfunction Ta(a){var b=a.type;return(a=a.nodeName)&&\"input\"===a.toLowerCase()&&(\"checkbox\"===b||\"radio\"===b)}\nfunction Ua(a){var b=Ta(a)?\"checked\":\"value\",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,b),d=\"\"+a[b];if(!a.hasOwnProperty(b)&&\"undefined\"!==typeof c&&\"function\"===typeof c.get&&\"function\"===typeof c.set){var e=c.get,f=c.set;Object.defineProperty(a,b,{configurable:!0,get:function(){return e.call(this)},set:function(a){d=\"\"+a;f.call(this,a)}});Object.defineProperty(a,b,{enumerable:c.enumerable});return{getValue:function(){return d},setValue:function(a){d=\"\"+a},stopTracking:function(){a._valueTracker=\nnull;delete a[b]}}}}function Va(a){a._valueTracker||(a._valueTracker=Ua(a))}function Wa(a){if(!a)return!1;var b=a._valueTracker;if(!b)return!0;var c=b.getValue();var d=\"\";a&&(d=Ta(a)?a.checked?\"true\":\"false\":a.value);a=d;return a!==c?(b.setValue(a),!0):!1}function Xa(a){a=a||(\"undefined\"!==typeof document?document:void 0);if(\"undefined\"===typeof a)return null;try{return a.activeElement||a.body}catch(b){return a.body}}\nfunction Ya(a,b){var c=b.checked;return A({},b,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=c?c:a._wrapperState.initialChecked})}function Za(a,b){var c=null==b.defaultValue?\"\":b.defaultValue,d=null!=b.checked?b.checked:b.defaultChecked;c=Sa(null!=b.value?b.value:c);a._wrapperState={initialChecked:d,initialValue:c,controlled:\"checkbox\"===b.type||\"radio\"===b.type?null!=b.checked:null!=b.value}}function ab(a,b){b=b.checked;null!=b&&ta(a,\"checked\",b,!1)}\nfunction bb(a,b){ab(a,b);var c=Sa(b.value),d=b.type;if(null!=c)if(\"number\"===d){if(0===c&&\"\"===a.value||a.value!=c)a.value=\"\"+c}else a.value!==\"\"+c&&(a.value=\"\"+c);else if(\"submit\"===d||\"reset\"===d){a.removeAttribute(\"value\");return}b.hasOwnProperty(\"value\")?cb(a,b.type,c):b.hasOwnProperty(\"defaultValue\")&&cb(a,b.type,Sa(b.defaultValue));null==b.checked&&null!=b.defaultChecked&&(a.defaultChecked=!!b.defaultChecked)}\nfunction db(a,b,c){if(b.hasOwnProperty(\"value\")||b.hasOwnProperty(\"defaultValue\")){var d=b.type;if(!(\"submit\"!==d&&\"reset\"!==d||void 0!==b.value&&null!==b.value))return;b=\"\"+a._wrapperState.initialValue;c||b===a.value||(a.value=b);a.defaultValue=b}c=a.name;\"\"!==c&&(a.name=\"\");a.defaultChecked=!!a._wrapperState.initialChecked;\"\"!==c&&(a.name=c)}\nfunction cb(a,b,c){if(\"number\"!==b||Xa(a.ownerDocument)!==a)null==c?a.defaultValue=\"\"+a._wrapperState.initialValue:a.defaultValue!==\"\"+c&&(a.defaultValue=\"\"+c)}var eb=Array.isArray;\nfunction fb(a,b,c,d){a=a.options;if(b){b={};for(var e=0;e<c.length;e++)b[\"$\"+c[e]]=!0;for(c=0;c<a.length;c++)e=b.hasOwnProperty(\"$\"+a[c].value),a[c].selected!==e&&(a[c].selected=e),e&&d&&(a[c].defaultSelected=!0)}else{c=\"\"+Sa(c);b=null;for(e=0;e<a.length;e++){if(a[e].value===c){a[e].selected=!0;d&&(a[e].defaultSelected=!0);return}null!==b||a[e].disabled||(b=a[e])}null!==b&&(b.selected=!0)}}\nfunction gb(a,b){if(null!=b.dangerouslySetInnerHTML)throw Error(p(91));return A({},b,{value:void 0,defaultValue:void 0,children:\"\"+a._wrapperState.initialValue})}function hb(a,b){var c=b.value;if(null==c){c=b.children;b=b.defaultValue;if(null!=c){if(null!=b)throw Error(p(92));if(eb(c)){if(1<c.length)throw Error(p(93));c=c[0]}b=c}null==b&&(b=\"\");c=b}a._wrapperState={initialValue:Sa(c)}}\nfunction ib(a,b){var c=Sa(b.value),d=Sa(b.defaultValue);null!=c&&(c=\"\"+c,c!==a.value&&(a.value=c),null==b.defaultValue&&a.defaultValue!==c&&(a.defaultValue=c));null!=d&&(a.defaultValue=\"\"+d)}function jb(a){var b=a.textContent;b===a._wrapperState.initialValue&&\"\"!==b&&null!==b&&(a.value=b)}function kb(a){switch(a){case \"svg\":return\"http://www.w3.org/2000/svg\";case \"math\":return\"http://www.w3.org/1998/Math/MathML\";default:return\"http://www.w3.org/1999/xhtml\"}}\nfunction lb(a,b){return null==a||\"http://www.w3.org/1999/xhtml\"===a?kb(b):\"http://www.w3.org/2000/svg\"===a&&\"foreignObject\"===b?\"http://www.w3.org/1999/xhtml\":a}\nvar mb,nb=function(a){return\"undefined\"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(b,c,d,e){MSApp.execUnsafeLocalFunction(function(){return a(b,c,d,e)})}:a}(function(a,b){if(\"http://www.w3.org/2000/svg\"!==a.namespaceURI||\"innerHTML\"in a)a.innerHTML=b;else{mb=mb||document.createElement(\"div\");mb.innerHTML=\"<svg>\"+b.valueOf().toString()+\"</svg>\";for(b=mb.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;b.firstChild;)a.appendChild(b.firstChild)}});\nfunction ob(a,b){if(b){var c=a.firstChild;if(c&&c===a.lastChild&&3===c.nodeType){c.nodeValue=b;return}}a.textContent=b}\nvar pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,\nzoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=[\"Webkit\",\"ms\",\"Moz\",\"O\"];Object.keys(pb).forEach(function(a){qb.forEach(function(b){b=b+a.charAt(0).toUpperCase()+a.substring(1);pb[b]=pb[a]})});function rb(a,b,c){return null==b||\"boolean\"===typeof b||\"\"===b?\"\":c||\"number\"!==typeof b||0===b||pb.hasOwnProperty(a)&&pb[a]?(\"\"+b).trim():b+\"px\"}\nfunction sb(a,b){a=a.style;for(var c in b)if(b.hasOwnProperty(c)){var d=0===c.indexOf(\"--\"),e=rb(c,b[c],d);\"float\"===c&&(c=\"cssFloat\");d?a.setProperty(c,e):a[c]=e}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});\nfunction ub(a,b){if(b){if(tb[a]&&(null!=b.children||null!=b.dangerouslySetInnerHTML))throw Error(p(137,a));if(null!=b.dangerouslySetInnerHTML){if(null!=b.children)throw Error(p(60));if(\"object\"!==typeof b.dangerouslySetInnerHTML||!(\"__html\"in b.dangerouslySetInnerHTML))throw Error(p(61));}if(null!=b.style&&\"object\"!==typeof b.style)throw Error(p(62));}}\nfunction vb(a,b){if(-1===a.indexOf(\"-\"))return\"string\"===typeof b.is;switch(a){case \"annotation-xml\":case \"color-profile\":case \"font-face\":case \"font-face-src\":case \"font-face-uri\":case \"font-face-format\":case \"font-face-name\":case \"missing-glyph\":return!1;default:return!0}}var wb=null;function xb(a){a=a.target||a.srcElement||window;a.correspondingUseElement&&(a=a.correspondingUseElement);return 3===a.nodeType?a.parentNode:a}var yb=null,zb=null,Ab=null;\nfunction Bb(a){if(a=Cb(a)){if(\"function\"!==typeof yb)throw Error(p(280));var b=a.stateNode;b&&(b=Db(b),yb(a.stateNode,a.type,b))}}function Eb(a){zb?Ab?Ab.push(a):Ab=[a]:zb=a}function Fb(){if(zb){var a=zb,b=Ab;Ab=zb=null;Bb(a);if(b)for(a=0;a<b.length;a++)Bb(b[a])}}function Gb(a,b){return a(b)}function Hb(){}var Ib=!1;function Jb(a,b,c){if(Ib)return a(b,c);Ib=!0;try{return Gb(a,b,c)}finally{if(Ib=!1,null!==zb||null!==Ab)Hb(),Fb()}}\nfunction Kb(a,b){var c=a.stateNode;if(null===c)return null;var d=Db(c);if(null===d)return null;c=d[b];a:switch(b){case \"onClick\":case \"onClickCapture\":case \"onDoubleClick\":case \"onDoubleClickCapture\":case \"onMouseDown\":case \"onMouseDownCapture\":case \"onMouseMove\":case \"onMouseMoveCapture\":case \"onMouseUp\":case \"onMouseUpCapture\":case \"onMouseEnter\":(d=!d.disabled)||(a=a.type,d=!(\"button\"===a||\"input\"===a||\"select\"===a||\"textarea\"===a));a=!d;break a;default:a=!1}if(a)return null;if(c&&\"function\"!==\ntypeof c)throw Error(p(231,b,typeof c));return c}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,\"passive\",{get:function(){Lb=!0}});window.addEventListener(\"test\",Mb,Mb);window.removeEventListener(\"test\",Mb,Mb)}catch(a){Lb=!1}function Nb(a,b,c,d,e,f,g,h,k){var l=Array.prototype.slice.call(arguments,3);try{b.apply(c,l)}catch(m){this.onError(m)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(a){Ob=!0;Pb=a}};function Tb(a,b,c,d,e,f,g,h,k){Ob=!1;Pb=null;Nb.apply(Sb,arguments)}\nfunction Ub(a,b,c,d,e,f,g,h,k){Tb.apply(this,arguments);if(Ob){if(Ob){var l=Pb;Ob=!1;Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=l)}}function Vb(a){var b=a,c=a;if(a.alternate)for(;b.return;)b=b.return;else{a=b;do b=a,0!==(b.flags&4098)&&(c=b.return),a=b.return;while(a)}return 3===b.tag?c:null}function Wb(a){if(13===a.tag){var b=a.memoizedState;null===b&&(a=a.alternate,null!==a&&(b=a.memoizedState));if(null!==b)return b.dehydrated}return null}function Xb(a){if(Vb(a)!==a)throw Error(p(188));}\nfunction Yb(a){var b=a.alternate;if(!b){b=Vb(a);if(null===b)throw Error(p(188));return b!==a?null:a}for(var c=a,d=b;;){var e=c.return;if(null===e)break;var f=e.alternate;if(null===f){d=e.return;if(null!==d){c=d;continue}break}if(e.child===f.child){for(f=e.child;f;){if(f===c)return Xb(e),a;if(f===d)return Xb(e),b;f=f.sibling}throw Error(p(188));}if(c.return!==d.return)c=e,d=f;else{for(var g=!1,h=e.child;h;){if(h===c){g=!0;c=e;d=f;break}if(h===d){g=!0;d=e;c=f;break}h=h.sibling}if(!g){for(h=f.child;h;){if(h===\nc){g=!0;c=f;d=e;break}if(h===d){g=!0;d=f;c=e;break}h=h.sibling}if(!g)throw Error(p(189));}}if(c.alternate!==d)throw Error(p(190));}if(3!==c.tag)throw Error(p(188));return c.stateNode.current===c?a:b}function Zb(a){a=Yb(a);return null!==a?$b(a):null}function $b(a){if(5===a.tag||6===a.tag)return a;for(a=a.child;null!==a;){var b=$b(a);if(null!==b)return b;a=a.sibling}return null}\nvar ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(a){if(lc&&\"function\"===typeof lc.onCommitFiberRoot)try{lc.onCommitFiberRoot(kc,a,void 0,128===(a.current.flags&128))}catch(b){}}\nvar oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(a){a>>>=0;return 0===a?32:31-(pc(a)/qc|0)|0}var rc=64,sc=4194304;\nfunction tc(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;\ndefault:return a}}function uc(a,b){var c=a.pendingLanes;if(0===c)return 0;var d=0,e=a.suspendedLanes,f=a.pingedLanes,g=c&268435455;if(0!==g){var h=g&~e;0!==h?d=tc(h):(f&=g,0!==f&&(d=tc(f)))}else g=c&~e,0!==g?d=tc(g):0!==f&&(d=tc(f));if(0===d)return 0;if(0!==b&&b!==d&&0===(b&e)&&(e=d&-d,f=b&-b,e>=f||16===e&&0!==(f&4194240)))return b;0!==(d&4)&&(d|=c&16);b=a.entangledLanes;if(0!==b)for(a=a.entanglements,b&=d;0<b;)c=31-oc(b),e=1<<c,d|=a[c],b&=~e;return d}\nfunction vc(a,b){switch(a){case 1:case 2:case 4:return b+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return b+5E3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}\nfunction wc(a,b){for(var c=a.suspendedLanes,d=a.pingedLanes,e=a.expirationTimes,f=a.pendingLanes;0<f;){var g=31-oc(f),h=1<<g,k=e[g];if(-1===k){if(0===(h&c)||0!==(h&d))e[g]=vc(h,b)}else k<=b&&(a.expiredLanes|=h);f&=~h}}function xc(a){a=a.pendingLanes&-1073741825;return 0!==a?a:a&1073741824?1073741824:0}function yc(){var a=rc;rc<<=1;0===(rc&4194240)&&(rc=64);return a}function zc(a){for(var b=[],c=0;31>c;c++)b.push(a);return b}\nfunction Ac(a,b,c){a.pendingLanes|=b;536870912!==b&&(a.suspendedLanes=0,a.pingedLanes=0);a=a.eventTimes;b=31-oc(b);a[b]=c}function Bc(a,b){var c=a.pendingLanes&~b;a.pendingLanes=b;a.suspendedLanes=0;a.pingedLanes=0;a.expiredLanes&=b;a.mutableReadLanes&=b;a.entangledLanes&=b;b=a.entanglements;var d=a.eventTimes;for(a=a.expirationTimes;0<c;){var e=31-oc(c),f=1<<e;b[e]=0;d[e]=-1;a[e]=-1;c&=~f}}\nfunction Cc(a,b){var c=a.entangledLanes|=b;for(a=a.entanglements;c;){var d=31-oc(c),e=1<<d;e&b|a[d]&b&&(a[d]|=b);c&=~e}}var C=0;function Dc(a){a&=-a;return 1<a?4<a?0!==(a&268435455)?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc=\"mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit\".split(\" \");\nfunction Sc(a,b){switch(a){case \"focusin\":case \"focusout\":Lc=null;break;case \"dragenter\":case \"dragleave\":Mc=null;break;case \"mouseover\":case \"mouseout\":Nc=null;break;case \"pointerover\":case \"pointerout\":Oc.delete(b.pointerId);break;case \"gotpointercapture\":case \"lostpointercapture\":Pc.delete(b.pointerId)}}\nfunction Tc(a,b,c,d,e,f){if(null===a||a.nativeEvent!==f)return a={blockedOn:b,domEventName:c,eventSystemFlags:d,nativeEvent:f,targetContainers:[e]},null!==b&&(b=Cb(b),null!==b&&Fc(b)),a;a.eventSystemFlags|=d;b=a.targetContainers;null!==e&&-1===b.indexOf(e)&&b.push(e);return a}\nfunction Uc(a,b,c,d,e){switch(b){case \"focusin\":return Lc=Tc(Lc,a,b,c,d,e),!0;case \"dragenter\":return Mc=Tc(Mc,a,b,c,d,e),!0;case \"mouseover\":return Nc=Tc(Nc,a,b,c,d,e),!0;case \"pointerover\":var f=e.pointerId;Oc.set(f,Tc(Oc.get(f)||null,a,b,c,d,e));return!0;case \"gotpointercapture\":return f=e.pointerId,Pc.set(f,Tc(Pc.get(f)||null,a,b,c,d,e)),!0}return!1}\nfunction Vc(a){var b=Wc(a.target);if(null!==b){var c=Vb(b);if(null!==c)if(b=c.tag,13===b){if(b=Wb(c),null!==b){a.blockedOn=b;Ic(a.priority,function(){Gc(c)});return}}else if(3===b&&c.stateNode.current.memoizedState.isDehydrated){a.blockedOn=3===c.tag?c.stateNode.containerInfo:null;return}}a.blockedOn=null}\nfunction Xc(a){if(null!==a.blockedOn)return!1;for(var b=a.targetContainers;0<b.length;){var c=Yc(a.domEventName,a.eventSystemFlags,b[0],a.nativeEvent);if(null===c){c=a.nativeEvent;var d=new c.constructor(c.type,c);wb=d;c.target.dispatchEvent(d);wb=null}else return b=Cb(c),null!==b&&Fc(b),a.blockedOn=c,!1;b.shift()}return!0}function Zc(a,b,c){Xc(a)&&c.delete(b)}function $c(){Jc=!1;null!==Lc&&Xc(Lc)&&(Lc=null);null!==Mc&&Xc(Mc)&&(Mc=null);null!==Nc&&Xc(Nc)&&(Nc=null);Oc.forEach(Zc);Pc.forEach(Zc)}\nfunction ad(a,b){a.blockedOn===b&&(a.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}\nfunction bd(a){function b(b){return ad(b,a)}if(0<Kc.length){ad(Kc[0],a);for(var c=1;c<Kc.length;c++){var d=Kc[c];d.blockedOn===a&&(d.blockedOn=null)}}null!==Lc&&ad(Lc,a);null!==Mc&&ad(Mc,a);null!==Nc&&ad(Nc,a);Oc.forEach(b);Pc.forEach(b);for(c=0;c<Qc.length;c++)d=Qc[c],d.blockedOn===a&&(d.blockedOn=null);for(;0<Qc.length&&(c=Qc[0],null===c.blockedOn);)Vc(c),null===c.blockedOn&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;\nfunction ed(a,b,c,d){var e=C,f=cd.transition;cd.transition=null;try{C=1,fd(a,b,c,d)}finally{C=e,cd.transition=f}}function gd(a,b,c,d){var e=C,f=cd.transition;cd.transition=null;try{C=4,fd(a,b,c,d)}finally{C=e,cd.transition=f}}\nfunction fd(a,b,c,d){if(dd){var e=Yc(a,b,c,d);if(null===e)hd(a,b,d,id,c),Sc(a,d);else if(Uc(e,a,b,c,d))d.stopPropagation();else if(Sc(a,d),b&4&&-1<Rc.indexOf(a)){for(;null!==e;){var f=Cb(e);null!==f&&Ec(f);f=Yc(a,b,c,d);null===f&&hd(a,b,d,id,c);if(f===e)break;e=f}null!==e&&d.stopPropagation()}else hd(a,b,d,null,c)}}var id=null;\nfunction Yc(a,b,c,d){id=null;a=xb(d);a=Wc(a);if(null!==a)if(b=Vb(a),null===b)a=null;else if(c=b.tag,13===c){a=Wb(b);if(null!==a)return a;a=null}else if(3===c){if(b.stateNode.current.memoizedState.isDehydrated)return 3===b.tag?b.stateNode.containerInfo:null;a=null}else b!==a&&(a=null);id=a;return null}\nfunction jd(a){switch(a){case \"cancel\":case \"click\":case \"close\":case \"contextmenu\":case \"copy\":case \"cut\":case \"auxclick\":case \"dblclick\":case \"dragend\":case \"dragstart\":case \"drop\":case \"focusin\":case \"focusout\":case \"input\":case \"invalid\":case \"keydown\":case \"keypress\":case \"keyup\":case \"mousedown\":case \"mouseup\":case \"paste\":case \"pause\":case \"play\":case \"pointercancel\":case \"pointerdown\":case \"pointerup\":case \"ratechange\":case \"reset\":case \"resize\":case \"seeked\":case \"submit\":case \"touchcancel\":case \"touchend\":case \"touchstart\":case \"volumechange\":case \"change\":case \"selectionchange\":case \"textInput\":case \"compositionstart\":case \"compositionend\":case \"compositionupdate\":case \"beforeblur\":case \"afterblur\":case \"beforeinput\":case \"blur\":case \"fullscreenchange\":case \"focus\":case \"hashchange\":case \"popstate\":case \"select\":case \"selectstart\":return 1;case \"drag\":case \"dragenter\":case \"dragexit\":case \"dragleave\":case \"dragover\":case \"mousemove\":case \"mouseout\":case \"mouseover\":case \"pointermove\":case \"pointerout\":case \"pointerover\":case \"scroll\":case \"toggle\":case \"touchmove\":case \"wheel\":case \"mouseenter\":case \"mouseleave\":case \"pointerenter\":case \"pointerleave\":return 4;\ncase \"message\":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var a,b=ld,c=b.length,d,e=\"value\"in kd?kd.value:kd.textContent,f=e.length;for(a=0;a<c&&b[a]===e[a];a++);var g=c-a;for(d=1;d<=g&&b[c-d]===e[f-d];d++);return md=e.slice(a,1<d?1-d:void 0)}\nfunction od(a){var b=a.keyCode;\"charCode\"in a?(a=a.charCode,0===a&&13===b&&(a=13)):a=b;10===a&&(a=13);return 32<=a||13===a?a:0}function pd(){return!0}function qd(){return!1}\nfunction rd(a){function b(b,d,e,f,g){this._reactName=b;this._targetInst=e;this.type=d;this.nativeEvent=f;this.target=g;this.currentTarget=null;for(var c in a)a.hasOwnProperty(c)&&(b=a[c],this[c]=b?b(f):f[c]);this.isDefaultPrevented=(null!=f.defaultPrevented?f.defaultPrevented:!1===f.returnValue)?pd:qd;this.isPropagationStopped=qd;return this}A(b.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():\"unknown\"!==typeof a.returnValue&&\n(a.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():\"unknown\"!==typeof a.cancelBubble&&(a.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd});return b}\nvar sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(a){return void 0===a.relatedTarget?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){if(\"movementX\"in\na)return a.movementX;a!==yd&&(yd&&\"mousemove\"===a.type?(wd=a.screenX-yd.screenX,xd=a.screenY-yd.screenY):xd=wd=0,yd=a);return wd},movementY:function(a){return\"movementY\"in a?a.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(a){return\"clipboardData\"in a?a.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:\"Escape\",\nSpacebar:\" \",Left:\"ArrowLeft\",Up:\"ArrowUp\",Right:\"ArrowRight\",Down:\"ArrowDown\",Del:\"Delete\",Win:\"OS\",Menu:\"ContextMenu\",Apps:\"ContextMenu\",Scroll:\"ScrollLock\",MozPrintableKey:\"Unidentified\"},Nd={8:\"Backspace\",9:\"Tab\",12:\"Clear\",13:\"Enter\",16:\"Shift\",17:\"Control\",18:\"Alt\",19:\"Pause\",20:\"CapsLock\",27:\"Escape\",32:\" \",33:\"PageUp\",34:\"PageDown\",35:\"End\",36:\"Home\",37:\"ArrowLeft\",38:\"ArrowUp\",39:\"ArrowRight\",40:\"ArrowDown\",45:\"Insert\",46:\"Delete\",112:\"F1\",113:\"F2\",114:\"F3\",115:\"F4\",116:\"F5\",117:\"F6\",118:\"F7\",\n119:\"F8\",120:\"F9\",121:\"F10\",122:\"F11\",123:\"F12\",144:\"NumLock\",145:\"ScrollLock\",224:\"Meta\"},Od={Alt:\"altKey\",Control:\"ctrlKey\",Meta:\"metaKey\",Shift:\"shiftKey\"};function Pd(a){var b=this.nativeEvent;return b.getModifierState?b.getModifierState(a):(a=Od[a])?!!b[a]:!1}function zd(){return Pd}\nvar Qd=A({},ud,{key:function(a){if(a.key){var b=Md[a.key]||a.key;if(\"Unidentified\"!==b)return b}return\"keypress\"===a.type?(a=od(a),13===a?\"Enter\":String.fromCharCode(a)):\"keydown\"===a.type||\"keyup\"===a.type?Nd[a.keyCode]||\"Unidentified\":\"\"},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(a){return\"keypress\"===a.type?od(a):0},keyCode:function(a){return\"keydown\"===a.type||\"keyup\"===a.type?a.keyCode:0},which:function(a){return\"keypress\"===\na.type?od(a):\"keydown\"===a.type||\"keyup\"===a.type?a.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(a){return\"deltaX\"in a?a.deltaX:\"wheelDeltaX\"in a?-a.wheelDeltaX:0},\ndeltaY:function(a){return\"deltaY\"in a?a.deltaY:\"wheelDeltaY\"in a?-a.wheelDeltaY:\"wheelDelta\"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&\"CompositionEvent\"in window,be=null;ia&&\"documentMode\"in document&&(be=document.documentMode);var ce=ia&&\"TextEvent\"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=String.fromCharCode(32),fe=!1;\nfunction ge(a,b){switch(a){case \"keyup\":return-1!==$d.indexOf(b.keyCode);case \"keydown\":return 229!==b.keyCode;case \"keypress\":case \"mousedown\":case \"focusout\":return!0;default:return!1}}function he(a){a=a.detail;return\"object\"===typeof a&&\"data\"in a?a.data:null}var ie=!1;function je(a,b){switch(a){case \"compositionend\":return he(b);case \"keypress\":if(32!==b.which)return null;fe=!0;return ee;case \"textInput\":return a=b.data,a===ee&&fe?null:a;default:return null}}\nfunction ke(a,b){if(ie)return\"compositionend\"===a||!ae&&ge(a,b)?(a=nd(),md=ld=kd=null,ie=!1,a):null;switch(a){case \"paste\":return null;case \"keypress\":if(!(b.ctrlKey||b.altKey||b.metaKey)||b.ctrlKey&&b.altKey){if(b.char&&1<b.char.length)return b.char;if(b.which)return String.fromCharCode(b.which)}return null;case \"compositionend\":return de&&\"ko\"!==b.locale?null:b.data;default:return null}}\nvar le={color:!0,date:!0,datetime:!0,\"datetime-local\":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return\"input\"===b?!!le[a.type]:\"textarea\"===b?!0:!1}function ne(a,b,c,d){Eb(d);b=oe(b,\"onChange\");0<b.length&&(c=new td(\"onChange\",\"change\",null,c,d),a.push({event:c,listeners:b}))}var pe=null,qe=null;function re(a){se(a,0)}function te(a){var b=ue(a);if(Wa(b))return a}\nfunction ve(a,b){if(\"change\"===a)return b}var we=!1;if(ia){var xe;if(ia){var ye=\"oninput\"in document;if(!ye){var ze=document.createElement(\"div\");ze.setAttribute(\"oninput\",\"return;\");ye=\"function\"===typeof ze.oninput}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent(\"onpropertychange\",Be),qe=pe=null)}function Be(a){if(\"value\"===a.propertyName&&te(qe)){var b=[];ne(b,qe,a,xb(a));Jb(re,b)}}\nfunction Ce(a,b,c){\"focusin\"===a?(Ae(),pe=b,qe=c,pe.attachEvent(\"onpropertychange\",Be)):\"focusout\"===a&&Ae()}function De(a){if(\"selectionchange\"===a||\"keyup\"===a||\"keydown\"===a)return te(qe)}function Ee(a,b){if(\"click\"===a)return te(b)}function Fe(a,b){if(\"input\"===a||\"change\"===a)return te(b)}function Ge(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var He=\"function\"===typeof Object.is?Object.is:Ge;\nfunction Ie(a,b){if(He(a,b))return!0;if(\"object\"!==typeof a||null===a||\"object\"!==typeof b||null===b)return!1;var c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var e=c[d];if(!ja.call(b,e)||!He(a[e],b[e]))return!1}return!0}function Je(a){for(;a&&a.firstChild;)a=a.firstChild;return a}\nfunction Ke(a,b){var c=Je(a);a=0;for(var d;c;){if(3===c.nodeType){d=a+c.textContent.length;if(a<=b&&d>=b)return{node:c,offset:b-a};a=d}a:{for(;c;){if(c.nextSibling){c=c.nextSibling;break a}c=c.parentNode}c=void 0}c=Je(c)}}function Le(a,b){return a&&b?a===b?!0:a&&3===a.nodeType?!1:b&&3===b.nodeType?Le(a,b.parentNode):\"contains\"in a?a.contains(b):a.compareDocumentPosition?!!(a.compareDocumentPosition(b)&16):!1:!1}\nfunction Me(){for(var a=window,b=Xa();b instanceof a.HTMLIFrameElement;){try{var c=\"string\"===typeof b.contentWindow.location.href}catch(d){c=!1}if(c)a=b.contentWindow;else break;b=Xa(a.document)}return b}function Ne(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return b&&(\"input\"===b&&(\"text\"===a.type||\"search\"===a.type||\"tel\"===a.type||\"url\"===a.type||\"password\"===a.type)||\"textarea\"===b||\"true\"===a.contentEditable)}\nfunction Oe(a){var b=Me(),c=a.focusedElem,d=a.selectionRange;if(b!==c&&c&&c.ownerDocument&&Le(c.ownerDocument.documentElement,c)){if(null!==d&&Ne(c))if(b=d.start,a=d.end,void 0===a&&(a=b),\"selectionStart\"in c)c.selectionStart=b,c.selectionEnd=Math.min(a,c.value.length);else if(a=(b=c.ownerDocument||document)&&b.defaultView||window,a.getSelection){a=a.getSelection();var e=c.textContent.length,f=Math.min(d.start,e);d=void 0===d.end?f:Math.min(d.end,e);!a.extend&&f>d&&(e=d,d=f,f=e);e=Ke(c,f);var g=Ke(c,\nd);e&&g&&(1!==a.rangeCount||a.anchorNode!==e.node||a.anchorOffset!==e.offset||a.focusNode!==g.node||a.focusOffset!==g.offset)&&(b=b.createRange(),b.setStart(e.node,e.offset),a.removeAllRanges(),f>d?(a.addRange(b),a.extend(g.node,g.offset)):(b.setEnd(g.node,g.offset),a.addRange(b)))}b=[];for(a=c;a=a.parentNode;)1===a.nodeType&&b.push({element:a,left:a.scrollLeft,top:a.scrollTop});\"function\"===typeof c.focus&&c.focus();for(c=0;c<b.length;c++)a=b[c],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}\nvar Pe=ia&&\"documentMode\"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;\nfunction Ue(a,b,c){var d=c.window===c?c.document:9===c.nodeType?c:c.ownerDocument;Te||null==Qe||Qe!==Xa(d)||(d=Qe,\"selectionStart\"in d&&Ne(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Se&&Ie(Se,d)||(Se=d,d=oe(Re,\"onSelect\"),0<d.length&&(b=new td(\"onSelect\",\"select\",null,b,c),a.push({event:b,listeners:d}),b.target=Qe)))}\nfunction Ve(a,b){var c={};c[a.toLowerCase()]=b.toLowerCase();c[\"Webkit\"+a]=\"webkit\"+b;c[\"Moz\"+a]=\"moz\"+b;return c}var We={animationend:Ve(\"Animation\",\"AnimationEnd\"),animationiteration:Ve(\"Animation\",\"AnimationIteration\"),animationstart:Ve(\"Animation\",\"AnimationStart\"),transitionend:Ve(\"Transition\",\"TransitionEnd\")},Xe={},Ye={};\nia&&(Ye=document.createElement(\"div\").style,\"AnimationEvent\"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),\"TransitionEvent\"in window||delete We.transitionend.transition);function Ze(a){if(Xe[a])return Xe[a];if(!We[a])return a;var b=We[a],c;for(c in b)if(b.hasOwnProperty(c)&&c in Ye)return Xe[a]=b[c];return a}var $e=Ze(\"animationend\"),af=Ze(\"animationiteration\"),bf=Ze(\"animationstart\"),cf=Ze(\"transitionend\"),df=new Map,ef=\"abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel\".split(\" \");\nfunction ff(a,b){df.set(a,b);fa(b,[a])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,\"on\"+kf)}ff($e,\"onAnimationEnd\");ff(af,\"onAnimationIteration\");ff(bf,\"onAnimationStart\");ff(\"dblclick\",\"onDoubleClick\");ff(\"focusin\",\"onFocus\");ff(\"focusout\",\"onBlur\");ff(cf,\"onTransitionEnd\");ha(\"onMouseEnter\",[\"mouseout\",\"mouseover\"]);ha(\"onMouseLeave\",[\"mouseout\",\"mouseover\"]);ha(\"onPointerEnter\",[\"pointerout\",\"pointerover\"]);\nha(\"onPointerLeave\",[\"pointerout\",\"pointerover\"]);fa(\"onChange\",\"change click focusin focusout input keydown keyup selectionchange\".split(\" \"));fa(\"onSelect\",\"focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange\".split(\" \"));fa(\"onBeforeInput\",[\"compositionend\",\"keypress\",\"textInput\",\"paste\"]);fa(\"onCompositionEnd\",\"compositionend focusout keydown keypress keyup mousedown\".split(\" \"));fa(\"onCompositionStart\",\"compositionstart focusout keydown keypress keyup mousedown\".split(\" \"));\nfa(\"onCompositionUpdate\",\"compositionupdate focusout keydown keypress keyup mousedown\".split(\" \"));var lf=\"abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting\".split(\" \"),mf=new Set(\"cancel close invalid load scroll toggle\".split(\" \").concat(lf));\nfunction nf(a,b,c){var d=a.type||\"unknown-event\";a.currentTarget=c;Ub(d,b,void 0,a);a.currentTarget=null}\nfunction se(a,b){b=0!==(b&4);for(var c=0;c<a.length;c++){var d=a[c],e=d.event;d=d.listeners;a:{var f=void 0;if(b)for(var g=d.length-1;0<=g;g--){var h=d[g],k=h.instance,l=h.currentTarget;h=h.listener;if(k!==f&&e.isPropagationStopped())break a;nf(e,h,l);f=k}else for(g=0;g<d.length;g++){h=d[g];k=h.instance;l=h.currentTarget;h=h.listener;if(k!==f&&e.isPropagationStopped())break a;nf(e,h,l);f=k}}}if(Qb)throw a=Rb,Qb=!1,Rb=null,a;}\nfunction D(a,b){var c=b[of];void 0===c&&(c=b[of]=new Set);var d=a+\"__bubble\";c.has(d)||(pf(b,a,2,!1),c.add(d))}function qf(a,b,c){var d=0;b&&(d|=4);pf(c,a,d,b)}var rf=\"_reactListening\"+Math.random().toString(36).slice(2);function sf(a){if(!a[rf]){a[rf]=!0;da.forEach(function(b){\"selectionchange\"!==b&&(mf.has(b)||qf(b,!1,a),qf(b,!0,a))});var b=9===a.nodeType?a:a.ownerDocument;null===b||b[rf]||(b[rf]=!0,qf(\"selectionchange\",!1,b))}}\nfunction pf(a,b,c,d){switch(jd(b)){case 1:var e=ed;break;case 4:e=gd;break;default:e=fd}c=e.bind(null,b,c,a);e=void 0;!Lb||\"touchstart\"!==b&&\"touchmove\"!==b&&\"wheel\"!==b||(e=!0);d?void 0!==e?a.addEventListener(b,c,{capture:!0,passive:e}):a.addEventListener(b,c,!0):void 0!==e?a.addEventListener(b,c,{passive:e}):a.addEventListener(b,c,!1)}\nfunction hd(a,b,c,d,e){var f=d;if(0===(b&1)&&0===(b&2)&&null!==d)a:for(;;){if(null===d)return;var g=d.tag;if(3===g||4===g){var h=d.stateNode.containerInfo;if(h===e||8===h.nodeType&&h.parentNode===e)break;if(4===g)for(g=d.return;null!==g;){var k=g.tag;if(3===k||4===k)if(k=g.stateNode.containerInfo,k===e||8===k.nodeType&&k.parentNode===e)return;g=g.return}for(;null!==h;){g=Wc(h);if(null===g)return;k=g.tag;if(5===k||6===k){d=f=g;continue a}h=h.parentNode}}d=d.return}Jb(function(){var d=f,e=xb(c),g=[];\na:{var h=df.get(a);if(void 0!==h){var k=td,n=a;switch(a){case \"keypress\":if(0===od(c))break a;case \"keydown\":case \"keyup\":k=Rd;break;case \"focusin\":n=\"focus\";k=Fd;break;case \"focusout\":n=\"blur\";k=Fd;break;case \"beforeblur\":case \"afterblur\":k=Fd;break;case \"click\":if(2===c.button)break a;case \"auxclick\":case \"dblclick\":case \"mousedown\":case \"mousemove\":case \"mouseup\":case \"mouseout\":case \"mouseover\":case \"contextmenu\":k=Bd;break;case \"drag\":case \"dragend\":case \"dragenter\":case \"dragexit\":case \"dragleave\":case \"dragover\":case \"dragstart\":case \"drop\":k=\nDd;break;case \"touchcancel\":case \"touchend\":case \"touchmove\":case \"touchstart\":k=Vd;break;case $e:case af:case bf:k=Hd;break;case cf:k=Xd;break;case \"scroll\":k=vd;break;case \"wheel\":k=Zd;break;case \"copy\":case \"cut\":case \"paste\":k=Jd;break;case \"gotpointercapture\":case \"lostpointercapture\":case \"pointercancel\":case \"pointerdown\":case \"pointermove\":case \"pointerout\":case \"pointerover\":case \"pointerup\":k=Td}var t=0!==(b&4),J=!t&&\"scroll\"===a,x=t?null!==h?h+\"Capture\":null:h;t=[];for(var w=d,u;null!==\nw;){u=w;var F=u.stateNode;5===u.tag&&null!==F&&(u=F,null!==x&&(F=Kb(w,x),null!=F&&t.push(tf(w,F,u))));if(J)break;w=w.return}0<t.length&&(h=new k(h,n,null,c,e),g.push({event:h,listeners:t}))}}if(0===(b&7)){a:{h=\"mouseover\"===a||\"pointerover\"===a;k=\"mouseout\"===a||\"pointerout\"===a;if(h&&c!==wb&&(n=c.relatedTarget||c.fromElement)&&(Wc(n)||n[uf]))break a;if(k||h){h=e.window===e?e:(h=e.ownerDocument)?h.defaultView||h.parentWindow:window;if(k){if(n=c.relatedTarget||c.toElement,k=d,n=n?Wc(n):null,null!==\nn&&(J=Vb(n),n!==J||5!==n.tag&&6!==n.tag))n=null}else k=null,n=d;if(k!==n){t=Bd;F=\"onMouseLeave\";x=\"onMouseEnter\";w=\"mouse\";if(\"pointerout\"===a||\"pointerover\"===a)t=Td,F=\"onPointerLeave\",x=\"onPointerEnter\",w=\"pointer\";J=null==k?h:ue(k);u=null==n?h:ue(n);h=new t(F,w+\"leave\",k,c,e);h.target=J;h.relatedTarget=u;F=null;Wc(e)===d&&(t=new t(x,w+\"enter\",n,c,e),t.target=u,t.relatedTarget=J,F=t);J=F;if(k&&n)b:{t=k;x=n;w=0;for(u=t;u;u=vf(u))w++;u=0;for(F=x;F;F=vf(F))u++;for(;0<w-u;)t=vf(t),w--;for(;0<u-w;)x=\nvf(x),u--;for(;w--;){if(t===x||null!==x&&t===x.alternate)break b;t=vf(t);x=vf(x)}t=null}else t=null;null!==k&&wf(g,h,k,t,!1);null!==n&&null!==J&&wf(g,J,n,t,!0)}}}a:{h=d?ue(d):window;k=h.nodeName&&h.nodeName.toLowerCase();if(\"select\"===k||\"input\"===k&&\"file\"===h.type)var na=ve;else if(me(h))if(we)na=Fe;else{na=De;var xa=Ce}else(k=h.nodeName)&&\"input\"===k.toLowerCase()&&(\"checkbox\"===h.type||\"radio\"===h.type)&&(na=Ee);if(na&&(na=na(a,d))){ne(g,na,c,e);break a}xa&&xa(a,h,d);\"focusout\"===a&&(xa=h._wrapperState)&&\nxa.controlled&&\"number\"===h.type&&cb(h,\"number\",h.value)}xa=d?ue(d):window;switch(a){case \"focusin\":if(me(xa)||\"true\"===xa.contentEditable)Qe=xa,Re=d,Se=null;break;case \"focusout\":Se=Re=Qe=null;break;case \"mousedown\":Te=!0;break;case \"contextmenu\":case \"mouseup\":case \"dragend\":Te=!1;Ue(g,c,e);break;case \"selectionchange\":if(Pe)break;case \"keydown\":case \"keyup\":Ue(g,c,e)}var $a;if(ae)b:{switch(a){case \"compositionstart\":var ba=\"onCompositionStart\";break b;case \"compositionend\":ba=\"onCompositionEnd\";\nbreak b;case \"compositionupdate\":ba=\"onCompositionUpdate\";break b}ba=void 0}else ie?ge(a,c)&&(ba=\"onCompositionEnd\"):\"keydown\"===a&&229===c.keyCode&&(ba=\"onCompositionStart\");ba&&(de&&\"ko\"!==c.locale&&(ie||\"onCompositionStart\"!==ba?\"onCompositionEnd\"===ba&&ie&&($a=nd()):(kd=e,ld=\"value\"in kd?kd.value:kd.textContent,ie=!0)),xa=oe(d,ba),0<xa.length&&(ba=new Ld(ba,a,null,c,e),g.push({event:ba,listeners:xa}),$a?ba.data=$a:($a=he(c),null!==$a&&(ba.data=$a))));if($a=ce?je(a,c):ke(a,c))d=oe(d,\"onBeforeInput\"),\n0<d.length&&(e=new Ld(\"onBeforeInput\",\"beforeinput\",null,c,e),g.push({event:e,listeners:d}),e.data=$a)}se(g,b)})}function tf(a,b,c){return{instance:a,listener:b,currentTarget:c}}function oe(a,b){for(var c=b+\"Capture\",d=[];null!==a;){var e=a,f=e.stateNode;5===e.tag&&null!==f&&(e=f,f=Kb(a,c),null!=f&&d.unshift(tf(a,f,e)),f=Kb(a,b),null!=f&&d.push(tf(a,f,e)));a=a.return}return d}function vf(a){if(null===a)return null;do a=a.return;while(a&&5!==a.tag);return a?a:null}\nfunction wf(a,b,c,d,e){for(var f=b._reactName,g=[];null!==c&&c!==d;){var h=c,k=h.alternate,l=h.stateNode;if(null!==k&&k===d)break;5===h.tag&&null!==l&&(h=l,e?(k=Kb(c,f),null!=k&&g.unshift(tf(c,k,h))):e||(k=Kb(c,f),null!=k&&g.push(tf(c,k,h))));c=c.return}0!==g.length&&a.push({event:b,listeners:g})}var xf=/\\r\\n?/g,yf=/\\u0000|\\uFFFD/g;function zf(a){return(\"string\"===typeof a?a:\"\"+a).replace(xf,\"\\n\").replace(yf,\"\")}function Af(a,b,c){b=zf(b);if(zf(a)!==b&&c)throw Error(p(425));}function Bf(){}\nvar Cf=null,Df=null;function Ef(a,b){return\"textarea\"===a||\"noscript\"===a||\"string\"===typeof b.children||\"number\"===typeof b.children||\"object\"===typeof b.dangerouslySetInnerHTML&&null!==b.dangerouslySetInnerHTML&&null!=b.dangerouslySetInnerHTML.__html}\nvar Ff=\"function\"===typeof setTimeout?setTimeout:void 0,Gf=\"function\"===typeof clearTimeout?clearTimeout:void 0,Hf=\"function\"===typeof Promise?Promise:void 0,Jf=\"function\"===typeof queueMicrotask?queueMicrotask:\"undefined\"!==typeof Hf?function(a){return Hf.resolve(null).then(a).catch(If)}:Ff;function If(a){setTimeout(function(){throw a;})}\nfunction Kf(a,b){var c=b,d=0;do{var e=c.nextSibling;a.removeChild(c);if(e&&8===e.nodeType)if(c=e.data,\"/$\"===c){if(0===d){a.removeChild(e);bd(b);return}d--}else\"$\"!==c&&\"$?\"!==c&&\"$!\"!==c||d++;c=e}while(c);bd(b)}function Lf(a){for(;null!=a;a=a.nextSibling){var b=a.nodeType;if(1===b||3===b)break;if(8===b){b=a.data;if(\"$\"===b||\"$!\"===b||\"$?\"===b)break;if(\"/$\"===b)return null}}return a}\nfunction Mf(a){a=a.previousSibling;for(var b=0;a;){if(8===a.nodeType){var c=a.data;if(\"$\"===c||\"$!\"===c||\"$?\"===c){if(0===b)return a;b--}else\"/$\"===c&&b++}a=a.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of=\"__reactFiber$\"+Nf,Pf=\"__reactProps$\"+Nf,uf=\"__reactContainer$\"+Nf,of=\"__reactEvents$\"+Nf,Qf=\"__reactListeners$\"+Nf,Rf=\"__reactHandles$\"+Nf;\nfunction Wc(a){var b=a[Of];if(b)return b;for(var c=a.parentNode;c;){if(b=c[uf]||c[Of]){c=b.alternate;if(null!==b.child||null!==c&&null!==c.child)for(a=Mf(a);null!==a;){if(c=a[Of])return c;a=Mf(a)}return b}a=c;c=a.parentNode}return null}function Cb(a){a=a[Of]||a[uf];return!a||5!==a.tag&&6!==a.tag&&13!==a.tag&&3!==a.tag?null:a}function ue(a){if(5===a.tag||6===a.tag)return a.stateNode;throw Error(p(33));}function Db(a){return a[Pf]||null}var Sf=[],Tf=-1;function Uf(a){return{current:a}}\nfunction E(a){0>Tf||(a.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(a,b){Tf++;Sf[Tf]=a.current;a.current=b}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(a,b){var c=a.type.contextTypes;if(!c)return Vf;var d=a.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===b)return d.__reactInternalMemoizedMaskedChildContext;var e={},f;for(f in c)e[f]=b[f];d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=b,a.__reactInternalMemoizedMaskedChildContext=e);return e}\nfunction Zf(a){a=a.childContextTypes;return null!==a&&void 0!==a}function $f(){E(Wf);E(H)}function ag(a,b,c){if(H.current!==Vf)throw Error(p(168));G(H,b);G(Wf,c)}function bg(a,b,c){var d=a.stateNode;b=b.childContextTypes;if(\"function\"!==typeof d.getChildContext)return c;d=d.getChildContext();for(var e in d)if(!(e in b))throw Error(p(108,Ra(a)||\"Unknown\",e));return A({},c,d)}\nfunction cg(a){a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Vf;Xf=H.current;G(H,a);G(Wf,Wf.current);return!0}function dg(a,b,c){var d=a.stateNode;if(!d)throw Error(p(169));c?(a=bg(a,b,Xf),d.__reactInternalMemoizedMergedChildContext=a,E(Wf),E(H),G(H,a)):E(Wf);G(Wf,c)}var eg=null,fg=!1,gg=!1;function hg(a){null===eg?eg=[a]:eg.push(a)}function ig(a){fg=!0;hg(a)}\nfunction jg(){if(!gg&&null!==eg){gg=!0;var a=0,b=C;try{var c=eg;for(C=1;a<c.length;a++){var d=c[a];do d=d(!0);while(null!==d)}eg=null;fg=!1}catch(e){throw null!==eg&&(eg=eg.slice(a+1)),ac(fc,jg),e;}finally{C=b,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg=\"\";function tg(a,b){kg[lg++]=ng;kg[lg++]=mg;mg=a;ng=b}\nfunction ug(a,b,c){og[pg++]=rg;og[pg++]=sg;og[pg++]=qg;qg=a;var d=rg;a=sg;var e=32-oc(d)-1;d&=~(1<<e);c+=1;var f=32-oc(b)+e;if(30<f){var g=e-e%5;f=(d&(1<<g)-1).toString(32);d>>=g;e-=g;rg=1<<32-oc(b)+e|c<<e|d;sg=f+a}else rg=1<<f|c<<e|d,sg=a}function vg(a){null!==a.return&&(tg(a,1),ug(a,1,0))}function wg(a){for(;a===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;a===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;\nfunction Ag(a,b){var c=Bg(5,null,null,0);c.elementType=\"DELETED\";c.stateNode=b;c.return=a;b=a.deletions;null===b?(a.deletions=[c],a.flags|=16):b.push(c)}\nfunction Cg(a,b){switch(a.tag){case 5:var c=a.type;b=1!==b.nodeType||c.toLowerCase()!==b.nodeName.toLowerCase()?null:b;return null!==b?(a.stateNode=b,xg=a,yg=Lf(b.firstChild),!0):!1;case 6:return b=\"\"===a.pendingProps||3!==b.nodeType?null:b,null!==b?(a.stateNode=b,xg=a,yg=null,!0):!1;case 13:return b=8!==b.nodeType?null:b,null!==b?(c=null!==qg?{id:rg,overflow:sg}:null,a.memoizedState={dehydrated:b,treeContext:c,retryLane:1073741824},c=Bg(18,null,null,0),c.stateNode=b,c.return=a,a.child=c,xg=a,yg=\nnull,!0):!1;default:return!1}}function Dg(a){return 0!==(a.mode&1)&&0===(a.flags&128)}function Eg(a){if(I){var b=yg;if(b){var c=b;if(!Cg(a,b)){if(Dg(a))throw Error(p(418));b=Lf(c.nextSibling);var d=xg;b&&Cg(a,b)?Ag(d,c):(a.flags=a.flags&-4097|2,I=!1,xg=a)}}else{if(Dg(a))throw Error(p(418));a.flags=a.flags&-4097|2;I=!1;xg=a}}}function Fg(a){for(a=a.return;null!==a&&5!==a.tag&&3!==a.tag&&13!==a.tag;)a=a.return;xg=a}\nfunction Gg(a){if(a!==xg)return!1;if(!I)return Fg(a),I=!0,!1;var b;(b=3!==a.tag)&&!(b=5!==a.tag)&&(b=a.type,b=\"head\"!==b&&\"body\"!==b&&!Ef(a.type,a.memoizedProps));if(b&&(b=yg)){if(Dg(a))throw Hg(),Error(p(418));for(;b;)Ag(a,b),b=Lf(b.nextSibling)}Fg(a);if(13===a.tag){a=a.memoizedState;a=null!==a?a.dehydrated:null;if(!a)throw Error(p(317));a:{a=a.nextSibling;for(b=0;a;){if(8===a.nodeType){var c=a.data;if(\"/$\"===c){if(0===b){yg=Lf(a.nextSibling);break a}b--}else\"$\"!==c&&\"$!\"!==c&&\"$?\"!==c||b++}a=a.nextSibling}yg=\nnull}}else yg=xg?Lf(a.stateNode.nextSibling):null;return!0}function Hg(){for(var a=yg;a;)a=Lf(a.nextSibling)}function Ig(){yg=xg=null;I=!1}function Jg(a){null===zg?zg=[a]:zg.push(a)}var Kg=ua.ReactCurrentBatchConfig;\nfunction Lg(a,b,c){a=c.ref;if(null!==a&&\"function\"!==typeof a&&\"object\"!==typeof a){if(c._owner){c=c._owner;if(c){if(1!==c.tag)throw Error(p(309));var d=c.stateNode}if(!d)throw Error(p(147,a));var e=d,f=\"\"+a;if(null!==b&&null!==b.ref&&\"function\"===typeof b.ref&&b.ref._stringRef===f)return b.ref;b=function(a){var b=e.refs;null===a?delete b[f]:b[f]=a};b._stringRef=f;return b}if(\"string\"!==typeof a)throw Error(p(284));if(!c._owner)throw Error(p(290,a));}return a}\nfunction Mg(a,b){a=Object.prototype.toString.call(b);throw Error(p(31,\"[object Object]\"===a?\"object with keys {\"+Object.keys(b).join(\", \")+\"}\":a));}function Ng(a){var b=a._init;return b(a._payload)}\nfunction Og(a){function b(b,c){if(a){var d=b.deletions;null===d?(b.deletions=[c],b.flags|=16):d.push(c)}}function c(c,d){if(!a)return null;for(;null!==d;)b(c,d),d=d.sibling;return null}function d(a,b){for(a=new Map;null!==b;)null!==b.key?a.set(b.key,b):a.set(b.index,b),b=b.sibling;return a}function e(a,b){a=Pg(a,b);a.index=0;a.sibling=null;return a}function f(b,c,d){b.index=d;if(!a)return b.flags|=1048576,c;d=b.alternate;if(null!==d)return d=d.index,d<c?(b.flags|=2,c):d;b.flags|=2;return c}function g(b){a&&\nnull===b.alternate&&(b.flags|=2);return b}function h(a,b,c,d){if(null===b||6!==b.tag)return b=Qg(c,a.mode,d),b.return=a,b;b=e(b,c);b.return=a;return b}function k(a,b,c,d){var f=c.type;if(f===ya)return m(a,b,c.props.children,d,c.key);if(null!==b&&(b.elementType===f||\"object\"===typeof f&&null!==f&&f.$$typeof===Ha&&Ng(f)===b.type))return d=e(b,c.props),d.ref=Lg(a,b,c),d.return=a,d;d=Rg(c.type,c.key,c.props,null,a.mode,d);d.ref=Lg(a,b,c);d.return=a;return d}function l(a,b,c,d){if(null===b||4!==b.tag||\nb.stateNode.containerInfo!==c.containerInfo||b.stateNode.implementation!==c.implementation)return b=Sg(c,a.mode,d),b.return=a,b;b=e(b,c.children||[]);b.return=a;return b}function m(a,b,c,d,f){if(null===b||7!==b.tag)return b=Tg(c,a.mode,d,f),b.return=a,b;b=e(b,c);b.return=a;return b}function q(a,b,c){if(\"string\"===typeof b&&\"\"!==b||\"number\"===typeof b)return b=Qg(\"\"+b,a.mode,c),b.return=a,b;if(\"object\"===typeof b&&null!==b){switch(b.$$typeof){case va:return c=Rg(b.type,b.key,b.props,null,a.mode,c),\nc.ref=Lg(a,null,b),c.return=a,c;case wa:return b=Sg(b,a.mode,c),b.return=a,b;case Ha:var d=b._init;return q(a,d(b._payload),c)}if(eb(b)||Ka(b))return b=Tg(b,a.mode,c,null),b.return=a,b;Mg(a,b)}return null}function r(a,b,c,d){var e=null!==b?b.key:null;if(\"string\"===typeof c&&\"\"!==c||\"number\"===typeof c)return null!==e?null:h(a,b,\"\"+c,d);if(\"object\"===typeof c&&null!==c){switch(c.$$typeof){case va:return c.key===e?k(a,b,c,d):null;case wa:return c.key===e?l(a,b,c,d):null;case Ha:return e=c._init,r(a,\nb,e(c._payload),d)}if(eb(c)||Ka(c))return null!==e?null:m(a,b,c,d,null);Mg(a,c)}return null}function y(a,b,c,d,e){if(\"string\"===typeof d&&\"\"!==d||\"number\"===typeof d)return a=a.get(c)||null,h(b,a,\"\"+d,e);if(\"object\"===typeof d&&null!==d){switch(d.$$typeof){case va:return a=a.get(null===d.key?c:d.key)||null,k(b,a,d,e);case wa:return a=a.get(null===d.key?c:d.key)||null,l(b,a,d,e);case Ha:var f=d._init;return y(a,b,c,f(d._payload),e)}if(eb(d)||Ka(d))return a=a.get(c)||null,m(b,a,d,e,null);Mg(b,d)}return null}\nfunction n(e,g,h,k){for(var l=null,m=null,u=g,w=g=0,x=null;null!==u&&w<h.length;w++){u.index>w?(x=u,u=null):x=u.sibling;var n=r(e,u,h[w],k);if(null===n){null===u&&(u=x);break}a&&u&&null===n.alternate&&b(e,u);g=f(n,g,w);null===m?l=n:m.sibling=n;m=n;u=x}if(w===h.length)return c(e,u),I&&tg(e,w),l;if(null===u){for(;w<h.length;w++)u=q(e,h[w],k),null!==u&&(g=f(u,g,w),null===m?l=u:m.sibling=u,m=u);I&&tg(e,w);return l}for(u=d(e,u);w<h.length;w++)x=y(u,e,w,h[w],k),null!==x&&(a&&null!==x.alternate&&u.delete(null===\nx.key?w:x.key),g=f(x,g,w),null===m?l=x:m.sibling=x,m=x);a&&u.forEach(function(a){return b(e,a)});I&&tg(e,w);return l}function t(e,g,h,k){var l=Ka(h);if(\"function\"!==typeof l)throw Error(p(150));h=l.call(h);if(null==h)throw Error(p(151));for(var u=l=null,m=g,w=g=0,x=null,n=h.next();null!==m&&!n.done;w++,n=h.next()){m.index>w?(x=m,m=null):x=m.sibling;var t=r(e,m,n.value,k);if(null===t){null===m&&(m=x);break}a&&m&&null===t.alternate&&b(e,m);g=f(t,g,w);null===u?l=t:u.sibling=t;u=t;m=x}if(n.done)return c(e,\nm),I&&tg(e,w),l;if(null===m){for(;!n.done;w++,n=h.next())n=q(e,n.value,k),null!==n&&(g=f(n,g,w),null===u?l=n:u.sibling=n,u=n);I&&tg(e,w);return l}for(m=d(e,m);!n.done;w++,n=h.next())n=y(m,e,w,n.value,k),null!==n&&(a&&null!==n.alternate&&m.delete(null===n.key?w:n.key),g=f(n,g,w),null===u?l=n:u.sibling=n,u=n);a&&m.forEach(function(a){return b(e,a)});I&&tg(e,w);return l}function J(a,d,f,h){\"object\"===typeof f&&null!==f&&f.type===ya&&null===f.key&&(f=f.props.children);if(\"object\"===typeof f&&null!==f){switch(f.$$typeof){case va:a:{for(var k=\nf.key,l=d;null!==l;){if(l.key===k){k=f.type;if(k===ya){if(7===l.tag){c(a,l.sibling);d=e(l,f.props.children);d.return=a;a=d;break a}}else if(l.elementType===k||\"object\"===typeof k&&null!==k&&k.$$typeof===Ha&&Ng(k)===l.type){c(a,l.sibling);d=e(l,f.props);d.ref=Lg(a,l,f);d.return=a;a=d;break a}c(a,l);break}else b(a,l);l=l.sibling}f.type===ya?(d=Tg(f.props.children,a.mode,h,f.key),d.return=a,a=d):(h=Rg(f.type,f.key,f.props,null,a.mode,h),h.ref=Lg(a,d,f),h.return=a,a=h)}return g(a);case wa:a:{for(l=f.key;null!==\nd;){if(d.key===l)if(4===d.tag&&d.stateNode.containerInfo===f.containerInfo&&d.stateNode.implementation===f.implementation){c(a,d.sibling);d=e(d,f.children||[]);d.return=a;a=d;break a}else{c(a,d);break}else b(a,d);d=d.sibling}d=Sg(f,a.mode,h);d.return=a;a=d}return g(a);case Ha:return l=f._init,J(a,d,l(f._payload),h)}if(eb(f))return n(a,d,f,h);if(Ka(f))return t(a,d,f,h);Mg(a,f)}return\"string\"===typeof f&&\"\"!==f||\"number\"===typeof f?(f=\"\"+f,null!==d&&6===d.tag?(c(a,d.sibling),d=e(d,f),d.return=a,a=d):\n(c(a,d),d=Qg(f,a.mode,h),d.return=a,a=d),g(a)):c(a,d)}return J}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(a){var b=Wg.current;E(Wg);a._currentValue=b}function bh(a,b,c){for(;null!==a;){var d=a.alternate;(a.childLanes&b)!==b?(a.childLanes|=b,null!==d&&(d.childLanes|=b)):null!==d&&(d.childLanes&b)!==b&&(d.childLanes|=b);if(a===c)break;a=a.return}}\nfunction ch(a,b){Xg=a;Zg=Yg=null;a=a.dependencies;null!==a&&null!==a.firstContext&&(0!==(a.lanes&b)&&(dh=!0),a.firstContext=null)}function eh(a){var b=a._currentValue;if(Zg!==a)if(a={context:a,memoizedValue:b,next:null},null===Yg){if(null===Xg)throw Error(p(308));Yg=a;Xg.dependencies={lanes:0,firstContext:a}}else Yg=Yg.next=a;return b}var fh=null;function gh(a){null===fh?fh=[a]:fh.push(a)}\nfunction hh(a,b,c,d){var e=b.interleaved;null===e?(c.next=c,gh(b)):(c.next=e.next,e.next=c);b.interleaved=c;return ih(a,d)}function ih(a,b){a.lanes|=b;var c=a.alternate;null!==c&&(c.lanes|=b);c=a;for(a=a.return;null!==a;)a.childLanes|=b,c=a.alternate,null!==c&&(c.childLanes|=b),c=a,a=a.return;return 3===c.tag?c.stateNode:null}var jh=!1;function kh(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}\nfunction lh(a,b){a=a.updateQueue;b.updateQueue===a&&(b.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function mh(a,b){return{eventTime:a,lane:b,tag:0,payload:null,callback:null,next:null}}\nfunction nh(a,b,c){var d=a.updateQueue;if(null===d)return null;d=d.shared;if(0!==(K&2)){var e=d.pending;null===e?b.next=b:(b.next=e.next,e.next=b);d.pending=b;return ih(a,c)}e=d.interleaved;null===e?(b.next=b,gh(d)):(b.next=e.next,e.next=b);d.interleaved=b;return ih(a,c)}function oh(a,b,c){b=b.updateQueue;if(null!==b&&(b=b.shared,0!==(c&4194240))){var d=b.lanes;d&=a.pendingLanes;c|=d;b.lanes=c;Cc(a,c)}}\nfunction ph(a,b){var c=a.updateQueue,d=a.alternate;if(null!==d&&(d=d.updateQueue,c===d)){var e=null,f=null;c=c.firstBaseUpdate;if(null!==c){do{var g={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};null===f?e=f=g:f=f.next=g;c=c.next}while(null!==c);null===f?e=f=b:f=f.next=b}else e=f=b;c={baseState:d.baseState,firstBaseUpdate:e,lastBaseUpdate:f,shared:d.shared,effects:d.effects};a.updateQueue=c;return}a=c.lastBaseUpdate;null===a?c.firstBaseUpdate=b:a.next=\nb;c.lastBaseUpdate=b}\nfunction qh(a,b,c,d){var e=a.updateQueue;jh=!1;var f=e.firstBaseUpdate,g=e.lastBaseUpdate,h=e.shared.pending;if(null!==h){e.shared.pending=null;var k=h,l=k.next;k.next=null;null===g?f=l:g.next=l;g=k;var m=a.alternate;null!==m&&(m=m.updateQueue,h=m.lastBaseUpdate,h!==g&&(null===h?m.firstBaseUpdate=l:h.next=l,m.lastBaseUpdate=k))}if(null!==f){var q=e.baseState;g=0;m=l=k=null;h=f;do{var r=h.lane,y=h.eventTime;if((d&r)===r){null!==m&&(m=m.next={eventTime:y,lane:0,tag:h.tag,payload:h.payload,callback:h.callback,\nnext:null});a:{var n=a,t=h;r=b;y=c;switch(t.tag){case 1:n=t.payload;if(\"function\"===typeof n){q=n.call(y,q,r);break a}q=n;break a;case 3:n.flags=n.flags&-65537|128;case 0:n=t.payload;r=\"function\"===typeof n?n.call(y,q,r):n;if(null===r||void 0===r)break a;q=A({},q,r);break a;case 2:jh=!0}}null!==h.callback&&0!==h.lane&&(a.flags|=64,r=e.effects,null===r?e.effects=[h]:r.push(h))}else y={eventTime:y,lane:r,tag:h.tag,payload:h.payload,callback:h.callback,next:null},null===m?(l=m=y,k=q):m=m.next=y,g|=r;\nh=h.next;if(null===h)if(h=e.shared.pending,null===h)break;else r=h,h=r.next,r.next=null,e.lastBaseUpdate=r,e.shared.pending=null}while(1);null===m&&(k=q);e.baseState=k;e.firstBaseUpdate=l;e.lastBaseUpdate=m;b=e.shared.interleaved;if(null!==b){e=b;do g|=e.lane,e=e.next;while(e!==b)}else null===f&&(e.shared.lanes=0);rh|=g;a.lanes=g;a.memoizedState=q}}\nfunction sh(a,b,c){a=b.effects;b.effects=null;if(null!==a)for(b=0;b<a.length;b++){var d=a[b],e=d.callback;if(null!==e){d.callback=null;d=c;if(\"function\"!==typeof e)throw Error(p(191,e));e.call(d)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(a){if(a===th)throw Error(p(174));return a}\nfunction yh(a,b){G(wh,b);G(vh,a);G(uh,th);a=b.nodeType;switch(a){case 9:case 11:b=(b=b.documentElement)?b.namespaceURI:lb(null,\"\");break;default:a=8===a?b.parentNode:b,b=a.namespaceURI||null,a=a.tagName,b=lb(b,a)}E(uh);G(uh,b)}function zh(){E(uh);E(vh);E(wh)}function Ah(a){xh(wh.current);var b=xh(uh.current);var c=lb(b,a.type);b!==c&&(G(vh,a),G(uh,c))}function Bh(a){vh.current===a&&(E(uh),E(vh))}var L=Uf(0);\nfunction Ch(a){for(var b=a;null!==b;){if(13===b.tag){var c=b.memoizedState;if(null!==c&&(c=c.dehydrated,null===c||\"$?\"===c.data||\"$!\"===c.data))return b}else if(19===b.tag&&void 0!==b.memoizedProps.revealOrder){if(0!==(b.flags&128))return b}else if(null!==b.child){b.child.return=b;b=b.child;continue}if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}return null}var Dh=[];\nfunction Eh(){for(var a=0;a<Dh.length;a++)Dh[a]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M=null,N=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P(){throw Error(p(321));}function Mh(a,b){if(null===b)return!1;for(var c=0;c<b.length&&c<a.length;c++)if(!He(a[c],b[c]))return!1;return!0}\nfunction Nh(a,b,c,d,e,f){Hh=f;M=b;b.memoizedState=null;b.updateQueue=null;b.lanes=0;Fh.current=null===a||null===a.memoizedState?Oh:Ph;a=c(d,e);if(Jh){f=0;do{Jh=!1;Kh=0;if(25<=f)throw Error(p(301));f+=1;O=N=null;b.updateQueue=null;Fh.current=Qh;a=c(d,e)}while(Jh)}Fh.current=Rh;b=null!==N&&null!==N.next;Hh=0;O=N=M=null;Ih=!1;if(b)throw Error(p(300));return a}function Sh(){var a=0!==Kh;Kh=0;return a}\nfunction Th(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};null===O?M.memoizedState=O=a:O=O.next=a;return O}function Uh(){if(null===N){var a=M.alternate;a=null!==a?a.memoizedState:null}else a=N.next;var b=null===O?M.memoizedState:O.next;if(null!==b)O=b,N=a;else{if(null===a)throw Error(p(310));N=a;a={memoizedState:N.memoizedState,baseState:N.baseState,baseQueue:N.baseQueue,queue:N.queue,next:null};null===O?M.memoizedState=O=a:O=O.next=a}return O}\nfunction Vh(a,b){return\"function\"===typeof b?b(a):b}\nfunction Wh(a){var b=Uh(),c=b.queue;if(null===c)throw Error(p(311));c.lastRenderedReducer=a;var d=N,e=d.baseQueue,f=c.pending;if(null!==f){if(null!==e){var g=e.next;e.next=f.next;f.next=g}d.baseQueue=e=f;c.pending=null}if(null!==e){f=e.next;d=d.baseState;var h=g=null,k=null,l=f;do{var m=l.lane;if((Hh&m)===m)null!==k&&(k=k.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),d=l.hasEagerState?l.eagerState:a(d,l.action);else{var q={lane:m,action:l.action,hasEagerState:l.hasEagerState,\neagerState:l.eagerState,next:null};null===k?(h=k=q,g=d):k=k.next=q;M.lanes|=m;rh|=m}l=l.next}while(null!==l&&l!==f);null===k?g=d:k.next=h;He(d,b.memoizedState)||(dh=!0);b.memoizedState=d;b.baseState=g;b.baseQueue=k;c.lastRenderedState=d}a=c.interleaved;if(null!==a){e=a;do f=e.lane,M.lanes|=f,rh|=f,e=e.next;while(e!==a)}else null===e&&(c.lanes=0);return[b.memoizedState,c.dispatch]}\nfunction Xh(a){var b=Uh(),c=b.queue;if(null===c)throw Error(p(311));c.lastRenderedReducer=a;var d=c.dispatch,e=c.pending,f=b.memoizedState;if(null!==e){c.pending=null;var g=e=e.next;do f=a(f,g.action),g=g.next;while(g!==e);He(f,b.memoizedState)||(dh=!0);b.memoizedState=f;null===b.baseQueue&&(b.baseState=f);c.lastRenderedState=f}return[f,d]}function Yh(){}\nfunction Zh(a,b){var c=M,d=Uh(),e=b(),f=!He(d.memoizedState,e);f&&(d.memoizedState=e,dh=!0);d=d.queue;$h(ai.bind(null,c,d,a),[a]);if(d.getSnapshot!==b||f||null!==O&&O.memoizedState.tag&1){c.flags|=2048;bi(9,ci.bind(null,c,d,e,b),void 0,null);if(null===Q)throw Error(p(349));0!==(Hh&30)||di(c,b,e)}return e}function di(a,b,c){a.flags|=16384;a={getSnapshot:b,value:c};b=M.updateQueue;null===b?(b={lastEffect:null,stores:null},M.updateQueue=b,b.stores=[a]):(c=b.stores,null===c?b.stores=[a]:c.push(a))}\nfunction ci(a,b,c,d){b.value=c;b.getSnapshot=d;ei(b)&&fi(a)}function ai(a,b,c){return c(function(){ei(b)&&fi(a)})}function ei(a){var b=a.getSnapshot;a=a.value;try{var c=b();return!He(a,c)}catch(d){return!0}}function fi(a){var b=ih(a,1);null!==b&&gi(b,a,1,-1)}\nfunction hi(a){var b=Th();\"function\"===typeof a&&(a=a());b.memoizedState=b.baseState=a;a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:a};b.queue=a;a=a.dispatch=ii.bind(null,M,a);return[b.memoizedState,a]}\nfunction bi(a,b,c,d){a={tag:a,create:b,destroy:c,deps:d,next:null};b=M.updateQueue;null===b?(b={lastEffect:null,stores:null},M.updateQueue=b,b.lastEffect=a.next=a):(c=b.lastEffect,null===c?b.lastEffect=a.next=a:(d=c.next,c.next=a,a.next=d,b.lastEffect=a));return a}function ji(){return Uh().memoizedState}function ki(a,b,c,d){var e=Th();M.flags|=a;e.memoizedState=bi(1|b,c,void 0,void 0===d?null:d)}\nfunction li(a,b,c,d){var e=Uh();d=void 0===d?null:d;var f=void 0;if(null!==N){var g=N.memoizedState;f=g.destroy;if(null!==d&&Mh(d,g.deps)){e.memoizedState=bi(b,c,f,d);return}}M.flags|=a;e.memoizedState=bi(1|b,c,f,d)}function mi(a,b){return ki(8390656,8,a,b)}function $h(a,b){return li(2048,8,a,b)}function ni(a,b){return li(4,2,a,b)}function oi(a,b){return li(4,4,a,b)}\nfunction pi(a,b){if(\"function\"===typeof b)return a=a(),b(a),function(){b(null)};if(null!==b&&void 0!==b)return a=a(),b.current=a,function(){b.current=null}}function qi(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return li(4,4,pi.bind(null,b,a),c)}function ri(){}function si(a,b){var c=Uh();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&Mh(b,d[1]))return d[0];c.memoizedState=[a,b];return a}\nfunction ti(a,b){var c=Uh();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&Mh(b,d[1]))return d[0];a=a();c.memoizedState=[a,b];return a}function ui(a,b,c){if(0===(Hh&21))return a.baseState&&(a.baseState=!1,dh=!0),a.memoizedState=c;He(c,b)||(c=yc(),M.lanes|=c,rh|=c,a.baseState=!0);return b}function vi(a,b){var c=C;C=0!==c&&4>c?c:4;a(!0);var d=Gh.transition;Gh.transition={};try{a(!1),b()}finally{C=c,Gh.transition=d}}function wi(){return Uh().memoizedState}\nfunction xi(a,b,c){var d=yi(a);c={lane:d,action:c,hasEagerState:!1,eagerState:null,next:null};if(zi(a))Ai(b,c);else if(c=hh(a,b,c,d),null!==c){var e=R();gi(c,a,d,e);Bi(c,b,d)}}\nfunction ii(a,b,c){var d=yi(a),e={lane:d,action:c,hasEagerState:!1,eagerState:null,next:null};if(zi(a))Ai(b,e);else{var f=a.alternate;if(0===a.lanes&&(null===f||0===f.lanes)&&(f=b.lastRenderedReducer,null!==f))try{var g=b.lastRenderedState,h=f(g,c);e.hasEagerState=!0;e.eagerState=h;if(He(h,g)){var k=b.interleaved;null===k?(e.next=e,gh(b)):(e.next=k.next,k.next=e);b.interleaved=e;return}}catch(l){}finally{}c=hh(a,b,e,d);null!==c&&(e=R(),gi(c,a,d,e),Bi(c,b,d))}}\nfunction zi(a){var b=a.alternate;return a===M||null!==b&&b===M}function Ai(a,b){Jh=Ih=!0;var c=a.pending;null===c?b.next=b:(b.next=c.next,c.next=b);a.pending=b}function Bi(a,b,c){if(0!==(c&4194240)){var d=b.lanes;d&=a.pendingLanes;c|=d;b.lanes=c;Cc(a,c)}}\nvar Rh={readContext:eh,useCallback:P,useContext:P,useEffect:P,useImperativeHandle:P,useInsertionEffect:P,useLayoutEffect:P,useMemo:P,useReducer:P,useRef:P,useState:P,useDebugValue:P,useDeferredValue:P,useTransition:P,useMutableSource:P,useSyncExternalStore:P,useId:P,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(a,b){Th().memoizedState=[a,void 0===b?null:b];return a},useContext:eh,useEffect:mi,useImperativeHandle:function(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return ki(4194308,\n4,pi.bind(null,b,a),c)},useLayoutEffect:function(a,b){return ki(4194308,4,a,b)},useInsertionEffect:function(a,b){return ki(4,2,a,b)},useMemo:function(a,b){var c=Th();b=void 0===b?null:b;a=a();c.memoizedState=[a,b];return a},useReducer:function(a,b,c){var d=Th();b=void 0!==c?c(b):b;d.memoizedState=d.baseState=b;a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:b};d.queue=a;a=a.dispatch=xi.bind(null,M,a);return[d.memoizedState,a]},useRef:function(a){var b=\nTh();a={current:a};return b.memoizedState=a},useState:hi,useDebugValue:ri,useDeferredValue:function(a){return Th().memoizedState=a},useTransition:function(){var a=hi(!1),b=a[0];a=vi.bind(null,a[1]);Th().memoizedState=a;return[b,a]},useMutableSource:function(){},useSyncExternalStore:function(a,b,c){var d=M,e=Th();if(I){if(void 0===c)throw Error(p(407));c=c()}else{c=b();if(null===Q)throw Error(p(349));0!==(Hh&30)||di(d,b,c)}e.memoizedState=c;var f={value:c,getSnapshot:b};e.queue=f;mi(ai.bind(null,d,\nf,a),[a]);d.flags|=2048;bi(9,ci.bind(null,d,f,c,b),void 0,null);return c},useId:function(){var a=Th(),b=Q.identifierPrefix;if(I){var c=sg;var d=rg;c=(d&~(1<<32-oc(d)-1)).toString(32)+c;b=\":\"+b+\"R\"+c;c=Kh++;0<c&&(b+=\"H\"+c.toString(32));b+=\":\"}else c=Lh++,b=\":\"+b+\"r\"+c.toString(32)+\":\";return a.memoizedState=b},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},\nuseDebugValue:ri,useDeferredValue:function(a){var b=Uh();return ui(b,N.memoizedState,a)},useTransition:function(){var a=Wh(Vh)[0],b=Uh().memoizedState;return[a,b]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(a){var b=Uh();return null===\nN?b.memoizedState=a:ui(b,N.memoizedState,a)},useTransition:function(){var a=Xh(Vh)[0],b=Uh().memoizedState;return[a,b]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(a,b){if(a&&a.defaultProps){b=A({},b);a=a.defaultProps;for(var c in a)void 0===b[c]&&(b[c]=a[c]);return b}return b}function Di(a,b,c,d){b=a.memoizedState;c=c(d,b);c=null===c||void 0===c?b:A({},b,c);a.memoizedState=c;0===a.lanes&&(a.updateQueue.baseState=c)}\nvar Ei={isMounted:function(a){return(a=a._reactInternals)?Vb(a)===a:!1},enqueueSetState:function(a,b,c){a=a._reactInternals;var d=R(),e=yi(a),f=mh(d,e);f.payload=b;void 0!==c&&null!==c&&(f.callback=c);b=nh(a,f,e);null!==b&&(gi(b,a,e,d),oh(b,a,e))},enqueueReplaceState:function(a,b,c){a=a._reactInternals;var d=R(),e=yi(a),f=mh(d,e);f.tag=1;f.payload=b;void 0!==c&&null!==c&&(f.callback=c);b=nh(a,f,e);null!==b&&(gi(b,a,e,d),oh(b,a,e))},enqueueForceUpdate:function(a,b){a=a._reactInternals;var c=R(),d=\nyi(a),e=mh(c,d);e.tag=2;void 0!==b&&null!==b&&(e.callback=b);b=nh(a,e,d);null!==b&&(gi(b,a,d,c),oh(b,a,d))}};function Fi(a,b,c,d,e,f,g){a=a.stateNode;return\"function\"===typeof a.shouldComponentUpdate?a.shouldComponentUpdate(d,f,g):b.prototype&&b.prototype.isPureReactComponent?!Ie(c,d)||!Ie(e,f):!0}\nfunction Gi(a,b,c){var d=!1,e=Vf;var f=b.contextType;\"object\"===typeof f&&null!==f?f=eh(f):(e=Zf(b)?Xf:H.current,d=b.contextTypes,f=(d=null!==d&&void 0!==d)?Yf(a,e):Vf);b=new b(c,f);a.memoizedState=null!==b.state&&void 0!==b.state?b.state:null;b.updater=Ei;a.stateNode=b;b._reactInternals=a;d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=e,a.__reactInternalMemoizedMaskedChildContext=f);return b}\nfunction Hi(a,b,c,d){a=b.state;\"function\"===typeof b.componentWillReceiveProps&&b.componentWillReceiveProps(c,d);\"function\"===typeof b.UNSAFE_componentWillReceiveProps&&b.UNSAFE_componentWillReceiveProps(c,d);b.state!==a&&Ei.enqueueReplaceState(b,b.state,null)}\nfunction Ii(a,b,c,d){var e=a.stateNode;e.props=c;e.state=a.memoizedState;e.refs={};kh(a);var f=b.contextType;\"object\"===typeof f&&null!==f?e.context=eh(f):(f=Zf(b)?Xf:H.current,e.context=Yf(a,f));e.state=a.memoizedState;f=b.getDerivedStateFromProps;\"function\"===typeof f&&(Di(a,b,f,c),e.state=a.memoizedState);\"function\"===typeof b.getDerivedStateFromProps||\"function\"===typeof e.getSnapshotBeforeUpdate||\"function\"!==typeof e.UNSAFE_componentWillMount&&\"function\"!==typeof e.componentWillMount||(b=e.state,\n\"function\"===typeof e.componentWillMount&&e.componentWillMount(),\"function\"===typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),b!==e.state&&Ei.enqueueReplaceState(e,e.state,null),qh(a,c,e,d),e.state=a.memoizedState);\"function\"===typeof e.componentDidMount&&(a.flags|=4194308)}function Ji(a,b){try{var c=\"\",d=b;do c+=Pa(d),d=d.return;while(d);var e=c}catch(f){e=\"\\nError generating stack: \"+f.message+\"\\n\"+f.stack}return{value:a,source:b,stack:e,digest:null}}\nfunction Ki(a,b,c){return{value:a,source:null,stack:null!=c?c:null,digest:null!=b?b:null}}function Li(a,b){try{console.error(b.value)}catch(c){setTimeout(function(){throw c;})}}var Mi=\"function\"===typeof WeakMap?WeakMap:Map;function Ni(a,b,c){c=mh(-1,c);c.tag=3;c.payload={element:null};var d=b.value;c.callback=function(){Oi||(Oi=!0,Pi=d);Li(a,b)};return c}\nfunction Qi(a,b,c){c=mh(-1,c);c.tag=3;var d=a.type.getDerivedStateFromError;if(\"function\"===typeof d){var e=b.value;c.payload=function(){return d(e)};c.callback=function(){Li(a,b)}}var f=a.stateNode;null!==f&&\"function\"===typeof f.componentDidCatch&&(c.callback=function(){Li(a,b);\"function\"!==typeof d&&(null===Ri?Ri=new Set([this]):Ri.add(this));var c=b.stack;this.componentDidCatch(b.value,{componentStack:null!==c?c:\"\"})});return c}\nfunction Si(a,b,c){var d=a.pingCache;if(null===d){d=a.pingCache=new Mi;var e=new Set;d.set(b,e)}else e=d.get(b),void 0===e&&(e=new Set,d.set(b,e));e.has(c)||(e.add(c),a=Ti.bind(null,a,b,c),b.then(a,a))}function Ui(a){do{var b;if(b=13===a.tag)b=a.memoizedState,b=null!==b?null!==b.dehydrated?!0:!1:!0;if(b)return a;a=a.return}while(null!==a);return null}\nfunction Vi(a,b,c,d,e){if(0===(a.mode&1))return a===b?a.flags|=65536:(a.flags|=128,c.flags|=131072,c.flags&=-52805,1===c.tag&&(null===c.alternate?c.tag=17:(b=mh(-1,1),b.tag=2,nh(c,b,1))),c.lanes|=1),a;a.flags|=65536;a.lanes=e;return a}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(a,b,c,d){b.child=null===a?Vg(b,null,c,d):Ug(b,a.child,c,d)}\nfunction Yi(a,b,c,d,e){c=c.render;var f=b.ref;ch(b,e);d=Nh(a,b,c,d,f,e);c=Sh();if(null!==a&&!dh)return b.updateQueue=a.updateQueue,b.flags&=-2053,a.lanes&=~e,Zi(a,b,e);I&&c&&vg(b);b.flags|=1;Xi(a,b,d,e);return b.child}\nfunction $i(a,b,c,d,e){if(null===a){var f=c.type;if(\"function\"===typeof f&&!aj(f)&&void 0===f.defaultProps&&null===c.compare&&void 0===c.defaultProps)return b.tag=15,b.type=f,bj(a,b,f,d,e);a=Rg(c.type,null,d,b,b.mode,e);a.ref=b.ref;a.return=b;return b.child=a}f=a.child;if(0===(a.lanes&e)){var g=f.memoizedProps;c=c.compare;c=null!==c?c:Ie;if(c(g,d)&&a.ref===b.ref)return Zi(a,b,e)}b.flags|=1;a=Pg(f,d);a.ref=b.ref;a.return=b;return b.child=a}\nfunction bj(a,b,c,d,e){if(null!==a){var f=a.memoizedProps;if(Ie(f,d)&&a.ref===b.ref)if(dh=!1,b.pendingProps=d=f,0!==(a.lanes&e))0!==(a.flags&131072)&&(dh=!0);else return b.lanes=a.lanes,Zi(a,b,e)}return cj(a,b,c,d,e)}\nfunction dj(a,b,c){var d=b.pendingProps,e=d.children,f=null!==a?a.memoizedState:null;if(\"hidden\"===d.mode)if(0===(b.mode&1))b.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=c;else{if(0===(c&1073741824))return a=null!==f?f.baseLanes|c:c,b.lanes=b.childLanes=1073741824,b.memoizedState={baseLanes:a,cachePool:null,transitions:null},b.updateQueue=null,G(ej,fj),fj|=a,null;b.memoizedState={baseLanes:0,cachePool:null,transitions:null};d=null!==f?f.baseLanes:c;G(ej,fj);fj|=d}else null!==\nf?(d=f.baseLanes|c,b.memoizedState=null):d=c,G(ej,fj),fj|=d;Xi(a,b,e,c);return b.child}function gj(a,b){var c=b.ref;if(null===a&&null!==c||null!==a&&a.ref!==c)b.flags|=512,b.flags|=2097152}function cj(a,b,c,d,e){var f=Zf(c)?Xf:H.current;f=Yf(b,f);ch(b,e);c=Nh(a,b,c,d,f,e);d=Sh();if(null!==a&&!dh)return b.updateQueue=a.updateQueue,b.flags&=-2053,a.lanes&=~e,Zi(a,b,e);I&&d&&vg(b);b.flags|=1;Xi(a,b,c,e);return b.child}\nfunction hj(a,b,c,d,e){if(Zf(c)){var f=!0;cg(b)}else f=!1;ch(b,e);if(null===b.stateNode)ij(a,b),Gi(b,c,d),Ii(b,c,d,e),d=!0;else if(null===a){var g=b.stateNode,h=b.memoizedProps;g.props=h;var k=g.context,l=c.contextType;\"object\"===typeof l&&null!==l?l=eh(l):(l=Zf(c)?Xf:H.current,l=Yf(b,l));var m=c.getDerivedStateFromProps,q=\"function\"===typeof m||\"function\"===typeof g.getSnapshotBeforeUpdate;q||\"function\"!==typeof g.UNSAFE_componentWillReceiveProps&&\"function\"!==typeof g.componentWillReceiveProps||\n(h!==d||k!==l)&&Hi(b,g,d,l);jh=!1;var r=b.memoizedState;g.state=r;qh(b,d,g,e);k=b.memoizedState;h!==d||r!==k||Wf.current||jh?(\"function\"===typeof m&&(Di(b,c,m,d),k=b.memoizedState),(h=jh||Fi(b,c,h,d,r,k,l))?(q||\"function\"!==typeof g.UNSAFE_componentWillMount&&\"function\"!==typeof g.componentWillMount||(\"function\"===typeof g.componentWillMount&&g.componentWillMount(),\"function\"===typeof g.UNSAFE_componentWillMount&&g.UNSAFE_componentWillMount()),\"function\"===typeof g.componentDidMount&&(b.flags|=4194308)):\n(\"function\"===typeof g.componentDidMount&&(b.flags|=4194308),b.memoizedProps=d,b.memoizedState=k),g.props=d,g.state=k,g.context=l,d=h):(\"function\"===typeof g.componentDidMount&&(b.flags|=4194308),d=!1)}else{g=b.stateNode;lh(a,b);h=b.memoizedProps;l=b.type===b.elementType?h:Ci(b.type,h);g.props=l;q=b.pendingProps;r=g.context;k=c.contextType;\"object\"===typeof k&&null!==k?k=eh(k):(k=Zf(c)?Xf:H.current,k=Yf(b,k));var y=c.getDerivedStateFromProps;(m=\"function\"===typeof y||\"function\"===typeof g.getSnapshotBeforeUpdate)||\n\"function\"!==typeof g.UNSAFE_componentWillReceiveProps&&\"function\"!==typeof g.componentWillReceiveProps||(h!==q||r!==k)&&Hi(b,g,d,k);jh=!1;r=b.memoizedState;g.state=r;qh(b,d,g,e);var n=b.memoizedState;h!==q||r!==n||Wf.current||jh?(\"function\"===typeof y&&(Di(b,c,y,d),n=b.memoizedState),(l=jh||Fi(b,c,l,d,r,n,k)||!1)?(m||\"function\"!==typeof g.UNSAFE_componentWillUpdate&&\"function\"!==typeof g.componentWillUpdate||(\"function\"===typeof g.componentWillUpdate&&g.componentWillUpdate(d,n,k),\"function\"===typeof g.UNSAFE_componentWillUpdate&&\ng.UNSAFE_componentWillUpdate(d,n,k)),\"function\"===typeof g.componentDidUpdate&&(b.flags|=4),\"function\"===typeof g.getSnapshotBeforeUpdate&&(b.flags|=1024)):(\"function\"!==typeof g.componentDidUpdate||h===a.memoizedProps&&r===a.memoizedState||(b.flags|=4),\"function\"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&r===a.memoizedState||(b.flags|=1024),b.memoizedProps=d,b.memoizedState=n),g.props=d,g.state=n,g.context=k,d=l):(\"function\"!==typeof g.componentDidUpdate||h===a.memoizedProps&&r===\na.memoizedState||(b.flags|=4),\"function\"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&r===a.memoizedState||(b.flags|=1024),d=!1)}return jj(a,b,c,d,f,e)}\nfunction jj(a,b,c,d,e,f){gj(a,b);var g=0!==(b.flags&128);if(!d&&!g)return e&&dg(b,c,!1),Zi(a,b,f);d=b.stateNode;Wi.current=b;var h=g&&\"function\"!==typeof c.getDerivedStateFromError?null:d.render();b.flags|=1;null!==a&&g?(b.child=Ug(b,a.child,null,f),b.child=Ug(b,null,h,f)):Xi(a,b,h,f);b.memoizedState=d.state;e&&dg(b,c,!0);return b.child}function kj(a){var b=a.stateNode;b.pendingContext?ag(a,b.pendingContext,b.pendingContext!==b.context):b.context&&ag(a,b.context,!1);yh(a,b.containerInfo)}\nfunction lj(a,b,c,d,e){Ig();Jg(e);b.flags|=256;Xi(a,b,c,d);return b.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(a){return{baseLanes:a,cachePool:null,transitions:null}}\nfunction oj(a,b,c){var d=b.pendingProps,e=L.current,f=!1,g=0!==(b.flags&128),h;(h=g)||(h=null!==a&&null===a.memoizedState?!1:0!==(e&2));if(h)f=!0,b.flags&=-129;else if(null===a||null!==a.memoizedState)e|=1;G(L,e&1);if(null===a){Eg(b);a=b.memoizedState;if(null!==a&&(a=a.dehydrated,null!==a))return 0===(b.mode&1)?b.lanes=1:\"$!\"===a.data?b.lanes=8:b.lanes=1073741824,null;g=d.children;a=d.fallback;return f?(d=b.mode,f=b.child,g={mode:\"hidden\",children:g},0===(d&1)&&null!==f?(f.childLanes=0,f.pendingProps=\ng):f=pj(g,d,0,null),a=Tg(a,d,c,null),f.return=b,a.return=b,f.sibling=a,b.child=f,b.child.memoizedState=nj(c),b.memoizedState=mj,a):qj(b,g)}e=a.memoizedState;if(null!==e&&(h=e.dehydrated,null!==h))return rj(a,b,g,d,h,e,c);if(f){f=d.fallback;g=b.mode;e=a.child;h=e.sibling;var k={mode:\"hidden\",children:d.children};0===(g&1)&&b.child!==e?(d=b.child,d.childLanes=0,d.pendingProps=k,b.deletions=null):(d=Pg(e,k),d.subtreeFlags=e.subtreeFlags&14680064);null!==h?f=Pg(h,f):(f=Tg(f,g,c,null),f.flags|=2);f.return=\nb;d.return=b;d.sibling=f;b.child=d;d=f;f=b.child;g=a.child.memoizedState;g=null===g?nj(c):{baseLanes:g.baseLanes|c,cachePool:null,transitions:g.transitions};f.memoizedState=g;f.childLanes=a.childLanes&~c;b.memoizedState=mj;return d}f=a.child;a=f.sibling;d=Pg(f,{mode:\"visible\",children:d.children});0===(b.mode&1)&&(d.lanes=c);d.return=b;d.sibling=null;null!==a&&(c=b.deletions,null===c?(b.deletions=[a],b.flags|=16):c.push(a));b.child=d;b.memoizedState=null;return d}\nfunction qj(a,b){b=pj({mode:\"visible\",children:b},a.mode,0,null);b.return=a;return a.child=b}function sj(a,b,c,d){null!==d&&Jg(d);Ug(b,a.child,null,c);a=qj(b,b.pendingProps.children);a.flags|=2;b.memoizedState=null;return a}\nfunction rj(a,b,c,d,e,f,g){if(c){if(b.flags&256)return b.flags&=-257,d=Ki(Error(p(422))),sj(a,b,g,d);if(null!==b.memoizedState)return b.child=a.child,b.flags|=128,null;f=d.fallback;e=b.mode;d=pj({mode:\"visible\",children:d.children},e,0,null);f=Tg(f,e,g,null);f.flags|=2;d.return=b;f.return=b;d.sibling=f;b.child=d;0!==(b.mode&1)&&Ug(b,a.child,null,g);b.child.memoizedState=nj(g);b.memoizedState=mj;return f}if(0===(b.mode&1))return sj(a,b,g,null);if(\"$!\"===e.data){d=e.nextSibling&&e.nextSibling.dataset;\nif(d)var h=d.dgst;d=h;f=Error(p(419));d=Ki(f,d,void 0);return sj(a,b,g,d)}h=0!==(g&a.childLanes);if(dh||h){d=Q;if(null!==d){switch(g&-g){case 4:e=2;break;case 16:e=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:e=32;break;case 536870912:e=268435456;break;default:e=0}e=0!==(e&(d.suspendedLanes|g))?0:e;\n0!==e&&e!==f.retryLane&&(f.retryLane=e,ih(a,e),gi(d,a,e,-1))}tj();d=Ki(Error(p(421)));return sj(a,b,g,d)}if(\"$?\"===e.data)return b.flags|=128,b.child=a.child,b=uj.bind(null,a),e._reactRetry=b,null;a=f.treeContext;yg=Lf(e.nextSibling);xg=b;I=!0;zg=null;null!==a&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=a.id,sg=a.overflow,qg=b);b=qj(b,d.children);b.flags|=4096;return b}function vj(a,b,c){a.lanes|=b;var d=a.alternate;null!==d&&(d.lanes|=b);bh(a.return,b,c)}\nfunction wj(a,b,c,d,e){var f=a.memoizedState;null===f?a.memoizedState={isBackwards:b,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:e}:(f.isBackwards=b,f.rendering=null,f.renderingStartTime=0,f.last=d,f.tail=c,f.tailMode=e)}\nfunction xj(a,b,c){var d=b.pendingProps,e=d.revealOrder,f=d.tail;Xi(a,b,d.children,c);d=L.current;if(0!==(d&2))d=d&1|2,b.flags|=128;else{if(null!==a&&0!==(a.flags&128))a:for(a=b.child;null!==a;){if(13===a.tag)null!==a.memoizedState&&vj(a,c,b);else if(19===a.tag)vj(a,c,b);else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===b)break a;for(;null===a.sibling;){if(null===a.return||a.return===b)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}d&=1}G(L,d);if(0===(b.mode&1))b.memoizedState=\nnull;else switch(e){case \"forwards\":c=b.child;for(e=null;null!==c;)a=c.alternate,null!==a&&null===Ch(a)&&(e=c),c=c.sibling;c=e;null===c?(e=b.child,b.child=null):(e=c.sibling,c.sibling=null);wj(b,!1,e,c,f);break;case \"backwards\":c=null;e=b.child;for(b.child=null;null!==e;){a=e.alternate;if(null!==a&&null===Ch(a)){b.child=e;break}a=e.sibling;e.sibling=c;c=e;e=a}wj(b,!0,c,null,f);break;case \"together\":wj(b,!1,null,null,void 0);break;default:b.memoizedState=null}return b.child}\nfunction ij(a,b){0===(b.mode&1)&&null!==a&&(a.alternate=null,b.alternate=null,b.flags|=2)}function Zi(a,b,c){null!==a&&(b.dependencies=a.dependencies);rh|=b.lanes;if(0===(c&b.childLanes))return null;if(null!==a&&b.child!==a.child)throw Error(p(153));if(null!==b.child){a=b.child;c=Pg(a,a.pendingProps);b.child=c;for(c.return=b;null!==a.sibling;)a=a.sibling,c=c.sibling=Pg(a,a.pendingProps),c.return=b;c.sibling=null}return b.child}\nfunction yj(a,b,c){switch(b.tag){case 3:kj(b);Ig();break;case 5:Ah(b);break;case 1:Zf(b.type)&&cg(b);break;case 4:yh(b,b.stateNode.containerInfo);break;case 10:var d=b.type._context,e=b.memoizedProps.value;G(Wg,d._currentValue);d._currentValue=e;break;case 13:d=b.memoizedState;if(null!==d){if(null!==d.dehydrated)return G(L,L.current&1),b.flags|=128,null;if(0!==(c&b.child.childLanes))return oj(a,b,c);G(L,L.current&1);a=Zi(a,b,c);return null!==a?a.sibling:null}G(L,L.current&1);break;case 19:d=0!==(c&\nb.childLanes);if(0!==(a.flags&128)){if(d)return xj(a,b,c);b.flags|=128}e=b.memoizedState;null!==e&&(e.rendering=null,e.tail=null,e.lastEffect=null);G(L,L.current);if(d)break;else return null;case 22:case 23:return b.lanes=0,dj(a,b,c)}return Zi(a,b,c)}var zj,Aj,Bj,Cj;\nzj=function(a,b){for(var c=b.child;null!==c;){if(5===c.tag||6===c.tag)a.appendChild(c.stateNode);else if(4!==c.tag&&null!==c.child){c.child.return=c;c=c.child;continue}if(c===b)break;for(;null===c.sibling;){if(null===c.return||c.return===b)return;c=c.return}c.sibling.return=c.return;c=c.sibling}};Aj=function(){};\nBj=function(a,b,c,d){var e=a.memoizedProps;if(e!==d){a=b.stateNode;xh(uh.current);var f=null;switch(c){case \"input\":e=Ya(a,e);d=Ya(a,d);f=[];break;case \"select\":e=A({},e,{value:void 0});d=A({},d,{value:void 0});f=[];break;case \"textarea\":e=gb(a,e);d=gb(a,d);f=[];break;default:\"function\"!==typeof e.onClick&&\"function\"===typeof d.onClick&&(a.onclick=Bf)}ub(c,d);var g;c=null;for(l in e)if(!d.hasOwnProperty(l)&&e.hasOwnProperty(l)&&null!=e[l])if(\"style\"===l){var h=e[l];for(g in h)h.hasOwnProperty(g)&&\n(c||(c={}),c[g]=\"\")}else\"dangerouslySetInnerHTML\"!==l&&\"children\"!==l&&\"suppressContentEditableWarning\"!==l&&\"suppressHydrationWarning\"!==l&&\"autoFocus\"!==l&&(ea.hasOwnProperty(l)?f||(f=[]):(f=f||[]).push(l,null));for(l in d){var k=d[l];h=null!=e?e[l]:void 0;if(d.hasOwnProperty(l)&&k!==h&&(null!=k||null!=h))if(\"style\"===l)if(h){for(g in h)!h.hasOwnProperty(g)||k&&k.hasOwnProperty(g)||(c||(c={}),c[g]=\"\");for(g in k)k.hasOwnProperty(g)&&h[g]!==k[g]&&(c||(c={}),c[g]=k[g])}else c||(f||(f=[]),f.push(l,\nc)),c=k;else\"dangerouslySetInnerHTML\"===l?(k=k?k.__html:void 0,h=h?h.__html:void 0,null!=k&&h!==k&&(f=f||[]).push(l,k)):\"children\"===l?\"string\"!==typeof k&&\"number\"!==typeof k||(f=f||[]).push(l,\"\"+k):\"suppressContentEditableWarning\"!==l&&\"suppressHydrationWarning\"!==l&&(ea.hasOwnProperty(l)?(null!=k&&\"onScroll\"===l&&D(\"scroll\",a),f||h===k||(f=[])):(f=f||[]).push(l,k))}c&&(f=f||[]).push(\"style\",c);var l=f;if(b.updateQueue=l)b.flags|=4}};Cj=function(a,b,c,d){c!==d&&(b.flags|=4)};\nfunction Dj(a,b){if(!I)switch(a.tailMode){case \"hidden\":b=a.tail;for(var c=null;null!==b;)null!==b.alternate&&(c=b),b=b.sibling;null===c?a.tail=null:c.sibling=null;break;case \"collapsed\":c=a.tail;for(var d=null;null!==c;)null!==c.alternate&&(d=c),c=c.sibling;null===d?b||null===a.tail?a.tail=null:a.tail.sibling=null:d.sibling=null}}\nfunction S(a){var b=null!==a.alternate&&a.alternate.child===a.child,c=0,d=0;if(b)for(var e=a.child;null!==e;)c|=e.lanes|e.childLanes,d|=e.subtreeFlags&14680064,d|=e.flags&14680064,e.return=a,e=e.sibling;else for(e=a.child;null!==e;)c|=e.lanes|e.childLanes,d|=e.subtreeFlags,d|=e.flags,e.return=a,e=e.sibling;a.subtreeFlags|=d;a.childLanes=c;return b}\nfunction Ej(a,b,c){var d=b.pendingProps;wg(b);switch(b.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(b),null;case 1:return Zf(b.type)&&$f(),S(b),null;case 3:d=b.stateNode;zh();E(Wf);E(H);Eh();d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null);if(null===a||null===a.child)Gg(b)?b.flags|=4:null===a||a.memoizedState.isDehydrated&&0===(b.flags&256)||(b.flags|=1024,null!==zg&&(Fj(zg),zg=null));Aj(a,b);S(b);return null;case 5:Bh(b);var e=xh(wh.current);\nc=b.type;if(null!==a&&null!=b.stateNode)Bj(a,b,c,d,e),a.ref!==b.ref&&(b.flags|=512,b.flags|=2097152);else{if(!d){if(null===b.stateNode)throw Error(p(166));S(b);return null}a=xh(uh.current);if(Gg(b)){d=b.stateNode;c=b.type;var f=b.memoizedProps;d[Of]=b;d[Pf]=f;a=0!==(b.mode&1);switch(c){case \"dialog\":D(\"cancel\",d);D(\"close\",d);break;case \"iframe\":case \"object\":case \"embed\":D(\"load\",d);break;case \"video\":case \"audio\":for(e=0;e<lf.length;e++)D(lf[e],d);break;case \"source\":D(\"error\",d);break;case \"img\":case \"image\":case \"link\":D(\"error\",\nd);D(\"load\",d);break;case \"details\":D(\"toggle\",d);break;case \"input\":Za(d,f);D(\"invalid\",d);break;case \"select\":d._wrapperState={wasMultiple:!!f.multiple};D(\"invalid\",d);break;case \"textarea\":hb(d,f),D(\"invalid\",d)}ub(c,f);e=null;for(var g in f)if(f.hasOwnProperty(g)){var h=f[g];\"children\"===g?\"string\"===typeof h?d.textContent!==h&&(!0!==f.suppressHydrationWarning&&Af(d.textContent,h,a),e=[\"children\",h]):\"number\"===typeof h&&d.textContent!==\"\"+h&&(!0!==f.suppressHydrationWarning&&Af(d.textContent,\nh,a),e=[\"children\",\"\"+h]):ea.hasOwnProperty(g)&&null!=h&&\"onScroll\"===g&&D(\"scroll\",d)}switch(c){case \"input\":Va(d);db(d,f,!0);break;case \"textarea\":Va(d);jb(d);break;case \"select\":case \"option\":break;default:\"function\"===typeof f.onClick&&(d.onclick=Bf)}d=e;b.updateQueue=d;null!==d&&(b.flags|=4)}else{g=9===e.nodeType?e:e.ownerDocument;\"http://www.w3.org/1999/xhtml\"===a&&(a=kb(c));\"http://www.w3.org/1999/xhtml\"===a?\"script\"===c?(a=g.createElement(\"div\"),a.innerHTML=\"<script>\\x3c/script>\",a=a.removeChild(a.firstChild)):\n\"string\"===typeof d.is?a=g.createElement(c,{is:d.is}):(a=g.createElement(c),\"select\"===c&&(g=a,d.multiple?g.multiple=!0:d.size&&(g.size=d.size))):a=g.createElementNS(a,c);a[Of]=b;a[Pf]=d;zj(a,b,!1,!1);b.stateNode=a;a:{g=vb(c,d);switch(c){case \"dialog\":D(\"cancel\",a);D(\"close\",a);e=d;break;case \"iframe\":case \"object\":case \"embed\":D(\"load\",a);e=d;break;case \"video\":case \"audio\":for(e=0;e<lf.length;e++)D(lf[e],a);e=d;break;case \"source\":D(\"error\",a);e=d;break;case \"img\":case \"image\":case \"link\":D(\"error\",\na);D(\"load\",a);e=d;break;case \"details\":D(\"toggle\",a);e=d;break;case \"input\":Za(a,d);e=Ya(a,d);D(\"invalid\",a);break;case \"option\":e=d;break;case \"select\":a._wrapperState={wasMultiple:!!d.multiple};e=A({},d,{value:void 0});D(\"invalid\",a);break;case \"textarea\":hb(a,d);e=gb(a,d);D(\"invalid\",a);break;default:e=d}ub(c,e);h=e;for(f in h)if(h.hasOwnProperty(f)){var k=h[f];\"style\"===f?sb(a,k):\"dangerouslySetInnerHTML\"===f?(k=k?k.__html:void 0,null!=k&&nb(a,k)):\"children\"===f?\"string\"===typeof k?(\"textarea\"!==\nc||\"\"!==k)&&ob(a,k):\"number\"===typeof k&&ob(a,\"\"+k):\"suppressContentEditableWarning\"!==f&&\"suppressHydrationWarning\"!==f&&\"autoFocus\"!==f&&(ea.hasOwnProperty(f)?null!=k&&\"onScroll\"===f&&D(\"scroll\",a):null!=k&&ta(a,f,k,g))}switch(c){case \"input\":Va(a);db(a,d,!1);break;case \"textarea\":Va(a);jb(a);break;case \"option\":null!=d.value&&a.setAttribute(\"value\",\"\"+Sa(d.value));break;case \"select\":a.multiple=!!d.multiple;f=d.value;null!=f?fb(a,!!d.multiple,f,!1):null!=d.defaultValue&&fb(a,!!d.multiple,d.defaultValue,\n!0);break;default:\"function\"===typeof e.onClick&&(a.onclick=Bf)}switch(c){case \"button\":case \"input\":case \"select\":case \"textarea\":d=!!d.autoFocus;break a;case \"img\":d=!0;break a;default:d=!1}}d&&(b.flags|=4)}null!==b.ref&&(b.flags|=512,b.flags|=2097152)}S(b);return null;case 6:if(a&&null!=b.stateNode)Cj(a,b,a.memoizedProps,d);else{if(\"string\"!==typeof d&&null===b.stateNode)throw Error(p(166));c=xh(wh.current);xh(uh.current);if(Gg(b)){d=b.stateNode;c=b.memoizedProps;d[Of]=b;if(f=d.nodeValue!==c)if(a=\nxg,null!==a)switch(a.tag){case 3:Af(d.nodeValue,c,0!==(a.mode&1));break;case 5:!0!==a.memoizedProps.suppressHydrationWarning&&Af(d.nodeValue,c,0!==(a.mode&1))}f&&(b.flags|=4)}else d=(9===c.nodeType?c:c.ownerDocument).createTextNode(d),d[Of]=b,b.stateNode=d}S(b);return null;case 13:E(L);d=b.memoizedState;if(null===a||null!==a.memoizedState&&null!==a.memoizedState.dehydrated){if(I&&null!==yg&&0!==(b.mode&1)&&0===(b.flags&128))Hg(),Ig(),b.flags|=98560,f=!1;else if(f=Gg(b),null!==d&&null!==d.dehydrated){if(null===\na){if(!f)throw Error(p(318));f=b.memoizedState;f=null!==f?f.dehydrated:null;if(!f)throw Error(p(317));f[Of]=b}else Ig(),0===(b.flags&128)&&(b.memoizedState=null),b.flags|=4;S(b);f=!1}else null!==zg&&(Fj(zg),zg=null),f=!0;if(!f)return b.flags&65536?b:null}if(0!==(b.flags&128))return b.lanes=c,b;d=null!==d;d!==(null!==a&&null!==a.memoizedState)&&d&&(b.child.flags|=8192,0!==(b.mode&1)&&(null===a||0!==(L.current&1)?0===T&&(T=3):tj()));null!==b.updateQueue&&(b.flags|=4);S(b);return null;case 4:return zh(),\nAj(a,b),null===a&&sf(b.stateNode.containerInfo),S(b),null;case 10:return ah(b.type._context),S(b),null;case 17:return Zf(b.type)&&$f(),S(b),null;case 19:E(L);f=b.memoizedState;if(null===f)return S(b),null;d=0!==(b.flags&128);g=f.rendering;if(null===g)if(d)Dj(f,!1);else{if(0!==T||null!==a&&0!==(a.flags&128))for(a=b.child;null!==a;){g=Ch(a);if(null!==g){b.flags|=128;Dj(f,!1);d=g.updateQueue;null!==d&&(b.updateQueue=d,b.flags|=4);b.subtreeFlags=0;d=c;for(c=b.child;null!==c;)f=c,a=d,f.flags&=14680066,\ng=f.alternate,null===g?(f.childLanes=0,f.lanes=a,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=g.childLanes,f.lanes=g.lanes,f.child=g.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=g.memoizedProps,f.memoizedState=g.memoizedState,f.updateQueue=g.updateQueue,f.type=g.type,a=g.dependencies,f.dependencies=null===a?null:{lanes:a.lanes,firstContext:a.firstContext}),c=c.sibling;G(L,L.current&1|2);return b.child}a=\na.sibling}null!==f.tail&&B()>Gj&&(b.flags|=128,d=!0,Dj(f,!1),b.lanes=4194304)}else{if(!d)if(a=Ch(g),null!==a){if(b.flags|=128,d=!0,c=a.updateQueue,null!==c&&(b.updateQueue=c,b.flags|=4),Dj(f,!0),null===f.tail&&\"hidden\"===f.tailMode&&!g.alternate&&!I)return S(b),null}else 2*B()-f.renderingStartTime>Gj&&1073741824!==c&&(b.flags|=128,d=!0,Dj(f,!1),b.lanes=4194304);f.isBackwards?(g.sibling=b.child,b.child=g):(c=f.last,null!==c?c.sibling=g:b.child=g,f.last=g)}if(null!==f.tail)return b=f.tail,f.rendering=\nb,f.tail=b.sibling,f.renderingStartTime=B(),b.sibling=null,c=L.current,G(L,d?c&1|2:c&1),b;S(b);return null;case 22:case 23:return Hj(),d=null!==b.memoizedState,null!==a&&null!==a.memoizedState!==d&&(b.flags|=8192),d&&0!==(b.mode&1)?0!==(fj&1073741824)&&(S(b),b.subtreeFlags&6&&(b.flags|=8192)):S(b),null;case 24:return null;case 25:return null}throw Error(p(156,b.tag));}\nfunction Ij(a,b){wg(b);switch(b.tag){case 1:return Zf(b.type)&&$f(),a=b.flags,a&65536?(b.flags=a&-65537|128,b):null;case 3:return zh(),E(Wf),E(H),Eh(),a=b.flags,0!==(a&65536)&&0===(a&128)?(b.flags=a&-65537|128,b):null;case 5:return Bh(b),null;case 13:E(L);a=b.memoizedState;if(null!==a&&null!==a.dehydrated){if(null===b.alternate)throw Error(p(340));Ig()}a=b.flags;return a&65536?(b.flags=a&-65537|128,b):null;case 19:return E(L),null;case 4:return zh(),null;case 10:return ah(b.type._context),null;case 22:case 23:return Hj(),\nnull;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=\"function\"===typeof WeakSet?WeakSet:Set,V=null;function Lj(a,b){var c=a.ref;if(null!==c)if(\"function\"===typeof c)try{c(null)}catch(d){W(a,b,d)}else c.current=null}function Mj(a,b,c){try{c()}catch(d){W(a,b,d)}}var Nj=!1;\nfunction Oj(a,b){Cf=dd;a=Me();if(Ne(a)){if(\"selectionStart\"in a)var c={start:a.selectionStart,end:a.selectionEnd};else a:{c=(c=a.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&0!==d.rangeCount){c=d.anchorNode;var e=d.anchorOffset,f=d.focusNode;d=d.focusOffset;try{c.nodeType,f.nodeType}catch(F){c=null;break a}var g=0,h=-1,k=-1,l=0,m=0,q=a,r=null;b:for(;;){for(var y;;){q!==c||0!==e&&3!==q.nodeType||(h=g+e);q!==f||0!==d&&3!==q.nodeType||(k=g+d);3===q.nodeType&&(g+=\nq.nodeValue.length);if(null===(y=q.firstChild))break;r=q;q=y}for(;;){if(q===a)break b;r===c&&++l===e&&(h=g);r===f&&++m===d&&(k=g);if(null!==(y=q.nextSibling))break;q=r;r=q.parentNode}q=y}c=-1===h||-1===k?null:{start:h,end:k}}else c=null}c=c||{start:0,end:0}}else c=null;Df={focusedElem:a,selectionRange:c};dd=!1;for(V=b;null!==V;)if(b=V,a=b.child,0!==(b.subtreeFlags&1028)&&null!==a)a.return=b,V=a;else for(;null!==V;){b=V;try{var n=b.alternate;if(0!==(b.flags&1024))switch(b.tag){case 0:case 11:case 15:break;\ncase 1:if(null!==n){var t=n.memoizedProps,J=n.memoizedState,x=b.stateNode,w=x.getSnapshotBeforeUpdate(b.elementType===b.type?t:Ci(b.type,t),J);x.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var u=b.stateNode.containerInfo;1===u.nodeType?u.textContent=\"\":9===u.nodeType&&u.documentElement&&u.removeChild(u.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163));}}catch(F){W(b,b.return,F)}a=b.sibling;if(null!==a){a.return=b.return;V=a;break}V=b.return}n=Nj;Nj=!1;return n}\nfunction Pj(a,b,c){var d=b.updateQueue;d=null!==d?d.lastEffect:null;if(null!==d){var e=d=d.next;do{if((e.tag&a)===a){var f=e.destroy;e.destroy=void 0;void 0!==f&&Mj(b,c,f)}e=e.next}while(e!==d)}}function Qj(a,b){b=b.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){var c=b=b.next;do{if((c.tag&a)===a){var d=c.create;c.destroy=d()}c=c.next}while(c!==b)}}function Rj(a){var b=a.ref;if(null!==b){var c=a.stateNode;switch(a.tag){case 5:a=c;break;default:a=c}\"function\"===typeof b?b(a):b.current=a}}\nfunction Sj(a){var b=a.alternate;null!==b&&(a.alternate=null,Sj(b));a.child=null;a.deletions=null;a.sibling=null;5===a.tag&&(b=a.stateNode,null!==b&&(delete b[Of],delete b[Pf],delete b[of],delete b[Qf],delete b[Rf]));a.stateNode=null;a.return=null;a.dependencies=null;a.memoizedProps=null;a.memoizedState=null;a.pendingProps=null;a.stateNode=null;a.updateQueue=null}function Tj(a){return 5===a.tag||3===a.tag||4===a.tag}\nfunction Uj(a){a:for(;;){for(;null===a.sibling;){if(null===a.return||Tj(a.return))return null;a=a.return}a.sibling.return=a.return;for(a=a.sibling;5!==a.tag&&6!==a.tag&&18!==a.tag;){if(a.flags&2)continue a;if(null===a.child||4===a.tag)continue a;else a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}\nfunction Vj(a,b,c){var d=a.tag;if(5===d||6===d)a=a.stateNode,b?8===c.nodeType?c.parentNode.insertBefore(a,b):c.insertBefore(a,b):(8===c.nodeType?(b=c.parentNode,b.insertBefore(a,c)):(b=c,b.appendChild(a)),c=c._reactRootContainer,null!==c&&void 0!==c||null!==b.onclick||(b.onclick=Bf));else if(4!==d&&(a=a.child,null!==a))for(Vj(a,b,c),a=a.sibling;null!==a;)Vj(a,b,c),a=a.sibling}\nfunction Wj(a,b,c){var d=a.tag;if(5===d||6===d)a=a.stateNode,b?c.insertBefore(a,b):c.appendChild(a);else if(4!==d&&(a=a.child,null!==a))for(Wj(a,b,c),a=a.sibling;null!==a;)Wj(a,b,c),a=a.sibling}var X=null,Xj=!1;function Yj(a,b,c){for(c=c.child;null!==c;)Zj(a,b,c),c=c.sibling}\nfunction Zj(a,b,c){if(lc&&\"function\"===typeof lc.onCommitFiberUnmount)try{lc.onCommitFiberUnmount(kc,c)}catch(h){}switch(c.tag){case 5:U||Lj(c,b);case 6:var d=X,e=Xj;X=null;Yj(a,b,c);X=d;Xj=e;null!==X&&(Xj?(a=X,c=c.stateNode,8===a.nodeType?a.parentNode.removeChild(c):a.removeChild(c)):X.removeChild(c.stateNode));break;case 18:null!==X&&(Xj?(a=X,c=c.stateNode,8===a.nodeType?Kf(a.parentNode,c):1===a.nodeType&&Kf(a,c),bd(a)):Kf(X,c.stateNode));break;case 4:d=X;e=Xj;X=c.stateNode.containerInfo;Xj=!0;\nYj(a,b,c);X=d;Xj=e;break;case 0:case 11:case 14:case 15:if(!U&&(d=c.updateQueue,null!==d&&(d=d.lastEffect,null!==d))){e=d=d.next;do{var f=e,g=f.destroy;f=f.tag;void 0!==g&&(0!==(f&2)?Mj(c,b,g):0!==(f&4)&&Mj(c,b,g));e=e.next}while(e!==d)}Yj(a,b,c);break;case 1:if(!U&&(Lj(c,b),d=c.stateNode,\"function\"===typeof d.componentWillUnmount))try{d.props=c.memoizedProps,d.state=c.memoizedState,d.componentWillUnmount()}catch(h){W(c,b,h)}Yj(a,b,c);break;case 21:Yj(a,b,c);break;case 22:c.mode&1?(U=(d=U)||null!==\nc.memoizedState,Yj(a,b,c),U=d):Yj(a,b,c);break;default:Yj(a,b,c)}}function ak(a){var b=a.updateQueue;if(null!==b){a.updateQueue=null;var c=a.stateNode;null===c&&(c=a.stateNode=new Kj);b.forEach(function(b){var d=bk.bind(null,a,b);c.has(b)||(c.add(b),b.then(d,d))})}}\nfunction ck(a,b){var c=b.deletions;if(null!==c)for(var d=0;d<c.length;d++){var e=c[d];try{var f=a,g=b,h=g;a:for(;null!==h;){switch(h.tag){case 5:X=h.stateNode;Xj=!1;break a;case 3:X=h.stateNode.containerInfo;Xj=!0;break a;case 4:X=h.stateNode.containerInfo;Xj=!0;break a}h=h.return}if(null===X)throw Error(p(160));Zj(f,g,e);X=null;Xj=!1;var k=e.alternate;null!==k&&(k.return=null);e.return=null}catch(l){W(e,b,l)}}if(b.subtreeFlags&12854)for(b=b.child;null!==b;)dk(b,a),b=b.sibling}\nfunction dk(a,b){var c=a.alternate,d=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:ck(b,a);ek(a);if(d&4){try{Pj(3,a,a.return),Qj(3,a)}catch(t){W(a,a.return,t)}try{Pj(5,a,a.return)}catch(t){W(a,a.return,t)}}break;case 1:ck(b,a);ek(a);d&512&&null!==c&&Lj(c,c.return);break;case 5:ck(b,a);ek(a);d&512&&null!==c&&Lj(c,c.return);if(a.flags&32){var e=a.stateNode;try{ob(e,\"\")}catch(t){W(a,a.return,t)}}if(d&4&&(e=a.stateNode,null!=e)){var f=a.memoizedProps,g=null!==c?c.memoizedProps:f,h=a.type,k=a.updateQueue;\na.updateQueue=null;if(null!==k)try{\"input\"===h&&\"radio\"===f.type&&null!=f.name&&ab(e,f);vb(h,g);var l=vb(h,f);for(g=0;g<k.length;g+=2){var m=k[g],q=k[g+1];\"style\"===m?sb(e,q):\"dangerouslySetInnerHTML\"===m?nb(e,q):\"children\"===m?ob(e,q):ta(e,m,q,l)}switch(h){case \"input\":bb(e,f);break;case \"textarea\":ib(e,f);break;case \"select\":var r=e._wrapperState.wasMultiple;e._wrapperState.wasMultiple=!!f.multiple;var y=f.value;null!=y?fb(e,!!f.multiple,y,!1):r!==!!f.multiple&&(null!=f.defaultValue?fb(e,!!f.multiple,\nf.defaultValue,!0):fb(e,!!f.multiple,f.multiple?[]:\"\",!1))}e[Pf]=f}catch(t){W(a,a.return,t)}}break;case 6:ck(b,a);ek(a);if(d&4){if(null===a.stateNode)throw Error(p(162));e=a.stateNode;f=a.memoizedProps;try{e.nodeValue=f}catch(t){W(a,a.return,t)}}break;case 3:ck(b,a);ek(a);if(d&4&&null!==c&&c.memoizedState.isDehydrated)try{bd(b.containerInfo)}catch(t){W(a,a.return,t)}break;case 4:ck(b,a);ek(a);break;case 13:ck(b,a);ek(a);e=a.child;e.flags&8192&&(f=null!==e.memoizedState,e.stateNode.isHidden=f,!f||\nnull!==e.alternate&&null!==e.alternate.memoizedState||(fk=B()));d&4&&ak(a);break;case 22:m=null!==c&&null!==c.memoizedState;a.mode&1?(U=(l=U)||m,ck(b,a),U=l):ck(b,a);ek(a);if(d&8192){l=null!==a.memoizedState;if((a.stateNode.isHidden=l)&&!m&&0!==(a.mode&1))for(V=a,m=a.child;null!==m;){for(q=V=m;null!==V;){r=V;y=r.child;switch(r.tag){case 0:case 11:case 14:case 15:Pj(4,r,r.return);break;case 1:Lj(r,r.return);var n=r.stateNode;if(\"function\"===typeof n.componentWillUnmount){d=r;c=r.return;try{b=d,n.props=\nb.memoizedProps,n.state=b.memoizedState,n.componentWillUnmount()}catch(t){W(d,c,t)}}break;case 5:Lj(r,r.return);break;case 22:if(null!==r.memoizedState){gk(q);continue}}null!==y?(y.return=r,V=y):gk(q)}m=m.sibling}a:for(m=null,q=a;;){if(5===q.tag){if(null===m){m=q;try{e=q.stateNode,l?(f=e.style,\"function\"===typeof f.setProperty?f.setProperty(\"display\",\"none\",\"important\"):f.display=\"none\"):(h=q.stateNode,k=q.memoizedProps.style,g=void 0!==k&&null!==k&&k.hasOwnProperty(\"display\")?k.display:null,h.style.display=\nrb(\"display\",g))}catch(t){W(a,a.return,t)}}}else if(6===q.tag){if(null===m)try{q.stateNode.nodeValue=l?\"\":q.memoizedProps}catch(t){W(a,a.return,t)}}else if((22!==q.tag&&23!==q.tag||null===q.memoizedState||q===a)&&null!==q.child){q.child.return=q;q=q.child;continue}if(q===a)break a;for(;null===q.sibling;){if(null===q.return||q.return===a)break a;m===q&&(m=null);q=q.return}m===q&&(m=null);q.sibling.return=q.return;q=q.sibling}}break;case 19:ck(b,a);ek(a);d&4&&ak(a);break;case 21:break;default:ck(b,\na),ek(a)}}function ek(a){var b=a.flags;if(b&2){try{a:{for(var c=a.return;null!==c;){if(Tj(c)){var d=c;break a}c=c.return}throw Error(p(160));}switch(d.tag){case 5:var e=d.stateNode;d.flags&32&&(ob(e,\"\"),d.flags&=-33);var f=Uj(a);Wj(a,f,e);break;case 3:case 4:var g=d.stateNode.containerInfo,h=Uj(a);Vj(a,h,g);break;default:throw Error(p(161));}}catch(k){W(a,a.return,k)}a.flags&=-3}b&4096&&(a.flags&=-4097)}function hk(a,b,c){V=a;ik(a,b,c)}\nfunction ik(a,b,c){for(var d=0!==(a.mode&1);null!==V;){var e=V,f=e.child;if(22===e.tag&&d){var g=null!==e.memoizedState||Jj;if(!g){var h=e.alternate,k=null!==h&&null!==h.memoizedState||U;h=Jj;var l=U;Jj=g;if((U=k)&&!l)for(V=e;null!==V;)g=V,k=g.child,22===g.tag&&null!==g.memoizedState?jk(e):null!==k?(k.return=g,V=k):jk(e);for(;null!==f;)V=f,ik(f,b,c),f=f.sibling;V=e;Jj=h;U=l}kk(a,b,c)}else 0!==(e.subtreeFlags&8772)&&null!==f?(f.return=e,V=f):kk(a,b,c)}}\nfunction kk(a){for(;null!==V;){var b=V;if(0!==(b.flags&8772)){var c=b.alternate;try{if(0!==(b.flags&8772))switch(b.tag){case 0:case 11:case 15:U||Qj(5,b);break;case 1:var d=b.stateNode;if(b.flags&4&&!U)if(null===c)d.componentDidMount();else{var e=b.elementType===b.type?c.memoizedProps:Ci(b.type,c.memoizedProps);d.componentDidUpdate(e,c.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var f=b.updateQueue;null!==f&&sh(b,f,d);break;case 3:var g=b.updateQueue;if(null!==g){c=null;if(null!==b.child)switch(b.child.tag){case 5:c=\nb.child.stateNode;break;case 1:c=b.child.stateNode}sh(b,g,c)}break;case 5:var h=b.stateNode;if(null===c&&b.flags&4){c=h;var k=b.memoizedProps;switch(b.type){case \"button\":case \"input\":case \"select\":case \"textarea\":k.autoFocus&&c.focus();break;case \"img\":k.src&&(c.src=k.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(null===b.memoizedState){var l=b.alternate;if(null!==l){var m=l.memoizedState;if(null!==m){var q=m.dehydrated;null!==q&&bd(q)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;\ndefault:throw Error(p(163));}U||b.flags&512&&Rj(b)}catch(r){W(b,b.return,r)}}if(b===a){V=null;break}c=b.sibling;if(null!==c){c.return=b.return;V=c;break}V=b.return}}function gk(a){for(;null!==V;){var b=V;if(b===a){V=null;break}var c=b.sibling;if(null!==c){c.return=b.return;V=c;break}V=b.return}}\nfunction jk(a){for(;null!==V;){var b=V;try{switch(b.tag){case 0:case 11:case 15:var c=b.return;try{Qj(4,b)}catch(k){W(b,c,k)}break;case 1:var d=b.stateNode;if(\"function\"===typeof d.componentDidMount){var e=b.return;try{d.componentDidMount()}catch(k){W(b,e,k)}}var f=b.return;try{Rj(b)}catch(k){W(b,f,k)}break;case 5:var g=b.return;try{Rj(b)}catch(k){W(b,g,k)}}}catch(k){W(b,b.return,k)}if(b===a){V=null;break}var h=b.sibling;if(null!==h){h.return=b.return;V=h;break}V=b.return}}\nvar lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q=null,Y=null,Z=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=Infinity,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R(){return 0!==(K&6)?B():-1!==Ak?Ak:Ak=B()}\nfunction yi(a){if(0===(a.mode&1))return 1;if(0!==(K&2)&&0!==Z)return Z&-Z;if(null!==Kg.transition)return 0===Bk&&(Bk=yc()),Bk;a=C;if(0!==a)return a;a=window.event;a=void 0===a?16:jd(a.type);return a}function gi(a,b,c,d){if(50<yk)throw yk=0,zk=null,Error(p(185));Ac(a,c,d);if(0===(K&2)||a!==Q)a===Q&&(0===(K&2)&&(qk|=c),4===T&&Ck(a,Z)),Dk(a,d),1===c&&0===K&&0===(b.mode&1)&&(Gj=B()+500,fg&&jg())}\nfunction Dk(a,b){var c=a.callbackNode;wc(a,b);var d=uc(a,a===Q?Z:0);if(0===d)null!==c&&bc(c),a.callbackNode=null,a.callbackPriority=0;else if(b=d&-d,a.callbackPriority!==b){null!=c&&bc(c);if(1===b)0===a.tag?ig(Ek.bind(null,a)):hg(Ek.bind(null,a)),Jf(function(){0===(K&6)&&jg()}),c=null;else{switch(Dc(d)){case 1:c=fc;break;case 4:c=gc;break;case 16:c=hc;break;case 536870912:c=jc;break;default:c=hc}c=Fk(c,Gk.bind(null,a))}a.callbackPriority=b;a.callbackNode=c}}\nfunction Gk(a,b){Ak=-1;Bk=0;if(0!==(K&6))throw Error(p(327));var c=a.callbackNode;if(Hk()&&a.callbackNode!==c)return null;var d=uc(a,a===Q?Z:0);if(0===d)return null;if(0!==(d&30)||0!==(d&a.expiredLanes)||b)b=Ik(a,d);else{b=d;var e=K;K|=2;var f=Jk();if(Q!==a||Z!==b)uk=null,Gj=B()+500,Kk(a,b);do try{Lk();break}catch(h){Mk(a,h)}while(1);$g();mk.current=f;K=e;null!==Y?b=0:(Q=null,Z=0,b=T)}if(0!==b){2===b&&(e=xc(a),0!==e&&(d=e,b=Nk(a,e)));if(1===b)throw c=pk,Kk(a,0),Ck(a,d),Dk(a,B()),c;if(6===b)Ck(a,d);\nelse{e=a.current.alternate;if(0===(d&30)&&!Ok(e)&&(b=Ik(a,d),2===b&&(f=xc(a),0!==f&&(d=f,b=Nk(a,f))),1===b))throw c=pk,Kk(a,0),Ck(a,d),Dk(a,B()),c;a.finishedWork=e;a.finishedLanes=d;switch(b){case 0:case 1:throw Error(p(345));case 2:Pk(a,tk,uk);break;case 3:Ck(a,d);if((d&130023424)===d&&(b=fk+500-B(),10<b)){if(0!==uc(a,0))break;e=a.suspendedLanes;if((e&d)!==d){R();a.pingedLanes|=a.suspendedLanes&e;break}a.timeoutHandle=Ff(Pk.bind(null,a,tk,uk),b);break}Pk(a,tk,uk);break;case 4:Ck(a,d);if((d&4194240)===\nd)break;b=a.eventTimes;for(e=-1;0<d;){var g=31-oc(d);f=1<<g;g=b[g];g>e&&(e=g);d&=~f}d=e;d=B()-d;d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3E3>d?3E3:4320>d?4320:1960*lk(d/1960))-d;if(10<d){a.timeoutHandle=Ff(Pk.bind(null,a,tk,uk),d);break}Pk(a,tk,uk);break;case 5:Pk(a,tk,uk);break;default:throw Error(p(329));}}}Dk(a,B());return a.callbackNode===c?Gk.bind(null,a):null}\nfunction Nk(a,b){var c=sk;a.current.memoizedState.isDehydrated&&(Kk(a,b).flags|=256);a=Ik(a,b);2!==a&&(b=tk,tk=c,null!==b&&Fj(b));return a}function Fj(a){null===tk?tk=a:tk.push.apply(tk,a)}\nfunction Ok(a){for(var b=a;;){if(b.flags&16384){var c=b.updateQueue;if(null!==c&&(c=c.stores,null!==c))for(var d=0;d<c.length;d++){var e=c[d],f=e.getSnapshot;e=e.value;try{if(!He(f(),e))return!1}catch(g){return!1}}}c=b.child;if(b.subtreeFlags&16384&&null!==c)c.return=b,b=c;else{if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return!0;b=b.return}b.sibling.return=b.return;b=b.sibling}}return!0}\nfunction Ck(a,b){b&=~rk;b&=~qk;a.suspendedLanes|=b;a.pingedLanes&=~b;for(a=a.expirationTimes;0<b;){var c=31-oc(b),d=1<<c;a[c]=-1;b&=~d}}function Ek(a){if(0!==(K&6))throw Error(p(327));Hk();var b=uc(a,0);if(0===(b&1))return Dk(a,B()),null;var c=Ik(a,b);if(0!==a.tag&&2===c){var d=xc(a);0!==d&&(b=d,c=Nk(a,d))}if(1===c)throw c=pk,Kk(a,0),Ck(a,b),Dk(a,B()),c;if(6===c)throw Error(p(345));a.finishedWork=a.current.alternate;a.finishedLanes=b;Pk(a,tk,uk);Dk(a,B());return null}\nfunction Qk(a,b){var c=K;K|=1;try{return a(b)}finally{K=c,0===K&&(Gj=B()+500,fg&&jg())}}function Rk(a){null!==wk&&0===wk.tag&&0===(K&6)&&Hk();var b=K;K|=1;var c=ok.transition,d=C;try{if(ok.transition=null,C=1,a)return a()}finally{C=d,ok.transition=c,K=b,0===(K&6)&&jg()}}function Hj(){fj=ej.current;E(ej)}\nfunction Kk(a,b){a.finishedWork=null;a.finishedLanes=0;var c=a.timeoutHandle;-1!==c&&(a.timeoutHandle=-1,Gf(c));if(null!==Y)for(c=Y.return;null!==c;){var d=c;wg(d);switch(d.tag){case 1:d=d.type.childContextTypes;null!==d&&void 0!==d&&$f();break;case 3:zh();E(Wf);E(H);Eh();break;case 5:Bh(d);break;case 4:zh();break;case 13:E(L);break;case 19:E(L);break;case 10:ah(d.type._context);break;case 22:case 23:Hj()}c=c.return}Q=a;Y=a=Pg(a.current,null);Z=fj=b;T=0;pk=null;rk=qk=rh=0;tk=sk=null;if(null!==fh){for(b=\n0;b<fh.length;b++)if(c=fh[b],d=c.interleaved,null!==d){c.interleaved=null;var e=d.next,f=c.pending;if(null!==f){var g=f.next;f.next=e;d.next=g}c.pending=d}fh=null}return a}\nfunction Mk(a,b){do{var c=Y;try{$g();Fh.current=Rh;if(Ih){for(var d=M.memoizedState;null!==d;){var e=d.queue;null!==e&&(e.pending=null);d=d.next}Ih=!1}Hh=0;O=N=M=null;Jh=!1;Kh=0;nk.current=null;if(null===c||null===c.return){T=1;pk=b;Y=null;break}a:{var f=a,g=c.return,h=c,k=b;b=Z;h.flags|=32768;if(null!==k&&\"object\"===typeof k&&\"function\"===typeof k.then){var l=k,m=h,q=m.tag;if(0===(m.mode&1)&&(0===q||11===q||15===q)){var r=m.alternate;r?(m.updateQueue=r.updateQueue,m.memoizedState=r.memoizedState,\nm.lanes=r.lanes):(m.updateQueue=null,m.memoizedState=null)}var y=Ui(g);if(null!==y){y.flags&=-257;Vi(y,g,h,f,b);y.mode&1&&Si(f,l,b);b=y;k=l;var n=b.updateQueue;if(null===n){var t=new Set;t.add(k);b.updateQueue=t}else n.add(k);break a}else{if(0===(b&1)){Si(f,l,b);tj();break a}k=Error(p(426))}}else if(I&&h.mode&1){var J=Ui(g);if(null!==J){0===(J.flags&65536)&&(J.flags|=256);Vi(J,g,h,f,b);Jg(Ji(k,h));break a}}f=k=Ji(k,h);4!==T&&(T=2);null===sk?sk=[f]:sk.push(f);f=g;do{switch(f.tag){case 3:f.flags|=65536;\nb&=-b;f.lanes|=b;var x=Ni(f,k,b);ph(f,x);break a;case 1:h=k;var w=f.type,u=f.stateNode;if(0===(f.flags&128)&&(\"function\"===typeof w.getDerivedStateFromError||null!==u&&\"function\"===typeof u.componentDidCatch&&(null===Ri||!Ri.has(u)))){f.flags|=65536;b&=-b;f.lanes|=b;var F=Qi(f,h,b);ph(f,F);break a}}f=f.return}while(null!==f)}Sk(c)}catch(na){b=na;Y===c&&null!==c&&(Y=c=c.return);continue}break}while(1)}function Jk(){var a=mk.current;mk.current=Rh;return null===a?Rh:a}\nfunction tj(){if(0===T||3===T||2===T)T=4;null===Q||0===(rh&268435455)&&0===(qk&268435455)||Ck(Q,Z)}function Ik(a,b){var c=K;K|=2;var d=Jk();if(Q!==a||Z!==b)uk=null,Kk(a,b);do try{Tk();break}catch(e){Mk(a,e)}while(1);$g();K=c;mk.current=d;if(null!==Y)throw Error(p(261));Q=null;Z=0;return T}function Tk(){for(;null!==Y;)Uk(Y)}function Lk(){for(;null!==Y&&!cc();)Uk(Y)}function Uk(a){var b=Vk(a.alternate,a,fj);a.memoizedProps=a.pendingProps;null===b?Sk(a):Y=b;nk.current=null}\nfunction Sk(a){var b=a;do{var c=b.alternate;a=b.return;if(0===(b.flags&32768)){if(c=Ej(c,b,fj),null!==c){Y=c;return}}else{c=Ij(c,b);if(null!==c){c.flags&=32767;Y=c;return}if(null!==a)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{T=6;Y=null;return}}b=b.sibling;if(null!==b){Y=b;return}Y=b=a}while(null!==b);0===T&&(T=5)}function Pk(a,b,c){var d=C,e=ok.transition;try{ok.transition=null,C=1,Wk(a,b,c,d)}finally{ok.transition=e,C=d}return null}\nfunction Wk(a,b,c,d){do Hk();while(null!==wk);if(0!==(K&6))throw Error(p(327));c=a.finishedWork;var e=a.finishedLanes;if(null===c)return null;a.finishedWork=null;a.finishedLanes=0;if(c===a.current)throw Error(p(177));a.callbackNode=null;a.callbackPriority=0;var f=c.lanes|c.childLanes;Bc(a,f);a===Q&&(Y=Q=null,Z=0);0===(c.subtreeFlags&2064)&&0===(c.flags&2064)||vk||(vk=!0,Fk(hc,function(){Hk();return null}));f=0!==(c.flags&15990);if(0!==(c.subtreeFlags&15990)||f){f=ok.transition;ok.transition=null;\nvar g=C;C=1;var h=K;K|=4;nk.current=null;Oj(a,c);dk(c,a);Oe(Df);dd=!!Cf;Df=Cf=null;a.current=c;hk(c,a,e);dc();K=h;C=g;ok.transition=f}else a.current=c;vk&&(vk=!1,wk=a,xk=e);f=a.pendingLanes;0===f&&(Ri=null);mc(c.stateNode,d);Dk(a,B());if(null!==b)for(d=a.onRecoverableError,c=0;c<b.length;c++)e=b[c],d(e.value,{componentStack:e.stack,digest:e.digest});if(Oi)throw Oi=!1,a=Pi,Pi=null,a;0!==(xk&1)&&0!==a.tag&&Hk();f=a.pendingLanes;0!==(f&1)?a===zk?yk++:(yk=0,zk=a):yk=0;jg();return null}\nfunction Hk(){if(null!==wk){var a=Dc(xk),b=ok.transition,c=C;try{ok.transition=null;C=16>a?16:a;if(null===wk)var d=!1;else{a=wk;wk=null;xk=0;if(0!==(K&6))throw Error(p(331));var e=K;K|=4;for(V=a.current;null!==V;){var f=V,g=f.child;if(0!==(V.flags&16)){var h=f.deletions;if(null!==h){for(var k=0;k<h.length;k++){var l=h[k];for(V=l;null!==V;){var m=V;switch(m.tag){case 0:case 11:case 15:Pj(8,m,f)}var q=m.child;if(null!==q)q.return=m,V=q;else for(;null!==V;){m=V;var r=m.sibling,y=m.return;Sj(m);if(m===\nl){V=null;break}if(null!==r){r.return=y;V=r;break}V=y}}}var n=f.alternate;if(null!==n){var t=n.child;if(null!==t){n.child=null;do{var J=t.sibling;t.sibling=null;t=J}while(null!==t)}}V=f}}if(0!==(f.subtreeFlags&2064)&&null!==g)g.return=f,V=g;else b:for(;null!==V;){f=V;if(0!==(f.flags&2048))switch(f.tag){case 0:case 11:case 15:Pj(9,f,f.return)}var x=f.sibling;if(null!==x){x.return=f.return;V=x;break b}V=f.return}}var w=a.current;for(V=w;null!==V;){g=V;var u=g.child;if(0!==(g.subtreeFlags&2064)&&null!==\nu)u.return=g,V=u;else b:for(g=w;null!==V;){h=V;if(0!==(h.flags&2048))try{switch(h.tag){case 0:case 11:case 15:Qj(9,h)}}catch(na){W(h,h.return,na)}if(h===g){V=null;break b}var F=h.sibling;if(null!==F){F.return=h.return;V=F;break b}V=h.return}}K=e;jg();if(lc&&\"function\"===typeof lc.onPostCommitFiberRoot)try{lc.onPostCommitFiberRoot(kc,a)}catch(na){}d=!0}return d}finally{C=c,ok.transition=b}}return!1}function Xk(a,b,c){b=Ji(c,b);b=Ni(a,b,1);a=nh(a,b,1);b=R();null!==a&&(Ac(a,1,b),Dk(a,b))}\nfunction W(a,b,c){if(3===a.tag)Xk(a,a,c);else for(;null!==b;){if(3===b.tag){Xk(b,a,c);break}else if(1===b.tag){var d=b.stateNode;if(\"function\"===typeof b.type.getDerivedStateFromError||\"function\"===typeof d.componentDidCatch&&(null===Ri||!Ri.has(d))){a=Ji(c,a);a=Qi(b,a,1);b=nh(b,a,1);a=R();null!==b&&(Ac(b,1,a),Dk(b,a));break}}b=b.return}}\nfunction Ti(a,b,c){var d=a.pingCache;null!==d&&d.delete(b);b=R();a.pingedLanes|=a.suspendedLanes&c;Q===a&&(Z&c)===c&&(4===T||3===T&&(Z&130023424)===Z&&500>B()-fk?Kk(a,0):rk|=c);Dk(a,b)}function Yk(a,b){0===b&&(0===(a.mode&1)?b=1:(b=sc,sc<<=1,0===(sc&130023424)&&(sc=4194304)));var c=R();a=ih(a,b);null!==a&&(Ac(a,b,c),Dk(a,c))}function uj(a){var b=a.memoizedState,c=0;null!==b&&(c=b.retryLane);Yk(a,c)}\nfunction bk(a,b){var c=0;switch(a.tag){case 13:var d=a.stateNode;var e=a.memoizedState;null!==e&&(c=e.retryLane);break;case 19:d=a.stateNode;break;default:throw Error(p(314));}null!==d&&d.delete(b);Yk(a,c)}var Vk;\nVk=function(a,b,c){if(null!==a)if(a.memoizedProps!==b.pendingProps||Wf.current)dh=!0;else{if(0===(a.lanes&c)&&0===(b.flags&128))return dh=!1,yj(a,b,c);dh=0!==(a.flags&131072)?!0:!1}else dh=!1,I&&0!==(b.flags&1048576)&&ug(b,ng,b.index);b.lanes=0;switch(b.tag){case 2:var d=b.type;ij(a,b);a=b.pendingProps;var e=Yf(b,H.current);ch(b,c);e=Nh(null,b,d,a,e,c);var f=Sh();b.flags|=1;\"object\"===typeof e&&null!==e&&\"function\"===typeof e.render&&void 0===e.$$typeof?(b.tag=1,b.memoizedState=null,b.updateQueue=\nnull,Zf(d)?(f=!0,cg(b)):f=!1,b.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,kh(b),e.updater=Ei,b.stateNode=e,e._reactInternals=b,Ii(b,d,a,c),b=jj(null,b,d,!0,f,c)):(b.tag=0,I&&f&&vg(b),Xi(null,b,e,c),b=b.child);return b;case 16:d=b.elementType;a:{ij(a,b);a=b.pendingProps;e=d._init;d=e(d._payload);b.type=d;e=b.tag=Zk(d);a=Ci(d,a);switch(e){case 0:b=cj(null,b,d,a,c);break a;case 1:b=hj(null,b,d,a,c);break a;case 11:b=Yi(null,b,d,a,c);break a;case 14:b=$i(null,b,d,Ci(d.type,a),c);break a}throw Error(p(306,\nd,\"\"));}return b;case 0:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:Ci(d,e),cj(a,b,d,e,c);case 1:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:Ci(d,e),hj(a,b,d,e,c);case 3:a:{kj(b);if(null===a)throw Error(p(387));d=b.pendingProps;f=b.memoizedState;e=f.element;lh(a,b);qh(b,d,null,c);var g=b.memoizedState;d=g.element;if(f.isDehydrated)if(f={element:d,isDehydrated:!1,cache:g.cache,pendingSuspenseBoundaries:g.pendingSuspenseBoundaries,transitions:g.transitions},b.updateQueue.baseState=\nf,b.memoizedState=f,b.flags&256){e=Ji(Error(p(423)),b);b=lj(a,b,d,c,e);break a}else if(d!==e){e=Ji(Error(p(424)),b);b=lj(a,b,d,c,e);break a}else for(yg=Lf(b.stateNode.containerInfo.firstChild),xg=b,I=!0,zg=null,c=Vg(b,null,d,c),b.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{Ig();if(d===e){b=Zi(a,b,c);break a}Xi(a,b,d,c)}b=b.child}return b;case 5:return Ah(b),null===a&&Eg(b),d=b.type,e=b.pendingProps,f=null!==a?a.memoizedProps:null,g=e.children,Ef(d,e)?g=null:null!==f&&Ef(d,f)&&(b.flags|=32),\ngj(a,b),Xi(a,b,g,c),b.child;case 6:return null===a&&Eg(b),null;case 13:return oj(a,b,c);case 4:return yh(b,b.stateNode.containerInfo),d=b.pendingProps,null===a?b.child=Ug(b,null,d,c):Xi(a,b,d,c),b.child;case 11:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:Ci(d,e),Yi(a,b,d,e,c);case 7:return Xi(a,b,b.pendingProps,c),b.child;case 8:return Xi(a,b,b.pendingProps.children,c),b.child;case 12:return Xi(a,b,b.pendingProps.children,c),b.child;case 10:a:{d=b.type._context;e=b.pendingProps;f=b.memoizedProps;\ng=e.value;G(Wg,d._currentValue);d._currentValue=g;if(null!==f)if(He(f.value,g)){if(f.children===e.children&&!Wf.current){b=Zi(a,b,c);break a}}else for(f=b.child,null!==f&&(f.return=b);null!==f;){var h=f.dependencies;if(null!==h){g=f.child;for(var k=h.firstContext;null!==k;){if(k.context===d){if(1===f.tag){k=mh(-1,c&-c);k.tag=2;var l=f.updateQueue;if(null!==l){l=l.shared;var m=l.pending;null===m?k.next=k:(k.next=m.next,m.next=k);l.pending=k}}f.lanes|=c;k=f.alternate;null!==k&&(k.lanes|=c);bh(f.return,\nc,b);h.lanes|=c;break}k=k.next}}else if(10===f.tag)g=f.type===b.type?null:f.child;else if(18===f.tag){g=f.return;if(null===g)throw Error(p(341));g.lanes|=c;h=g.alternate;null!==h&&(h.lanes|=c);bh(g,c,b);g=f.sibling}else g=f.child;if(null!==g)g.return=f;else for(g=f;null!==g;){if(g===b){g=null;break}f=g.sibling;if(null!==f){f.return=g.return;g=f;break}g=g.return}f=g}Xi(a,b,e.children,c);b=b.child}return b;case 9:return e=b.type,d=b.pendingProps.children,ch(b,c),e=eh(e),d=d(e),b.flags|=1,Xi(a,b,d,c),\nb.child;case 14:return d=b.type,e=Ci(d,b.pendingProps),e=Ci(d.type,e),$i(a,b,d,e,c);case 15:return bj(a,b,b.type,b.pendingProps,c);case 17:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:Ci(d,e),ij(a,b),b.tag=1,Zf(d)?(a=!0,cg(b)):a=!1,ch(b,c),Gi(b,d,e),Ii(b,d,e,c),jj(null,b,d,!0,a,c);case 19:return xj(a,b,c);case 22:return dj(a,b,c)}throw Error(p(156,b.tag));};function Fk(a,b){return ac(a,b)}\nfunction $k(a,b,c,d){this.tag=a;this.key=c;this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null;this.index=0;this.ref=null;this.pendingProps=b;this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null;this.mode=d;this.subtreeFlags=this.flags=0;this.deletions=null;this.childLanes=this.lanes=0;this.alternate=null}function Bg(a,b,c,d){return new $k(a,b,c,d)}function aj(a){a=a.prototype;return!(!a||!a.isReactComponent)}\nfunction Zk(a){if(\"function\"===typeof a)return aj(a)?1:0;if(void 0!==a&&null!==a){a=a.$$typeof;if(a===Da)return 11;if(a===Ga)return 14}return 2}\nfunction Pg(a,b){var c=a.alternate;null===c?(c=Bg(a.tag,b,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=b,c.type=a.type,c.flags=0,c.subtreeFlags=0,c.deletions=null);c.flags=a.flags&14680064;c.childLanes=a.childLanes;c.lanes=a.lanes;c.child=a.child;c.memoizedProps=a.memoizedProps;c.memoizedState=a.memoizedState;c.updateQueue=a.updateQueue;b=a.dependencies;c.dependencies=null===b?null:{lanes:b.lanes,firstContext:b.firstContext};\nc.sibling=a.sibling;c.index=a.index;c.ref=a.ref;return c}\nfunction Rg(a,b,c,d,e,f){var g=2;d=a;if(\"function\"===typeof a)aj(a)&&(g=1);else if(\"string\"===typeof a)g=5;else a:switch(a){case ya:return Tg(c.children,e,f,b);case za:g=8;e|=8;break;case Aa:return a=Bg(12,c,b,e|2),a.elementType=Aa,a.lanes=f,a;case Ea:return a=Bg(13,c,b,e),a.elementType=Ea,a.lanes=f,a;case Fa:return a=Bg(19,c,b,e),a.elementType=Fa,a.lanes=f,a;case Ia:return pj(c,e,f,b);default:if(\"object\"===typeof a&&null!==a)switch(a.$$typeof){case Ba:g=10;break a;case Ca:g=9;break a;case Da:g=11;\nbreak a;case Ga:g=14;break a;case Ha:g=16;d=null;break a}throw Error(p(130,null==a?a:typeof a,\"\"));}b=Bg(g,c,b,e);b.elementType=a;b.type=d;b.lanes=f;return b}function Tg(a,b,c,d){a=Bg(7,a,d,b);a.lanes=c;return a}function pj(a,b,c,d){a=Bg(22,a,d,b);a.elementType=Ia;a.lanes=c;a.stateNode={isHidden:!1};return a}function Qg(a,b,c){a=Bg(6,a,null,b);a.lanes=c;return a}\nfunction Sg(a,b,c){b=Bg(4,null!==a.children?a.children:[],a.key,b);b.lanes=c;b.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation};return b}\nfunction al(a,b,c,d,e){this.tag=b;this.containerInfo=a;this.finishedWork=this.pingCache=this.current=this.pendingChildren=null;this.timeoutHandle=-1;this.callbackNode=this.pendingContext=this.context=null;this.callbackPriority=0;this.eventTimes=zc(0);this.expirationTimes=zc(-1);this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0;this.entanglements=zc(0);this.identifierPrefix=d;this.onRecoverableError=e;this.mutableSourceEagerHydrationData=\nnull}function bl(a,b,c,d,e,f,g,h,k){a=new al(a,b,c,h,k);1===b?(b=1,!0===f&&(b|=8)):b=0;f=Bg(3,null,null,b);a.current=f;f.stateNode=a;f.memoizedState={element:d,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null};kh(f);return a}function cl(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:wa,key:null==d?null:\"\"+d,children:a,containerInfo:b,implementation:c}}\nfunction dl(a){if(!a)return Vf;a=a._reactInternals;a:{if(Vb(a)!==a||1!==a.tag)throw Error(p(170));var b=a;do{switch(b.tag){case 3:b=b.stateNode.context;break a;case 1:if(Zf(b.type)){b=b.stateNode.__reactInternalMemoizedMergedChildContext;break a}}b=b.return}while(null!==b);throw Error(p(171));}if(1===a.tag){var c=a.type;if(Zf(c))return bg(a,c,b)}return b}\nfunction el(a,b,c,d,e,f,g,h,k){a=bl(c,d,!0,a,e,f,g,h,k);a.context=dl(null);c=a.current;d=R();e=yi(c);f=mh(d,e);f.callback=void 0!==b&&null!==b?b:null;nh(c,f,e);a.current.lanes=e;Ac(a,e,d);Dk(a,d);return a}function fl(a,b,c,d){var e=b.current,f=R(),g=yi(e);c=dl(c);null===b.context?b.context=c:b.pendingContext=c;b=mh(f,g);b.payload={element:a};d=void 0===d?null:d;null!==d&&(b.callback=d);a=nh(e,b,g);null!==a&&(gi(a,e,g,f),oh(a,e,g));return g}\nfunction gl(a){a=a.current;if(!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function hl(a,b){a=a.memoizedState;if(null!==a&&null!==a.dehydrated){var c=a.retryLane;a.retryLane=0!==c&&c<b?c:b}}function il(a,b){hl(a,b);(a=a.alternate)&&hl(a,b)}function jl(){return null}var kl=\"function\"===typeof reportError?reportError:function(a){console.error(a)};function ll(a){this._internalRoot=a}\nml.prototype.render=ll.prototype.render=function(a){var b=this._internalRoot;if(null===b)throw Error(p(409));fl(a,b,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var a=this._internalRoot;if(null!==a){this._internalRoot=null;var b=a.containerInfo;Rk(function(){fl(null,a,null,null)});b[uf]=null}};function ml(a){this._internalRoot=a}\nml.prototype.unstable_scheduleHydration=function(a){if(a){var b=Hc();a={blockedOn:null,target:a,priority:b};for(var c=0;c<Qc.length&&0!==b&&b<Qc[c].priority;c++);Qc.splice(c,0,a);0===c&&Vc(a)}};function nl(a){return!(!a||1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType)}function ol(a){return!(!a||1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType&&(8!==a.nodeType||\" react-mount-point-unstable \"!==a.nodeValue))}function pl(){}\nfunction ql(a,b,c,d,e){if(e){if(\"function\"===typeof d){var f=d;d=function(){var a=gl(g);f.call(a)}}var g=el(b,d,a,0,null,!1,!1,\"\",pl);a._reactRootContainer=g;a[uf]=g.current;sf(8===a.nodeType?a.parentNode:a);Rk();return g}for(;e=a.lastChild;)a.removeChild(e);if(\"function\"===typeof d){var h=d;d=function(){var a=gl(k);h.call(a)}}var k=bl(a,0,!1,null,null,!1,!1,\"\",pl);a._reactRootContainer=k;a[uf]=k.current;sf(8===a.nodeType?a.parentNode:a);Rk(function(){fl(b,k,c,d)});return k}\nfunction rl(a,b,c,d,e){var f=c._reactRootContainer;if(f){var g=f;if(\"function\"===typeof e){var h=e;e=function(){var a=gl(g);h.call(a)}}fl(b,g,a,e)}else g=ql(c,b,a,e,d);return gl(g)}Ec=function(a){switch(a.tag){case 3:var b=a.stateNode;if(b.current.memoizedState.isDehydrated){var c=tc(b.pendingLanes);0!==c&&(Cc(b,c|1),Dk(b,B()),0===(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var b=ih(a,1);if(null!==b){var c=R();gi(b,a,1,c)}}),il(a,1)}};\nFc=function(a){if(13===a.tag){var b=ih(a,134217728);if(null!==b){var c=R();gi(b,a,134217728,c)}il(a,134217728)}};Gc=function(a){if(13===a.tag){var b=yi(a),c=ih(a,b);if(null!==c){var d=R();gi(c,a,b,d)}il(a,b)}};Hc=function(){return C};Ic=function(a,b){var c=C;try{return C=a,b()}finally{C=c}};\nyb=function(a,b,c){switch(b){case \"input\":bb(a,c);b=c.name;if(\"radio\"===c.type&&null!=b){for(c=a;c.parentNode;)c=c.parentNode;c=c.querySelectorAll(\"input[name=\"+JSON.stringify(\"\"+b)+'][type=\"radio\"]');for(b=0;b<c.length;b++){var d=c[b];if(d!==a&&d.form===a.form){var e=Db(d);if(!e)throw Error(p(90));Wa(d);bb(d,e)}}}break;case \"textarea\":ib(a,c);break;case \"select\":b=c.value,null!=b&&fb(a,!!c.multiple,b,!1)}};Gb=Qk;Hb=Rk;\nvar sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:\"18.3.1\",rendererPackageName:\"react-dom\"};\nvar ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){a=Zb(a);return null===a?null:a.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||\njl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:\"18.3.1-next-f1338f8080-20240426\"};if(\"undefined\"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch(a){}}exports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;\nexports.createPortal=function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!nl(b))throw Error(p(200));return cl(a,b,null,c)};exports.createRoot=function(a,b){if(!nl(a))throw Error(p(299));var c=!1,d=\"\",e=kl;null!==b&&void 0!==b&&(!0===b.unstable_strictMode&&(c=!0),void 0!==b.identifierPrefix&&(d=b.identifierPrefix),void 0!==b.onRecoverableError&&(e=b.onRecoverableError));b=bl(a,1,!1,null,null,c,!1,d,e);a[uf]=b.current;sf(8===a.nodeType?a.parentNode:a);return new ll(b)};\nexports.findDOMNode=function(a){if(null==a)return null;if(1===a.nodeType)return a;var b=a._reactInternals;if(void 0===b){if(\"function\"===typeof a.render)throw Error(p(188));a=Object.keys(a).join(\",\");throw Error(p(268,a));}a=Zb(b);a=null===a?null:a.stateNode;return a};exports.flushSync=function(a){return Rk(a)};exports.hydrate=function(a,b,c){if(!ol(b))throw Error(p(200));return rl(null,a,b,!0,c)};\nexports.hydrateRoot=function(a,b,c){if(!nl(a))throw Error(p(405));var d=null!=c&&c.hydratedSources||null,e=!1,f=\"\",g=kl;null!==c&&void 0!==c&&(!0===c.unstable_strictMode&&(e=!0),void 0!==c.identifierPrefix&&(f=c.identifierPrefix),void 0!==c.onRecoverableError&&(g=c.onRecoverableError));b=el(b,null,a,1,null!=c?c:null,e,!1,f,g);a[uf]=b.current;sf(a);if(d)for(a=0;a<d.length;a++)c=d[a],e=c._getVersion,e=e(c._source),null==b.mutableSourceEagerHydrationData?b.mutableSourceEagerHydrationData=[c,e]:b.mutableSourceEagerHydrationData.push(c,\ne);return new ml(b)};exports.render=function(a,b,c){if(!ol(b))throw Error(p(200));return rl(null,a,b,!1,c)};exports.unmountComponentAtNode=function(a){if(!ol(a))throw Error(p(40));return a._reactRootContainer?(Rk(function(){rl(null,null,a,!1,function(){a._reactRootContainer=null;a[uf]=null})}),!0):!1};exports.unstable_batchedUpdates=Qk;\nexports.unstable_renderSubtreeIntoContainer=function(a,b,c,d){if(!ol(c))throw Error(p(200));if(null==a||void 0===a._reactInternals)throw Error(p(38));return rl(a,b,c,!1,d)};exports.version=\"18.3.1-next-f1338f8080-20240426\";\n","'use strict';\n\nfunction checkDCE() {\n  /* global __REACT_DEVTOOLS_GLOBAL_HOOK__ */\n  if (\n    typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ === 'undefined' ||\n    typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE !== 'function'\n  ) {\n    return;\n  }\n  if (process.env.NODE_ENV !== 'production') {\n    // This branch is unreachable because this function is only called\n    // in production, but the condition is true only in development.\n    // Therefore if the branch is still here, dead code elimination wasn't\n    // properly applied.\n    // Don't change the message. React DevTools relies on it. Also make sure\n    // this message doesn't occur elsewhere in this function, or it will cause\n    // a false positive.\n    throw new Error('^_^');\n  }\n  try {\n    // Verify that the code above has been dead code eliminated (DCE'd).\n    __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE);\n  } catch (err) {\n    // DevTools shouldn't crash React, no matter what.\n    // We should still report in case we break this code.\n    console.error(err);\n  }\n}\n\nif (process.env.NODE_ENV === 'production') {\n  // DCE check should happen before ReactDOM bundle executes so that\n  // DevTools can report bad minification during injection.\n  checkDCE();\n  module.exports = require('./cjs/react-dom.production.min.js');\n} else {\n  module.exports = require('./cjs/react-dom.development.js');\n}\n","'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","const createStoreImpl = (createState) => {\n  let state;\n  const listeners = /* @__PURE__ */ new Set();\n  const setState = (partial, replace) => {\n    const nextState = typeof partial === \"function\" ? partial(state) : partial;\n    if (!Object.is(nextState, state)) {\n      const previousState = state;\n      state = (replace != null ? replace : typeof nextState !== \"object\" || nextState === null) ? nextState : Object.assign({}, state, nextState);\n      listeners.forEach((listener) => listener(state, previousState));\n    }\n  };\n  const getState = () => state;\n  const getInitialState = () => initialState;\n  const subscribe = (listener) => {\n    listeners.add(listener);\n    return () => listeners.delete(listener);\n  };\n  const destroy = () => {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      console.warn(\n        \"[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected.\"\n      );\n    }\n    listeners.clear();\n  };\n  const api = { setState, getState, getInitialState, subscribe, destroy };\n  const initialState = state = createState(setState, getState, api);\n  return api;\n};\nconst createStore = (createState) => createState ? createStoreImpl(createState) : createStoreImpl;\nvar vanilla = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    console.warn(\n      \"[DEPRECATED] Default export is deprecated. Instead use import { createStore } from 'zustand/vanilla'.\"\n    );\n  }\n  return createStore(createState);\n};\n\nexport { createStore, vanilla as default };\n","/**\n * @license React\n * use-sync-external-store-shim.production.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\nvar React = require(\"react\");\nfunction is(x, y) {\n  return (x === y && (0 !== x || 1 / x === 1 / y)) || (x !== x && y !== y);\n}\nvar objectIs = \"function\" === typeof Object.is ? Object.is : is,\n  useState = React.useState,\n  useEffect = React.useEffect,\n  useLayoutEffect = React.useLayoutEffect,\n  useDebugValue = React.useDebugValue;\nfunction useSyncExternalStore$2(subscribe, getSnapshot) {\n  var value = getSnapshot(),\n    _useState = useState({ inst: { value: value, getSnapshot: getSnapshot } }),\n    inst = _useState[0].inst,\n    forceUpdate = _useState[1];\n  useLayoutEffect(\n    function () {\n      inst.value = value;\n      inst.getSnapshot = getSnapshot;\n      checkIfSnapshotChanged(inst) && forceUpdate({ inst: inst });\n    },\n    [subscribe, value, getSnapshot]\n  );\n  useEffect(\n    function () {\n      checkIfSnapshotChanged(inst) && forceUpdate({ inst: inst });\n      return subscribe(function () {\n        checkIfSnapshotChanged(inst) && forceUpdate({ inst: inst });\n      });\n    },\n    [subscribe]\n  );\n  useDebugValue(value);\n  return value;\n}\nfunction checkIfSnapshotChanged(inst) {\n  var latestGetSnapshot = inst.getSnapshot;\n  inst = inst.value;\n  try {\n    var nextValue = latestGetSnapshot();\n    return !objectIs(inst, nextValue);\n  } catch (error) {\n    return !0;\n  }\n}\nfunction useSyncExternalStore$1(subscribe, getSnapshot) {\n  return getSnapshot();\n}\nvar shim =\n  \"undefined\" === typeof window ||\n  \"undefined\" === typeof window.document ||\n  \"undefined\" === typeof window.document.createElement\n    ? useSyncExternalStore$1\n    : useSyncExternalStore$2;\nexports.useSyncExternalStore =\n  void 0 !== React.useSyncExternalStore ? React.useSyncExternalStore : shim;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim.production.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim.development.js');\n}\n","/**\n * @license React\n * use-sync-external-store-shim/with-selector.production.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\nvar React = require(\"react\"),\n  shim = require(\"use-sync-external-store/shim\");\nfunction is(x, y) {\n  return (x === y && (0 !== x || 1 / x === 1 / y)) || (x !== x && y !== y);\n}\nvar objectIs = \"function\" === typeof Object.is ? Object.is : is,\n  useSyncExternalStore = shim.useSyncExternalStore,\n  useRef = React.useRef,\n  useEffect = React.useEffect,\n  useMemo = React.useMemo,\n  useDebugValue = React.useDebugValue;\nexports.useSyncExternalStoreWithSelector = function (\n  subscribe,\n  getSnapshot,\n  getServerSnapshot,\n  selector,\n  isEqual\n) {\n  var instRef = useRef(null);\n  if (null === instRef.current) {\n    var inst = { hasValue: !1, value: null };\n    instRef.current = inst;\n  } else inst = instRef.current;\n  instRef = useMemo(\n    function () {\n      function memoizedSelector(nextSnapshot) {\n        if (!hasMemo) {\n          hasMemo = !0;\n          memoizedSnapshot = nextSnapshot;\n          nextSnapshot = selector(nextSnapshot);\n          if (void 0 !== isEqual && inst.hasValue) {\n            var currentSelection = inst.value;\n            if (isEqual(currentSelection, nextSnapshot))\n              return (memoizedSelection = currentSelection);\n          }\n          return (memoizedSelection = nextSnapshot);\n        }\n        currentSelection = memoizedSelection;\n        if (objectIs(memoizedSnapshot, nextSnapshot)) return currentSelection;\n        var nextSelection = selector(nextSnapshot);\n        if (void 0 !== isEqual && isEqual(currentSelection, nextSelection))\n          return (memoizedSnapshot = nextSnapshot), currentSelection;\n        memoizedSnapshot = nextSnapshot;\n        return (memoizedSelection = nextSelection);\n      }\n      var hasMemo = !1,\n        memoizedSnapshot,\n        memoizedSelection,\n        maybeGetServerSnapshot =\n          void 0 === getServerSnapshot ? null : getServerSnapshot;\n      return [\n        function () {\n          return memoizedSelector(getSnapshot());\n        },\n        null === maybeGetServerSnapshot\n          ? void 0\n          : function () {\n              return memoizedSelector(maybeGetServerSnapshot());\n            }\n      ];\n    },\n    [getSnapshot, getServerSnapshot, selector, isEqual]\n  );\n  var value = useSyncExternalStore(subscribe, instRef[0], instRef[1]);\n  useEffect(\n    function () {\n      inst.hasValue = !0;\n      inst.value = value;\n    },\n    [value]\n  );\n  useDebugValue(value);\n  return value;\n};\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.production.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.development.js');\n}\n","import { createStore } from 'zustand/vanilla';\nexport * from 'zustand/vanilla';\nimport ReactExports from 'react';\nimport useSyncExternalStoreExports from 'use-sync-external-store/shim/with-selector.js';\n\nconst { useDebugValue } = ReactExports;\nconst { useSyncExternalStoreWithSelector } = useSyncExternalStoreExports;\nlet didWarnAboutEqualityFn = false;\nconst identity = (arg) => arg;\nfunction useStore(api, selector = identity, equalityFn) {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && equalityFn && !didWarnAboutEqualityFn) {\n    console.warn(\n      \"[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937\"\n    );\n    didWarnAboutEqualityFn = true;\n  }\n  const slice = useSyncExternalStoreWithSelector(\n    api.subscribe,\n    api.getState,\n    api.getServerState || api.getInitialState,\n    selector,\n    equalityFn\n  );\n  useDebugValue(slice);\n  return slice;\n}\nconst createImpl = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && typeof createState !== \"function\") {\n    console.warn(\n      \"[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.\"\n    );\n  }\n  const api = typeof createState === \"function\" ? createStore(createState) : createState;\n  const useBoundStore = (selector, equalityFn) => useStore(api, selector, equalityFn);\n  Object.assign(useBoundStore, api);\n  return useBoundStore;\n};\nconst create = (createState) => createState ? createImpl(createState) : createImpl;\nvar react = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    console.warn(\n      \"[DEPRECATED] Default export is deprecated. Instead use `import { create } from 'zustand'`.\"\n    );\n  }\n  return create(createState);\n};\n\nexport { create, react as default, useStore };\n","const reduxImpl = (reducer, initial) => (set, _get, api) => {\n  api.dispatch = (action) => {\n    set((state) => reducer(state, action), false, action);\n    return action;\n  };\n  api.dispatchFromDevtools = true;\n  return { dispatch: (...a) => api.dispatch(...a), ...initial };\n};\nconst redux = reduxImpl;\n\nconst trackedConnections = /* @__PURE__ */ new Map();\nconst getTrackedConnectionState = (name) => {\n  const api = trackedConnections.get(name);\n  if (!api) return {};\n  return Object.fromEntries(\n    Object.entries(api.stores).map(([key, api2]) => [key, api2.getState()])\n  );\n};\nconst extractConnectionInformation = (store, extensionConnector, options) => {\n  if (store === void 0) {\n    return {\n      type: \"untracked\",\n      connection: extensionConnector.connect(options)\n    };\n  }\n  const existingConnection = trackedConnections.get(options.name);\n  if (existingConnection) {\n    return { type: \"tracked\", store, ...existingConnection };\n  }\n  const newConnection = {\n    connection: extensionConnector.connect(options),\n    stores: {}\n  };\n  trackedConnections.set(options.name, newConnection);\n  return { type: \"tracked\", store, ...newConnection };\n};\nconst devtoolsImpl = (fn, devtoolsOptions = {}) => (set, get, api) => {\n  const { enabled, anonymousActionType, store, ...options } = devtoolsOptions;\n  let extensionConnector;\n  try {\n    extensionConnector = (enabled != null ? enabled : (import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") && window.__REDUX_DEVTOOLS_EXTENSION__;\n  } catch (_e) {\n  }\n  if (!extensionConnector) {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && enabled) {\n      console.warn(\n        \"[zustand devtools middleware] Please install/enable Redux devtools extension\"\n      );\n    }\n    return fn(set, get, api);\n  }\n  const { connection, ...connectionInformation } = extractConnectionInformation(store, extensionConnector, options);\n  let isRecording = true;\n  api.setState = (state, replace, nameOrAction) => {\n    const r = set(state, replace);\n    if (!isRecording) return r;\n    const action = nameOrAction === void 0 ? { type: anonymousActionType || \"anonymous\" } : typeof nameOrAction === \"string\" ? { type: nameOrAction } : nameOrAction;\n    if (store === void 0) {\n      connection == null ? void 0 : connection.send(action, get());\n      return r;\n    }\n    connection == null ? void 0 : connection.send(\n      {\n        ...action,\n        type: `${store}/${action.type}`\n      },\n      {\n        ...getTrackedConnectionState(options.name),\n        [store]: api.getState()\n      }\n    );\n    return r;\n  };\n  const setStateFromDevtools = (...a) => {\n    const originalIsRecording = isRecording;\n    isRecording = false;\n    set(...a);\n    isRecording = originalIsRecording;\n  };\n  const initialState = fn(api.setState, get, api);\n  if (connectionInformation.type === \"untracked\") {\n    connection == null ? void 0 : connection.init(initialState);\n  } else {\n    connectionInformation.stores[connectionInformation.store] = api;\n    connection == null ? void 0 : connection.init(\n      Object.fromEntries(\n        Object.entries(connectionInformation.stores).map(([key, store2]) => [\n          key,\n          key === connectionInformation.store ? initialState : store2.getState()\n        ])\n      )\n    );\n  }\n  if (api.dispatchFromDevtools && typeof api.dispatch === \"function\") {\n    let didWarnAboutReservedActionType = false;\n    const originalDispatch = api.dispatch;\n    api.dispatch = (...a) => {\n      if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && a[0].type === \"__setState\" && !didWarnAboutReservedActionType) {\n        console.warn(\n          '[zustand devtools middleware] \"__setState\" action type is reserved to set state from the devtools. Avoid using it.'\n        );\n        didWarnAboutReservedActionType = true;\n      }\n      originalDispatch(...a);\n    };\n  }\n  connection.subscribe((message) => {\n    var _a;\n    switch (message.type) {\n      case \"ACTION\":\n        if (typeof message.payload !== \"string\") {\n          console.error(\n            \"[zustand devtools middleware] Unsupported action format\"\n          );\n          return;\n        }\n        return parseJsonThen(\n          message.payload,\n          (action) => {\n            if (action.type === \"__setState\") {\n              if (store === void 0) {\n                setStateFromDevtools(action.state);\n                return;\n              }\n              if (Object.keys(action.state).length !== 1) {\n                console.error(\n                  `\n                    [zustand devtools middleware] Unsupported __setState action format. \n                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),\n                    and value of this only key should be a state object. Example: { \"type\": \"__setState\", \"state\": { \"abc123Store\": { \"foo\": \"bar\" } } }\n                    `\n                );\n              }\n              const stateFromDevtools = action.state[store];\n              if (stateFromDevtools === void 0 || stateFromDevtools === null) {\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(stateFromDevtools)) {\n                setStateFromDevtools(stateFromDevtools);\n              }\n              return;\n            }\n            if (!api.dispatchFromDevtools) return;\n            if (typeof api.dispatch !== \"function\") return;\n            api.dispatch(action);\n          }\n        );\n      case \"DISPATCH\":\n        switch (message.payload.type) {\n          case \"RESET\":\n            setStateFromDevtools(initialState);\n            if (store === void 0) {\n              return connection == null ? void 0 : connection.init(api.getState());\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"COMMIT\":\n            if (store === void 0) {\n              connection == null ? void 0 : connection.init(api.getState());\n              return;\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"ROLLBACK\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                connection == null ? void 0 : connection.init(api.getState());\n                return;\n              }\n              setStateFromDevtools(state[store]);\n              connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n            });\n          case \"JUMP_TO_STATE\":\n          case \"JUMP_TO_ACTION\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(state[store])) {\n                setStateFromDevtools(state[store]);\n              }\n            });\n          case \"IMPORT_STATE\": {\n            const { nextLiftedState } = message.payload;\n            const lastComputedState = (_a = nextLiftedState.computedStates.slice(-1)[0]) == null ? void 0 : _a.state;\n            if (!lastComputedState) return;\n            if (store === void 0) {\n              setStateFromDevtools(lastComputedState);\n            } else {\n              setStateFromDevtools(lastComputedState[store]);\n            }\n            connection == null ? void 0 : connection.send(\n              null,\n              // FIXME no-any\n              nextLiftedState\n            );\n            return;\n          }\n          case \"PAUSE_RECORDING\":\n            return isRecording = !isRecording;\n        }\n        return;\n    }\n  });\n  return initialState;\n};\nconst devtools = devtoolsImpl;\nconst parseJsonThen = (stringified, f) => {\n  let parsed;\n  try {\n    parsed = JSON.parse(stringified);\n  } catch (e) {\n    console.error(\n      \"[zustand devtools middleware] Could not parse the received json\",\n      e\n    );\n  }\n  if (parsed !== void 0) f(parsed);\n};\n\nconst subscribeWithSelectorImpl = (fn) => (set, get, api) => {\n  const origSubscribe = api.subscribe;\n  api.subscribe = (selector, optListener, options) => {\n    let listener = selector;\n    if (optListener) {\n      const equalityFn = (options == null ? void 0 : options.equalityFn) || Object.is;\n      let currentSlice = selector(api.getState());\n      listener = (state) => {\n        const nextSlice = selector(state);\n        if (!equalityFn(currentSlice, nextSlice)) {\n          const previousSlice = currentSlice;\n          optListener(currentSlice = nextSlice, previousSlice);\n        }\n      };\n      if (options == null ? void 0 : options.fireImmediately) {\n        optListener(currentSlice, currentSlice);\n      }\n    }\n    return origSubscribe(listener);\n  };\n  const initialState = fn(set, get, api);\n  return initialState;\n};\nconst subscribeWithSelector = subscribeWithSelectorImpl;\n\nconst combine = (initialState, create) => (...a) => Object.assign({}, initialState, create(...a));\n\nfunction createJSONStorage(getStorage, options) {\n  let storage;\n  try {\n    storage = getStorage();\n  } catch (_e) {\n    return;\n  }\n  const persistStorage = {\n    getItem: (name) => {\n      var _a;\n      const parse = (str2) => {\n        if (str2 === null) {\n          return null;\n        }\n        return JSON.parse(str2, options == null ? void 0 : options.reviver);\n      };\n      const str = (_a = storage.getItem(name)) != null ? _a : null;\n      if (str instanceof Promise) {\n        return str.then(parse);\n      }\n      return parse(str);\n    },\n    setItem: (name, newValue) => storage.setItem(\n      name,\n      JSON.stringify(newValue, options == null ? void 0 : options.replacer)\n    ),\n    removeItem: (name) => storage.removeItem(name)\n  };\n  return persistStorage;\n}\nconst toThenable = (fn) => (input) => {\n  try {\n    const result = fn(input);\n    if (result instanceof Promise) {\n      return result;\n    }\n    return {\n      then(onFulfilled) {\n        return toThenable(onFulfilled)(result);\n      },\n      catch(_onRejected) {\n        return this;\n      }\n    };\n  } catch (e) {\n    return {\n      then(_onFulfilled) {\n        return this;\n      },\n      catch(onRejected) {\n        return toThenable(onRejected)(e);\n      }\n    };\n  }\n};\nconst oldImpl = (config, baseOptions) => (set, get, api) => {\n  let options = {\n    getStorage: () => localStorage,\n    serialize: JSON.stringify,\n    deserialize: JSON.parse,\n    partialize: (state) => state,\n    version: 0,\n    merge: (persistedState, currentState) => ({\n      ...currentState,\n      ...persistedState\n    }),\n    ...baseOptions\n  };\n  let hasHydrated = false;\n  const hydrationListeners = /* @__PURE__ */ new Set();\n  const finishHydrationListeners = /* @__PURE__ */ new Set();\n  let storage;\n  try {\n    storage = options.getStorage();\n  } catch (_e) {\n  }\n  if (!storage) {\n    return config(\n      (...args) => {\n        console.warn(\n          `[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`\n        );\n        set(...args);\n      },\n      get,\n      api\n    );\n  }\n  const thenableSerialize = toThenable(options.serialize);\n  const setItem = () => {\n    const state = options.partialize({ ...get() });\n    let errorInSync;\n    const thenable = thenableSerialize({ state, version: options.version }).then(\n      (serializedValue) => storage.setItem(options.name, serializedValue)\n    ).catch((e) => {\n      errorInSync = e;\n    });\n    if (errorInSync) {\n      throw errorInSync;\n    }\n    return thenable;\n  };\n  const savedSetState = api.setState;\n  api.setState = (state, replace) => {\n    savedSetState(state, replace);\n    void setItem();\n  };\n  const configResult = config(\n    (...args) => {\n      set(...args);\n      void setItem();\n    },\n    get,\n    api\n  );\n  let stateFromStorage;\n  const hydrate = () => {\n    var _a;\n    if (!storage) return;\n    hasHydrated = false;\n    hydrationListeners.forEach((cb) => cb(get()));\n    const postRehydrationCallback = ((_a = options.onRehydrateStorage) == null ? void 0 : _a.call(options, get())) || void 0;\n    return toThenable(storage.getItem.bind(storage))(options.name).then((storageValue) => {\n      if (storageValue) {\n        return options.deserialize(storageValue);\n      }\n    }).then((deserializedStorageValue) => {\n      if (deserializedStorageValue) {\n        if (typeof deserializedStorageValue.version === \"number\" && deserializedStorageValue.version !== options.version) {\n          if (options.migrate) {\n            return options.migrate(\n              deserializedStorageValue.state,\n              deserializedStorageValue.version\n            );\n          }\n          console.error(\n            `State loaded from storage couldn't be migrated since no migrate function was provided`\n          );\n        } else {\n          return deserializedStorageValue.state;\n        }\n      }\n    }).then((migratedState) => {\n      var _a2;\n      stateFromStorage = options.merge(\n        migratedState,\n        (_a2 = get()) != null ? _a2 : configResult\n      );\n      set(stateFromStorage, true);\n      return setItem();\n    }).then(() => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(stateFromStorage, void 0);\n      hasHydrated = true;\n      finishHydrationListeners.forEach((cb) => cb(stateFromStorage));\n    }).catch((e) => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(void 0, e);\n    });\n  };\n  api.persist = {\n    setOptions: (newOptions) => {\n      options = {\n        ...options,\n        ...newOptions\n      };\n      if (newOptions.getStorage) {\n        storage = newOptions.getStorage();\n      }\n    },\n    clearStorage: () => {\n      storage == null ? void 0 : storage.removeItem(options.name);\n    },\n    getOptions: () => options,\n    rehydrate: () => hydrate(),\n    hasHydrated: () => hasHydrated,\n    onHydrate: (cb) => {\n      hydrationListeners.add(cb);\n      return () => {\n        hydrationListeners.delete(cb);\n      };\n    },\n    onFinishHydration: (cb) => {\n      finishHydrationListeners.add(cb);\n      return () => {\n        finishHydrationListeners.delete(cb);\n      };\n    }\n  };\n  hydrate();\n  return stateFromStorage || configResult;\n};\nconst newImpl = (config, baseOptions) => (set, get, api) => {\n  let options = {\n    storage: createJSONStorage(() => localStorage),\n    partialize: (state) => state,\n    version: 0,\n    merge: (persistedState, currentState) => ({\n      ...currentState,\n      ...persistedState\n    }),\n    ...baseOptions\n  };\n  let hasHydrated = false;\n  const hydrationListeners = /* @__PURE__ */ new Set();\n  const finishHydrationListeners = /* @__PURE__ */ new Set();\n  let storage = options.storage;\n  if (!storage) {\n    return config(\n      (...args) => {\n        console.warn(\n          `[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`\n        );\n        set(...args);\n      },\n      get,\n      api\n    );\n  }\n  const setItem = () => {\n    const state = options.partialize({ ...get() });\n    return storage.setItem(options.name, {\n      state,\n      version: options.version\n    });\n  };\n  const savedSetState = api.setState;\n  api.setState = (state, replace) => {\n    savedSetState(state, replace);\n    void setItem();\n  };\n  const configResult = config(\n    (...args) => {\n      set(...args);\n      void setItem();\n    },\n    get,\n    api\n  );\n  api.getInitialState = () => configResult;\n  let stateFromStorage;\n  const hydrate = () => {\n    var _a, _b;\n    if (!storage) return;\n    hasHydrated = false;\n    hydrationListeners.forEach((cb) => {\n      var _a2;\n      return cb((_a2 = get()) != null ? _a2 : configResult);\n    });\n    const postRehydrationCallback = ((_b = options.onRehydrateStorage) == null ? void 0 : _b.call(options, (_a = get()) != null ? _a : configResult)) || void 0;\n    return toThenable(storage.getItem.bind(storage))(options.name).then((deserializedStorageValue) => {\n      if (deserializedStorageValue) {\n        if (typeof deserializedStorageValue.version === \"number\" && deserializedStorageValue.version !== options.version) {\n          if (options.migrate) {\n            return [\n              true,\n              options.migrate(\n                deserializedStorageValue.state,\n                deserializedStorageValue.version\n              )\n            ];\n          }\n          console.error(\n            `State loaded from storage couldn't be migrated since no migrate function was provided`\n          );\n        } else {\n          return [false, deserializedStorageValue.state];\n        }\n      }\n      return [false, void 0];\n    }).then((migrationResult) => {\n      var _a2;\n      const [migrated, migratedState] = migrationResult;\n      stateFromStorage = options.merge(\n        migratedState,\n        (_a2 = get()) != null ? _a2 : configResult\n      );\n      set(stateFromStorage, true);\n      if (migrated) {\n        return setItem();\n      }\n    }).then(() => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(stateFromStorage, void 0);\n      stateFromStorage = get();\n      hasHydrated = true;\n      finishHydrationListeners.forEach((cb) => cb(stateFromStorage));\n    }).catch((e) => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(void 0, e);\n    });\n  };\n  api.persist = {\n    setOptions: (newOptions) => {\n      options = {\n        ...options,\n        ...newOptions\n      };\n      if (newOptions.storage) {\n        storage = newOptions.storage;\n      }\n    },\n    clearStorage: () => {\n      storage == null ? void 0 : storage.removeItem(options.name);\n    },\n    getOptions: () => options,\n    rehydrate: () => hydrate(),\n    hasHydrated: () => hasHydrated,\n    onHydrate: (cb) => {\n      hydrationListeners.add(cb);\n      return () => {\n        hydrationListeners.delete(cb);\n      };\n    },\n    onFinishHydration: (cb) => {\n      finishHydrationListeners.add(cb);\n      return () => {\n        finishHydrationListeners.delete(cb);\n      };\n    }\n  };\n  if (!options.skipHydration) {\n    hydrate();\n  }\n  return stateFromStorage || configResult;\n};\nconst persistImpl = (config, baseOptions) => {\n  if (\"getStorage\" in baseOptions || \"serialize\" in baseOptions || \"deserialize\" in baseOptions) {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      console.warn(\n        \"[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead.\"\n      );\n    }\n    return oldImpl(config, baseOptions);\n  }\n  return newImpl(config, baseOptions);\n};\nconst persist = persistImpl;\n\nexport { combine, createJSONStorage, devtools, persist, redux, subscribeWithSelector };\n","/**\r\n * Extracts the opaque color palette (RGB only) from an image.\r\n * Only includes fully opaque pixels (alpha === 255).\r\n * \r\n * @param imageDataObj - ImageData object containing pixel data\r\n * @returns Map of hex colors to their RGB values\r\n */\r\nconst extractOpaqueColorPalette = (imageDataObj: ImageData): Map<string, { r: number; g: number; b: number }> => {\r\n  const data = imageDataObj.data;\r\n  const colorPalette = new Map<string, { r: number; g: number; b: number }>();\r\n\r\n  for (let i = 0; i < data.length; i += 4) {\r\n    const r = data[i];\r\n    const g = data[i + 1];\r\n    const b = data[i + 2];\r\n    const a = data[i + 3];\r\n\r\n    // Only include fully opaque pixels\r\n    if (a === 255) {\r\n      const hex = `#${((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1).toUpperCase()}`;\r\n      if (!colorPalette.has(hex)) {\r\n        colorPalette.set(hex, { r, g, b });\r\n      }\r\n    }\r\n  }\r\n\r\n  return colorPalette;\r\n};\r\n\r\n/**\r\n * Finds the nearest color in the palette using Euclidean distance in RGB space.\r\n */\r\nconst findNearestColor = (\r\n  r: number,\r\n  g: number,\r\n  b: number,\r\n  palette: Map<string, { r: number; g: number; b: number }>\r\n): { hex: string; r: number; g: number; b: number } => {\r\n  let nearestHex = '#000000';\r\n  let nearestRGB = { r: 0, g: 0, b: 0 };\r\n  let minDistance = Infinity;\r\n\r\n  for (const [hex, rgb] of palette) {\r\n    const distance = Math.sqrt(\r\n      Math.pow(r - rgb.r, 2) + Math.pow(g - rgb.g, 2) + Math.pow(b - rgb.b, 2)\r\n    );\r\n\r\n    if (distance < minDistance) {\r\n      minDistance = distance;\r\n      nearestHex = hex;\r\n      nearestRGB = rgb;\r\n    }\r\n  }\r\n\r\n  return { hex: nearestHex, ...nearestRGB };\r\n};\r\n\r\n/**\r\n * Applies a transparency mask to an image based on an alpha threshold.\r\n * Pixels with alpha < threshold become fully transparent (0).\r\n * Pixels with alpha >= threshold become fully opaque (255).\r\n * Optionally applies color palette reduction to newly opaque pixels.\r\n * \r\n * @param imageData - The base64 string of the image.\r\n * @param threshold - The alpha threshold (0-255).\r\n * @param useTemplatePalette - If true, map newly opaque pixels to nearest opaque colors.\r\n * @returns A Promise that resolves to the processed base64 string.\r\n */\r\nexport const applyTransparencyMask = (\r\n  imageData: string,\r\n  threshold: number,\r\n  useTemplatePalette: boolean = true\r\n): Promise<string> => {\r\n  return new Promise((resolve, reject) => {\r\n    try {\r\n      const img = new Image();\r\n      \r\n      img.onload = () => {\r\n        try {\r\n          const canvas = document.createElement('canvas');\r\n          canvas.width = img.width;\r\n          canvas.height = img.height;\r\n          const ctx = canvas.getContext('2d');\r\n\r\n          if (!ctx) {\r\n            reject(new Error('Could not get canvas context'));\r\n            return;\r\n          }\r\n\r\n          ctx.drawImage(img, 0, 0);\r\n          const imageDataObj = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n          const data = imageDataObj.data;\r\n\r\n          // Extract opaque color palette before processing if needed\r\n          let opaqueColorPalette: Map<string, { r: number; g: number; b: number }> | null = null;\r\n          if (useTemplatePalette) {\r\n            opaqueColorPalette = extractOpaqueColorPalette(imageDataObj);\r\n          }\r\n\r\n          for (let i = 0; i < data.length; i += 4) {\r\n            const alpha = data[i + 3];\r\n            \r\n            // If alpha === 0, continue (keep transparent)\r\n            if (alpha === 0) {\r\n              continue;\r\n            }\r\n\r\n            // If alpha < threshold, set data[i + 3] = 0 (make transparent)\r\n            if (alpha < threshold) {\r\n              data[i + 3] = 0;\r\n            } else {\r\n              // Else, set data[i + 3] = 255 (make opaque)\r\n              // If using template palette, map ONLY semi-transparent pixels becoming opaque\r\n              // Don't touch already-opaque pixels (alpha === 255)\r\n              if (useTemplatePalette && opaqueColorPalette && opaqueColorPalette.size > 0 && alpha < 255) {\r\n                const r = data[i];\r\n                const g = data[i + 1];\r\n                const b = data[i + 2];\r\n                const nearest = findNearestColor(r, g, b, opaqueColorPalette);\r\n                data[i] = nearest.r;\r\n                data[i + 1] = nearest.g;\r\n                data[i + 2] = nearest.b;\r\n              }\r\n              data[i + 3] = 255;\r\n            }\r\n          }\r\n\r\n          ctx.putImageData(imageDataObj, 0, 0);\r\n          resolve(canvas.toDataURL());\r\n        } catch (err) {\r\n          console.error('Error processing image data:', err);\r\n          reject(err);\r\n        }\r\n      };\r\n\r\n      img.onerror = (err) => {\r\n        console.error('Error loading image for processing:', err);\r\n        reject(new Error('Failed to load image'));\r\n      };\r\n\r\n      img.src = imageData;\r\n    } catch (err) {\r\n      console.error('Error initiating image processing:', err);\r\n      reject(err);\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * Converts a Blob to a base64 data URI\r\n * Used for clipboard image pasting\r\n */\r\nexport const blobToDataUrl = (blob: Blob): Promise<string> => {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.onload = (e) => {\r\n      const result = e.target?.result as string;\r\n      resolve(result);\r\n    };\r\n    reader.onerror = () => {\r\n      reject(new Error('Failed to read blob'));\r\n    };\r\n    reader.readAsDataURL(blob);\r\n  });\r\n};\r\n\r\n/**\r\n * Converts a base64 data URI to a Blob\r\n * Preserves transparency for PNG images\r\n */\r\nexport const dataUrlToBlob = (dataUrl: string): Blob => {\r\n  const parts = dataUrl.split(',');\r\n  const mimeMatch = parts[0].match(/:(.*?);/);\r\n  const mime = mimeMatch ? mimeMatch[1] : 'image/png';\r\n  const bstr = atob(parts[1]);\r\n  const n = bstr.length;\r\n  const u8arr = new Uint8Array(n);\r\n  \r\n  for (let i = 0; i < n; i++) {\r\n    u8arr[i] = bstr.charCodeAt(i);\r\n  }\r\n  \r\n  return new Blob([u8arr], { type: mime });\r\n};\r\n\r\n/**\r\n * Remove background by flood-filling from image corners using color tolerance.\r\n * Optionally return a heatmap (remaining pixels shown in red) instead of normal alpha mask.\r\n *\r\n * @param imageData - base64 data URL\r\n * @param tolerance - color distance tolerance (0-255)\r\n * @param makeHeatmap - if true, produces a red heatmap showing kept pixels\r\n * @returns Promise<string> - processed data URL (PNG)\r\n */\r\nexport const removeBackground = (\r\n  imageData: string,\r\n  tolerance: number = 30,\r\n  makeHeatmap: boolean = false\r\n): Promise<string> => {\r\n  return new Promise((resolve, reject) => {\r\n    try {\r\n      const img = new Image();\r\n      img.crossOrigin = 'anonymous';\r\n      img.onload = () => {\r\n        try {\r\n          const w = img.naturalWidth;\r\n          const h = img.naturalHeight;\r\n          const canvas = document.createElement('canvas');\r\n          canvas.width = w;\r\n          canvas.height = h;\r\n          const ctx = canvas.getContext('2d');\r\n          if (!ctx) {\r\n            reject(new Error('Could not get canvas context'));\r\n            return;\r\n          }\r\n          ctx.drawImage(img, 0, 0);\r\n          const imageDataObj = ctx.getImageData(0, 0, w, h);\r\n          const data = imageDataObj.data;\r\n\r\n          const visited = new Uint8Array(w * h);\r\n          const maskBg = new Uint8Array(w * h); // 1 = background\r\n\r\n          const pixelIndex = (x: number, y: number) => y * w + x;\r\n\r\n          const colorAt = (x: number, y: number) => {\r\n            const i = (y * w + x) * 4;\r\n            return { r: data[i], g: data[i + 1], b: data[i + 2], a: data[i + 3] };\r\n          };\r\n\r\n          const colorDistance = (c1: any, c2: any) => {\r\n            const dr = c1.r - c2.r;\r\n            const dg = c1.g - c2.g;\r\n            const db = c1.b - c2.b;\r\n            return Math.sqrt(dr * dr + dg * dg + db * db);\r\n          };\r\n\r\n          // Seed points: four corners (and small 3x3 around them)\r\n          const seeds: Array<{ x: number; y: number }> = [];\r\n          const pushSeeds = (cx: number, cy: number) => {\r\n            for (let yy = Math.max(0, cy - 1); yy <= Math.min(h - 1, cy + 1); yy++) {\r\n              for (let xx = Math.max(0, cx - 1); xx <= Math.min(w - 1, cx + 1); xx++) {\r\n                seeds.push({ x: xx, y: yy });\r\n              }\r\n            }\r\n          };\r\n          pushSeeds(0, 0);\r\n          pushSeeds(w - 1, 0);\r\n          pushSeeds(0, h - 1);\r\n          pushSeeds(w - 1, h - 1);\r\n\r\n          // Use first seed color as reference per seed\r\n          const queue: Array<{ x: number; y: number; base: { r: number; g: number; b: number } }> = [];\r\n          for (const s of seeds) {\r\n            const c = colorAt(s.x, s.y);\r\n            queue.push({ x: s.x, y: s.y, base: c });\r\n          }\r\n\r\n          const inBounds = (x: number, y: number) => x >= 0 && x < w && y >= 0 && y < h;\r\n\r\n          while (queue.length > 0) {\r\n            const { x, y, base } = queue.shift() as any;\r\n            const idx = pixelIndex(x, y);\r\n            if (visited[idx]) continue;\r\n            visited[idx] = 1;\r\n\r\n            const cur = colorAt(x, y);\r\n            const dist = colorDistance(cur, base);\r\n            if (dist <= tolerance) {\r\n              maskBg[idx] = 1;\r\n              // enqueue neighbors\r\n              const nbs = [\r\n                { x: x + 1, y },\r\n                { x: x - 1, y },\r\n                { x, y: y + 1 },\r\n                { x, y: y - 1 },\r\n              ];\r\n              for (const nb of nbs) {\r\n                if (inBounds(nb.x, nb.y)) {\r\n                  const nidx = pixelIndex(nb.x, nb.y);\r\n                  if (!visited[nidx]) {\r\n                    queue.push({ x: nb.x, y: nb.y, base });\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n\r\n          // Apply mask: if maskBg==1 => transparent, else keep. If makeHeatmap, color kept pixels red.\r\n          for (let y = 0; y < h; y++) {\r\n            for (let x = 0; x < w; x++) {\r\n              const pi = (y * w + x) * 4;\r\n              const m = maskBg[pixelIndex(x, y)];\r\n              if (m === 1) {\r\n                // background => transparent\r\n                data[pi + 3] = 0;\r\n              } else {\r\n                // kept pixel\r\n                if (makeHeatmap) {\r\n                  data[pi] = 255;\r\n                  data[pi + 1] = 0;\r\n                  data[pi + 2] = 0;\r\n                  data[pi + 3] = 255;\r\n                } else {\r\n                  data[pi + 3] = 255;\r\n                }\r\n              }\r\n            }\r\n          }\r\n\r\n          ctx.putImageData(imageDataObj, 0, 0);\r\n          resolve(canvas.toDataURL());\r\n        } catch (err) {\r\n          console.error('removeBackground processing error:', err);\r\n          reject(err);\r\n        }\r\n      };\r\n      img.onerror = (err) => {\r\n        console.error('removeBackground load error:', err);\r\n        reject(new Error('Failed to load image'));\r\n      };\r\n      img.src = imageData;\r\n    } catch (err) {\r\n      console.error('removeBackground init error:', err);\r\n      reject(err);\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * Composite multiple layers onto a canvas, preserving transparency\r\n * Layers are composited in z-index order\r\n */\r\nexport const compositeLayersToBlob = (\r\n  layers: Array<{\r\n    imageData: string;\r\n    x: number;\r\n    y: number;\r\n    width: number;\r\n    height: number;\r\n    opacity: number;\r\n  }>\r\n): Promise<Blob> => {\r\n  return new Promise((resolve, reject) => {\r\n    if (layers.length === 0) {\r\n      reject(new Error('No layers to composite'));\r\n      return;\r\n    }\r\n\r\n    // Calculate bounding box\r\n    let minX = Infinity;\r\n    let minY = Infinity;\r\n    let maxX = -Infinity;\r\n    let maxY = -Infinity;\r\n\r\n    for (const layer of layers) {\r\n      minX = Math.min(minX, layer.x);\r\n      minY = Math.min(minY, layer.y);\r\n      maxX = Math.max(maxX, layer.x + layer.width);\r\n      maxY = Math.max(maxY, layer.y + layer.height);\r\n    }\r\n\r\n    const width = Math.ceil(maxX - minX);\r\n    const height = Math.ceil(maxY - minY);\r\n\r\n    // Create canvas with transparent background\r\n    const canvas = document.createElement('canvas');\r\n    canvas.width = width;\r\n    canvas.height = height;\r\n\r\n    const ctx = canvas.getContext('2d', { willReadFrequently: true });\r\n    if (!ctx) {\r\n      reject(new Error('Failed to get canvas context'));\r\n      return;\r\n    }\r\n\r\n    // Clear canvas (transparent background)\r\n    ctx.clearRect(0, 0, width, height);\r\n\r\n    let loadedCount = 0;\r\n    let hasError = false;\r\n\r\n    // Load and composite each layer\r\n    for (const layer of layers) {\r\n      const img = new Image();\r\n      img.onload = () => {\r\n        if (hasError) return;\r\n\r\n        ctx.globalAlpha = layer.opacity;\r\n        ctx.drawImage(\r\n          img,\r\n          layer.x - minX,\r\n          layer.y - minY,\r\n          layer.width,\r\n          layer.height\r\n        );\r\n\r\n        loadedCount++;\r\n        if (loadedCount === layers.length) {\r\n          // All layers loaded and composited\r\n          ctx.globalAlpha = 1.0; // Reset alpha\r\n          canvas.toBlob(\r\n            (blob) => {\r\n              if (blob) {\r\n                resolve(blob);\r\n              } else {\r\n                reject(new Error('Failed to create blob from canvas'));\r\n              }\r\n            },\r\n            'image/png'\r\n          );\r\n        }\r\n      };\r\n\r\n      img.onerror = () => {\r\n        hasError = true;\r\n        reject(new Error(`Failed to load image for layer at (${layer.x}, ${layer.y})`));\r\n      };\r\n\r\n      img.src = layer.imageData;\r\n    }\r\n  });\r\n};\r\n","/**\r\n * Font management for text layers\r\n * Includes system fonts and curated Google Fonts\r\n */\r\n\r\nexport interface FontOption {\r\n  name: string;\r\n  value: string; // CSS font-family value\r\n  category: 'system' | 'google' | 'local';\r\n  googleFontName?: string; // For constructing Google Fonts URL\r\n}\r\n\r\n// System fonts available across Windows, macOS, and Linux\r\nexport const SYSTEM_FONTS: FontOption[] = [\r\n  { name: 'Arial', value: 'Arial, sans-serif', category: 'system' },\r\n  { name: 'Times New Roman', value: '\"Times New Roman\", Times, serif', category: 'system' },\r\n  { name: 'Courier New', value: '\"Courier New\", Courier, monospace', category: 'system' },\r\n  { name: 'Georgia', value: 'Georgia, serif', category: 'system' },\r\n  { name: 'Verdana', value: 'Verdana, sans-serif', category: 'system' },\r\n  { name: 'Comic Sans MS', value: '\"Comic Sans MS\", \"Comic Sans\", cursive', category: 'system' },\r\n  { name: 'Impact', value: 'Impact, Charcoal, sans-serif', category: 'system' },\r\n  { name: 'Trebuchet MS', value: '\"Trebuchet MS\", Helvetica, sans-serif', category: 'system' },\r\n  { name: 'Jokerman', value: 'Jokerman, fantasy', category: 'system' },\r\n];\r\n\r\n// Top 50 most popular Google Fonts (by usage statistics)\r\nexport const GOOGLE_FONTS: FontOption[] = [\r\n  // Sans-serif (most popular)\r\n  { name: 'Roboto', value: 'Roboto, sans-serif', category: 'google', googleFontName: 'Roboto' },\r\n  { name: 'Open Sans', value: '\"Open Sans\", sans-serif', category: 'google', googleFontName: 'Open+Sans' },\r\n  { name: 'Lato', value: 'Lato, sans-serif', category: 'google', googleFontName: 'Lato' },\r\n  { name: 'Montserrat', value: 'Montserrat, sans-serif', category: 'google', googleFontName: 'Montserrat' },\r\n  { name: 'Poppins', value: 'Poppins, sans-serif', category: 'google', googleFontName: 'Poppins' },\r\n  { name: 'Oswald', value: 'Oswald, sans-serif', category: 'google', googleFontName: 'Oswald' },\r\n  { name: 'Raleway', value: 'Raleway, sans-serif', category: 'google', googleFontName: 'Raleway' },\r\n  { name: 'Ubuntu', value: 'Ubuntu, sans-serif', category: 'google', googleFontName: 'Ubuntu' },\r\n  { name: 'Nunito', value: 'Nunito, sans-serif', category: 'google', googleFontName: 'Nunito' },\r\n  { name: 'PT Sans', value: '\"PT Sans\", sans-serif', category: 'google', googleFontName: 'PT+Sans' },\r\n  \r\n  // Serif\r\n  { name: 'Merriweather', value: 'Merriweather, serif', category: 'google', googleFontName: 'Merriweather' },\r\n  { name: 'Playfair Display', value: '\"Playfair Display\", serif', category: 'google', googleFontName: 'Playfair+Display' },\r\n  { name: 'Lora', value: 'Lora, serif', category: 'google', googleFontName: 'Lora' },\r\n  { name: 'PT Serif', value: '\"PT Serif\", serif', category: 'google', googleFontName: 'PT+Serif' },\r\n  { name: 'Crimson Text', value: '\"Crimson Text\", serif', category: 'google', googleFontName: 'Crimson+Text' },\r\n  { name: 'EB Garamond', value: '\"EB Garamond\", serif', category: 'google', googleFontName: 'EB+Garamond' },\r\n  { name: 'Libre Baskerville', value: '\"Libre Baskerville\", serif', category: 'google', googleFontName: 'Libre+Baskerville' },\r\n  { name: 'Cormorant', value: 'Cormorant, serif', category: 'google', googleFontName: 'Cormorant' },\r\n  { name: 'Spectral', value: 'Spectral, serif', category: 'google', googleFontName: 'Spectral' },\r\n  { name: 'Bitter', value: 'Bitter, serif', category: 'google', googleFontName: 'Bitter' },\r\n  \r\n  // Display\r\n  { name: 'Bebas Neue', value: '\"Bebas Neue\", cursive', category: 'google', googleFontName: 'Bebas+Neue' },\r\n  { name: 'Pacifico', value: 'Pacifico, cursive', category: 'google', googleFontName: 'Pacifico' },\r\n  { name: 'Righteous', value: 'Righteous, cursive', category: 'google', googleFontName: 'Righteous' },\r\n  { name: 'Bangers', value: 'Bangers, cursive', category: 'google', googleFontName: 'Bangers' },\r\n  { name: 'Permanent Marker', value: '\"Permanent Marker\", cursive', category: 'google', googleFontName: 'Permanent+Marker' },\r\n  { name: 'Lobster', value: 'Lobster, cursive', category: 'google', googleFontName: 'Lobster' },\r\n  { name: 'Press Start 2P', value: '\"Press Start 2P\", cursive', category: 'google', googleFontName: 'Press+Start+2P' },\r\n  { name: 'Fredoka One', value: '\"Fredoka One\", cursive', category: 'google', googleFontName: 'Fredoka+One' },\r\n  { name: 'Alfa Slab One', value: '\"Alfa Slab One\", cursive', category: 'google', googleFontName: 'Alfa+Slab+One' },\r\n  { name: 'Rubik Mono One', value: '\"Rubik Mono One\", sans-serif', category: 'google', googleFontName: 'Rubik+Mono+One' },\r\n  \r\n  // Handwriting\r\n  { name: 'Dancing Script', value: '\"Dancing Script\", cursive', category: 'google', googleFontName: 'Dancing+Script' },\r\n  { name: 'Caveat', value: 'Caveat, cursive', category: 'google', googleFontName: 'Caveat' },\r\n  { name: 'Shadows Into Light', value: '\"Shadows Into Light\", cursive', category: 'google', googleFontName: 'Shadows+Into+Light' },\r\n  { name: 'Satisfy', value: 'Satisfy, cursive', category: 'google', googleFontName: 'Satisfy' },\r\n  { name: 'Indie Flower', value: '\"Indie Flower\", cursive', category: 'google', googleFontName: 'Indie+Flower' },\r\n  { name: 'Architects Daughter', value: '\"Architects Daughter\", cursive', category: 'google', googleFontName: 'Architects+Daughter' },\r\n  { name: 'Kalam', value: 'Kalam, cursive', category: 'google', googleFontName: 'Kalam' },\r\n  { name: 'Amatic SC', value: '\"Amatic SC\", cursive', category: 'google', googleFontName: 'Amatic+SC' },\r\n  { name: 'Patrick Hand', value: '\"Patrick Hand\", cursive', category: 'google', googleFontName: 'Patrick+Hand' },\r\n  { name: 'Courgette', value: 'Courgette, cursive', category: 'google', googleFontName: 'Courgette' },\r\n  \r\n  // Monospace\r\n  { name: 'Roboto Mono', value: '\"Roboto Mono\", monospace', category: 'google', googleFontName: 'Roboto+Mono' },\r\n  { name: 'Source Code Pro', value: '\"Source Code Pro\", monospace', category: 'google', googleFontName: 'Source+Code+Pro' },\r\n  { name: 'Fira Code', value: '\"Fira Code\", monospace', category: 'google', googleFontName: 'Fira+Code' },\r\n  { name: 'JetBrains Mono', value: '\"JetBrains Mono\", monospace', category: 'google', googleFontName: 'JetBrains+Mono' },\r\n  { name: 'Space Mono', value: '\"Space Mono\", monospace', category: 'google', googleFontName: 'Space+Mono' },\r\n  { name: 'Courier Prime', value: '\"Courier Prime\", monospace', category: 'google', googleFontName: 'Courier+Prime' },\r\n  { name: 'Inconsolata', value: 'Inconsolata, monospace', category: 'google', googleFontName: 'Inconsolata' },\r\n  { name: 'IBM Plex Mono', value: '\"IBM Plex Mono\", monospace', category: 'google', googleFontName: 'IBM+Plex+Mono' },\r\n  { name: 'Anonymous Pro', value: '\"Anonymous Pro\", monospace', category: 'google', googleFontName: 'Anonymous+Pro' },\r\n  { name: 'Overpass Mono', value: '\"Overpass Mono\", monospace', category: 'google', googleFontName: 'Overpass+Mono' },\r\n  \r\n  // Fun / Silly\r\n  { name: 'Creepster', value: '\"Creepster\", cursive', category: 'google', googleFontName: 'Creepster' },\r\n  { name: 'Frijole', value: '\"Frijole\", cursive', category: 'google', googleFontName: 'Frijole' },\r\n  { name: 'Spicy Rice', value: '\"Spicy Rice\", cursive', category: 'google', googleFontName: 'Spicy+Rice' },\r\n  { name: 'Ranchers', value: '\"Ranchers\", cursive', category: 'google', googleFontName: 'Ranchers' },\r\n  { name: 'Chewy', value: '\"Chewy\", cursive', category: 'google', googleFontName: 'Chewy' },\r\n];\r\n\r\n// All fonts combined\r\nexport const ALL_FONTS: FontOption[] = [...SYSTEM_FONTS, ...GOOGLE_FONTS];\r\n\r\n// Track which Google Fonts have been loaded\r\nconst loadedGoogleFonts = new Set<string>();\r\n\r\n/**\r\n * Load a Google Font dynamically\r\n * @param fontName The Google Font name (URL-encoded)\r\n * @returns Promise that resolves when font is loaded\r\n */\r\nexport async function loadGoogleFont(fontName: string): Promise<void> {\r\n  if (loadedGoogleFonts.has(fontName)) {\r\n    return Promise.resolve();\r\n  }\r\n\r\n  return new Promise((resolve, reject) => {\r\n    const link = document.createElement('link');\r\n    link.rel = 'stylesheet';\r\n    link.href = `https://fonts.googleapis.com/css2?family=${fontName}:wght@400;700&display=swap`;\r\n    \r\n    link.onload = () => {\r\n      loadedGoogleFonts.add(fontName);\r\n      resolve();\r\n    };\r\n    \r\n    link.onerror = () => {\r\n      console.error(`Failed to load Google Font: ${fontName}`);\r\n      reject(new Error(`Failed to load font: ${fontName}`));\r\n    };\r\n    \r\n    document.head.appendChild(link);\r\n  });\r\n}\r\n\r\n/**\r\n * Preload ALL Google Fonts in a single request.\r\n * Uses a batched Google Fonts CSS URL so the browser downloads them all at once.\r\n * Returns a promise that resolves when the stylesheet has loaded.\r\n */\r\nlet _googleFontsPreloaded = false;\r\nexport function preloadAllGoogleFonts(): Promise<void> {\r\n  if (_googleFontsPreloaded) return Promise.resolve();\r\n  _googleFontsPreloaded = true;\r\n\r\n  const families = GOOGLE_FONTS\r\n    .filter(f => f.googleFontName)\r\n    .map(f => `family=${f.googleFontName}:wght@400;700`)\r\n    .join('&');\r\n\r\n  return new Promise((resolve) => {\r\n    const link = document.createElement('link');\r\n    link.rel = 'stylesheet';\r\n    link.href = `https://fonts.googleapis.com/css2?${families}&display=swap`;\r\n    link.onload = () => {\r\n      // Mark every font as loaded so individual loadGoogleFont calls are no-ops\r\n      GOOGLE_FONTS.forEach(f => { if (f.googleFontName) loadedGoogleFonts.add(f.googleFontName); });\r\n      resolve();\r\n    };\r\n    link.onerror = () => resolve(); // fail silently\r\n    document.head.appendChild(link);\r\n  });\r\n}\r\n\r\n/**\r\n * Get font option by value\r\n */\r\nexport function getFontByValue(value: string): FontOption | undefined {\r\n  return ALL_FONTS.find(font => font.value === value);\r\n}\r\n\r\n/**\r\n * Get font option by name\r\n */\r\nexport function getFontByName(name: string): FontOption | undefined {\r\n  return ALL_FONTS.find(font => font.name === name);\r\n}\r\n\r\n/**\r\n * Detect locally installed fonts using the Local Font Access API.\r\n * Only available in Chromium-based browsers (Chrome 103+, Edge 103+).\r\n * Returns deduplicated FontOption[] with category 'local'.\r\n * Falls back to empty array if the API is unavailable or the user denies permission.\r\n */\r\nexport async function detectLocalFonts(): Promise<FontOption[]> {\r\n  try {\r\n    // Check if the API exists\r\n    if (!('queryLocalFonts' in window)) {\r\n      return [];\r\n    }\r\n\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    const fonts: any[] = await (window as any).queryLocalFonts();\r\n\r\n    // Deduplicate by family name  the API returns one entry per style variant\r\n    const seenFamilies = new Set<string>();\r\n    // Also skip families we already have in SYSTEM_FONTS or GOOGLE_FONTS\r\n    const existingNames = new Set(\r\n      ALL_FONTS.map(f => f.name.toLowerCase())\r\n    );\r\n\r\n    const localFonts: FontOption[] = [];\r\n    for (const font of fonts) {\r\n      const family: string = font.family;\r\n      const key = family.toLowerCase();\r\n      if (seenFamilies.has(key) || existingNames.has(key)) continue;\r\n      seenFamilies.add(key);\r\n      localFonts.push({\r\n        name: family,\r\n        value: `\"${family}\"`,\r\n        category: 'local',\r\n      });\r\n    }\r\n\r\n    // Sort alphabetically\r\n    localFonts.sort((a, b) => a.name.localeCompare(b.name));\r\n    return localFonts;\r\n  } catch {\r\n    // User denied permission or API error  silently return empty\r\n    return [];\r\n  }\r\n}\r\n","/**\r\n * Text rasterizer for converting text to high-quality images\r\n * Renders at 4x resolution for crisp output at all zoom levels\r\n */\r\n\r\nimport { loadGoogleFont, getFontByValue } from './fonts';\r\n\r\nexport interface TextRasterizeOptions {\r\n  text: string;\r\n  fontSize: number; // Font size in pixels (at 1x scale)\r\n  fontFamily: string; // CSS font-family value\r\n  color: string; // Hex color\r\n  textAlign?: 'left' | 'center' | 'right';\r\n  maxWidth?: number; // Optional max width for word wrapping (in pixels at 1x scale)\r\n  lineHeight?: number; // Line height multiplier (default 1.2)\r\n  disableTransparency?: boolean; // If true, renders aliased text (no transparency/anti-aliasing)\r\n  letterSpacing?: number; // Letter spacing in pixels\r\n  fontWeight?: 'normal' | 'bold' | 'lighter' | string; // Font weight\r\n}\r\n\r\nexport interface RasterizedText {\r\n  dataUrl: string; // Base64 data URI\r\n  width: number; // Final width in pixels (at 1x scale)\r\n  height: number; // Final height in pixels (at 1x scale)\r\n}\r\n\r\nconst HIGH_DPI_SCALE = 4; // 4x resolution for crisp text\r\n\r\n/**\r\n * Measure text dimensions before rendering\r\n */\r\nfunction measureText(\r\n  ctx: CanvasRenderingContext2D,\r\n  text: string,\r\n  fontSize: number,\r\n  fontFamily: string,\r\n  maxWidth?: number,\r\n  lineHeight: number = 1.2,\r\n  scale: number = HIGH_DPI_SCALE,\r\n  letterSpacing: number = 0,\r\n  fontWeight: string = 'normal'\r\n): { width: number; height: number; lines: string[] } {\r\n  ctx.font = `${fontWeight} ${fontSize * scale}px ${fontFamily}`;\r\n  // @ts-ignore - letterSpacing is a newer property\r\n  if (typeof ctx.letterSpacing !== 'undefined') {\r\n     // @ts-ignore\r\n    ctx.letterSpacing = `${letterSpacing * scale}px`;\r\n  }\r\n  \r\n  const lines: string[] = [];\r\n  const paragraphs = text.split('\\n');\r\n  \r\n  for (const paragraph of paragraphs) {\r\n    if (!paragraph.trim()) {\r\n      lines.push('');\r\n      continue;\r\n    }\r\n    \r\n    if (!maxWidth) {\r\n      lines.push(paragraph);\r\n      continue;\r\n    }\r\n    \r\n    // Word wrapping\r\n    const words = paragraph.split(' ');\r\n    let currentLine = '';\r\n    \r\n    for (const word of words) {\r\n      const testLine = currentLine ? `${currentLine} ${word}` : word;\r\n      const metrics = ctx.measureText(testLine);\r\n      const testWidth = metrics.width / scale;\r\n      \r\n      if (testWidth > maxWidth && currentLine) {\r\n        lines.push(currentLine);\r\n        currentLine = word;\r\n      } else {\r\n        currentLine = testLine;\r\n      }\r\n    }\r\n    \r\n    if (currentLine) {\r\n      lines.push(currentLine);\r\n    }\r\n  }\r\n  \r\n  // Measure final dimensions\r\n  let maxLineWidth = 0;\r\n  for (const line of lines) {\r\n    const metrics = ctx.measureText(line);\r\n    const lineWidth = metrics.width / scale;\r\n    maxLineWidth = Math.max(maxLineWidth, lineWidth);\r\n  }\r\n  \r\n  const lineHeightPx = fontSize * lineHeight;\r\n  const totalHeight = lines.length * lineHeightPx;\r\n  \r\n  return {\r\n    width: Math.ceil(maxLineWidth),\r\n    height: Math.ceil(totalHeight),\r\n    lines\r\n  };\r\n}\r\n\r\n/**\r\n * Rasterize text to a high-DPI image\r\n * @param options Text rendering options\r\n * @returns Promise with data URL and dimensions\r\n */\r\nexport async function rasterizeText(options: TextRasterizeOptions): Promise<RasterizedText> {\r\n  const {\r\n    text,\r\n    fontSize,\r\n    fontFamily,\r\n    color,\r\n    textAlign = 'left',\r\n    maxWidth,\r\n    lineHeight = 1.2,\r\n    disableTransparency = false,\r\n    letterSpacing = 0,\r\n    fontWeight = 'normal'\r\n  } = options;\r\n  \r\n  // Load Google Font if needed\r\n  const fontOption = getFontByValue(fontFamily);\r\n  if (fontOption?.category === 'google' && fontOption.googleFontName) {\r\n    try {\r\n      await loadGoogleFont(fontOption.googleFontName);\r\n      // Wait a bit for font to be available\r\n      await new Promise(resolve => setTimeout(resolve, 100));\r\n    } catch (error) {\r\n      console.error('Failed to load Google Font, using fallback:', error);\r\n    }\r\n  }\r\n  \r\n  // Create temporary canvas for measurement\r\n  const measureCanvas = document.createElement('canvas');\r\n  const measureCtx = measureCanvas.getContext('2d', { willReadFrequently: true });\r\n  if (!measureCtx) {\r\n    throw new Error('Failed to get canvas context');\r\n  }\r\n  \r\n  // Determine scale\r\n  const scale = disableTransparency ? 1 : HIGH_DPI_SCALE;\r\n  \r\n  // Measure text dimensions\r\n  const { width, height, lines } = measureText(\r\n    measureCtx,\r\n    text,\r\n    fontSize,\r\n    fontFamily,\r\n    maxWidth,\r\n    lineHeight,\r\n    scale,\r\n    letterSpacing,\r\n    fontWeight\r\n  );\r\n  \r\n  // Add padding (10px at 1x scale)\r\n  const padding = 10;\r\n  const scaledPadding = padding * scale;\r\n  const canvasWidth = (width + padding * 2) * scale;\r\n  const canvasHeight = (height + padding * 2) * scale;\r\n  \r\n  // Create canvas\r\n  const canvas = document.createElement('canvas');\r\n  canvas.width = canvasWidth;\r\n  canvas.height = canvasHeight;\r\n  \r\n  const ctx = canvas.getContext('2d', { willReadFrequently: true });\r\n  if (!ctx) {\r\n    throw new Error('Failed to get canvas context');\r\n  }\r\n  \r\n  // Set up rendering context\r\n  ctx.font = `${fontWeight} ${fontSize * scale}px ${fontFamily}`;\r\n  // @ts-ignore\r\n  if (typeof ctx.letterSpacing !== 'undefined') {\r\n    // @ts-ignore\r\n    ctx.letterSpacing = `${letterSpacing * scale}px`;\r\n  }\r\n  ctx.fillStyle = color;\r\n  ctx.textBaseline = 'top';\r\n  \r\n  // Configure smoothing\r\n  ctx.imageSmoothingEnabled = !disableTransparency;\r\n  ctx.imageSmoothingQuality = disableTransparency ? 'low' : 'high';\r\n  \r\n  // Render each line\r\n  const lineHeightPx = fontSize * lineHeight * scale;\r\n  let y = scaledPadding;\r\n  \r\n  for (const line of lines) {\r\n    if (!line) {\r\n      // Empty line, just advance y\r\n      y += lineHeightPx;\r\n      continue;\r\n    }\r\n    \r\n    let x = scaledPadding;\r\n    \r\n    // Apply text alignment\r\n    if (textAlign === 'center') {\r\n      const lineWidth = ctx.measureText(line).width;\r\n      x = (canvasWidth - lineWidth) / 2;\r\n    } else if (textAlign === 'right') {\r\n      const lineWidth = ctx.measureText(line).width;\r\n      x = canvasWidth - lineWidth - scaledPadding;\r\n    }\r\n    \r\n    ctx.fillText(line, x, y);\r\n    y += lineHeightPx;\r\n  }\r\n  \r\n  // If transparency is disabled, threshold the alpha channel\r\n  if (disableTransparency) {\r\n    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n    const data = imageData.data;\r\n    \r\n    // Parse target color\r\n    const r = parseInt(color.slice(1, 3), 16);\r\n    const g = parseInt(color.slice(3, 5), 16);\r\n    const b = parseInt(color.slice(5, 7), 16);\r\n    \r\n    for (let i = 0; i < data.length; i += 4) {\r\n      // Threshold alpha at 128\r\n      if (data[i + 3] >= 128) {\r\n        data[i + 3] = 255; // Fully opaque\r\n        // Force exact color to remove any anti-aliasing artifacts\r\n        data[i] = r;\r\n        data[i + 1] = g;\r\n        data[i + 2] = b;\r\n      } else {\r\n        data[i + 3] = 0; // Fully transparent\r\n      }\r\n    }\r\n    \r\n    ctx.putImageData(imageData, 0, 0);\r\n  }\r\n  \r\n  // Create final canvas (handles downscaling if needed, or just cropping/copying)\r\n  const finalCanvas = document.createElement('canvas');\r\n  finalCanvas.width = width + padding * 2;\r\n  finalCanvas.height = height + padding * 2;\r\n  \r\n  const finalCtx = finalCanvas.getContext('2d', { willReadFrequently: true });\r\n  if (!finalCtx) {\r\n    throw new Error('Failed to get final canvas context');\r\n  }\r\n  \r\n  finalCtx.imageSmoothingEnabled = !disableTransparency;\r\n  finalCtx.imageSmoothingQuality = disableTransparency ? 'low' : 'high';\r\n  \r\n  finalCtx.drawImage(\r\n    canvas,\r\n    0, 0, canvasWidth, canvasHeight,\r\n    0, 0, finalCanvas.width, finalCanvas.height\r\n  );\r\n  \r\n  // Convert to data URL\r\n  const dataUrl = finalCanvas.toDataURL('image/png');\r\n  \r\n  return {\r\n    dataUrl,\r\n    width: finalCanvas.width,\r\n    height: finalCanvas.height\r\n  };\r\n}\r\n\r\n/**\r\n * Check if a layer has text metadata (is a text layer)\r\n */\r\nexport function isTextLayer(layer: { textContent?: string }): boolean {\r\n  return layer.textContent !== undefined && layer.textContent !== null;\r\n}\r\n\r\n/**\r\n * Check if a layer has shape metadata (is a shape layer)\r\n */\r\nexport function isShapeLayer(layer: { shapeType?: string }): boolean {\r\n  return layer.shapeType !== undefined && layer.shapeType !== null;\r\n}\r\n\r\n","/**\r\n * Zustand store for global application state management\r\n * Handles project data, layers, selection, and UI state\r\n */\r\n\r\nimport { create } from 'zustand';\r\nimport { devtools } from 'zustand/middleware';\r\nimport { \r\n  AppState, \r\n  ProjectData, \r\n  Layer, \r\n  CanvasConfig,\r\n  ViewportState,\r\n  ProjectMetadata,\r\n  HistoryState,\r\n  UIState\r\n} from '../types/compositor.types';\r\nimport { blobToDataUrl, dataUrlToBlob, compositeLayersToBlob } from '../utils/imageProcessing';\r\nimport { rasterizeText } from '../utils/textRasterizer';\r\n\r\n// Default project configuration\r\nconst DEFAULT_PROJECT_DATA: ProjectData = {\r\n  version: '1.0.0',\r\n  projectName: 'Untitled',\r\n  created: new Date().toISOString(),\r\n  modified: new Date().toISOString(),\r\n  canvas: {\r\n    width: 3276,\r\n    height: 3276,\r\n    backgroundColor: null, // Transparent by default\r\n    borderColor: '#000000',\r\n    borderWidth: 0,\r\n    borderOpacity: 1,\r\n    borderEnabled: true,\r\n    shadowIntensity: 0.5,\r\n    showCheckeredBackground: false,\r\n    dragInfoEnabled: true,\r\n  },\r\n  viewport: {\r\n    zoom: 100,\r\n    panX: 0,\r\n    panY: 0,\r\n  },\r\n  grid: {\r\n    enabled: false,\r\n    density: 4,\r\n  },\r\n  rulers: {\r\n    enabled: false,\r\n    guides: [],\r\n  },\r\n  layers: [],\r\n  metadata: {\r\n    author: '',\r\n    description: '',\r\n    tags: [],\r\n  },\r\n};\r\n\r\nconst DEFAULT_HISTORY: HistoryState = {\r\n  past: [],\r\n  future: [],\r\n  maxSteps: 50,\r\n};\r\n\r\nconst DEFAULT_UI: UIState = {\r\n  activeTool: 'select',\r\n  showRulers: false,\r\n  showSelectionBorders: true,\r\n  showSelectionTools: true,\r\n  selectionBorderAnimationSpeed: 0.1,\r\n  clipboardLayers: [],\r\n  isDraggingLayer: false,\r\n  dragLayerId: null,\r\n  dragStartX: 0,\r\n  dragStartY: 0,\r\n  dragOffsetX: 0,\r\n  dragOffsetY: 0,\r\n};\r\n\r\ninterface CompositorStore extends AppState {\r\n  // Project operations\r\n  setProjectName: (name: string) => void;\r\n  setCanvasConfig: (config: Partial<CanvasConfig>) => void;\r\n  setViewport: (viewport: Partial<ViewportState>) => void;\r\n  setProjectMetadata: (metadata: Partial<ProjectMetadata>) => void;\r\n\r\n  // Layer operations\r\n  addLayer: (layer: Omit<Layer, 'id'> & { id?: string }) => void;\r\n  removeLayer: (layerId: string) => void;\r\n  updateLayer: (layerId: string, updates: Partial<Layer>) => void;\r\n  duplicateLayer: (layerId: string) => void;\r\n  moveLayer: (layerId: string, deltaX: number, deltaY: number) => void;\r\n  reorderLayer: (layerId: string, direction: 'up' | 'down') => void;\r\n  reorderSelectedLayers: (direction: 'up' | 'down') => void;\r\n  bringLayerToFront: (layerId: string) => void;\r\n  sendLayerToBack: (layerId: string) => void;\r\n\r\n  // Multi-layer operations\r\n  selectLayer: (layerId: string, multiSelect?: boolean) => void;\r\n  selectAllLayers: () => void;\r\n  deselectAllLayers: () => void;\r\n  selectLayerRange: (fromId: string, toId: string) => void;\r\n  moveSelectedLayers: (deltaX: number, deltaY: number) => void;\r\n  deleteSelectedLayers: () => void;\r\n  toggleVisibilitySelected: () => void;\r\n\r\n  // Drag operations\r\n  startDraggingLayer: (layerId: string, startX: number, startY: number) => void;\r\n  updateDragPosition: (currentX: number, currentY: number) => void;\r\n  stopDraggingLayer: () => void;\r\n\r\n  // History operations\r\n  pushHistory: () => void;\r\n  undo: () => void;\r\n  redo: () => void;\r\n\r\n  // UI operations\r\n  setActiveTool: (tool: 'select' | 'pan' | 'zoom') => void;\r\n  toggleGrid: () => void;\r\n  setGridDensity: (density: number) => void;\r\n  toggleRulers: () => void;\r\n  toggleSelectionBorders: () => void;\r\n  toggleSelectionTools: () => void;\r\n  setSelectionBorderAnimationSpeed: (speed: number) => void;\r\n  copySelectedLayers: () => void;\r\n  copySelectedLayersToClipboard: () => Promise<void>;\r\n  pasteSelectedLayers: () => void;\r\n  pasteFromClipboard: () => Promise<void>;\r\n\r\n  // Canvas operations\r\n  cropCanvasToLayers: () => void;\r\n\r\n  // File operations\r\n  resetProject: () => void;\r\n  loadProject: (projectData: ProjectData) => void;\r\n  markDirty: () => void;\r\n  markClean: () => void;\r\n}\r\n\r\nconst useCompositorStore = create<CompositorStore>()(\r\n  devtools(\r\n    (set) => ({\r\n      // Initial state\r\n      project: DEFAULT_PROJECT_DATA,\r\n      selectedLayerIds: [],\r\n      isDirty: false,\r\n      history: DEFAULT_HISTORY,\r\n      ui: DEFAULT_UI,\r\n\r\n      // Project operations\r\n      setProjectName: (name: string) => {\r\n        set((state) => ({\r\n          project: {\r\n            ...state.project,\r\n            projectName: name,\r\n            modified: new Date().toISOString(),\r\n          },\r\n          isDirty: true,\r\n        }));\r\n      },\r\n\r\n      setCanvasConfig: (config: Partial<CanvasConfig>) => {\r\n        set((state) => ({\r\n          project: {\r\n            ...state.project,\r\n            canvas: {\r\n              ...state.project.canvas,\r\n              ...config,\r\n            },\r\n            modified: new Date().toISOString(),\r\n          },\r\n          isDirty: true,\r\n        }));\r\n      },\r\n\r\n      setViewport: (viewport: Partial<ViewportState>) => {\r\n        set((state) => ({\r\n          project: {\r\n            ...state.project,\r\n            viewport: {\r\n              ...state.project.viewport,\r\n              ...viewport,\r\n            },\r\n          },\r\n          // Note: NOT marking isDirty or affecting history - viewport is UI state, not project state\r\n        }));\r\n      },\r\n\r\n      setProjectMetadata: (metadata: Partial<ProjectMetadata>) => {\r\n        set((state) => ({\r\n          project: {\r\n            ...state.project,\r\n            metadata: {\r\n              ...state.project.metadata,\r\n              ...metadata,\r\n            },\r\n            modified: new Date().toISOString(),\r\n          },\r\n          isDirty: true,\r\n        }));\r\n      },\r\n\r\n      // Layer operations\r\n      addLayer: (layer: Omit<Layer, 'id'> & { id?: string }) => {\r\n        const newId = layer.id || `layer_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n        set((state) => {\r\n          const isFirstLayer = state.project.layers.length === 0;\r\n          return {\r\n            project: {\r\n              ...state.project,\r\n              layers: [\r\n                ...state.project.layers,\r\n                {\r\n                  ...layer,\r\n                  id: newId,\r\n                },\r\n              ],\r\n              modified: new Date().toISOString(),\r\n            },\r\n            isDirty: true,\r\n            // Auto-select if it's the first layer\r\n            ...(isFirstLayer ? { selectedLayerIds: [newId] } : {}),\r\n          };\r\n        });\r\n      },\r\n\r\n      removeLayer: (layerId: string) => {\r\n        set((state) => ({\r\n          project: {\r\n            ...state.project,\r\n            layers: state.project.layers.filter((l) => l.id !== layerId),\r\n            modified: new Date().toISOString(),\r\n          },\r\n          selectedLayerIds: state.selectedLayerIds.filter((id) => id !== layerId),\r\n          isDirty: true,\r\n        }));\r\n      },\r\n\r\n      updateLayer: (layerId: string, updates: Partial<Layer>) => {\r\n        set((state) => ({\r\n          project: {\r\n            ...state.project,\r\n            layers: state.project.layers.map((layer) =>\r\n              layer.id === layerId\r\n                ? {\r\n                    ...layer,\r\n                    ...updates,\r\n                  }\r\n                : layer\r\n            ),\r\n            modified: new Date().toISOString(),\r\n          },\r\n          isDirty: true,\r\n        }));\r\n      },\r\n\r\n      duplicateLayer: (layerId: string) => {\r\n        set((state) => {\r\n          const layerToClone = state.project.layers.find((l) => l.id === layerId);\r\n          if (!layerToClone) return state;\r\n\r\n          const newLayer: Layer = {\r\n            ...layerToClone,\r\n            id: `layer_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n            name: `${layerToClone.name} (copy)`,\r\n            zIndex: Math.max(...state.project.layers.map((l) => l.zIndex), 0) + 1,\r\n          };\r\n\r\n          return {\r\n            project: {\r\n              ...state.project,\r\n              layers: [...state.project.layers, newLayer],\r\n              modified: new Date().toISOString(),\r\n            },\r\n            isDirty: true,\r\n          };\r\n        });\r\n      },\r\n\r\n      moveLayer: (layerId: string, deltaX: number, deltaY: number) => {\r\n        set((state) => {\r\n          const currentState = useCompositorStore.getState();\r\n          const newPast = [...currentState.history.past, currentState.project];\r\n          if (newPast.length > currentState.history.maxSteps) {\r\n            newPast.shift();\r\n          }\r\n\r\n          return {\r\n            project: {\r\n              ...state.project,\r\n              layers: state.project.layers.map((layer) => {\r\n                if (layer.id === layerId && !layer.locked) {\r\n                  const newX = Math.floor(layer.x + deltaX);\r\n                  const newY = Math.floor(layer.y + deltaY);\r\n\r\n                  return { ...layer, x: newX, y: newY };\r\n                }\r\n                return layer;\r\n              }),\r\n              modified: new Date().toISOString(),\r\n            },\r\n            history: {\r\n              ...currentState.history,\r\n              past: newPast,\r\n              future: [],\r\n            },\r\n            isDirty: true,\r\n          };\r\n        });\r\n      },\r\n\r\n      reorderLayer: (layerId: string, direction: 'up' | 'down') => {\r\n        set((state) => {\r\n          const currentZIndex = state.project.layers.find((l) => l.id === layerId)?.zIndex;\r\n          if (currentZIndex === undefined) return state;\r\n\r\n          const zIndices = state.project.layers.map((l) => l.zIndex).sort((a, b) => a - b);\r\n          const currentPos = zIndices.indexOf(currentZIndex);\r\n\r\n          if (\r\n            (direction === 'up' && currentPos === zIndices.length - 1) ||\r\n            (direction === 'down' && currentPos === 0)\r\n          ) {\r\n            return state;\r\n          }\r\n\r\n          const newZIndex =\r\n            direction === 'up' ? zIndices[currentPos + 1] : zIndices[currentPos - 1];\r\n          const otherLayerId = state.project.layers.find((l) => l.zIndex === newZIndex)?.id;\r\n\r\n          if (!otherLayerId) return state;\r\n\r\n          return {\r\n            project: {\r\n              ...state.project,\r\n              layers: state.project.layers.map((layer) => {\r\n                if (layer.id === layerId) return { ...layer, zIndex: newZIndex };\r\n                if (layer.id === otherLayerId) return { ...layer, zIndex: currentZIndex };\r\n                return layer;\r\n              }),\r\n              modified: new Date().toISOString(),\r\n            },\r\n            isDirty: true,\r\n          };\r\n        });\r\n      },\r\n\r\n      reorderSelectedLayers: (direction: 'up' | 'down') => {\r\n        set((state) => {\r\n          if (state.selectedLayerIds.length === 0) return state;\r\n\r\n          const zIndices = state.project.layers.map((l) => l.zIndex).sort((a, b) => a - b);\r\n          const selectedZIndices = state.project.layers\r\n            .filter((l) => state.selectedLayerIds.includes(l.id))\r\n            .map((l) => l.zIndex)\r\n            .sort((a, b) => a - b);\r\n\r\n          // Check if we can move in this direction\r\n          const minSelectedZ = Math.min(...selectedZIndices);\r\n          const maxSelectedZ = Math.max(...selectedZIndices);\r\n\r\n          if (direction === 'up' && maxSelectedZ === zIndices[zIndices.length - 1]) return state;\r\n          if (direction === 'down' && minSelectedZ === zIndices[0]) return state;\r\n\r\n          // Find the target z-index to swap with\r\n          if (direction === 'up') {\r\n            const targetZIndex = zIndices.find((z) => z > maxSelectedZ);\r\n            if (targetZIndex === undefined) return state;\r\n\r\n            return {\r\n              project: {\r\n                ...state.project,\r\n                layers: state.project.layers.map((layer) => {\r\n                  if (state.selectedLayerIds.includes(layer.id)) {\r\n                    return { ...layer, zIndex: targetZIndex };\r\n                  }\r\n                  if (layer.zIndex === targetZIndex) {\r\n                    return { ...layer, zIndex: maxSelectedZ };\r\n                  }\r\n                  return layer;\r\n                }),\r\n                modified: new Date().toISOString(),\r\n              },\r\n              isDirty: true,\r\n            };\r\n          } else {\r\n            const targetZIndex = [...zIndices].reverse().find((z) => z < minSelectedZ);\r\n            if (targetZIndex === undefined) return state;\r\n\r\n            return {\r\n              project: {\r\n                ...state.project,\r\n                layers: state.project.layers.map((layer) => {\r\n                  if (state.selectedLayerIds.includes(layer.id)) {\r\n                    return { ...layer, zIndex: targetZIndex };\r\n                  }\r\n                  if (layer.zIndex === targetZIndex) {\r\n                    return { ...layer, zIndex: minSelectedZ };\r\n                  }\r\n                  return layer;\r\n                }),\r\n                modified: new Date().toISOString(),\r\n              },\r\n              isDirty: true,\r\n            };\r\n          }\r\n        });\r\n      },\r\n\r\n      bringLayerToFront: (layerId: string) => {\r\n        set((state) => {\r\n          const maxZIndex = Math.max(...state.project.layers.map((l) => l.zIndex), 0);\r\n          return {\r\n            project: {\r\n              ...state.project,\r\n              layers: state.project.layers.map((layer) =>\r\n                layer.id === layerId ? { ...layer, zIndex: maxZIndex + 1 } : layer\r\n              ),\r\n              modified: new Date().toISOString(),\r\n            },\r\n            isDirty: true,\r\n          };\r\n        });\r\n      },\r\n\r\n      sendLayerToBack: (layerId: string) => {\r\n        set((state) => {\r\n          const minZIndex = Math.min(...state.project.layers.map((l) => l.zIndex), 0);\r\n          return {\r\n            project: {\r\n              ...state.project,\r\n              layers: state.project.layers.map((layer) =>\r\n                layer.id === layerId ? { ...layer, zIndex: minZIndex - 1 } : layer\r\n              ),\r\n              modified: new Date().toISOString(),\r\n            },\r\n            isDirty: true,\r\n          };\r\n        });\r\n      },\r\n\r\n      // Multi-layer operations\r\n      selectLayer: (layerId: string, multiSelect: boolean = false) => {\r\n        set((state) => {\r\n          if (multiSelect) {\r\n            return {\r\n              selectedLayerIds: state.selectedLayerIds.includes(layerId)\r\n                ? state.selectedLayerIds.filter((id) => id !== layerId)\r\n                : [...state.selectedLayerIds, layerId],\r\n            };\r\n          }\r\n          return { selectedLayerIds: [layerId] };\r\n        });\r\n      },\r\n\r\n      selectAllLayers: () => {\r\n        set((state) => ({\r\n          selectedLayerIds: state.project.layers.map((l) => l.id),\r\n        }));\r\n      },\r\n\r\n      deselectAllLayers: () => {\r\n        set({ selectedLayerIds: [] });\r\n      },\r\n\r\n      selectLayerRange: (fromId: string, toId: string) => {\r\n        set((state) => {\r\n          const layerIds = state.project.layers.map((l) => l.id);\r\n          const fromIndex = layerIds.indexOf(fromId);\r\n          const toIndex = layerIds.indexOf(toId);\r\n\r\n          if (fromIndex === -1 || toIndex === -1) return state;\r\n\r\n          const [start, end] = fromIndex < toIndex ? [fromIndex, toIndex] : [toIndex, fromIndex];\r\n          const selectedLayerIds = layerIds.slice(start, end + 1);\r\n\r\n          return { selectedLayerIds };\r\n        });\r\n      },\r\n\r\n      moveSelectedLayers: (deltaX: number, deltaY: number) => {\r\n        set((state) => ({\r\n          project: {\r\n            ...state.project,\r\n            layers: state.project.layers.map((layer) => {\r\n              if (state.selectedLayerIds.includes(layer.id) && !layer.locked) {\r\n                const newX = Math.floor(layer.x + deltaX);\r\n                const newY = Math.floor(layer.y + deltaY);\r\n\r\n                return { ...layer, x: newX, y: newY };\r\n              }\r\n              return layer;\r\n            }),\r\n            modified: new Date().toISOString(),\r\n          },\r\n          isDirty: true,\r\n        }));\r\n      },\r\n\r\n      deleteSelectedLayers: () => {\r\n        set((state) => ({\r\n          project: {\r\n            ...state.project,\r\n            layers: state.project.layers.filter(\r\n              (l) => !state.selectedLayerIds.includes(l.id)\r\n            ),\r\n            modified: new Date().toISOString(),\r\n          },\r\n          selectedLayerIds: [],\r\n          isDirty: true,\r\n        }));\r\n      },\r\n\r\n      toggleVisibilitySelected: () => {\r\n        set((state) => {\r\n          const allVisible = state.selectedLayerIds.every((id) =>\r\n            state.project.layers.find((l) => l.id === id)?.visible\r\n          );\r\n\r\n          return {\r\n            project: {\r\n              ...state.project,\r\n              layers: state.project.layers.map((layer) =>\r\n                state.selectedLayerIds.includes(layer.id)\r\n                  ? { ...layer, visible: !allVisible }\r\n                  : layer\r\n              ),\r\n              modified: new Date().toISOString(),\r\n            },\r\n            isDirty: true,\r\n          };\r\n        });\r\n      },\r\n\r\n      // Drag operations\r\n      startDraggingLayer: (layerId: string, startX: number, startY: number) => {\r\n        set((state) => ({\r\n          ui: {\r\n            ...state.ui,\r\n            isDraggingLayer: true,\r\n            dragLayerId: layerId,\r\n            dragStartX: startX,\r\n            dragStartY: startY,\r\n          },\r\n        }));\r\n      },\r\n\r\n      updateDragPosition: (currentX: number, currentY: number) => {\r\n        set((state) => {\r\n          if (!state.ui.isDraggingLayer) return state;\r\n\r\n          // Calculate offset from original drag start\r\n          let offsetX = currentX - state.ui.dragStartX;\r\n          let offsetY = currentY - state.ui.dragStartY;\r\n\r\n          // Snap to integer pixels for pixel-perfect rendering (no sub-pixel smearing)\r\n          offsetX = Math.round(offsetX);\r\n          offsetY = Math.round(offsetY);\r\n\r\n          // Only update UI state - don't modify project.layers during drag\r\n          // This prevents multiple history entries from rapid mouse movements\r\n          return {\r\n            ui: {\r\n              ...state.ui,\r\n              dragOffsetX: offsetX,\r\n              dragOffsetY: offsetY,\r\n            },\r\n          };\r\n        });\r\n      },\r\n\r\n      stopDraggingLayer: () => {\r\n        set((state) => {\r\n          if (!state.ui.isDraggingLayer || !state.ui.dragLayerId) return state;\r\n\r\n          // Get the layers to move\r\n          const layersToMove = state.selectedLayerIds.includes(state.ui.dragLayerId)\r\n            ? state.selectedLayerIds\r\n            : [state.ui.dragLayerId];\r\n\r\n          // Apply the accumulated drag offset to project layers\r\n          const offsetX = state.ui.dragOffsetX;\r\n          const offsetY = state.ui.dragOffsetY;\r\n\r\n          // Only push history if layers actually moved\r\n          const layersActuallyMoved = offsetX !== 0 || offsetY !== 0;\r\n\r\n          const newProject = {\r\n            ...state.project,\r\n            layers: state.project.layers.map((layer) => {\r\n              if (layersToMove.includes(layer.id) && !layer.locked) {\r\n                return {\r\n                  ...layer,\r\n                  x: Math.floor(layer.x + offsetX),\r\n                  y: Math.floor(layer.y + offsetY),\r\n                };\r\n              }\r\n              return layer;\r\n            }),\r\n            modified: new Date().toISOString(),\r\n          };\r\n\r\n          const newState = {\r\n            project: newProject,\r\n            ui: {\r\n              ...state.ui,\r\n              isDraggingLayer: false,\r\n              dragLayerId: null,\r\n              dragOffsetX: 0,\r\n              dragOffsetY: 0,\r\n            },\r\n            isDirty: true,\r\n          };\r\n\r\n          // Push history exactly once if layers moved\r\n          if (layersActuallyMoved) {\r\n            const currentState = useCompositorStore.getState();\r\n            const { viewport, ...projectWithoutViewport } = currentState.project;\r\n            const newPast = [...currentState.history.past, projectWithoutViewport as ProjectData];\r\n            if (newPast.length > currentState.history.maxSteps) {\r\n              newPast.shift();\r\n            }\r\n\r\n            return {\r\n              ...newState,\r\n              history: {\r\n                ...currentState.history,\r\n                past: newPast,\r\n                future: [],\r\n              },\r\n              _lastHistoryPushAt: Date.now(), // Prevent useAutoHistory from pushing after drag\r\n            };\r\n          }\r\n\r\n          return newState;\r\n        });\r\n      },\r\n\r\n      // History operations\r\n      pushHistory: () => {\r\n        set((state) => {\r\n          // Store project WITHOUT viewport - we'll preserve the current viewport during undo\r\n          const { viewport, ...projectWithoutViewport } = state.project;\r\n          const newPast = [...state.history.past, projectWithoutViewport as ProjectData];\r\n          if (newPast.length > state.history.maxSteps) {\r\n            newPast.shift();\r\n          }\r\n\r\n          return {\r\n            history: {\r\n              ...state.history,\r\n              past: newPast,\r\n              future: [],\r\n            },\r\n            _lastHistoryPushAt: Date.now(), // Mark when history was manually pushed\r\n          };\r\n        });\r\n      },\r\n\r\n      undo: () => {\r\n        set((state) => {\r\n          if (state.history.past.length === 0) return state;\r\n\r\n          const newPast = [...state.history.past];\r\n          const previousProject = newPast.pop();\r\n          \r\n          if (!previousProject) return state;\r\n\r\n          // Add current project to future, but strip viewport like we do in pushHistory\r\n          const { viewport, ...projectWithoutViewport } = state.project;\r\n          const newFuture = [projectWithoutViewport as ProjectData, ...state.history.future];\r\n\r\n          return {\r\n            project: {\r\n              ...previousProject,\r\n              viewport: state.project.viewport, // Preserve current viewport\r\n            },\r\n            history: {\r\n              ...state.history,\r\n              past: newPast,\r\n              future: newFuture,\r\n            },\r\n            _lastHistoryPushAt: Date.now(), // Prevent useAutoHistory from pushing during undo\r\n          };\r\n        });\r\n      },\r\n\r\n      redo: () => {\r\n        set((state) => {\r\n          if (state.history.future.length === 0) return state;\r\n\r\n          const newFuture = [...state.history.future];\r\n          const nextProject = newFuture.shift();\r\n          \r\n          // Add current project to past, but strip viewport like we do in pushHistory\r\n          const { viewport, ...projectWithoutViewport } = state.project;\r\n          const newPast = [...state.history.past, projectWithoutViewport as ProjectData];\r\n\r\n          if (!nextProject) return state;\r\n\r\n          return {\r\n            project: {\r\n              ...nextProject,\r\n              viewport: state.project.viewport, // Preserve current viewport\r\n            },\r\n            history: {\r\n              ...state.history,\r\n              past: newPast,\r\n              future: newFuture,\r\n            },\r\n            _lastHistoryPushAt: Date.now(), // Prevent useAutoHistory from pushing during redo\r\n          };\r\n        });\r\n      },\r\n\r\n      // UI operations\r\n      setActiveTool: (tool: 'select' | 'pan' | 'zoom') => {\r\n        set((state) => ({\r\n          ui: {\r\n            ...state.ui,\r\n            activeTool: tool,\r\n          },\r\n        }));\r\n      },\r\n\r\n      toggleGrid: () => {\r\n        set((state) => ({\r\n          project: {\r\n            ...state.project,\r\n            grid: {\r\n              ...state.project.grid,\r\n              enabled: !state.project.grid.enabled,\r\n            },\r\n            modified: new Date().toISOString(),\r\n          },\r\n          isDirty: true,\r\n        }));\r\n      },\r\n\r\n      setGridDensity: (density: number) => {\r\n        set((state) => ({\r\n          project: {\r\n            ...state.project,\r\n            grid: {\r\n              ...state.project.grid,\r\n              density: Math.max(1, Math.min(8, density)),\r\n            },\r\n            modified: new Date().toISOString(),\r\n          },\r\n          isDirty: true,\r\n        }));\r\n      },\r\n\r\n      toggleRulers: () => {\r\n        set((state) => ({\r\n          project: {\r\n            ...state.project,\r\n            rulers: {\r\n              ...state.project.rulers,\r\n              enabled: !state.project.rulers.enabled,\r\n            },\r\n            modified: new Date().toISOString(),\r\n          },\r\n          isDirty: true,\r\n        }));\r\n      },\r\n\r\n      toggleSelectionBorders: () => {\r\n        set((state) => ({\r\n          ui: {\r\n            ...state.ui,\r\n            showSelectionBorders: !state.ui.showSelectionBorders,\r\n          },\r\n        }));\r\n      },\r\n\r\n      toggleSelectionTools: () => {\r\n        set((state) => ({\r\n          ui: {\r\n            ...state.ui,\r\n            showSelectionTools: !state.ui.showSelectionTools,\r\n          },\r\n        }));\r\n      },\r\n\r\n      setSelectionBorderAnimationSpeed: (speed: number) => {\r\n        set((state) => ({\r\n          ui: {\r\n            ...state.ui,\r\n            selectionBorderAnimationSpeed: Math.max(0, Math.min(1, speed)),\r\n          },\r\n        }));\r\n      },\r\n\r\n      copySelectedLayers: () => {\r\n        set((state) => ({\r\n          ui: {\r\n            ...state.ui,\r\n            clipboardLayers: state.project.layers.filter((l) =>\r\n              state.selectedLayerIds.includes(l.id)\r\n            ),\r\n          },\r\n        }));\r\n      },\r\n\r\n      copySelectedLayersToClipboard: async () => {\r\n        try {\r\n          const state = useCompositorStore.getState();\r\n          const selectedLayers = state.project.layers.filter((l) =>\r\n            state.selectedLayerIds.includes(l.id)\r\n          );\r\n\r\n          if (selectedLayers.length === 0) {\r\n            console.warn('No layers selected to copy');\r\n            return;\r\n          }\r\n\r\n          let blob: Blob;\r\n\r\n          if (selectedLayers.length === 1) {\r\n            // Single layer: copy directly\r\n            blob = dataUrlToBlob(selectedLayers[0].imageData);\r\n          } else {\r\n            // Multiple layers: composite them together\r\n            // Sort by zIndex to maintain layer order\r\n            const sortedLayers = selectedLayers.sort((a, b) => a.zIndex - b.zIndex);\r\n            blob = await compositeLayersToBlob(sortedLayers);\r\n          }\r\n\r\n          // Write to system clipboard\r\n          const clipboardItem = new ClipboardItem({ 'image/png': blob });\r\n          await navigator.clipboard.write([clipboardItem]);\r\n        } catch (error) {\r\n          console.error('Failed to copy layers to clipboard:', error);\r\n        }\r\n      },\r\n\r\n      pasteSelectedLayers: () => {\r\n        set((state) => {\r\n          const maxZIndex = Math.max(...state.project.layers.map((l) => l.zIndex), 0);\r\n\r\n          const pastedLayers: Layer[] = state.ui.clipboardLayers.map((layer, index) => ({\r\n            ...layer,\r\n            id: `layer_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n            x: layer.x + 10, // Offset to show pasted layers\r\n            y: layer.y + 10,\r\n            zIndex: maxZIndex + index + 1,\r\n          }));\r\n\r\n          return {\r\n            project: {\r\n              ...state.project,\r\n              layers: [...state.project.layers, ...pastedLayers],\r\n              modified: new Date().toISOString(),\r\n            },\r\n            selectedLayerIds: pastedLayers.map((l) => l.id),\r\n            isDirty: true,\r\n          };\r\n        });\r\n      },\r\n\r\n      pasteFromClipboard: async () => {\r\n        try {\r\n          // Try Clipboard API first (for modern browsers)\r\n          if (navigator.clipboard) {\r\n            try {\r\n              // Try to read image from clipboard\r\n              const clipboardItems = await navigator.clipboard.read();\r\n              \r\n              for (const item of clipboardItems) {\r\n                // Check for image types\r\n                const imageTypes = Array.from(item.types).filter((type) =>\r\n                  type.startsWith('image/')\r\n                );\r\n\r\n                if (imageTypes.length > 0) {\r\n                  // Handle image paste\r\n                  const imageType = imageTypes[0];\r\n                  const blob = await item.getType(imageType);\r\n                  const dataUrl = await blobToDataUrl(blob);\r\n\r\n                  // Get image dimensions\r\n                  const img = new Image();\r\n                  img.src = dataUrl;\r\n\r\n                  await new Promise<void>((resolve, reject) => {\r\n                    img.onload = () => resolve();\r\n                    img.onerror = () => reject(new Error('Failed to load image'));\r\n                  });\r\n\r\n                  const state = useCompositorStore.getState();\r\n                  const maxZIndex = Math.max(...state.project.layers.map((l) => l.zIndex), 0);\r\n\r\n                  useCompositorStore.setState((prevState) => ({\r\n                    project: {\r\n                      ...prevState.project,\r\n                      layers: [\r\n                        ...prevState.project.layers,\r\n                        {\r\n                          id: `layer_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n                          name: 'Pasted Image',\r\n                          imageData: dataUrl,\r\n                          x: 0,\r\n                          y: 0,\r\n                          zIndex: maxZIndex + 1,\r\n                          visible: true,\r\n                          locked: false,\r\n                          opacity: 1.0,\r\n                          width: img.naturalWidth,\r\n                          height: img.naturalHeight,\r\n                        },\r\n                      ],\r\n                      modified: new Date().toISOString(),\r\n                    },\r\n                    isDirty: true,\r\n                  }));\r\n                  return;\r\n                }\r\n              }\r\n\r\n              // Fall through to text reading if no image found\r\n            } catch (error) {\r\n              // Image reading failed, try text\r\n              console.debug('Image paste failed, trying text paste:', error);\r\n            }\r\n\r\n            // Try to read text from clipboard\r\n            try {\r\n              const text = await navigator.clipboard.readText();\r\n              if (text.trim()) {\r\n                // Create text layer\r\n                const rasterized = await rasterizeText({\r\n                  text,\r\n                  fontSize: 16,\r\n                  fontFamily: 'Arial',\r\n                  color: '#000000',\r\n                  textAlign: 'left',\r\n                  lineHeight: 1.2,\r\n                });\r\n\r\n                const state = useCompositorStore.getState();\r\n                const maxZIndex = Math.max(...state.project.layers.map((l) => l.zIndex), 0);\r\n\r\n                useCompositorStore.setState((prevState) => ({\r\n                  project: {\r\n                    ...prevState.project,\r\n                    layers: [\r\n                      ...prevState.project.layers,\r\n                      {\r\n                        id: `layer_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n                        name: `Text: ${text.substring(0, 20)}${text.length > 20 ? '...' : ''}`,\r\n                        imageData: rasterized.dataUrl,\r\n                        x: 0,\r\n                        y: 0,\r\n                        zIndex: maxZIndex + 1,\r\n                        visible: true,\r\n                        locked: false,\r\n                        opacity: 1.0,\r\n                        width: rasterized.width,\r\n                        height: rasterized.height,\r\n                        textContent: text,\r\n                        fontSize: 16,\r\n                        fontFamily: 'Arial',\r\n                        fontColor: '#000000',\r\n                        textAlign: 'left',\r\n                        lineHeight: 1.2,\r\n                      },\r\n                    ],\r\n                    modified: new Date().toISOString(),\r\n                  },\r\n                  isDirty: true,\r\n                }));\r\n              }\r\n            } catch (error) {\r\n              console.debug('Text paste failed:', error);\r\n            }\r\n          }\r\n        } catch (error) {\r\n          console.error('Clipboard paste error:', error);\r\n        }\r\n      },\r\n\r\n      // Canvas operations\r\n      cropCanvasToLayers: () => {\r\n        set((state) => {\r\n          if (state.project.layers.length === 0) {\r\n            console.warn('[DEBUG] No layers to crop to');\r\n            return state;\r\n          }\r\n\r\n          // Calculate the bounding box of all layers\r\n          let minX = Infinity;\r\n          let minY = Infinity;\r\n          let maxX = -Infinity;\r\n          let maxY = -Infinity;\r\n\r\n          state.project.layers.forEach((layer) => {\r\n            minX = Math.min(minX, layer.x);\r\n            minY = Math.min(minY, layer.y);\r\n            maxX = Math.max(maxX, layer.x + layer.width);\r\n            maxY = Math.max(maxY, layer.y + layer.height);\r\n          });\r\n\r\n          const newWidth = Math.ceil(maxX - minX);\r\n          const newHeight = Math.ceil(maxY - minY);\r\n          const offsetX = minX;\r\n          const offsetY = minY;\r\n\r\n          // If no layers or dimensions are invalid, don't change canvas\r\n          if (newWidth <= 0 || newHeight <= 0) {\r\n            console.warn('[DEBUG] Invalid bounds for crop');\r\n            return state;\r\n          }\r\n\r\n          console.log(\r\n            `[DEBUG] Cropping canvas to layers: ${newWidth}x${newHeight} at offset (${offsetX}, ${offsetY})`\r\n          );\r\n\r\n          // Update canvas dimensions and reposition layers\r\n          const updatedLayers = state.project.layers.map((layer) => ({\r\n            ...layer,\r\n            x: layer.x - offsetX,\r\n            y: layer.y - offsetY,\r\n          }));\r\n\r\n          return {\r\n            project: {\r\n              ...state.project,\r\n              canvas: {\r\n                ...state.project.canvas,\r\n                width: newWidth,\r\n                height: newHeight,\r\n              },\r\n              layers: updatedLayers,\r\n              modified: new Date().toISOString(),\r\n            },\r\n            isDirty: true,\r\n          };\r\n        });\r\n      },\r\n\r\n      // File operations\r\n      resetProject: () => {\r\n        set({\r\n          project: DEFAULT_PROJECT_DATA,\r\n          selectedLayerIds: [],\r\n          isDirty: false,\r\n          history: DEFAULT_HISTORY,\r\n          ui: DEFAULT_UI,\r\n        });\r\n      },\r\n\r\n      loadProject: (projectData: ProjectData) => {\r\n        // Filter out preview layers before loading\r\n        const filteredProject = {\r\n          ...projectData,\r\n          layers: projectData.layers.filter(\r\n            l => l.id !== '__text_canvas_preview__' && l.id !== '__shape_canvas_preview__'\r\n          )\r\n        };\r\n        set({\r\n          project: filteredProject,\r\n          selectedLayerIds: [],\r\n          isDirty: false,\r\n          history: DEFAULT_HISTORY,\r\n          ui: DEFAULT_UI,\r\n        });\r\n      },\r\n\r\n      markDirty: () => {\r\n        set({ isDirty: true });\r\n      },\r\n\r\n      markClean: () => {\r\n        set({ isDirty: false });\r\n      },\r\n    }),\r\n    {\r\n      name: 'CompositorStore',\r\n      enabled: true,\r\n    }\r\n  )\r\n);\r\n\r\nexport default useCompositorStore;\r\n","/**\r\n * Grid overlay component\r\n * Renders a 1-pixel photoshop-style grid overlay\r\n * Grid is rendered in viewport coordinates, not canvas coordinates\r\n */\r\n\r\nimport { useEffect, useRef } from 'react';\r\nimport { ViewportState } from '../../types/compositor.types';\r\n\r\ninterface GridOverlayProps {\r\n  canvas: HTMLCanvasElement | null;\r\n  gridEnabled: boolean;\r\n  viewport: ViewportState;\r\n  canvasWidth: number;\r\n  canvasHeight: number;\r\n  gridDensity: number;\r\n  canvasBorderEnabled: boolean;\r\n}\r\n\r\nfunction GridOverlay({ canvas, gridEnabled, viewport, canvasWidth, canvasHeight, gridDensity, canvasBorderEnabled }: GridOverlayProps) {\r\n  const gridCanvasRef = useRef<HTMLCanvasElement>(null);\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n  useEffect(() => {\r\n    if (!gridCanvasRef.current || !canvas || !containerRef.current) {\r\n      return;\r\n    }\r\n\r\n    const gridCanvas = gridCanvasRef.current;\r\n    const ctx = gridCanvas.getContext('2d');\r\n    if (!ctx) return;\r\n\r\n    // Grid renders at all zoom levels with opacity fade\r\n    // At 200% and above: full opacity (100%)\r\n    // At 100%: 50% opacity\r\n    // At 50%: 0% opacity (invisible)\r\n    // Below 50%: hidden\r\n    const minZoomForVisibility = 50;\r\n\r\n    // Only draw if enabled and zoom is at least 50%\r\n    if (!gridEnabled || viewport.zoom < minZoomForVisibility) {\r\n      ctx.clearRect(0, 0, gridCanvas.width, gridCanvas.height);\r\n      return;\r\n    }\r\n\r\n    const zoom = viewport.zoom / 100;\r\n    \r\n    // Set canvas to match visible viewport\r\n    gridCanvas.width = containerRef.current.clientWidth;\r\n    gridCanvas.height = containerRef.current.clientHeight;\r\n\r\n    ctx.clearRect(0, 0, gridCanvas.width, gridCanvas.height);\r\n\r\n    // Calculate opacity based on zoom level\r\n    // Keep opacity lower at medium-high zoom to prevent darkening\r\n    // 50% zoom = 0% opacity (invisible)\r\n    // 100% zoom = 30% opacity\r\n    // 200%+ zoom = 40% opacity (not 100% to keep it lighter)\r\n    let opacity = 0;\r\n    if (viewport.zoom <= minZoomForVisibility) {\r\n      opacity = 0;\r\n    } else if (viewport.zoom < 150) {\r\n      // Linear interpolation from 0% (at 50% zoom) to 30% (at 150% zoom)\r\n      opacity = (viewport.zoom - minZoomForVisibility) / (100) * 0.3;\r\n    } else {\r\n      // Keep at 40% for higher zoom levels (200%+)\r\n      opacity = 0.4;\r\n    }\r\n\r\n    // Dynamically increase effective grid density at low zoom levels to prevent overcrowding\r\n    // This prevents the screen from turning black with dense grids at low zoom\r\n    let effectiveGridDensity = gridDensity;\r\n    \r\n    // At low zoom levels, multiply the grid density to make lines further apart\r\n    if (zoom < 3) {\r\n      // At 300% zoom (3x), use 3x the density\r\n      // At 200% zoom (2x), use 4x the density  \r\n      // At 100% zoom (1x), use 6x the density\r\n      // At 50% zoom (0.5x), use 12x the density\r\n      const densityMultiplier = 9 / (zoom * 3);\r\n      effectiveGridDensity = gridDensity * densityMultiplier;\r\n    }\r\n    \r\n    // Configure grid appearance - pure black lines with calculated opacity\r\n    ctx.strokeStyle = `rgba(0, 0, 0, ${opacity})`;\r\n    ctx.lineWidth = 1;\r\n\r\n    // Get canvas bounds in screen space and set up clipping\r\n    const canvasRect = canvas.getBoundingClientRect();\r\n    const containerRect = containerRef.current.getBoundingClientRect();\r\n    \r\n    // Calculate canvas position relative to grid container\r\n    let canvasScreenX = canvasRect.left - containerRect.left;\r\n    let canvasScreenY = canvasRect.top - containerRect.top;\r\n    let canvasScreenWidth = canvasRect.width;\r\n    let canvasScreenHeight = canvasRect.height;\r\n    \r\n    // Inset clipping region by border width to avoid rendering on the border\r\n    const borderInset = canvasBorderEnabled ? 1 : 0;\r\n    canvasScreenX += borderInset;\r\n    canvasScreenY += borderInset;\r\n    canvasScreenWidth -= borderInset * 2;\r\n    canvasScreenHeight -= borderInset * 2;\r\n    \r\n    // Set up clipping region to only render within canvas bounds (excluding border)\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    ctx.rect(canvasScreenX, canvasScreenY, canvasScreenWidth, canvasScreenHeight);\r\n    ctx.clip();\r\n\r\n    // Derive grid positions directly from the actual canvas element's bounding rect.\r\n    // This is pixel-perfect because it uses the real rendered position and size,\r\n    // rather than trying to reproduce the CSS transform math independently.\r\n    const pixelWidth = canvasScreenWidth / canvasWidth;\r\n    const pixelHeight = canvasScreenHeight / canvasHeight;\r\n\r\n    // Determine visible range in world pixels to avoid drawing off-screen lines\r\n    const visibleStartX = Math.max(0, Math.floor(-canvasScreenX / pixelWidth));\r\n    const visibleEndX = Math.min(canvasWidth, Math.ceil((gridCanvas.width - canvasScreenX) / pixelWidth));\r\n    const visibleStartY = Math.max(0, Math.floor(-canvasScreenY / pixelHeight));\r\n    const visibleEndY = Math.min(canvasHeight, Math.ceil((gridCanvas.height - canvasScreenY) / pixelHeight));\r\n\r\n    // Draw vertical grid lines (every N pixels based on effective density)\r\n    const firstX = Math.ceil(visibleStartX / effectiveGridDensity) * effectiveGridDensity;\r\n    for (let worldX = firstX; worldX <= visibleEndX; worldX += effectiveGridDensity) {\r\n      const screenX = Math.round(canvasScreenX + worldX * pixelWidth) + 0.5;\r\n      ctx.beginPath();\r\n      ctx.moveTo(screenX, canvasScreenY);\r\n      ctx.lineTo(screenX, canvasScreenY + canvasScreenHeight);\r\n      ctx.stroke();\r\n    }\r\n\r\n    // Draw horizontal grid lines (every N pixels based on effective density)\r\n    const firstY = Math.ceil(visibleStartY / effectiveGridDensity) * effectiveGridDensity;\r\n    for (let worldY = firstY; worldY <= visibleEndY; worldY += effectiveGridDensity) {\r\n      const screenY = Math.round(canvasScreenY + worldY * pixelHeight) + 0.5;\r\n      ctx.beginPath();\r\n      ctx.moveTo(canvasScreenX, screenY);\r\n      ctx.lineTo(canvasScreenX + canvasScreenWidth, screenY);\r\n      ctx.stroke();\r\n    }\r\n    \r\n    // Restore context to remove clipping\r\n    ctx.restore();\r\n  }, [gridEnabled, viewport, canvasWidth, canvasHeight, canvas, gridDensity, canvasBorderEnabled]);\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      style={{\r\n        position: 'absolute',\r\n        top: 0,\r\n        left: 0,\r\n        width: '100%',\r\n        height: '100%',\r\n        pointerEvents: 'none',\r\n        overflow: 'hidden',\r\n      }}\r\n    >\r\n      <canvas\r\n        ref={gridCanvasRef}\r\n        style={{\r\n          position: 'absolute',\r\n          top: 0,\r\n          left: 0,\r\n          imageRendering: 'pixelated',\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default GridOverlay;","import React from 'react';\r\n\r\ninterface DragInfoTooltipProps {\r\n  offsetX: number;\r\n  offsetY: number;\r\n  mouseX: number;\r\n  mouseY: number;\r\n}\r\n\r\n/**\r\n * Small tooltip that shows drag translation info\r\n * Follows the mouse cursor while dragging\r\n */\r\nconst DragInfoTooltip: React.FC<DragInfoTooltipProps> = ({\r\n  offsetX,\r\n  offsetY,\r\n  mouseX,\r\n  mouseY,\r\n}) => {\r\n  return (\r\n    <div\r\n      style={{\r\n        position: 'fixed',\r\n        left: `${mouseX + 10}px`,\r\n        top: `${mouseY + 10}px`,\r\n        pointerEvents: 'none',\r\n        zIndex: 1000,\r\n      }}\r\n    >\r\n      <div className=\"bg-panel-bg border border-border rounded px-2 py-1 text-xs text-gray-300 whitespace-nowrap shadow-lg\">\r\n        <div>X: {offsetX > 0 ? '+' : ''}{offsetX}</div>\r\n        <div>Y: {offsetY > 0 ? '+' : ''}{offsetY}</div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DragInfoTooltip;\r\n","/* eslint-disable react-hooks/exhaustive-deps */\r\nimport { useEffect, useRef, useState } from 'react';\r\nimport useCompositorStore from '../../store/compositorStore';\r\nimport GridOverlay from './GridOverlay';\r\nimport DragInfoTooltip from './DragInfoTooltip';\r\n\r\n/**\r\n * Canvas renderer component\r\n * Handles drawing and pixel-perfect rendering\r\n */\r\nfunction CanvasRenderer() {\r\n  const canvasRef = useRef<HTMLCanvasElement>(null);\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n  const project = useCompositorStore((state) => state.project);\r\n  const selectedLayerIds = useCompositorStore((state) => state.selectedLayerIds);\r\n  const showSelectionBorders = useCompositorStore((state) => state.ui.showSelectionBorders);\r\n  const showSelectionTools = useCompositorStore((state) => state.ui.showSelectionTools);\r\n  const borderAnimationSpeed = useCompositorStore((state) => state.ui.selectionBorderAnimationSpeed);\r\n  const isDraggingLayer = useCompositorStore((state) => state.ui.isDraggingLayer);\r\n  const dragLayerId = useCompositorStore((state) => state.ui.dragLayerId);\r\n  const dragOffsetX = useCompositorStore((state) => state.ui.dragOffsetX);\r\n  const dragOffsetY = useCompositorStore((state) => state.ui.dragOffsetY);\r\n  const selectLayer = useCompositorStore((state) => state.selectLayer);\r\n  const deselectAllLayers = useCompositorStore((state) => state.deselectAllLayers);\r\n  const startDraggingLayer = useCompositorStore((state) => state.startDraggingLayer);\r\n  const updateDragPosition = useCompositorStore((state) => state.updateDragPosition);\r\n  const stopDraggingLayer = useCompositorStore((state) => state.stopDraggingLayer);\r\n  const setViewport = useCompositorStore((state) => state.setViewport);\r\n  const removeLayer = useCompositorStore((state) => state.removeLayer);\r\n  const updateLayer = useCompositorStore((state) => state.updateLayer);\r\n\r\n  const [loadedImages, setLoadedImages] = useState<Map<string, HTMLImageElement>>(new Map());\r\n  const [isPanning, setIsPanning] = useState(false);\r\n  const [panStart, setPanStart] = useState({ x: 0, y: 0 });\r\n  const [hoverCoords, setHoverCoords] = useState<{ x: number; y: number } | null>(null);\r\n  const [mousePos, setMousePos] = useState({ x: 0, y: 0 });\r\n\r\n  /**\r\n   * Decode base64 image data and cache it\r\n   */\r\n  useEffect(() => {\r\n    const loadImages = async () => {\r\n      const newImages = new Map<string, HTMLImageElement>();\r\n\r\n      for (const layer of project.layers) {\r\n        if (!loadedImages.has(layer.id) || loadedImages.get(layer.id)?.src !== layer.imageData) {\r\n          try {\r\n            const img = new Image();\r\n            img.src = layer.imageData;\r\n            \r\n            await new Promise<void>((resolve, reject) => {\r\n              img.onload = () => resolve();\r\n              img.onerror = () => reject(new Error(`Failed to load image for layer: ${layer.name}`));\r\n            });\r\n\r\n            newImages.set(layer.id, img);\r\n            // console.log(`[DEBUG] Image loaded for layer: ${layer.name} (${layer.width}x${layer.height})`);\r\n          } catch (error) {\r\n            // console.error(`[DEBUG] Error loading image for layer ${layer.name}:`, error);\r\n          }\r\n        }\r\n      }\r\n\r\n      setLoadedImages((prev) => new Map([...prev, ...newImages]));\r\n    };\r\n\r\n    loadImages();\r\n  }, [project.layers]);\r\n\r\n  /**\r\n   * Initialize viewport to show canvas centered and fit on screen\r\n   */\r\n  useEffect(() => {\r\n    const container = containerRef.current;\r\n    const canvas = canvasRef.current;\r\n    if (!container || !canvas) return;\r\n\r\n    // Only run once on mount - check if viewport is at defaults\r\n    if (project.viewport.zoom !== 100 || project.viewport.panX !== 0 || project.viewport.panY !== 0) {\r\n      return;\r\n    }\r\n\r\n    // Calculate zoom to fit canvas in view\r\n    const containerWidth = container.clientWidth;\r\n    const containerHeight = container.clientHeight;\r\n    \r\n    const canvasWidth = project.canvas.width;\r\n    const canvasHeight = project.canvas.height;\r\n\r\n    // Calculate zoom with some padding (90% of available space)\r\n    const zoomX = (containerWidth / canvasWidth) * 100 * 0.9;\r\n    const zoomY = (containerHeight / canvasHeight) * 100 * 0.9;\r\n    const zoomToFit = Math.min(zoomX, zoomY, 100); // Don't zoom in, max 100%\r\n\r\n    // console.log(`[DEBUG] Initializing viewport - zoom to fit: ${zoomToFit.toFixed(1)}%`);\r\n    setViewport({ zoom: Math.max(zoomToFit, 10) }); // Minimum 10% zoom\r\n  }, []); // Empty deps - only run once on mount\r\n\r\n  /**\r\n   * Render canvas\r\n   * CRITICAL: Must set imageSmoothingEnabled = false for pixel-perfect rendering\r\n   */\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) {\r\n      console.warn('[DEBUG] Canvas element not found');\r\n      return;\r\n    }\r\n\r\n    const ctx = canvas.getContext('2d');\r\n    if (!ctx) {\r\n      console.error('[DEBUG] Failed to get canvas context');\r\n      return;\r\n    }\r\n\r\n    // CRITICAL: Disable image smoothing for pixel-perfect rendering\r\n    ctx.imageSmoothingEnabled = false;\r\n    (ctx as any).webkitImageSmoothingEnabled = false;\r\n    (ctx as any).mozImageSmoothingEnabled = false;\r\n\r\n    // Set canvas size\r\n    canvas.width = project.canvas.width;\r\n    canvas.height = project.canvas.height;\r\n\r\n    // console.log(`[DEBUG] Canvas size set to ${canvas.width}x${canvas.height}`);\r\n\r\n    // Clear canvas\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n    // Fill background color if set\r\n    if (project.canvas.backgroundColor) {\r\n      ctx.fillStyle = project.canvas.backgroundColor;\r\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n      // console.log(`[DEBUG] Background color applied: ${project.canvas.backgroundColor}`);\r\n    }\r\n\r\n    // Draw checkered background for transparency\r\n    if (project.canvas.showCheckeredBackground && !project.canvas.backgroundColor) {\r\n      // Use a fixed pattern size (in pixels) that scales with zoom for consistent appearance\r\n      const patternSize = 8;\r\n      \r\n      // Create an off-screen canvas for the pattern\r\n      const patternCanvas = document.createElement('canvas');\r\n      patternCanvas.width = patternSize * 2;\r\n      patternCanvas.height = patternSize * 2;\r\n      const patternCtx = patternCanvas.getContext('2d');\r\n      \r\n      if (patternCtx) {\r\n        // Draw checkerboard pattern on small canvas\r\n        patternCtx.fillStyle = '#ffffff';\r\n        patternCtx.fillRect(0, 0, patternSize * 2, patternSize * 2);\r\n        patternCtx.fillStyle = '#cccccc';\r\n        patternCtx.fillRect(0, 0, patternSize, patternSize);\r\n        patternCtx.fillRect(patternSize, patternSize, patternSize, patternSize);\r\n        \r\n        // Use the pattern to fill the entire canvas\r\n        const pattern = ctx.createPattern(patternCanvas, 'repeat');\r\n        if (pattern) {\r\n          ctx.fillStyle = pattern;\r\n          ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n        }\r\n      }\r\n    }\r\n\r\n    // Draw canvas border (expands outward from canvas edge)\r\n    if (project.canvas.borderWidth && project.canvas.borderWidth > 0) {\r\n      const borderWidth = project.canvas.borderWidth;\r\n      ctx.strokeStyle = project.canvas.borderColor;\r\n      ctx.globalAlpha = project.canvas.borderOpacity;\r\n      ctx.lineWidth = borderWidth * 2; // Double width so it expands outward evenly\r\n      \r\n      // Offset by half the border width so it expands outward\r\n      const offset = borderWidth / 2;\r\n      ctx.strokeRect(offset, offset, canvas.width - borderWidth, canvas.height - borderWidth);\r\n      \r\n      ctx.globalAlpha = 1; // Reset alpha\r\n      // console.log(`[DEBUG] Canvas border drawn: ${borderWidth}px ${project.canvas.borderColor}`);\r\n    }\r\n\r\n    // Sort layers by z-index for rendering\r\n    const sortedLayers = [...project.layers]\r\n      .filter((layer) => layer.visible)\r\n      .sort((a, b) => a.zIndex - b.zIndex);\r\n\r\n    // console.log(`[DEBUG] Rendering ${sortedLayers.length} visible layers`);\r\n\r\n    // Render each layer\r\n    for (const layer of sortedLayers) {\r\n      const img = loadedImages.get(layer.id);\r\n      if (!img) {\r\n        console.warn(`[DEBUG] Image not loaded for layer: ${layer.name}`);\r\n        continue;\r\n      }\r\n\r\n      // Get the current state for drag offset\r\n      const state = useCompositorStore.getState();\r\n      const isDraggingThisLayer = state.ui.isDraggingLayer && \r\n        (state.ui.dragLayerId === layer.id || \r\n         state.selectedLayerIds.includes(layer.id) && state.selectedLayerIds.includes(state.ui.dragLayerId!));\r\n\r\n      // Use floor to ensure integer positioning for pixel precision\r\n      let x = Math.floor(layer.x);\r\n      let y = Math.floor(layer.y);\r\n\r\n      // Apply drag offset for visual feedback during drag\r\n      if (isDraggingThisLayer) {\r\n        x += state.ui.dragOffsetX;\r\n        y += state.ui.dragOffsetY;\r\n      }\r\n\r\n      // Apply opacity\r\n      const prevAlpha = ctx.globalAlpha;\r\n      ctx.globalAlpha = layer.opacity !== undefined ? layer.opacity : 1.0;\r\n\r\n      ctx.drawImage(img, x, y);\r\n      \r\n      // Restore opacity\r\n      ctx.globalAlpha = prevAlpha;\r\n      \r\n      // console.log(`[DEBUG] Layer rendered: ${layer.name} at (${x}, ${y}) with opacity ${ctx.globalAlpha}`);\r\n    }\r\n  }, [project, loadedImages, isDraggingLayer, dragLayerId, dragOffsetX, dragOffsetY]);\r\n\r\n  /**\r\n   * Calculate world coordinates from mouse position\r\n   * This accounts for the canvas transform: translate(-panX*zoom, -panY*zoom) scale(zoom)\r\n   */\r\n  const getWorldCoordinates = (screenX: number, screenY: number): { x: number; y: number } => {\r\n    const container = containerRef.current;\r\n    if (!container) return { x: 0, y: 0 };\r\n\r\n    const containerRect = container.getBoundingClientRect();\r\n    \r\n    // Position relative to the container (accounting for 20px padding on container)\r\n    const relativeX = screenX - containerRect.left - 20;\r\n    const relativeY = screenY - containerRect.top - 20;\r\n    \r\n    // The inner div has width: calc(100% - 20px) inside a container with padding 20px\r\n    // So total reduction is 40px (20px padding + 20px from calc)\r\n    const viewportWidth = containerRect.width - 40;\r\n    const viewportHeight = containerRect.height - 40;\r\n    \r\n    const centerX = viewportWidth / 2;\r\n    const centerY = viewportHeight / 2;\r\n    \r\n    const offsetFromCenterX = relativeX - centerX;\r\n    const offsetFromCenterY = relativeY - centerY;\r\n    \r\n    const zoom = project.viewport.zoom / 100;\r\n    const canvasDistX = offsetFromCenterX / zoom;\r\n    const canvasDistY = offsetFromCenterY / zoom;\r\n    \r\n    const canvasCenterX = project.canvas.width / 2;\r\n    const canvasCenterY = project.canvas.height / 2;\r\n    \r\n    const worldX = canvasCenterX + canvasDistX + project.viewport.panX;\r\n    const worldY = canvasCenterY + canvasDistY + project.viewport.panY;\r\n    \r\n    return { x: worldX, y: worldY };\r\n  };\r\n\r\n  /**\r\n   * Handle canvas mouse events for layer dragging and panning\r\n   */\r\n  const handleCanvasMouseDown = (e: React.MouseEvent<HTMLDivElement>) => {\r\n    // console.log('[DEBUG] Canvas mouse down event fired');\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) {\r\n      console.warn('[DEBUG] Canvas ref not available');\r\n      return;\r\n    }\r\n\r\n    // Middle-click (button 1) for panning\r\n    if (e.button === 1) {\r\n      e.preventDefault();\r\n      setIsPanning(true);\r\n      setPanStart({ x: e.clientX, y: e.clientY });\r\n      // console.log('[DEBUG] Started panning with middle-click');\r\n      return;\r\n    }\r\n\r\n    // Left-click (button 0) for layer selection/dragging or canvas panning\r\n    if (e.button !== 0) {\r\n      // console.log(`[DEBUG] Ignoring mouse button ${e.button}`);\r\n      return;\r\n    }\r\n\r\n    const { x: worldX, y: worldY } = getWorldCoordinates(e.clientX, e.clientY);\r\n\r\n    // console.log(\r\n    //   `[DEBUG] Left-click at world (${worldX.toFixed(1)}, ${worldY.toFixed(1)})`\r\n    // );\r\n\r\n    // Find layer at this position (check in reverse order - top layer first)\r\n    const sortedLayers = [...project.layers]\r\n      .filter((layer) => layer.visible)\r\n      .sort((a, b) => b.zIndex - a.zIndex);\r\n\r\n    // console.log(`[DEBUG] Checking ${sortedLayers.length} layers for click intersection`);\r\n\r\n    for (const layer of sortedLayers) {\r\n      if (\r\n        worldX >= layer.x &&\r\n        worldX < layer.x + layer.width &&\r\n        worldY >= layer.y &&\r\n        worldY < layer.y + layer.height\r\n      ) {\r\n        // console.log(`[DEBUG] Layer clicked: ${layer.name} at (${layer.x}, ${layer.y}) size (${layer.width}x${layer.height})`);\r\n\r\n        // Don't start dragging if layer is locked\r\n        if (layer.locked) {\r\n          // Still allow selection, just not dragging\r\n          selectLayer(layer.id, e.ctrlKey || e.metaKey);\r\n          return;\r\n        }\r\n\r\n        const isMultiSelect = e.ctrlKey || e.metaKey;\r\n        \r\n        // If clicking a layer that's already selected (without Ctrl), keep other selections\r\n        // This allows multi-layer dragging by dragging any selected layer\r\n        const isAlreadySelected = selectedLayerIds.includes(layer.id);\r\n        const shouldKeepSelection = isAlreadySelected && !isMultiSelect;\r\n        \r\n        if (!shouldKeepSelection) {\r\n          selectLayer(layer.id, isMultiSelect);\r\n        }\r\n        \r\n        startDraggingLayer(layer.id, worldX, worldY);\r\n        // console.log(`[DEBUG] Started dragging layer: ${layer.name}`);\r\n        return;\r\n      } else {\r\n        // console.log(`[DEBUG] Layer ${layer.name} at (${layer.x}, ${layer.y}) size (${layer.width}x${layer.height}) - no hit`);\r\n      }\r\n    }\r\n\r\n    // No layer clicked - start panning with left-click instead\r\n    // console.log('[DEBUG] No layer clicked - starting left-click pan');\r\n    deselectAllLayers();\r\n    setIsPanning(true);\r\n    setPanStart({ x: e.clientX, y: e.clientY });\r\n  };\r\n\r\n  const handleCanvasMouseMove = (e: React.MouseEvent<HTMLDivElement>) => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n\r\n    // Track mouse position for drag tooltip\r\n    setMousePos({ x: e.clientX, y: e.clientY });\r\n\r\n    const { x: worldX, y: worldY } = getWorldCoordinates(e.clientX, e.clientY);\r\n\r\n    // Update hover coordinates\r\n    setHoverCoords({ x: Math.floor(worldX), y: Math.floor(worldY) });\r\n\r\n    // Handle middle-click panning\r\n    if (isPanning) {\r\n      const zoom = project.viewport.zoom / 100;\r\n      const deltaX = e.clientX - panStart.x;\r\n      const deltaY = e.clientY - panStart.y;\r\n      \r\n      const newPanX = project.viewport.panX - (deltaX / zoom);\r\n      const newPanY = project.viewport.panY - (deltaY / zoom);\r\n      \r\n      setViewport({ panX: newPanX, panY: newPanY });\r\n      setPanStart({ x: e.clientX, y: e.clientY });\r\n      return;\r\n    }\r\n\r\n    const isDragging = useCompositorStore.getState().ui.isDraggingLayer;\r\n    if (isDragging) {\r\n      updateDragPosition(worldX, worldY);\r\n    }\r\n  };\r\n\r\n  const handleCanvasMouseUp = () => {\r\n    setIsPanning(false);\r\n    stopDraggingLayer();\r\n    // console.log('[DEBUG] Layer drag ended');\r\n  };\r\n\r\n  const handleCanvasWheel = (e: React.WheelEvent<HTMLDivElement>) => {\r\n    e.preventDefault();\r\n\r\n    const direction = e.deltaY > 0 ? -1 : 1;\r\n    const currentZoom = project.viewport.zoom;\r\n    const zoomLevels = [25, 33, 50, 66, 75, 100, 125, 150, 200, 400, 800, 1600, 3200];\r\n\r\n    let newZoom = currentZoom;\r\n    if (direction > 0) {\r\n      newZoom = zoomLevels.find((z) => z > currentZoom) || zoomLevels[zoomLevels.length - 1];\r\n    } else {\r\n      newZoom =\r\n        [...zoomLevels].reverse().find((z) => z < currentZoom) || zoomLevels[0];\r\n    }\r\n\r\n    // console.log(`[DEBUG] Mouse wheel zoom: ${currentZoom}% -> ${newZoom}%`);\r\n    setViewport({ zoom: newZoom });\r\n  };\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      id=\"canvas-renderer\"\r\n      className=\"relative w-full h-full bg-canvas-bg overflow-hidden cursor-crosshair\"\r\n      style={{ paddingTop: '20px', paddingLeft: '20px' }}\r\n      onMouseDown={handleCanvasMouseDown}\r\n      onMouseMove={handleCanvasMouseMove}\r\n      onMouseUp={handleCanvasMouseUp}\r\n      onMouseLeave={handleCanvasMouseUp}\r\n      onWheel={handleCanvasWheel}\r\n    >\r\n      {/* Canvas container with centering and scrollbars */}\r\n      <div\r\n        className=\"w-full h-full flex items-center justify-center\"\r\n        style={{ width: 'calc(100% - 20px)', height: 'calc(100% - 20px)', overflowX: 'auto', overflowY: 'auto' }}\r\n      >\r\n        <div\r\n          style={{\r\n            transform: `translate(${-project.viewport.panX * (project.viewport.zoom / 100)}px, ${-project.viewport.panY * (project.viewport.zoom / 100)}px) scale(${project.viewport.zoom / 100})`,\r\n            transformOrigin: 'center center',\r\n            position: 'absolute',\r\n          }}\r\n        >\r\n          <canvas\r\n            ref={canvasRef}\r\n            style={{\r\n              imageRendering: 'pixelated',\r\n              backfaceVisibility: 'hidden',\r\n              WebkitFontSmoothing: 'antialiased',\r\n              outline: project.canvas.borderEnabled ? '1px solid rgb(75, 85, 99)' : 'none',\r\n              outlineOffset: '0px',\r\n              boxShadow: project.canvas.shadowIntensity > 0 \r\n                ? `0 10px 40px rgba(0, 0, 0, ${0.5 * project.canvas.shadowIntensity})`\r\n                : 'none',\r\n            }}\r\n          />\r\n\r\n          {/* Selection borders overlay - SVG with CSS animation */}\r\n          {showSelectionBorders && selectedLayerIds.length > 0 && (\r\n            <svg\r\n              width={project.canvas.width}\r\n              height={project.canvas.height}\r\n              style={{\r\n                position: 'absolute',\r\n                top: 0,\r\n                left: 0,\r\n                pointerEvents: 'none',\r\n                overflow: 'visible',\r\n                display: 'block',\r\n              }}\r\n            >\r\n              {project.layers.map((layer) => {\r\n                if (!selectedLayerIds.includes(layer.id)) return null;\r\n\r\n                const isDraggingThisLayer = isDraggingLayer && \r\n                  (dragLayerId === layer.id || \r\n                   selectedLayerIds.includes(dragLayerId!));\r\n\r\n                let x = Math.floor(layer.x);\r\n                let y = Math.floor(layer.y);\r\n\r\n                // Apply drag offset for visual feedback during drag\r\n                if (isDraggingThisLayer) {\r\n                  x += dragOffsetX;\r\n                  y += dragOffsetY;\r\n                }\r\n\r\n                // Check for text layer and single selection\r\n                const isTextLayer = layer.textContent !== undefined;\r\n                const isShapeLayer = layer.shapeType !== undefined;\r\n                const showEditIcon = (isTextLayer || isShapeLayer) && selectedLayerIds.length === 1;\r\n\r\n                return (\r\n                  <g key={layer.id}>\r\n                    {/* Light gray stripe */}\r\n                    <rect\r\n                      x={x-0.12}\r\n                      y={y-0.25}\r\n                      width={layer.width+0.3}\r\n                      height={layer.height+0.3}\r\n                      fill=\"none\"\r\n                      stroke=\"#b0b0b0\"\r\n                      strokeWidth=\"0.25\"\r\n                      strokeDasharray=\"4,4\"\r\n                      style={{\r\n                        animation: borderAnimationSpeed > 0 ? `marching-ants ${8 / (0.125 * borderAnimationSpeed) / 1000}s linear infinite` : 'none',\r\n                      }}\r\n                    />\r\n                    {/* Dark gray stripe offset */}\r\n                    <rect\r\n                      x={x-0.12}\r\n                      y={y-0.25}\r\n                      width={layer.width+0.3}\r\n                      height={layer.height+0.3}\r\n                      fill=\"none\"\r\n                      stroke=\"#505050\"\r\n                      strokeWidth=\"0.25\"\r\n                      strokeDasharray=\"4,4\"\r\n                      strokeDashoffset=\"2\"\r\n                      style={{\r\n                        animation: borderAnimationSpeed > 0 ? `marching-ants ${8 / (0.125 * borderAnimationSpeed) / 1000}s linear infinite` : 'none',\r\n                      }}\r\n                    />\r\n                    \r\n                    {/* Delete Icon (All Layers) */}\r\n                    {showSelectionTools && selectedLayerIds.includes(layer.id) && selectedLayerIds.length === 1 && (\r\n                      <g\r\n                        className=\"selection-tool-icon\"\r\n                        transform={`translate(${x + 4}, ${y - 14})`}\r\n                        style={{ cursor: 'pointer', pointerEvents: 'auto' }}\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          removeLayer(layer.id);\r\n                        }}\r\n                        onMouseDown={(e) => e.stopPropagation()}\r\n                      >\r\n                        <circle cx=\"6\" cy=\"6\" r=\"5\" fill=\"none\" stroke=\"none\" pointerEvents=\"all\" />\r\n                        <path\r\n                          d=\"M4 4l16 16M20 4l-16 16\"\r\n                          stroke=\"#9ca3af\"\r\n                          strokeWidth=\"1\"\r\n                          strokeLinecap=\"round\"\r\n                          strokeLinejoin=\"round\"\r\n                          transform=\"scale(0.4)\"\r\n                          pointerEvents=\"none\"\r\n                        />\r\n                      </g>\r\n                    )}\r\n\r\n                    {/* Visibility Toggle Icon (All Layers) */}\r\n                    {showSelectionTools && selectedLayerIds.includes(layer.id) && selectedLayerIds.length === 1 && (\r\n                      <g\r\n                        className=\"selection-tool-icon\"\r\n                        transform={`translate(${x + 14}, ${y - 14})`}\r\n                        style={{ cursor: 'pointer', pointerEvents: 'auto' }}\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          updateLayer(layer.id, { visible: !layer.visible });\r\n                        }}\r\n                        onMouseDown={(e) => e.stopPropagation()}\r\n                      >\r\n                        <circle cx=\"6\" cy=\"6\" r=\"5\" fill=\"none\" stroke=\"none\" pointerEvents=\"all\" />\r\n                        {layer.visible ? (\r\n                          <path\r\n                            d=\"M12 4.5C7.244 4.5 3.226 7.662 1.934 12c1.292 4.338 5.31 7.5 10.066 7.5s8.773-3.162 10.065-7.5c-1.292-4.338-5.31-7.5-10.065-7.5zm0 12a4.5 4.5 0 110-9 4.5 4.5 0 010 9z\"\r\n                            fill=\"#9ca3af\"\r\n                            stroke=\"#4b5563\"\r\n                            strokeWidth=\"0.5\"\r\n                            transform=\"scale(0.4)\"\r\n                            pointerEvents=\"none\"\r\n                          />\r\n                        ) : (\r\n                          <g pointerEvents=\"none\">\r\n                            <circle cx=\"6\" cy=\"6\" r=\"4\" fill=\"none\" stroke=\"#9ca3af\" strokeWidth=\"0.5\" />\r\n                            <line x1=\"2\" y1=\"2\" x2=\"10\" y2=\"10\" stroke=\"#9ca3af\" strokeWidth=\"0.5\" />\r\n                          </g>\r\n                        )}\r\n                      </g>\r\n                    )}\r\n\r\n                    {/* Edit Icon (Text or Shape) */}\r\n                    {showSelectionTools && showEditIcon && (\r\n                      <g\r\n                        className=\"selection-tool-icon\"\r\n                        transform={`translate(${x + 24}, ${y - 14})`}\r\n                        style={{ cursor: 'pointer', pointerEvents: 'auto' }}\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          if (isTextLayer) {\r\n                            (window as any).openTextLayerModal?.(layer);\r\n                          } else if (isShapeLayer) {\r\n                            (window as any).openShapeModal?.(layer);\r\n                          }\r\n                        }}\r\n                        onMouseDown={(e) => e.stopPropagation()}\r\n                      >\r\n                        <circle cx=\"6\" cy=\"6\" r=\"5\" fill=\"none\" stroke=\"none\" pointerEvents=\"all\" />\r\n                        <path\r\n                          d=\"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z\"\r\n                          fill=\"#9ca3af\"\r\n                          stroke=\"#4b5563\"\r\n                          strokeWidth=\"0.5\"\r\n                          transform=\"scale(0.4)\"\r\n                          pointerEvents=\"none\"\r\n                        />\r\n                      </g>\r\n                    )}\r\n                  </g>\r\n                );\r\n              })}\r\n              <style>{`\r\n                @keyframes marching-ants {\r\n                  0% {\r\n                    stroke-dashoffset: 0;\r\n                  }\r\n                  100% {\r\n                    stroke-dashoffset: -8;\r\n                  }\r\n                }\r\n                .selection-tool-icon {\r\n                  opacity: 0.6;\r\n                  transition: opacity 0.2s ease, filter 0.2s ease;\r\n                }\r\n                .selection-tool-icon:hover {\r\n                  opacity: 1;\r\n                  filter: drop-shadow(0 0 4px rgba(156, 163, 175, 0.8));\r\n                }\r\n              `}</style>\r\n            </svg>\r\n          )}\r\n        </div>\r\n\r\n        {/* Grid Overlay - NOT transformed, stays fixed to viewport */}\r\n        <GridOverlay\r\n          canvas={canvasRef.current}\r\n          gridEnabled={project.grid.enabled}\r\n          viewport={project.viewport}\r\n          canvasWidth={project.canvas.width}\r\n          canvasHeight={project.canvas.height}\r\n          gridDensity={project.grid.density}\r\n          canvasBorderEnabled={project.canvas.borderEnabled}\r\n        />\r\n      </div>\r\n\r\n      {/* Coordinate Display */}\r\n      <div id=\"canvas-status-bar\" className=\"absolute bottom-4 right-4 bg-panel-bg border border-border rounded px-3 py-2 text-xs text-gray-400 space-y-1\" aria-label=\"Canvas status\">\r\n        <div>Canvas: {project.canvas.width}x{project.canvas.height}</div>\r\n        <div>Zoom: {project.viewport.zoom}%</div>\r\n        <div>Layers: {project.layers.length}</div>\r\n        {hoverCoords && <div>Coords: ({hoverCoords.x}, {hoverCoords.y})</div>}\r\n        <div className=\"text-gray-500 text-xs mt-2 pt-2 border-t border-border\">Middle-click to pan</div>\r\n      </div>\r\n\r\n      {/* Selected Layers Info */}\r\n      {selectedLayerIds.length > 0 && (\r\n        <div id=\"canvas-selection-info\" className=\"absolute top-4 right-4 bg-panel-bg border border-blue-600 rounded px-3 py-2 text-xs text-blue-400\" aria-live=\"polite\">\r\n          Selected: {selectedLayerIds.length} layer{selectedLayerIds.length !== 1 ? 's' : ''}\r\n        </div>\r\n      )}\r\n\r\n      {/* Drag Info Tooltip */}\r\n      {isDraggingLayer && project.canvas.dragInfoEnabled && (\r\n        <DragInfoTooltip\r\n          offsetX={dragOffsetX}\r\n          offsetY={dragOffsetY}\r\n          mouseX={mousePos.x}\r\n          mouseY={mousePos.y}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default CanvasRenderer;\r\n","/**\r\n * Project serialization and deserialization utilities\r\n * Handles save/load operations for .pixcomp files\r\n */\r\n\r\nimport { ProjectData } from '../types/compositor.types';\r\n\r\nconst CURRENT_VERSION = '1.0.0';\r\nconst MIN_SUPPORTED_VERSION = '1.0.0';\r\n\r\n/**\r\n * Serialize project to JSON string\r\n */\r\nexport function serializeProject(project: ProjectData): string {\r\n  // Filter out temporary canvas preview layers before serializing\r\n  const filteredLayers = project.layers.filter(\r\n    layer => layer.id !== '__text_canvas_preview__' && layer.id !== '__shape_canvas_preview__'\r\n  );\r\n\r\n  const serialized: ProjectData = {\r\n    ...project,\r\n    layers: filteredLayers,\r\n    modified: new Date().toISOString(),\r\n  };\r\n\r\n  return JSON.stringify(serialized, null, 2);\r\n}\r\n\r\n/**\r\n * Deserialize project from JSON string\r\n * Validates version and required fields\r\n */\r\nexport async function deserializeProject(jsonString: string): Promise<ProjectData> {\r\n  try {\r\n    // console.log('[DEBUG] Parsing project JSON...');\r\n    const data = JSON.parse(jsonString);\r\n\r\n    // Validate version exists\r\n    if (!data.version) {\r\n      throw new Error('Invalid project file: missing version field');\r\n    }\r\n\r\n    // console.log(`[DEBUG] Project version: ${data.version}`);\r\n\r\n    // Check version compatibility\r\n    if (!isVersionCompatible(data.version)) {\r\n      throw new Error(\r\n        `Project version ${data.version} is not supported. ` +\r\n        `Current version: ${CURRENT_VERSION}, ` +\r\n        `minimum supported: ${MIN_SUPPORTED_VERSION}`\r\n      );\r\n    }\r\n\r\n    // Filter out temporary canvas preview layers\r\n    if (data.layers) {\r\n      data.layers = data.layers.filter(\r\n        (layer: any) => layer.id !== '__text_canvas_preview__' && layer.id !== '__shape_canvas_preview__'\r\n      );\r\n    }\r\n\r\n    // Validate required fields\r\n    validateProjectData(data);\r\n\r\n    // console.log('[DEBUG] Project validation passed');\r\n\r\n    // Validate and load all images\r\n    // console.log(`[DEBUG] Validating ${data.layers.length} image(s)...`);\r\n    await validateLayerImages(data.layers);\r\n\r\n    // console.log('[DEBUG] All images validated successfully');\r\n    return data as ProjectData;\r\n  } catch (error) {\r\n    console.error('[DEBUG] Project deserialization failed:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Check if project version is compatible with current version\r\n */\r\nfunction isVersionCompatible(version: string): boolean {\r\n  const [major, minor] = version.split('.').map(Number);\r\n  const [minMajor, minMinor] = MIN_SUPPORTED_VERSION.split('.').map(Number);\r\n\r\n  // Allow same or newer version up to next major version\r\n  if (major > minMajor) {\r\n    return false; // Too new\r\n  }\r\n\r\n  if (major < minMajor) {\r\n    return false; // Too old\r\n  }\r\n\r\n  // Same major version, check minor\r\n  return minor >= minMinor;\r\n}\r\n\r\n/**\r\n * Validate project data structure\r\n */\r\nfunction validateProjectData(data: any): void {\r\n  const requiredFields = ['version', 'canvas', 'layers', 'viewport', 'grid', 'rulers'];\r\n\r\n  for (const field of requiredFields) {\r\n    if (!(field in data)) {\r\n      throw new Error(`Invalid project file: missing required field '${field}'`);\r\n    }\r\n  }\r\n\r\n  // Validate canvas config\r\n  if (typeof data.canvas.width !== 'number' || data.canvas.width <= 0) {\r\n    throw new Error('Invalid project file: canvas width must be a positive number');\r\n  }\r\n\r\n  if (typeof data.canvas.height !== 'number' || data.canvas.height <= 0) {\r\n    throw new Error('Invalid project file: canvas height must be a positive number');\r\n  }\r\n\r\n  // Validate layers array\r\n  if (!Array.isArray(data.layers)) {\r\n    throw new Error('Invalid project file: layers must be an array');\r\n  }\r\n\r\n  // Validate each layer\r\n  for (let i = 0; i < data.layers.length; i++) {\r\n    const layer = data.layers[i];\r\n\r\n    const requiredLayerFields = ['id', 'name', 'imageData', 'x', 'y', 'zIndex', 'visible', 'locked', 'width', 'height'];\r\n\r\n    for (const field of requiredLayerFields) {\r\n      if (!(field in layer)) {\r\n        throw new Error(`Invalid layer ${i}: missing required field '${field}'`);\r\n      }\r\n    }\r\n\r\n    if (typeof layer.x !== 'number' || typeof layer.y !== 'number') {\r\n      throw new Error(`Invalid layer ${i}: x and y must be numbers`);\r\n    }\r\n\r\n    if (!layer.imageData.startsWith('data:image/')) {\r\n      throw new Error(`Invalid layer ${i}: imageData must be a valid data URL`);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Validate that all layer images can be loaded\r\n */\r\nasync function validateLayerImages(layers: any[]): Promise<void> {\r\n  for (let i = 0; i < layers.length; i++) {\r\n    const layer = layers[i];\r\n\r\n    try {\r\n      await loadImage(layer.imageData);\r\n      // console.log(`[DEBUG] Layer ${i} image validated: ${layer.name}`);\r\n    } catch (error) {\r\n      throw new Error(`Failed to load image for layer ${i} (${layer.name}): ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Load image from data URL\r\n */\r\nfunction loadImage(dataUrl: string): Promise<HTMLImageElement> {\r\n  return new Promise((resolve, reject) => {\r\n    const img = new Image();\r\n    const timeout = setTimeout(() => {\r\n      reject(new Error('Image load timeout'));\r\n    }, 5000);\r\n\r\n    img.onload = () => {\r\n      clearTimeout(timeout);\r\n      resolve(img);\r\n    };\r\n\r\n    img.onerror = () => {\r\n      clearTimeout(timeout);\r\n      reject(new Error('Failed to load image'));\r\n    };\r\n\r\n    img.src = dataUrl;\r\n  });\r\n}\r\n\r\n/**\r\n * Export canvas to PNG blob at specified scale\r\n */\r\nexport async function exportCanvasToPNG(\r\n  layers: any[],\r\n  width: number,\r\n  height: number,\r\n  scale: number = 1,\r\n  backgroundColor: string | null = null\r\n): Promise<Blob> {\r\n  const exportCanvas = document.createElement('canvas');\r\n  exportCanvas.width = width * scale;\r\n  exportCanvas.height = height * scale;\r\n\r\n  const ctx = exportCanvas.getContext('2d');\r\n  if (!ctx) {\r\n    throw new Error('Failed to get canvas context');\r\n  }\r\n\r\n  // CRITICAL: Disable image smoothing\r\n  ctx.imageSmoothingEnabled = false;\r\n  (ctx as any).webkitImageSmoothingEnabled = false;\r\n  (ctx as any).mozImageSmoothingEnabled = false;\r\n\r\n  // Scale context\r\n  ctx.scale(scale, scale);\r\n\r\n  // Fill background if set\r\n  if (backgroundColor) {\r\n    ctx.fillStyle = backgroundColor;\r\n    ctx.fillRect(0, 0, width, height);\r\n  }\r\n\r\n  // Render visible layers sorted by z-index\r\n  const sortedLayers = [...layers]\r\n    .filter((layer) => layer.visible)\r\n    .sort((a, b) => a.zIndex - b.zIndex);\r\n\r\n  for (const layer of sortedLayers) {\r\n    try {\r\n      const img = await loadImage(layer.imageData);\r\n      ctx.drawImage(img, layer.x, layer.y);\r\n    } catch (error) {\r\n      console.warn(`Failed to export layer ${layer.name}:`, error);\r\n    }\r\n  }\r\n\r\n  return new Promise((resolve) => {\r\n    exportCanvas.toBlob((blob) => {\r\n      if (!blob) {\r\n        throw new Error('Failed to create PNG blob');\r\n      }\r\n      resolve(blob);\r\n    }, 'image/png');\r\n  });\r\n}\r\n","import { useRef } from 'react';\r\nimport useCompositorStore from '../../store/compositorStore';\r\nimport CanvasRenderer from './CanvasRenderer';\r\nimport { deserializeProject } from '../../utils/projectSerializer';\r\nimport { blobToDataUrl } from '../../utils/imageProcessing';\r\nimport { rasterizeText } from '../../utils/textRasterizer';\r\n\r\n/**\r\n * Canvas container component\r\n * Handles image uploads and manages canvas rendering\r\n */\r\nfunction Canvas() {\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n  const addLayer = useCompositorStore((state) => state.addLayer);\r\n  const loadProject = useCompositorStore((state) => state.loadProject);\r\n  const markClean = useCompositorStore((state) => state.markClean);\r\n\r\n  /**\r\n   * Handle image file upload\r\n   * Converts images to base64 data URIs\r\n   */\r\n  const handleImageUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const files = event.currentTarget.files;\r\n    if (!files) {\r\n      console.warn('[DEBUG] No files selected');\r\n      return;\r\n    }\r\n\r\n    // console.log(`[DEBUG] Processing ${files.length} image file(s)`);\r\n\r\n    for (const file of Array.from(files)) {\r\n      try {\r\n        // Check for .pixcomp file\r\n        if (file.name.toLowerCase().endsWith('.pixcomp')) {\r\n          try {\r\n            const text = await file.text();\r\n            const projectData = await deserializeProject(text);\r\n            loadProject(projectData);\r\n            markClean();\r\n            // Stop processing other files if a project is loaded\r\n            if (fileInputRef.current) {\r\n              fileInputRef.current.value = '';\r\n            }\r\n            return;\r\n          } catch (error) {\r\n            console.error('[DEBUG] Load project failed:', error);\r\n            alert(`Error loading project: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n            continue;\r\n          }\r\n        }\r\n\r\n        // Validate file type\r\n        if (!['image/png', 'image/gif', 'image/bmp', 'image/jpeg'].includes(file.type)) {\r\n          console.warn(`[DEBUG] Unsupported file type: ${file.type}`);\r\n          alert(`Unsupported file type: ${file.type}. Please use .pixcomp, PNG, GIF, BMP, or JPEG.`);\r\n          continue;\r\n        }\r\n\r\n        // console.log(`[DEBUG] Loading image: ${file.name} (${file.size} bytes, ${file.type})`);\r\n\r\n        const dataUrl = await new Promise<string>((resolve, reject) => {\r\n          const reader = new FileReader();\r\n          reader.onload = (e) => resolve(e.target?.result as string);\r\n          reader.onerror = () => reject(new Error('Failed to read file'));\r\n          reader.readAsDataURL(file);\r\n        });\r\n\r\n        // Create a temporary image to get dimensions\r\n        const img = new Image();\r\n        img.src = dataUrl;\r\n\r\n        await new Promise<void>((resolve, reject) => {\r\n          img.onload = () => resolve();\r\n          img.onerror = () => reject(new Error('Failed to load image'));\r\n        });\r\n\r\n        const width = img.naturalWidth;\r\n        const height = img.naturalHeight;\r\n\r\n        // console.log(`[DEBUG] Image loaded: ${file.name} (${width}x${height})`);\r\n\r\n        // Add layer to store\r\n        addLayer({\r\n          name: file.name,\r\n          imageData: dataUrl,\r\n          x: 0,\r\n          y: 0,\r\n          zIndex: useCompositorStore.getState().project.layers.length,\r\n          visible: true,\r\n          locked: false,\r\n          opacity: 1.0,\r\n          width,\r\n          height,\r\n        });\r\n\r\n        // console.log(`[DEBUG] Layer added: ${file.name}`);\r\n      } catch (error) {\r\n        // console.error(`[DEBUG] Error loading image ${file.name}:`, error);\r\n        alert(`Error loading image ${file.name}: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n      }\r\n    }\r\n\r\n    // Reset file input\r\n    if (fileInputRef.current) {\r\n      fileInputRef.current.value = '';\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Handle paste event for fallback clipboard support\r\n   * Triggered when user pastes into the canvas area\r\n   */\r\n  const handlePaste = async (event: React.ClipboardEvent<HTMLDivElement>) => {\r\n    event.preventDefault();\r\n    \r\n    const items = event.clipboardData?.items;\r\n    if (!items) return;\r\n\r\n    for (let i = 0; i < items.length; i++) {\r\n      const item = items[i];\r\n\r\n      // Handle image paste\r\n      if (item.type.startsWith('image/')) {\r\n        try {\r\n          const blob = item.getAsFile();\r\n          if (!blob) continue;\r\n\r\n          const dataUrl = await blobToDataUrl(blob);\r\n\r\n          // Get image dimensions\r\n          const img = new Image();\r\n          img.src = dataUrl;\r\n\r\n          await new Promise<void>((resolve, reject) => {\r\n            img.onload = () => resolve();\r\n            img.onerror = () => reject(new Error('Failed to load image'));\r\n          });\r\n\r\n          const maxZIndex = Math.max(\r\n            ...useCompositorStore.getState().project.layers.map((l) => l.zIndex),\r\n            0\r\n          );\r\n\r\n          addLayer({\r\n            name: 'Pasted Image',\r\n            imageData: dataUrl,\r\n            x: 0,\r\n            y: 0,\r\n            zIndex: maxZIndex + 1,\r\n            visible: true,\r\n            locked: false,\r\n            opacity: 1.0,\r\n            width: img.naturalWidth,\r\n            height: img.naturalHeight,\r\n          });\r\n\r\n          // Only handle the first image\r\n          break;\r\n        } catch (error) {\r\n          console.error('Error pasting image:', error);\r\n        }\r\n      }\r\n    }\r\n\r\n    // Try to get text from clipboard if no image was found\r\n    if (event.clipboardData?.types.includes('text/plain')) {\r\n      try {\r\n        const text = event.clipboardData.getData('text/plain');\r\n        if (text.trim()) {\r\n          const rasterized = await rasterizeText({\r\n            text,\r\n            fontSize: 16,\r\n            fontFamily: 'Arial',\r\n            color: '#000000',\r\n            textAlign: 'left',\r\n            lineHeight: 1.2,\r\n          });\r\n\r\n          const maxZIndex = Math.max(\r\n            ...useCompositorStore.getState().project.layers.map((l) => l.zIndex),\r\n            0\r\n          );\r\n\r\n          addLayer({\r\n            id: `layer_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n            name: `Text: ${text.substring(0, 20)}${text.length > 20 ? '...' : ''}`,\r\n            imageData: rasterized.dataUrl,\r\n            x: 0,\r\n            y: 0,\r\n            zIndex: maxZIndex + 1,\r\n            visible: true,\r\n            locked: false,\r\n            opacity: 1.0,\r\n            width: rasterized.width,\r\n            height: rasterized.height,\r\n            textContent: text,\r\n            fontSize: 16,\r\n            fontFamily: 'Arial',\r\n            fontColor: '#000000',\r\n            textAlign: 'left',\r\n            lineHeight: 1.2,\r\n          });\r\n        }\r\n      } catch (error) {\r\n        console.error('Error pasting text:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div id=\"canvas-container\" className=\"w-full h-full flex flex-col relative\" onPaste={handlePaste}>\r\n      {/* Canvas Area */}\r\n      <div className=\"flex-1 relative overflow-hidden\" data-region=\"canvas\">\r\n        <CanvasRenderer />\r\n      </div>\r\n\r\n      {/* Upload Zone Overlay (shown when no layers) */}\r\n      {useCompositorStore((state) => state.project.layers.length === 0) && (\r\n        <div\r\n          id=\"canvas-upload-zone\"\r\n          onClick={() => fileInputRef.current?.click()}\r\n          className=\"absolute inset-0 flex items-center justify-center bg-black bg-opacity-30 cursor-pointer hover:bg-opacity-40 transition-all z-10\"\r\n          role=\"button\"\r\n          aria-label=\"Upload images\"\r\n        >\r\n          <div className=\"text-center\">\r\n            <div className=\"text-4xl mb-4\"></div>\r\n            <div className=\"text-lg font-semibold text-white mb-2\">\r\n              Click to upload images or drag & drop\r\n            </div>\r\n            <div className=\"text-sm text-gray-400\">\r\n              Supported: .pixcomp, PNG, GIF, BMP, JPEG\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Hidden file input */}\r\n      <input\r\n        ref={fileInputRef}\r\n        id=\"input-canvas-upload\"\r\n        type=\"file\"\r\n        multiple\r\n        accept=\".pixcomp,image/png,image/gif,image/bmp,image/jpeg\"\r\n        onChange={handleImageUpload}\r\n        className=\"hidden\"\r\n        aria-label=\"Upload images\"\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Canvas;\r\n","import { useState, useRef, useEffect } from 'react';\r\nimport useCompositorStore from '../../store/compositorStore';\r\nimport { Layer } from '../../types/compositor.types';\r\nimport { isTextLayer, isShapeLayer } from '../../utils/textRasterizer';\r\n\r\ninterface LayerItemProps {\r\n  layer: Layer;\r\n  isSelected: boolean;\r\n}\r\n\r\n// Global drag state shared across all LayerItem instances\r\nlet globalDraggedLayerId: string | null = null;\r\n\r\n/**\r\n * Individual layer item component\r\n * Displays layer thumbnail, name, and controls\r\n */\r\nfunction LayerItem({ layer, isSelected }: LayerItemProps) {\r\n  const selectLayer = useCompositorStore((state) => state.selectLayer);\r\n  const selectLayerRange = useCompositorStore((state) => state.selectLayerRange);\r\n  const updateLayer = useCompositorStore((state) => state.updateLayer);\r\n  const removeLayer = useCompositorStore((state) => state.removeLayer);\r\n  const reorderLayer = useCompositorStore((state) => state.reorderLayer);\r\n  const bringLayerToFront = useCompositorStore((state) => state.bringLayerToFront);\r\n  const sendLayerToBack = useCompositorStore((state) => state.sendLayerToBack);\r\n  const duplicateLayer = useCompositorStore((state) => state.duplicateLayer);\r\n\r\n  const [isEditingName, setIsEditingName] = useState(false);\r\n  const [tempName, setTempName] = useState(layer.name);\r\n  const [isDragOver, setIsDragOver] = useState(false);\r\n  const elementRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Set up global listeners to handle mouseup and mouse leaving window\r\n  useEffect(() => {\r\n    const handleGlobalMouseUp = () => {\r\n      if (globalDraggedLayerId) {\r\n        // console.log(`[DEBUG] Global drag released`);\r\n        globalDraggedLayerId = null;\r\n        setIsDragOver(false);\r\n      }\r\n    };\r\n\r\n    // Listen for mouseup anywhere in the document\r\n    document.addEventListener('mouseup', handleGlobalMouseUp);\r\n\r\n    // Also listen for when mouse leaves the window entirely\r\n    const handleMouseLeaveWindow = (e: MouseEvent) => {\r\n      // clientY < 0 means mouse left the top of the window\r\n      // clientX < 0 or clientX > window.innerWidth means left/right\r\n      // clientY > window.innerHeight means bottom\r\n      if (e.clientY < 0 || e.clientX < 0 || e.clientX > window.innerWidth || e.clientY > window.innerHeight) {\r\n        if (globalDraggedLayerId) {\r\n          // console.log(`[DEBUG] Mouse left window, canceling drag`);\r\n          globalDraggedLayerId = null;\r\n          setIsDragOver(false);\r\n        }\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mousemove', handleMouseLeaveWindow);\r\n\r\n    return () => {\r\n      document.removeEventListener('mouseup', handleGlobalMouseUp);\r\n      document.removeEventListener('mousemove', handleMouseLeaveWindow);\r\n    };\r\n  }, []);\r\n\r\n  const handleSelectLayer = (e: React.MouseEvent) => {\r\n    const multiSelect = e.ctrlKey || e.metaKey;\r\n    const rangeSelect = e.shiftKey;\r\n    \r\n    if (rangeSelect && useCompositorStore.getState().selectedLayerIds.length > 0) {\r\n      // Shift+Click for range selection\r\n      const lastSelectedId = useCompositorStore.getState().selectedLayerIds[useCompositorStore.getState().selectedLayerIds.length - 1];\r\n      selectLayerRange(lastSelectedId, layer.id);\r\n      // console.log(`[DEBUG] Layer range selected from ${lastSelectedId} to ${layer.id}`);\r\n    } else {\r\n      // Regular or multi-select\r\n      selectLayer(layer.id, multiSelect);\r\n      // console.log(`[DEBUG] Layer selected: ${layer.name} (multiSelect: ${multiSelect})`);\r\n    }\r\n  };\r\n\r\n  const handleCheckboxChange = (e: React.MouseEvent<HTMLButtonElement>) => {\r\n    e.stopPropagation();\r\n    // Toggle selection with multi-select enabled\r\n    selectLayer(layer.id, true);\r\n    // console.log(`[DEBUG] Layer toggled via checkbox: ${layer.name}`);\r\n  };\r\n\r\n  const handleMouseDown = (e: React.MouseEvent) => {\r\n    // Check if clicking on control buttons - don't start drag\r\n    if ((e.target as HTMLElement).closest('button') || isEditingName) {\r\n      return;\r\n    }\r\n\r\n    // Start drag by setting global dragged layer\r\n    globalDraggedLayerId = layer.id;\r\n    \r\n    // If not selected, select it\r\n    if (!isSelected) {\r\n      selectLayer(layer.id, false);\r\n    }\r\n    \r\n    // console.log(`[DEBUG] Starting drag of layer: ${layer.name}`);\r\n  };\r\n\r\n  const handleMouseEnter = () => {\r\n    if (!globalDraggedLayerId || globalDraggedLayerId === layer.id) {\r\n      setIsDragOver(false);\r\n      return;\r\n    }\r\n\r\n    setIsDragOver(true);\r\n    \r\n    // Determine direction to move: if dragged layer has lower z-index, move it up\r\n    const draggedLayer = useCompositorStore.getState().project.layers.find(l => l.id === globalDraggedLayerId);\r\n    const direction = draggedLayer && draggedLayer.zIndex < layer.zIndex ? 'up' : 'down';\r\n    \r\n    reorderLayer(globalDraggedLayerId, direction);\r\n    // console.log(`[DEBUG] Swapped: moved layer ${globalDraggedLayerId} ${direction}`);\r\n  };\r\n\r\n  const handleMouseLeave = () => {\r\n    setIsDragOver(false);\r\n  };\r\n\r\n  const handleMouseUp = () => {\r\n    if (globalDraggedLayerId) {\r\n      // console.log(`[DEBUG] Drag released`);\r\n      globalDraggedLayerId = null;\r\n    }\r\n  };\r\n\r\n  const handleToggleVisibility = (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    updateLayer(layer.id, { visible: !layer.visible });\r\n    // console.log(`[DEBUG] Layer visibility toggled: ${layer.name} -> ${!layer.visible}`);\r\n  };\r\n\r\n  const handleToggleLock = (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    updateLayer(layer.id, { locked: !layer.locked });\r\n    // console.log(`[DEBUG] Layer lock toggled: ${layer.name} -> ${!layer.locked}`);\r\n  };\r\n\r\n  const handleNameSave = () => {\r\n    if (tempName.trim()) {\r\n      updateLayer(layer.id, { name: tempName.trim() });\r\n      // console.log(`[DEBUG] Layer renamed: ${layer.name} -> ${tempName.trim()}`);\r\n    } else {\r\n      setTempName(layer.name);\r\n    }\r\n    setIsEditingName(false);\r\n  };\r\n\r\n  const handleKeyDown = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter') {\r\n      handleNameSave();\r\n    } else if (e.key === 'Escape') {\r\n      setTempName(layer.name);\r\n      setIsEditingName(false);\r\n    }\r\n  };\r\n\r\n  const handleRemoveLayer = (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    removeLayer(layer.id);\r\n    // console.log(`[DEBUG] Layer removed: ${layer.name}`);\r\n  };\r\n\r\n  const handleDuplicateLayer = (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    duplicateLayer(layer.id);\r\n    // console.log(`[DEBUG] Layer duplicated: ${layer.name}`);\r\n  };\r\n\r\n  const handleBringToFront = (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    bringLayerToFront(layer.id);\r\n    // console.log(`[DEBUG] Layer brought to front: ${layer.name}`);\r\n  };\r\n\r\n  const handleSendToBack = (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    sendLayerToBack(layer.id);\r\n    // console.log(`[DEBUG] Layer sent to back: ${layer.name}`);\r\n  };\r\n\r\n  return (\r\n    <div\r\n      ref={elementRef}\r\n      id={`layer-item-${layer.id}`}\r\n      onClick={handleSelectLayer}\r\n      onMouseDown={handleMouseDown}\r\n      onMouseEnter={handleMouseEnter}\r\n      onMouseLeave={handleMouseLeave}\r\n      onMouseUp={handleMouseUp}\r\n      title=\"Click to select  Ctrl/Cmd+Click for multi-select  Shift+Click for range select\"\r\n      aria-label={`Layer: ${layer.name}`}\r\n      aria-selected={isSelected}\r\n      role=\"option\"\r\n      className={`group p-2 rounded border transition-all cursor-pointer select-none ${\r\n        isDragOver ? 'bg-green-900 border-green-400 scale-105' : ''\r\n      } ${\r\n        isSelected\r\n          ? 'bg-blue-900 border-blue-500 text-white'\r\n          : 'bg-panel-bg border-border text-gray-300 hover:bg-gray-800'\r\n      }`}\r\n    >\r\n      {/* Layer Header */}\r\n      <div className=\"flex items-center gap-2 mb-1\">\r\n        {/* Selection Checkbox - Custom Styled */}\r\n        <button\r\n          id={`btn-layer-select-${layer.id}`}\r\n          onClick={handleCheckboxChange}\r\n          onMouseDown={(e) => e.stopPropagation()}\r\n          className={`w-4 h-4 flex-shrink-0 rounded border-2 flex items-center justify-center transition-colors ${\r\n            isSelected\r\n              ? 'bg-white border-white'\r\n              : 'bg-gray-700 border-gray-600 hover:border-gray-500'\r\n          }`}\r\n          title=\"Select/deselect this layer\"\r\n          aria-label={isSelected ? `Deselect ${layer.name}` : `Select ${layer.name}`}\r\n        >\r\n          {isSelected && (\r\n            <svg className=\"w-3 h-3 text-black\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n              <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\r\n            </svg>\r\n          )}\r\n        </button>\r\n        \r\n        {/* Thumbnail */}\r\n        <div className=\"w-8 h-8 flex-shrink-0 bg-canvas-bg border border-gray-600 rounded overflow-hidden relative\">\r\n          <img\r\n            src={layer.imageData}\r\n            alt={layer.name}\r\n            className=\"w-full h-full object-contain\"\r\n            style={{ imageRendering: 'pixelated' }}\r\n          />\r\n          {/* Text Layer Badge */}\r\n          {isTextLayer(layer) && (\r\n            <div className=\"absolute bottom-0 right-0 bg-blue-600 text-white text-[8px] font-bold px-1 rounded-tl\" title=\"Text Layer\">\r\n              T\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Layer Name */}\r\n        <div className=\"flex-1 min-w-0\">\r\n          {isEditingName ? (\r\n            <input\r\n              id={`input-layer-name-${layer.id}`}\r\n              autoFocus\r\n              type=\"text\"\r\n              value={tempName}\r\n              onChange={(e) => setTempName(e.target.value)}\r\n              onBlur={handleNameSave}\r\n              onKeyDown={handleKeyDown}\r\n              onClick={(e) => e.stopPropagation()}\r\n              className=\"w-full px-1 py-0 bg-canvas-bg border border-blue-400 rounded text-xs text-white focus:outline-none focus:ring-1 focus:ring-blue-300\"\r\n              placeholder=\"Layer name...\"\r\n              aria-label=\"Layer name\"\r\n            />\r\n          ) : (\r\n            <span className=\"text-xs font-medium truncate block\" title={layer.name}>\r\n              {layer.name}\r\n            </span>\r\n          )}\r\n        </div>\r\n\r\n        {/* Rename Button */}\r\n        {!isEditingName && (\r\n          <button\r\n            id={`btn-layer-rename-${layer.id}`}\r\n            onClick={(e) => {\r\n              e.stopPropagation();\r\n              setTempName(layer.name);\r\n              setIsEditingName(true);\r\n            }}\r\n            className=\"w-4 h-4 flex items-center justify-center flex-shrink-0 rounded transition-colors hover:bg-gray-600 opacity-0 group-hover:opacity-100\"\r\n            title=\"Rename layer\"\r\n            aria-label={`Rename ${layer.name}`}\r\n          >\r\n            <svg className=\"w-3 h-3 text-gray-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n              <path d=\"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z\" />\r\n            </svg>\r\n          </button>\r\n        )}\r\n\r\n        {/* Visibility Toggle */}\r\n        <button\r\n          id={`btn-layer-visibility-${layer.id}`}\r\n          onClick={handleToggleVisibility}\r\n          className=\"w-5 h-5 flex items-center justify-center flex-shrink-0 rounded transition-colors hover:bg-gray-600\"\r\n          title={layer.visible ? 'Hide layer' : 'Show layer'}\r\n          aria-label={layer.visible ? `Hide ${layer.name}` : `Show ${layer.name}`}\r\n        >\r\n          {layer.visible ? (\r\n            <svg className=\"w-4 h-4 text-gray-300\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n              <path d=\"M10 12a2 2 0 100-4 2 2 0 000 4z\" />\r\n              <path fillRule=\"evenodd\" d=\"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z\" clipRule=\"evenodd\" />\r\n            </svg>\r\n          ) : (\r\n            <svg className=\"w-4 h-4 text-gray-500\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n              <path fillRule=\"evenodd\" d=\"M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-5.838 1.834l-2.455-2.541zM12.305 15.93A9.959 9.959 0 0110 15c-4.478 0-8.268-2.943-9.542-7a9.88 9.88 0 011.964-2.964l2.386 2.386c-.078.464-.12.94-.12 1.424 0 3.314 2.686 6 6 6a5.975 5.975 0 002.717-.632l2.472 2.472z\" clipRule=\"evenodd\" />\r\n            </svg>\r\n          )}\r\n        </button>\r\n\r\n        {/* Lock Toggle */}\r\n        <button\r\n          id={`btn-layer-lock-${layer.id}`}\r\n          onClick={handleToggleLock}\r\n          className=\"w-5 h-5 flex items-center justify-center flex-shrink-0 rounded transition-colors hover:bg-gray-600\"\r\n          title={layer.locked ? 'Unlock layer' : 'Lock layer'}\r\n          aria-label={layer.locked ? `Unlock ${layer.name}` : `Lock ${layer.name}`}\r\n        >\r\n          {layer.locked ? (\r\n            <svg className=\"w-4 h-4 text-gray-300\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n              <path fillRule=\"evenodd\" d=\"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z\" clipRule=\"evenodd\" />\r\n            </svg>\r\n          ) : (\r\n            <svg className=\"w-4 h-4 text-gray-500\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n              <path d=\"M10 2a5 5 0 00-5 5v2a2 2 0 00-2 2v5a2 2 0 002 2h10a2 2 0 002-2v-5a2 2 0 00-2-2V7a5 5 0 00-5-5zm0 2a3 3 0 013 3v2H7V7a3 3 0 013-3z\" />\r\n            </svg>\r\n          )}\r\n        </button>\r\n      </div>\r\n\r\n      {/* Layer Info */}\r\n      <div className=\"text-xs text-gray-500 px-10 mb-2\">\r\n        {layer.width}{layer.height}  z:{layer.zIndex}\r\n      </div>\r\n\r\n      {/* Layer Controls */}\r\n      <div className=\"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity\">\r\n        {/* Edit Text Button (only for text layers) */}\r\n        {isTextLayer(layer) && (\r\n          <button\r\n            id={`btn-layer-edit-text-${layer.id}`}\r\n            onClick={(e) => {\r\n              e.stopPropagation();\r\n              (window as any).openTextLayerModal?.(layer);\r\n            }}\r\n            className=\"flex-1 px-1 py-1 text-xs bg-blue-700 hover:bg-blue-600 rounded transition-colors flex items-center justify-center\"\r\n            title=\"Edit text\"\r\n            aria-label={`Edit text for ${layer.name}`}\r\n          >\r\n            <span className=\"font-bold text-sm\">T</span>\r\n          </button>\r\n        )}\r\n\r\n        {/* Edit Shape Button (only for shape layers) */}\r\n        {isShapeLayer(layer) && (\r\n          <button\r\n            id={`btn-layer-edit-shape-${layer.id}`}\r\n            onClick={(e) => {\r\n              e.stopPropagation();\r\n              (window as any).openShapeModal?.(layer);\r\n            }}\r\n            className=\"flex-1 px-1 py-1 text-xs bg-purple-700 hover:bg-purple-600 rounded transition-colors flex items-center justify-center\"\r\n            title=\"Edit shape\"\r\n            aria-label={`Edit shape for ${layer.name}`}\r\n          >\r\n            \r\n          </button>\r\n        )}\r\n        <button\r\n          id={`btn-layer-bring-front-${layer.id}`}\r\n          onClick={handleBringToFront}\r\n          className=\"flex-1 px-1 py-1 text-xs bg-gray-700 hover:bg-gray-600 rounded transition-colors flex items-center justify-center\"\r\n          title=\"Bring to front\"\r\n          aria-label={`Bring ${layer.name} to front`}\r\n        >\r\n          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 20 20\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M7 11l5-5m0 0l5 5m-5-5v12\" />\r\n          </svg>\r\n        </button>\r\n        <button\r\n          id={`btn-layer-send-back-${layer.id}`}\r\n          onClick={handleSendToBack}\r\n          className=\"flex-1 px-1 py-1 text-xs bg-gray-700 hover:bg-gray-600 rounded transition-colors flex items-center justify-center\"\r\n          title=\"Send to back\"\r\n          aria-label={`Send ${layer.name} to back`}\r\n        >\r\n          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 20 20\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 9l-5 5m0 0l-5-5m5 5V2\" />\r\n          </svg>\r\n        </button>\r\n        <button\r\n          id={`btn-layer-duplicate-${layer.id}`}\r\n          onClick={handleDuplicateLayer}\r\n          className=\"flex-1 px-1 py-1 text-xs bg-blue-700 hover:bg-blue-600 rounded transition-colors flex items-center justify-center\"\r\n          title=\"Duplicate layer\"\r\n          aria-label={`Duplicate ${layer.name}`}\r\n        >\r\n          <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n            <path d=\"M4 4a2 2 0 012-2h6a2 2 0 012 2v12a1 1 0 110 2h-6a2 2 0 01-2-2V4z\" />\r\n            <path d=\"M14 4a2 2 0 00-2-2v12a2 2 0 002 2h2a2 2 0 002-2V4h-4z\" />\r\n          </svg>\r\n        </button>\r\n        <button\r\n          id={`btn-layer-remove-${layer.id}`}\r\n          onClick={handleRemoveLayer}\r\n          className=\"flex-1 px-1 py-1 text-xs bg-red-700 hover:bg-red-600 rounded transition-colors flex items-center justify-center\"\r\n          title=\"Remove layer\"\r\n          aria-label={`Remove ${layer.name}`}\r\n        >\r\n          <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n            <path fillRule=\"evenodd\" d=\"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z\" clipRule=\"evenodd\" />\r\n          </svg>\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default LayerItem;\r\n","/**\r\n * Custom hook for syncing store state with localStorage\r\n * Persists UI preferences and canvas settings across sessions\r\n */\r\n\r\nimport { useEffect } from 'react';\r\nimport useCompositorStore from '../store/compositorStore';\r\n\r\nconst STORAGE_KEY = 'pixelconnect-preferences';\r\n\r\ninterface StoredPreferences {\r\n  // Grid settings\r\n  gridDensity?: number;\r\n  gridEnabled?: boolean;\r\n  \r\n  // Border settings\r\n  showSelectionBorders?: boolean;\r\n  selectionBorderAnimationSpeed?: number;\r\n  \r\n  // Canvas border settings\r\n  canvasBorderColor?: string;\r\n  canvasBorderWidth?: number;\r\n  canvasBorderOpacity?: number;\r\n  canvasBorderEnabled?: boolean;\r\n  canvasShadowIntensity?: number;\r\n}\r\n\r\n/**\r\n * Load preferences from localStorage\r\n */\r\nexport function loadPreferences(): StoredPreferences {\r\n  try {\r\n    const stored = localStorage.getItem(STORAGE_KEY);\r\n    if (stored) {\r\n      return JSON.parse(stored);\r\n    }\r\n  } catch (error) {\r\n    console.warn('[DEBUG] Failed to load preferences from localStorage:', error);\r\n  }\r\n  return {};\r\n}\r\n\r\n/**\r\n * Save preferences to localStorage\r\n */\r\nexport function savePreferences(preferences: StoredPreferences): void {\r\n  try {\r\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(preferences));\r\n  } catch (error) {\r\n    console.warn('[DEBUG] Failed to save preferences to localStorage:', error);\r\n  }\r\n}\r\n\r\n/**\r\n * Hook to initialize preferences on app load\r\n */\r\nexport function useInitializePreferences(): void {\r\n  useEffect(() => {\r\n    const preferences = loadPreferences();\r\n    \r\n    // Apply stored preferences to store\r\n    if (preferences.gridDensity !== undefined) {\r\n      useCompositorStore.getState().setGridDensity(preferences.gridDensity);\r\n    }\r\n    if (preferences.gridEnabled !== undefined) {\r\n      const currentGridEnabled = useCompositorStore.getState().project.grid.enabled;\r\n      if (currentGridEnabled !== preferences.gridEnabled) {\r\n        useCompositorStore.getState().toggleGrid();\r\n      }\r\n    }\r\n    if (preferences.showSelectionBorders !== undefined) {\r\n      const currentShowBorders = useCompositorStore.getState().ui.showSelectionBorders;\r\n      if (currentShowBorders !== preferences.showSelectionBorders) {\r\n        useCompositorStore.getState().toggleSelectionBorders();\r\n      }\r\n    }\r\n    if (preferences.selectionBorderAnimationSpeed !== undefined) {\r\n      useCompositorStore.getState().setSelectionBorderAnimationSpeed(preferences.selectionBorderAnimationSpeed);\r\n    }\r\n    \r\n    // Apply canvas border settings\r\n    const canvasUpdates: any = {};\r\n    if (preferences.canvasBorderColor !== undefined) {\r\n      canvasUpdates.borderColor = preferences.canvasBorderColor;\r\n    }\r\n    if (preferences.canvasBorderWidth !== undefined) {\r\n      canvasUpdates.borderWidth = preferences.canvasBorderWidth;\r\n    }\r\n    if (preferences.canvasBorderOpacity !== undefined) {\r\n      canvasUpdates.borderOpacity = preferences.canvasBorderOpacity;\r\n    }\r\n    if (Object.keys(canvasUpdates).length > 0) {\r\n      useCompositorStore.getState().setCanvasConfig(canvasUpdates);\r\n    }\r\n    \r\n    // console.log('[DEBUG] Preferences loaded from localStorage');\r\n  }, []);\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport useCompositorStore from '../../store/compositorStore';\r\nimport { savePreferences, loadPreferences } from '../../hooks/useLocalStorage';\r\n\r\n/**\r\n * Canvas settings component\r\n * Allows configuration of canvas size and background\r\n */\r\nfunction CanvasSettings() {\r\n  const canvas = useCompositorStore((state) => state.project.canvas);\r\n  const layers = useCompositorStore((state) => state.project.layers);\r\n  const setCanvasConfig = useCompositorStore((state) => state.setCanvasConfig);\r\n  const cropCanvasToLayers = useCompositorStore((state) => state.cropCanvasToLayers);\r\n  const [isCollapsed, setIsCollapsed] = useState(false);\r\n  const [displayWidth, setDisplayWidth] = useState(String(canvas.width));\r\n  const [displayHeight, setDisplayHeight] = useState(String(canvas.height));\r\n\r\n  const handleWidthChange = (value: string) => {\r\n    // Allow any input including empty strings for display\r\n    setDisplayWidth(value);\r\n    // Only update state if it's a valid positive number\r\n    if (value !== '' && value !== '-') {\r\n      const width = parseInt(value, 10);\r\n      if (!isNaN(width) && width > 0) {\r\n        setCanvasConfig({ width });\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleHeightChange = (value: string) => {\r\n    // Allow any input including empty strings for display\r\n    setDisplayHeight(value);\r\n    // Only update state if it's a valid positive number\r\n    if (value !== '' && value !== '-') {\r\n      const height = parseInt(value, 10);\r\n      if (!isNaN(height) && height > 0) {\r\n        setCanvasConfig({ height });\r\n      }\r\n    }\r\n  };\r\n\r\n  // Sync display values when canvas config changes from outside\r\n  useEffect(() => {\r\n    setDisplayWidth(String(canvas.width));\r\n  }, [canvas.width]);\r\n\r\n  useEffect(() => {\r\n    setDisplayHeight(String(canvas.height));\r\n  }, [canvas.height]);\r\n\r\n  // Sync canvas settings to localStorage\r\n  useEffect(() => {\r\n    const preferences = loadPreferences();\r\n    preferences.canvasBorderEnabled = canvas.borderEnabled;\r\n    preferences.canvasShadowIntensity = canvas.shadowIntensity;\r\n    savePreferences(preferences);\r\n  }, [canvas.borderEnabled, canvas.shadowIntensity]);\r\n\r\n  const handleBackgroundColorChange = (value: string) => {\r\n    if (value === 'transparent') {\r\n      setCanvasConfig({ backgroundColor: null });\r\n      // console.log('[DEBUG] Canvas background set to transparent');\r\n    } else if (value.startsWith('#')) {\r\n      setCanvasConfig({ backgroundColor: value });\r\n      // console.log(`[DEBUG] Canvas background color changed to ${value}`);\r\n    }\r\n  };\r\n\r\n  const handleCommonSizeChange = (size: string) => {\r\n    const [w, h] = size.split('x').map(Number);\r\n    if (!isNaN(w) && !isNaN(h) && w > 0 && h > 0) {\r\n      setCanvasConfig({ width: w, height: h });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"border-t border-border bg-gray-850\" data-region=\"canvas-settings\">\r\n      {/* Collapsible Header */}\r\n      <button\r\n        id=\"btn-toggle-canvas-settings\"\r\n        onClick={() => setIsCollapsed(!isCollapsed)}\r\n        className=\"w-full px-3 py-2 flex items-center justify-between text-xs font-semibold text-gray-300 hover:bg-gray-800 transition-colors group\"\r\n        aria-label={isCollapsed ? 'Expand canvas settings' : 'Collapse canvas settings'}\r\n        aria-expanded={!isCollapsed}\r\n      >\r\n        <span>Canvas</span>\r\n        <span className={`text-gray-400 transition-transform group-hover:drop-shadow-lg group-hover:text-gray-200 ${isCollapsed ? '' : 'rotate-180'}`}></span>\r\n      </button>\r\n\r\n      {/* Collapsible Content */}\r\n      {!isCollapsed && (\r\n        <div className=\"p-3 space-y-3 bg-gray-850\">\r\n\r\n      {/* Common Sizes Dropdown */}\r\n      <div>\r\n        <label className=\"text-xs text-gray-400 block mb-1\">Common Sizes</label>\r\n        <select\r\n          id=\"select-canvas-size\"\r\n          onChange={(e) => handleCommonSizeChange(e.target.value)}\r\n          className=\"w-full px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-white focus:outline-none focus:ring-1 focus:ring-blue-400 cursor-pointer\"\r\n          defaultValue=\"\"\r\n          aria-label=\"Common canvas sizes\"\r\n        >\r\n          <option value=\"\">Select a size...</option>\r\n          <option value=\"1024x1024\">1024x1024</option>\r\n          <option value=\"2048x2048\">2048x2048</option>\r\n          <option value=\"1920x1080\">1920x1080</option>\r\n          <option value=\"3840x2160\">3840x2160 (4K)</option>\r\n          <option value=\"4632x2316\">4632x2316</option>\r\n          <option value=\"2316x4632\">2316x4632 (Vertical)</option>\r\n          <option value=\"3276x3276\">3276x3276</option>\r\n        </select>\r\n      </div>\r\n\r\n      {/* Canvas Size */}\r\n      <div className=\"grid grid-cols-2 gap-2\">\r\n        <div>\r\n          <label className=\"text-xs text-gray-400 block mb-1\">Width</label>\r\n          <input\r\n            id=\"input-canvas-width\"\r\n            type=\"text\"\r\n            inputMode=\"numeric\"\r\n            value={displayWidth}\r\n            onChange={(e) => handleWidthChange(e.target.value)}\r\n            className=\"w-full px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-white focus:outline-none focus:ring-1 focus:ring-blue-400\"\r\n            placeholder=\"Width\"\r\n            aria-label=\"Canvas width\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"text-xs text-gray-400 block mb-1\">Height</label>\r\n          <input\r\n            id=\"input-canvas-height\"\r\n            type=\"text\"\r\n            inputMode=\"numeric\"\r\n            value={displayHeight}\r\n            onChange={(e) => handleHeightChange(e.target.value)}\r\n            className=\"w-full px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-white focus:outline-none focus:ring-1 focus:ring-blue-400\"\r\n            placeholder=\"Height\"\r\n            aria-label=\"Canvas height\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Crop to Layers Button */}\r\n      <button\r\n        id=\"btn-crop-canvas-to-layers\"\r\n        onClick={() => {\r\n          cropCanvasToLayers();\r\n          // Auto-fit zoom after crop settles\r\n          (window as any).fitCanvasToScreen?.();\r\n        }}\r\n        disabled={layers.length === 0}\r\n        className={`w-full px-3 py-2 rounded transition-colors text-xs font-medium ${\r\n          layers.length === 0\r\n            ? 'bg-gray-700 text-gray-500 cursor-not-allowed'\r\n            : 'bg-slate-700 text-white hover:bg-slate-600'\r\n        }`}\r\n        title={layers.length === 0 ? 'Add layers first to crop canvas' : 'Crop canvas to layer bounds'}\r\n        aria-label=\"Crop canvas to layer bounds\"\r\n      >\r\n        Crop Canvas to Layers\r\n      </button>\r\n\r\n      {/* Background Color */}\r\n      <div>\r\n        <label className=\"text-xs text-gray-400 block mb-1\">Background</label>\r\n        <div className=\"flex gap-1\">\r\n          <input\r\n            id=\"input-bg-color\"\r\n            type=\"color\"\r\n            value={canvas.backgroundColor || '#ffffff'}\r\n            onChange={(e) => handleBackgroundColorChange(e.target.value)}\r\n            className=\"flex-1 h-8 rounded cursor-pointer border border-border\"\r\n            title=\"Pick background color\"\r\n            aria-label=\"Background color\"\r\n          />\r\n          <button\r\n            id=\"btn-bg-transparent\"\r\n            onClick={() => handleBackgroundColorChange('transparent')}\r\n            className={`flex-1 px-2 py-1 text-xs font-medium rounded transition-colors ${\r\n              canvas.backgroundColor === null\r\n                ? 'bg-blue-600 text-white'\r\n                : 'bg-panel-bg text-gray-400 hover:text-gray-300'\r\n            }`}\r\n            title=\"Set background to transparent\"\r\n            aria-label=\"Set background to transparent\"\r\n          >\r\n            Clear\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Border Settings */}\r\n      <div className=\"space-y-2 pt-2 border-t border-border\">\r\n        <div className=\"text-xs font-semibold text-gray-300\">Border</div>\r\n        \r\n        <div className=\"flex items-center gap-2\">\r\n          <input\r\n            type=\"checkbox\"\r\n            id=\"input-border-enabled\"\r\n            checked={canvas.borderEnabled ?? true}\r\n            onChange={(e) => setCanvasConfig({ borderEnabled: e.target.checked })}\r\n            className=\"w-4 h-4 rounded cursor-pointer\"\r\n            title=\"Enable or disable canvas border\"\r\n            aria-label=\"Enable or disable canvas border\"\r\n          />\r\n          <label htmlFor=\"input-border-enabled\" className=\"text-xs text-gray-400 cursor-pointer flex-1\">\r\n            Show Border\r\n          </label>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Shadow Settings */}\r\n      <div className=\"space-y-2 pt-2 border-t border-border\">\r\n        <div className=\"text-xs font-semibold text-gray-300\">Shadow</div>\r\n        \r\n        <div>\r\n          <label className=\"text-xs text-gray-400 block mb-1\">Intensity</label>\r\n          <input\r\n            id=\"input-shadow-intensity\"\r\n            type=\"range\"\r\n            min=\"0\"\r\n            max=\"1\"\r\n            step=\"0.1\"\r\n            value={canvas.shadowIntensity ?? 0.5}\r\n            onChange={(e) => setCanvasConfig({ shadowIntensity: parseFloat(e.target.value) })}\r\n            className=\"w-full h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer\"\r\n            title=\"Shadow intensity (0 = off, 1 = max)\"\r\n            aria-label=\"Shadow intensity\"\r\n          />\r\n          <div className=\"text-xs text-gray-500 mt-1\">\r\n            {Math.round((canvas.shadowIntensity ?? 0.5) * 100)}%\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Checkered Background */}\r\n      <div className=\"space-y-2 pt-2 border-t border-border\">\r\n        <div className=\"flex items-center gap-2\">\r\n          <input\r\n            type=\"checkbox\"\r\n            id=\"input-checkered-bg\"\r\n            checked={canvas.showCheckeredBackground ?? false}\r\n            onChange={(e) => setCanvasConfig({ showCheckeredBackground: e.target.checked })}\r\n            disabled={canvas.backgroundColor !== null}\r\n            className=\"w-4 h-4 rounded cursor-pointer disabled:opacity-50\"\r\n            title=\"Show checkered pattern for transparency (only available when background is transparent)\"\r\n            aria-label=\"Show checkered background\"\r\n          />\r\n          <label htmlFor=\"input-checkered-bg\" className={`text-xs cursor-pointer flex-1 ${canvas.backgroundColor !== null ? 'text-gray-600' : 'text-gray-400'}`}>\r\n            Checkered Background\r\n          </label>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Drag Info */}\r\n      <div className=\"space-y-2 pt-2 border-t border-border\">\r\n        <div className=\"flex items-center gap-2\">\r\n          <input\r\n            type=\"checkbox\"\r\n            id=\"input-drag-info\"\r\n            checked={canvas.dragInfoEnabled ?? true}\r\n            onChange={(e) => setCanvasConfig({ dragInfoEnabled: e.target.checked })}\r\n            className=\"w-4 h-4 rounded cursor-pointer\"\r\n            title=\"Show drag translation info when dragging layers\"\r\n            aria-label=\"Show drag info tooltip\"\r\n          />\r\n          <label htmlFor=\"input-drag-info\" className=\"text-xs text-gray-400 cursor-pointer flex-1\">\r\n            Show Drag Info\r\n          </label>\r\n        </div>\r\n      </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default CanvasSettings;\r\n","import { useRef } from 'react';\r\nimport useCompositorStore from '../../store/compositorStore';\r\nimport LayerItem from './LayerItem';\r\nimport CanvasSettings from '../PropertyPanel/CanvasSettings';\r\n\r\n/**\r\n * Layer panel component\r\n * Displays list of layers and layer management controls\r\n */\r\nfunction LayerPanel() {\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n  const project = useCompositorStore((state) => state.project);\r\n  const selectedLayerIds = useCompositorStore((state) => state.selectedLayerIds);\r\n  const selectAllLayers = useCompositorStore((state) => state.selectAllLayers);\r\n  const deselectAllLayers = useCompositorStore((state) => state.deselectAllLayers);\r\n  const deleteSelectedLayers = useCompositorStore((state) => state.deleteSelectedLayers);\r\n  const addLayer = useCompositorStore((state) => state.addLayer);\r\n\r\n  // Sort layers by z-index for display (highest z-index at top)\r\n  const sortedLayers = [...project.layers].sort((a, b) => b.zIndex - a.zIndex);\r\n\r\n  const handleDeleteSelected = () => {\r\n    if (selectedLayerIds.length === 0) {\r\n      console.warn('[DEBUG] No layers selected for deletion');\r\n      return;\r\n    }\r\n\r\n    const confirmed = window.confirm(\r\n      `Delete ${selectedLayerIds.length} layer${selectedLayerIds.length !== 1 ? 's' : ''}?`\r\n    );\r\n\r\n    if (confirmed) {\r\n      // console.log(`[DEBUG] Deleting ${selectedLayerIds.length} selected layer(s)`);\r\n      deleteSelectedLayers();\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Handle image file upload\r\n   * Converts images to base64 data URIs\r\n   */\r\n  const handleImageUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const files = event.currentTarget.files;\r\n    if (!files) {\r\n      console.warn('[DEBUG] No files selected');\r\n      return;\r\n    }\r\n\r\n    // console.log(`[DEBUG] Processing ${files.length} image file(s)`);\r\n\r\n    for (const file of Array.from(files)) {\r\n      try {\r\n        // Validate file type\r\n        if (!['image/png', 'image/gif', 'image/bmp', 'image/jpeg'].includes(file.type)) {\r\n          console.warn(`[DEBUG] Unsupported file type: ${file.type}`);\r\n          alert(`Unsupported file type: ${file.type}. Please use PNG, GIF, BMP, or JPEG.`);\r\n          continue;\r\n        }\r\n\r\n        // console.log(`[DEBUG] Loading image: ${file.name} (${file.size} bytes, ${file.type})`);\r\n\r\n        const dataUrl = await new Promise<string>((resolve, reject) => {\r\n          const reader = new FileReader();\r\n          reader.onload = (e) => resolve(e.target?.result as string);\r\n          reader.onerror = () => reject(new Error('Failed to read file'));\r\n          reader.readAsDataURL(file);\r\n        });\r\n\r\n        // Create a temporary image to get dimensions\r\n        const img = new Image();\r\n        img.src = dataUrl;\r\n\r\n        await new Promise<void>((resolve, reject) => {\r\n          img.onload = () => resolve();\r\n          img.onerror = () => reject(new Error('Failed to load image'));\r\n        });\r\n\r\n        const width = img.naturalWidth;\r\n        const height = img.naturalHeight;\r\n\r\n        // console.log(`[DEBUG] Image loaded: ${file.name} (${width}x${height})`);\r\n\r\n        // Add layer to store\r\n        addLayer({\r\n          name: file.name,\r\n          imageData: dataUrl,\r\n          x: 0,\r\n          y: 0,\r\n          zIndex: useCompositorStore.getState().project.layers.length,\r\n          visible: true,\r\n          locked: false,\r\n          opacity: 1.0,\r\n          width,\r\n          height,\r\n        });\r\n\r\n        // console.log(`[DEBUG] Layer added: ${file.name}`);\r\n      } catch (error) {\r\n        // console.error(`[DEBUG] Error loading image ${file.name}:`, error);\r\n        alert(`Error loading image ${file.name}: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n      }\r\n    }\r\n\r\n    // Reset file input\r\n    if (fileInputRef.current) {\r\n      fileInputRef.current.value = '';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"h-full flex flex-col bg-canvas-bg\" data-region=\"layer-panel\">\r\n      {/* Header */}\r\n      <div className=\"px-3 py-3 border-b border-border\">\r\n        <h2 className=\"text-sm font-semibold text-gray-300 mb-3\">Layers</h2>\r\n\r\n        {/* Layer Panel Controls */}\r\n        <div className=\"flex gap-1 flex-wrap\">\r\n          <button\r\n            id=\"btn-select-all-layers\"\r\n            onClick={selectAllLayers}\r\n            disabled={project.layers.length === 0}\r\n            className=\"flex-1 min-w-16 px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-300 bg-panel-bg hover:bg-gray-700 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n            title=\"Select all layers (Ctrl+A)\"\r\n            aria-label=\"Select all layers\"\r\n          >\r\n            All\r\n          </button>\r\n\r\n          <button\r\n            id=\"btn-deselect-all-layers\"\r\n            onClick={deselectAllLayers}\r\n            disabled={selectedLayerIds.length === 0}\r\n            className=\"flex-1 min-w-16 px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-300 bg-panel-bg hover:bg-gray-700 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n            title=\"Deselect all layers (Ctrl+D)\"\r\n            aria-label=\"Deselect all layers\"\r\n          >\r\n            None\r\n          </button>\r\n\r\n          <button\r\n            id=\"btn-delete-selected-layers\"\r\n            onClick={handleDeleteSelected}\r\n            disabled={selectedLayerIds.length === 0}\r\n            className=\"flex-1 min-w-16 px-2 py-1 text-xs font-medium text-red-400 hover:text-red-300 bg-panel-bg hover:bg-red-900 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n            title=\"Delete selected layers (Delete)\"\r\n            aria-label=\"Delete selected layers\"\r\n          >\r\n            Delete\r\n          </button>\r\n\r\n          <button\r\n            id=\"btn-create-text-layer\"\r\n            onClick={() => (window as any).openTextLayerModal?.()}\r\n            className=\"flex-1 min-w-16 px-2 py-1 text-xs font-medium text-blue-400 hover:text-blue-300 bg-panel-bg hover:bg-blue-900 rounded transition-colors flex items-center justify-center gap-1\"\r\n            title=\"Create text layer\"\r\n            aria-label=\"Create text layer\"\r\n          >\r\n            <span className=\"font-bold\">T</span>\r\n          </button>\r\n\r\n          <button\r\n            id=\"btn-create-shape-layer\"\r\n            onClick={() => (window as any).openShapeModal?.()}\r\n            className=\"flex-1 min-w-16 px-2 py-1 text-xs font-medium text-purple-400 hover:text-purple-300 bg-panel-bg hover:bg-purple-900 rounded transition-colors\"\r\n            title=\"Create shape layer\"\r\n            aria-label=\"Create shape layer\"\r\n          >\r\n            \r\n          </button>\r\n\r\n          <button\r\n            id=\"btn-upload-images\"\r\n            onClick={() => fileInputRef.current?.click()}\r\n            className=\"flex-1 min-w-16 px-2 py-1 text-xs font-medium text-green-400 hover:text-green-300 bg-panel-bg hover:bg-green-900 rounded transition-colors\"\r\n            title=\"Upload additional images\"\r\n            aria-label=\"Upload additional images\"\r\n          >\r\n            Add\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Layer List */}\r\n      <div className=\"flex-1 overflow-y-auto\">\r\n        {sortedLayers.length === 0 ? (\r\n          <div className=\"px-3 py-8 text-center text-sm text-gray-500\">\r\n            <div className=\"mb-2\">No layers yet</div>\r\n            <div className=\"text-xs\">Upload images to get started</div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-1 p-2\">\r\n            {sortedLayers.map((layer) => (\r\n              <LayerItem\r\n                key={layer.id}\r\n                layer={layer}\r\n                isSelected={selectedLayerIds.includes(layer.id)}\r\n              />\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Footer Info */}\r\n      {project.layers.length > 0 && (\r\n        <div className=\"px-3 py-2 border-t border-border text-xs text-gray-500\">\r\n          {project.layers.length} layer{project.layers.length !== 1 ? 's' : ''}\r\n          {selectedLayerIds.length > 0 && `  ${selectedLayerIds.length} selected`}\r\n        </div>\r\n      )}\r\n\r\n      {/* Canvas Settings (moved from Property panel) */}\r\n      <div className=\"border-t border-border px-3 py-2 bg-panel-bg\">\r\n        <CanvasSettings />\r\n      </div>\r\n\r\n      {/* Hidden file input */}\r\n      <input\r\n        ref={fileInputRef}\r\n        id=\"input-upload-images\"\r\n        type=\"file\"\r\n        multiple\r\n        accept=\"image/png,image/gif,image/bmp,image/jpeg\"\r\n        onChange={handleImageUpload}\r\n        className=\"hidden\"\r\n        aria-label=\"Upload images\"\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default LayerPanel;\r\n","import { useEffect, useState } from 'react';\r\nimport useCompositorStore from '../../store/compositorStore';\r\nimport { Layer } from '../../types/compositor.types';\r\n\r\ninterface PositionInputsProps {\r\n  layer: Layer;\r\n}\r\n\r\n/**\r\n * Position input controls for a single layer\r\n */\r\nfunction PositionInputs({ layer }: PositionInputsProps) {\r\n  const updateLayer = useCompositorStore((state) => state.updateLayer);\r\n  const pushHistory = useCompositorStore((state) => state.pushHistory);\r\n  const isDraggingLayer = useCompositorStore((state) => state.ui.isDraggingLayer);\r\n  const dragLayerId = useCompositorStore((state) => state.ui.dragLayerId);\r\n  const dragOffsetX = useCompositorStore((state) => state.ui.dragOffsetX);\r\n  const dragOffsetY = useCompositorStore((state) => state.ui.dragOffsetY);\r\n  \r\n  // Local state for display values to allow clearing\r\n  const [inputX, setInputX] = useState(String(layer.x));\r\n  const [inputY, setInputY] = useState(String(layer.y));\r\n\r\n  // Show preview position during drag, otherwise show actual position\r\n  const isDraggingThisLayer = isDraggingLayer && dragLayerId === layer.id;\r\n  const displayX = isDraggingThisLayer ? Math.floor(layer.x + dragOffsetX) : layer.x;\r\n  const displayY = isDraggingThisLayer ? Math.floor(layer.y + dragOffsetY) : layer.y;\r\n\r\n  // Sync display values when layer position changes from outside\r\n  useEffect(() => {\r\n    setInputX(String(displayX));\r\n  }, [displayX]);\r\n\r\n  useEffect(() => {\r\n    setInputY(String(displayY));\r\n  }, [displayY]);\r\n\r\n  const handleXChange = (value: string) => {\r\n    // Allow any input including empty strings for display\r\n    setInputX(value);\r\n    // Only update state if it's a valid number\r\n    if (value !== '' && value !== '-') {\r\n      const x = parseInt(value, 10);\r\n      if (!isNaN(x)) {\r\n        updateLayer(layer.id, { x });\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleYChange = (value: string) => {\r\n    // Allow any input including empty strings for display\r\n    setInputY(value);\r\n    // Only update state if it's a valid number\r\n    if (value !== '' && value !== '-') {\r\n      const y = parseInt(value, 10);\r\n      if (!isNaN(y)) {\r\n        updateLayer(layer.id, { y });\r\n      }\r\n    }\r\n  };\r\n\r\n  // Push history when position input loses focus (finalized)\r\n  const handlePositionFinalized = () => {\r\n    pushHistory();\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-panel-bg rounded p-3 space-y-3\" data-region=\"position-inputs\">\r\n      <div className=\"text-xs font-semibold text-gray-300\">Position</div>\r\n\r\n      {/* X Position */}\r\n      <div>\r\n        <label className=\"text-xs text-gray-400 block mb-1\">X</label>\r\n        <input\r\n          id=\"input-layer-x\"\r\n          type=\"text\"\r\n          inputMode=\"numeric\"\r\n          value={inputX}\r\n          onChange={(e) => handleXChange(e.target.value)}\r\n          onBlur={handlePositionFinalized}\r\n          className=\"w-full px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-white focus:outline-none focus:ring-1 focus:ring-blue-400\"\r\n          placeholder=\"X position\"\r\n          aria-label=\"Layer X position\"\r\n        />\r\n      </div>\r\n\r\n      {/* Y Position */}\r\n      <div>\r\n        <label className=\"text-xs text-gray-400 block mb-1\">Y</label>\r\n        <input\r\n          id=\"input-layer-y\"\r\n          type=\"text\"\r\n          inputMode=\"numeric\"\r\n          value={inputY}\r\n          onChange={(e) => handleYChange(e.target.value)}\r\n          onBlur={handlePositionFinalized}\r\n          className=\"w-full px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-white focus:outline-none focus:ring-1 focus:ring-blue-400\"\r\n          placeholder=\"Y position\"\r\n          aria-label=\"Layer Y position\"\r\n        />\r\n      </div>\r\n\r\n      {/* Dimensions (read-only) */}\r\n      <div className=\"grid grid-cols-2 gap-2 pt-2 border-t border-border\">\r\n        <div>\r\n          <label className=\"text-xs text-gray-400 block mb-1\">Width</label>\r\n          <div className=\"px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-gray-500\">\r\n            {layer.width}\r\n          </div>\r\n        </div>\r\n        <div>\r\n          <label className=\"text-xs text-gray-400 block mb-1\">Height</label>\r\n          <div className=\"px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-gray-500\">\r\n            {layer.height}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Z-Index (read-only) */}\r\n      <div>\r\n        <label className=\"text-xs text-gray-400 block mb-1\">Z-Index</label>\r\n        <div className=\"px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-gray-500\">\r\n          {layer.zIndex}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default PositionInputs;\r\n","import useCompositorStore from '../../store/compositorStore';\r\n\r\ninterface OpacityControlsProps {\r\n  layer: { id: string; opacity: number };\r\n}\r\n\r\n/**\r\n * Opacity controls for a single layer\r\n */\r\nfunction OpacityControl({ layer }: OpacityControlsProps) {\r\n  const updateLayer = useCompositorStore((state) => state.updateLayer);\r\n\r\n  const handleOpacityChange = (value: number) => {\r\n    const opacity = Math.max(0, Math.min(1, value / 100));\r\n    updateLayer(layer.id, { opacity });\r\n    // console.log(`[DEBUG] Layer opacity changed to ${(opacity * 100).toFixed(1)}%`);\r\n  };\r\n\r\n  const opacity = layer.opacity !== undefined ? layer.opacity : 1.0;\r\n\r\n  return (\r\n    <div className=\"bg-panel-bg rounded p-3 space-y-2\" data-region=\"opacity-control\">\r\n      <div className=\"text-xs font-semibold text-gray-300\">Opacity</div>\r\n      \r\n      {/* Opacity Slider */}\r\n      <div className=\"space-y-2\">\r\n        <input\r\n          id=\"input-layer-opacity\"\r\n          type=\"range\"\r\n          min=\"0\"\r\n          max=\"100\"\r\n          value={opacity * 100}\r\n          onChange={(e) => handleOpacityChange(parseInt(e.target.value))}\r\n          className=\"w-full h-2 bg-canvas-bg rounded appearance-none cursor-pointer accent-blue-400\"\r\n          aria-label=\"Layer opacity\"\r\n        />\r\n        \r\n        {/* Opacity Percentage Display */}\r\n        <div className=\"flex items-center justify-between\">\r\n          <span className=\"text-xs text-gray-400\">\r\n            {(opacity * 100).toFixed(0)}%\r\n          </span>\r\n          \r\n          {/* Quick presets */}\r\n          <div className=\"flex gap-1\">\r\n            <button\r\n              id=\"btn-opacity-50\"\r\n              onClick={() => handleOpacityChange(50)}\r\n              className=\"px-2 py-1 text-xs bg-canvas-bg hover:bg-border rounded transition\"\r\n              title=\"50% opacity\"\r\n              aria-label=\"Set 50% opacity\"\r\n            >\r\n              50%\r\n            </button>\r\n            <button\r\n              id=\"btn-opacity-100\"\r\n              onClick={() => handleOpacityChange(100)}\r\n              className=\"px-2 py-1 text-xs bg-canvas-bg hover:bg-border rounded transition\"\r\n              title=\"100% opacity (fully opaque)\"\r\n              aria-label=\"Set 100% opacity\"\r\n            >\r\n              100%\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default OpacityControl;\r\n","import { useState, useRef, useEffect } from 'react';\r\nimport { Layer } from '../../types/compositor.types';\r\n\r\ninterface ColorCount {\r\n  hex: string;\r\n  count: number;\r\n  percent: number;\r\n  hasAlpha?: boolean;\r\n  alpha?: number;\r\n}\r\n\r\n/**\r\n * Analyzes a layer's image data to extract color information\r\n * Handles both RGB and RGBA color analysis with deduplication\r\n * Uses efficient virtual scrolling for large color sets\r\n * Supports unloading results to free memory\r\n */\r\nfunction ColorAnalysis({ layer }: { layer: Layer }) {\r\n  const [colorsRGB, setColorsRGB] = useState<ColorCount[] | null>(null);\r\n  const [colorsRGBA, setColorsRGBA] = useState<ColorCount[] | null>(null);\r\n  const [isAnalyzing, setIsAnalyzing] = useState(false);\r\n  const [visibleColorsRGB, setVisibleColorsRGB] = useState<Set<number>>(new Set());\r\n  const [visibleColorsRGBA, setVisibleColorsRGBA] = useState<Set<number>>(new Set());\r\n  const scrollContainerRGBRef = useRef<HTMLDivElement>(null);\r\n  const scrollContainerRGBARef = useRef<HTMLDivElement>(null);\r\n  const itemHeightRef = useRef(28); // Approximate height of each color item in pixels\r\n\r\n  // Clear results when layer changes to avoid showing stale data\r\n  useEffect(() => {\r\n    setColorsRGB(null);\r\n    setColorsRGBA(null);\r\n    setVisibleColorsRGB(new Set());\r\n    setVisibleColorsRGBA(new Set());\r\n  }, [layer.id]);\r\n\r\n  // Virtual scroll handler for RGB colors\r\n  const handleScrollRGB = () => {\r\n    if (!scrollContainerRGBRef.current || !colorsRGB) return;\r\n\r\n    const container = scrollContainerRGBRef.current;\r\n    const scrollTop = container.scrollTop;\r\n    const containerHeight = container.clientHeight;\r\n    const itemHeight = itemHeightRef.current;\r\n\r\n    const startIndex = Math.max(0, Math.floor(scrollTop / itemHeight) - 2);\r\n    const endIndex = Math.min(colorsRGB.length, Math.ceil((scrollTop + containerHeight) / itemHeight) + 2);\r\n\r\n    const newVisibleColors = new Set<number>();\r\n    for (let i = startIndex; i < endIndex; i++) {\r\n      newVisibleColors.add(i);\r\n    }\r\n\r\n    setVisibleColorsRGB(newVisibleColors);\r\n  };\r\n\r\n  // Virtual scroll handler for RGBA colors\r\n  const handleScrollRGBA = () => {\r\n    if (!scrollContainerRGBARef.current || !colorsRGBA) return;\r\n\r\n    const container = scrollContainerRGBARef.current;\r\n    const scrollTop = container.scrollTop;\r\n    const containerHeight = container.clientHeight;\r\n    const itemHeight = itemHeightRef.current;\r\n\r\n    const startIndex = Math.max(0, Math.floor(scrollTop / itemHeight) - 2);\r\n    const endIndex = Math.min(colorsRGBA.length, Math.ceil((scrollTop + containerHeight) / itemHeight) + 2);\r\n\r\n    const newVisibleColors = new Set<number>();\r\n    for (let i = startIndex; i < endIndex; i++) {\r\n      newVisibleColors.add(i);\r\n    }\r\n\r\n    setVisibleColorsRGBA(newVisibleColors);\r\n  };\r\n\r\n  // Setup scroll listeners\r\n  useEffect(() => {\r\n    const rgbContainer = scrollContainerRGBRef.current;\r\n    if (rgbContainer) {\r\n      rgbContainer.addEventListener('scroll', handleScrollRGB);\r\n      handleScrollRGB();\r\n      return () => rgbContainer.removeEventListener('scroll', handleScrollRGB);\r\n    }\r\n  }, [colorsRGB]);\r\n\r\n  useEffect(() => {\r\n    const rgbaContainer = scrollContainerRGBARef.current;\r\n    if (rgbaContainer) {\r\n      rgbaContainer.addEventListener('scroll', handleScrollRGBA);\r\n      handleScrollRGBA();\r\n      return () => rgbaContainer.removeEventListener('scroll', handleScrollRGBA);\r\n    }\r\n  }, [colorsRGBA]);\r\n\r\n      const analyzeColors = async (includeAlpha: boolean) => {\r\n    setIsAnalyzing(true);\r\n    try {\r\n      const img = new Image();\r\n      img.onload = () => {\r\n        const canvas = document.createElement('canvas');\r\n        canvas.width = img.width;\r\n        canvas.height = img.height;\r\n        const ctx = canvas.getContext('2d');\r\n        if (!ctx) {\r\n          console.error('Failed to get canvas context');\r\n          setIsAnalyzing(false);\r\n          return;\r\n        }\r\n\r\n        ctx.drawImage(img, 0, 0);\r\n        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n        const data = imageData.data;\r\n\r\n        if (includeAlpha) {\r\n          // RGBA mode: Count colors with alpha channel\r\n          const colorMap = new Map<string, number>();\r\n          let totalPixels = 0;\r\n\r\n          for (let i = 0; i < data.length; i += 4) {\r\n            const r = data[i];\r\n            const g = data[i + 1];\r\n            const b = data[i + 2];\r\n            const a = data[i + 3];\r\n\r\n            // Skip fully transparent pixels\r\n            if (a === 0) continue;\r\n\r\n            totalPixels++;\r\n\r\n            // Create hex string with alpha\r\n            const hex = `#${((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1).toUpperCase()}`;\r\n            const hexWithAlpha = `${hex}${a.toString(16).padStart(2, '0').toUpperCase()}`;\r\n            colorMap.set(hexWithAlpha, (colorMap.get(hexWithAlpha) || 0) + 1);\r\n          }\r\n\r\n          // Convert to array and calculate percentages\r\n          totalPixels = Math.max(1, totalPixels);\r\n          const colors: ColorCount[] = Array.from(colorMap.entries())\r\n            .map(([colorKey, pixelCount]) => {\r\n              const hex = colorKey.substring(0, 7);\r\n              const alpha = parseInt(colorKey.substring(7), 16);\r\n\r\n              return {\r\n                hex,\r\n                count: pixelCount,\r\n                percent: (pixelCount / totalPixels) * 100,\r\n                hasAlpha: true,\r\n                alpha,\r\n              };\r\n            })\r\n            .filter(color => {\r\n              // Filter out fully transparent pixels\r\n              if (color.hex === '#000000' && color.alpha === 0) {\r\n                return false;\r\n              }\r\n              return true;\r\n            })\r\n            .sort((a, b) => b.count - a.count); // Sort by frequency descending\r\n\r\n          setColorsRGBA(colors);\r\n          setVisibleColorsRGBA(new Set());\r\n        } else {\r\n          // RGB mode: Count only fully opaque colors, deduplicate by hex only\r\n          const colorMap = new Map<string, number>();\r\n          let totalPixels = 0;\r\n\r\n          for (let i = 0; i < data.length; i += 4) {\r\n            const r = data[i];\r\n            const g = data[i + 1];\r\n            const b = data[i + 2];\r\n            const a = data[i + 3];\r\n\r\n            // Skip any non-fully-opaque pixels (including semi-transparent)\r\n            if (a !== 255) continue;\r\n\r\n            totalPixels++;\r\n\r\n            // Create hex string (ignoring alpha)\r\n            const hex = `#${((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1).toUpperCase()}`;\r\n            colorMap.set(hex, (colorMap.get(hex) || 0) + 1);\r\n          }\r\n\r\n          // Convert to array and calculate percentages\r\n          totalPixels = Math.max(1, totalPixels);\r\n          const colors: ColorCount[] = Array.from(colorMap.entries())\r\n            .map(([hex, pixelCount]) => ({\r\n              hex,\r\n              count: pixelCount,\r\n              percent: (pixelCount / totalPixels) * 100,\r\n              hasAlpha: false,\r\n              alpha: undefined,\r\n            }))\r\n            .sort((a, b) => b.count - a.count); // Sort by frequency descending\r\n\r\n          setColorsRGB(colors);\r\n          setVisibleColorsRGB(new Set());\r\n        }\r\n      };\r\n\r\n      img.onerror = () => {\r\n        console.error('Failed to load image for color analysis');\r\n        setIsAnalyzing(false);\r\n      };\r\n\r\n      img.src = layer.imageData;\r\n    } finally {\r\n      setIsAnalyzing(false);\r\n    }\r\n  };  const copyToClipboard = (text: string) => {\r\n    navigator.clipboard.writeText(text).catch(() => {\r\n      console.error('Failed to copy to clipboard');\r\n    });\r\n  };\r\n\r\n  const copyAllColorsToClipboard = (colors: ColorCount[] | null, includeAlpha: boolean) => {\r\n    if (!colors || colors.length === 0) return;\r\n\r\n    const colorStrings = colors.map(color => {\r\n      if (includeAlpha && color.alpha !== undefined) {\r\n        return `${color.hex}${color.alpha.toString(16).toUpperCase().padStart(2, '0')}`;\r\n      }\r\n      return color.hex;\r\n    });\r\n\r\n    const clipboardText = colorStrings.join('\\n');\r\n    copyToClipboard(clipboardText);\r\n  };\r\n\r\n  const renderColorList = (\r\n    colors: ColorCount[] | null,\r\n    visibleIndices: Set<number>,\r\n    scrollRef: React.RefObject<HTMLDivElement>\r\n  ) => {\r\n    if (!colors || colors.length === 0) {\r\n      return <p className=\"text-xs text-gray-500 p-2\">No colors found</p>;\r\n    }\r\n\r\n    // Render only visible colors\r\n    const renderedItems: React.ReactNode[] = [];\r\n    const sortedIndices = Array.from(visibleIndices).sort((a, b) => a - b);\r\n\r\n    for (const index of sortedIndices) {\r\n      const color = colors[index];\r\n      if (!color) continue;\r\n\r\n      renderedItems.push(\r\n        <div\r\n          key={`${color.hex}-${index}`}\r\n          className=\"flex items-center gap-2 px-2 py-1 text-xs hover:bg-gray-700 border-b border-gray-700/50 last:border-b-0 transition-colors\"\r\n          style={{ height: `${itemHeightRef.current}px` }}\r\n        >\r\n          {/* Color swatch */}\r\n          <div\r\n            className=\"w-4 h-4 rounded border border-gray-600 flex-shrink-0\"\r\n            style={{\r\n              backgroundColor: color.hex,\r\n            }}\r\n            title={color.hex}\r\n          />\r\n\r\n          {/* Hex value */}\r\n          <span className=\"font-mono text-gray-300 min-w-fit text-xs\">{color.hex}</span>\r\n\r\n          {/* Alpha value if applicable */}\r\n          {color.hasAlpha && color.alpha !== undefined && (\r\n            <span className=\"font-mono text-gray-500 text-xs\">{color.alpha.toString(16).toUpperCase().padStart(2, '0')}</span>\r\n          )}\r\n\r\n          {/* Count and percentage */}\r\n          <div className=\"ml-auto flex items-center gap-1 flex-shrink-0\">\r\n            <span className=\"font-mono text-gray-400 text-xs\">{color.count}</span>\r\n            <span className=\"text-gray-600 text-xs\">({color.percent.toFixed(2)}%)</span>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    // Calculate spacer heights for virtual scrolling\r\n    const minIndex = visibleIndices.size > 0 ? Math.min(...visibleIndices) : 0;\r\n    const maxIndex = visibleIndices.size > 0 ? Math.max(...visibleIndices) : 0;\r\n    const spacerTopHeight = Math.max(0, minIndex) * itemHeightRef.current;\r\n    const spacerBottomHeight = Math.max(0, colors.length - (maxIndex + 1)) * itemHeightRef.current;\r\n\r\n    return (\r\n      <div\r\n        ref={scrollRef}\r\n        className=\"max-h-64 overflow-y-auto bg-gray-800/50 rounded border border-gray-700 text-xs\"\r\n        style={{ height: '256px' }}\r\n      >\r\n        <div style={{ height: spacerTopHeight }} />\r\n        {renderedItems}\r\n        <div style={{ height: spacerBottomHeight }} />\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-panel-bg rounded p-3 space-y-2\" data-region=\"color-analysis\">\r\n      <div className=\"text-xs font-semibold text-gray-300\">Analyze Colors</div>\r\n\r\n      {/* RGB Analysis Button */}\r\n      <button\r\n        id=\"btn-analyze-rgb\"\r\n        onClick={() => analyzeColors(false)}\r\n        disabled={isAnalyzing}\r\n        className=\"w-full px-3 py-1 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-700 disabled:cursor-not-allowed text-xs font-medium text-blue-400 rounded transition-colors\"\r\n        aria-label=\"Analyze RGB colors\"\r\n      >\r\n        {isAnalyzing ? 'Analyzing...' : 'Get Colors...'}\r\n      </button>\r\n\r\n      {/* RGB Results */}\r\n      {colorsRGB && (\r\n        <div className=\"space-y-1\">\r\n          <div className=\"flex items-center justify-between text-xs text-gray-400\">\r\n            <span>{colorsRGB.length} colors (RGB)  {Math.floor(colorsRGB.reduce((sum, c) => sum + c.count, 0))} pixels</span>\r\n            <button\r\n              id=\"btn-copy-rgb-colors\"\r\n              onClick={() => copyAllColorsToClipboard(colorsRGB, false)}\r\n              className=\"p-1 text-gray-500 hover:text-gray-300 transition-colors flex-shrink-0\"\r\n              title=\"Copy all colors to clipboard\"\r\n              aria-label=\"Copy all RGB colors to clipboard\"\r\n            >\r\n              <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                <path d=\"M4 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V2z\" />\r\n                <path fillOpacity=\"0.5\" d=\"M2 6a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-2h-2v2H2V8h2V6H2z\" />\r\n              </svg>\r\n            </button>\r\n          </div>\r\n          {renderColorList(colorsRGB, visibleColorsRGB, scrollContainerRGBRef)}\r\n        </div>\r\n      )}\r\n\r\n      {/* Divider */}\r\n      {colorsRGB && <div className=\"my-2 border-t border-gray-700\" />}\r\n\r\n      {/* RGBA Analysis Button */}\r\n      <button\r\n        id=\"btn-analyze-rgba\"\r\n        onClick={() => analyzeColors(true)}\r\n        disabled={isAnalyzing}\r\n        className=\"w-full px-3 py-1 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-700 disabled:cursor-not-allowed text-xs font-medium text-purple-400 rounded transition-colors\"\r\n        aria-label=\"Analyze RGBA colors\"\r\n      >\r\n        {isAnalyzing ? 'Analyzing...' : 'Get Colors (inc. transparent pixels)...'}\r\n      </button>\r\n\r\n      {/* RGBA Results */}\r\n      {colorsRGBA && (\r\n        <div className=\"space-y-1\">\r\n          <div className=\"flex items-center justify-between text-xs text-gray-400\">\r\n            <span>{colorsRGBA.length} colors (RGBA)  {Math.floor(colorsRGBA.reduce((sum, c) => sum + c.count, 0))} pixels</span>\r\n            <button\r\n              id=\"btn-copy-rgba-colors\"\r\n              onClick={() => copyAllColorsToClipboard(colorsRGBA, true)}\r\n              className=\"p-1 text-gray-500 hover:text-gray-300 transition-colors flex-shrink-0\"\r\n              title=\"Copy all colors to clipboard\"\r\n              aria-label=\"Copy all RGBA colors to clipboard\"\r\n            >\r\n              <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                <path d=\"M4 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V2z\" />\r\n                <path fillOpacity=\"0.5\" d=\"M2 6a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-2h-2v2H2V8h2V6H2z\" />\r\n              </svg>\r\n            </button>\r\n          </div>\r\n          {renderColorList(colorsRGBA, visibleColorsRGBA, scrollContainerRGBARef)}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ColorAnalysis;\r\n","/**\r\n * Shape rasterizer for converting shapes to high-quality images\r\n */\r\n\r\nexport interface ShapeRasterizeOptions {\r\n  shapeType: 'rectangle' | 'circle' | 'triangle' | 'hexagon' | 'octagon' | 'star';\r\n  size: number;\r\n  stretchX: number; // 0.1-20.0\r\n  stretchY: number; // 0.1-20.0\r\n  color: string; // Hex color\r\n}\r\n\r\nexport interface RasterizedShape {\r\n  dataUrl: string;\r\n  width: number;\r\n  height: number;\r\n  offsetX: number; // Offset from center for proper positioning\r\n  offsetY: number;\r\n}\r\n\r\n/**\r\n * Calculate bounding box for the shape\r\n */\r\nfunction getShapeBounds(options: ShapeRasterizeOptions, radius: number): { minX: number; maxX: number; minY: number; maxY: number } {\r\n  const { shapeType, stretchX, stretchY } = options;\r\n  \r\n  let minX = Infinity, maxX = -Infinity, minY = Infinity, maxY = -Infinity;\r\n\r\n  const updateBounds = (x: number, y: number) => {\r\n    minX = Math.min(minX, x);\r\n    maxX = Math.max(maxX, x);\r\n    minY = Math.min(minY, y);\r\n    maxY = Math.max(maxY, y);\r\n  };\r\n\r\n  if (shapeType === 'rectangle' || shapeType === 'circle') {\r\n    // For rectangle and circle (ellipse), bounds are simple\r\n    const width = radius * 2 * stretchX;\r\n    const height = radius * 2 * stretchY;\r\n    return {\r\n      minX: -width / 2,\r\n      maxX: width / 2,\r\n      minY: -height / 2,\r\n      maxY: height / 2\r\n    };\r\n  }\r\n\r\n  // For polygons and stars, calculate vertices\r\n  let sides = 3;\r\n  if (shapeType === 'hexagon') sides = 6;\r\n  if (shapeType === 'octagon') sides = 8;\r\n  \r\n  if (shapeType === 'star') {\r\n    const points = 5;\r\n    const outerRadius = radius * stretchX;\r\n    const innerRadius = (radius * 0.4) * stretchX;\r\n    const angleStep = (Math.PI * 2) / (points * 2);\r\n    let startAngle = -Math.PI / 2;\r\n\r\n    for (let i = 0; i < points * 2; i++) {\r\n      const currentAngle = startAngle + angleStep * i;\r\n      const isOuter = i % 2 === 0;\r\n      \r\n      // Calculate raw coordinates on unit circle (scaled by radius)\r\n      // We use the same logic as drawStar but we need to be careful about stretch\r\n      // In drawStar:\r\n      // outerRadius = radius * stretchX\r\n      // innerRadius = radius * 0.4 * stretchX\r\n      // px = x + cos * r\r\n      // py = y + sin * r * stretchY\r\n      // This means X is scaled by stretchX (via r), and Y is scaled by stretchX * stretchY?\r\n      // No, wait.\r\n      // In drawStar:\r\n      // const r = isOuter ? outerRadius : innerRadius;\r\n      // const px = x + Math.cos(currentAngle) * r;\r\n      // const py = y + Math.sin(currentAngle) * r * stretchY;\r\n      \r\n      // If stretchX=1, stretchY=1: r=radius. px=cos*radius. py=sin*radius. Correct.\r\n      // If stretchX=2, stretchY=1: r=2*radius. px=cos*2*radius. py=sin*2*radius. Correct (2x width).\r\n      // If stretchX=1, stretchY=2: r=radius. px=cos*radius. py=sin*radius*2. Correct (2x height).\r\n      \r\n      // So we need to replicate this exactly.\r\n      const r = isOuter ? outerRadius : innerRadius;\r\n      const px = Math.cos(currentAngle) * r;\r\n      const py = Math.sin(currentAngle) * r * stretchY;\r\n      \r\n      updateBounds(px, py);\r\n    }\r\n  } else {\r\n    // Polygons\r\n    const angleStep = (Math.PI * 2) / sides;\r\n    let startAngle = -Math.PI / 2;\r\n    \r\n    for (let i = 0; i < sides; i++) {\r\n      const currentAngle = startAngle + angleStep * i;\r\n      const rawX = Math.cos(currentAngle) * radius;\r\n      const rawY = Math.sin(currentAngle) * radius;\r\n      updateBounds(rawX * stretchX, rawY * stretchY);\r\n    }\r\n  }\r\n\r\n  return { minX, maxX, minY, maxY };\r\n}\r\n\r\n/**\r\n * Rasterize shape to a high-DPI image\r\n */\r\nexport async function rasterizeShape(options: ShapeRasterizeOptions): Promise<RasterizedShape> {\r\n  const { shapeType, size, stretchX, stretchY, color } = options;\r\n\r\n  // For pixel-perfect rendering (no AA), we use 1x scale\r\n  // This matches the behavior of the text tool's \"disable transparency\" mode\r\n  const scale = 1;\r\n\r\n  const radius = (size * scale) / 2;\r\n  \r\n  // Calculate exact bounds\r\n  const bounds = getShapeBounds(options, radius);\r\n  const width = bounds.maxX - bounds.minX;\r\n  const height = bounds.maxY - bounds.minY;\r\n  \r\n  // No padding for pixel-perfect rendering\r\n  const padding = 0; \r\n  const canvasWidth = Math.ceil(width + padding * 2);\r\n  const canvasHeight = Math.ceil(height + padding * 2);\r\n\r\n  const canvas = document.createElement('canvas');\r\n  canvas.width = canvasWidth;\r\n  canvas.height = canvasHeight;\r\n\r\n  const ctx = canvas.getContext('2d');\r\n  if (!ctx) throw new Error('Failed to get canvas context');\r\n\r\n  // Disable smoothing for pixel-perfect rendering\r\n  ctx.imageSmoothingEnabled = false;\r\n  ctx.imageSmoothingQuality = 'low';\r\n\r\n  // Draw shape\r\n  ctx.fillStyle = color;\r\n  \r\n  // Center the shape in the canvas\r\n  ctx.translate(padding - bounds.minX, padding - bounds.minY);\r\n\r\n  switch (shapeType) {\r\n    case 'rectangle':\r\n      drawRectangle(ctx, 0, 0, radius, stretchX, stretchY);\r\n      break;\r\n    case 'circle':\r\n      drawCircle(ctx, 0, 0, radius, stretchX, stretchY);\r\n      break;\r\n    case 'triangle':\r\n      drawPolygon(ctx, 0, 0, radius, 3, stretchX, stretchY);\r\n      break;\r\n    case 'hexagon':\r\n      drawPolygon(ctx, 0, 0, radius, 6, stretchX, stretchY);\r\n      break;\r\n    case 'octagon':\r\n      drawPolygon(ctx, 0, 0, radius, 8, stretchX, stretchY);\r\n      break;\r\n    case 'star':\r\n      drawStar(ctx, 0, 0, radius, stretchX, stretchY);\r\n      break;\r\n  }\r\n\r\n  // Apply alpha thresholding to remove any anti-aliasing artifacts\r\n  // This ensures pixels are either fully transparent or fully opaque\r\n  const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n  const data = imageData.data;\r\n  \r\n  // Parse target color\r\n  const r = parseInt(color.slice(1, 3), 16);\r\n  const g = parseInt(color.slice(3, 5), 16);\r\n  const b = parseInt(color.slice(5, 7), 16);\r\n  \r\n  for (let i = 0; i < data.length; i += 4) {\r\n    // Threshold alpha at 128\r\n    if (data[i + 3] >= 128) {\r\n      data[i + 3] = 255; // Fully opaque\r\n      // Force exact color to remove any anti-aliasing artifacts\r\n      data[i] = r;\r\n      data[i + 1] = g;\r\n      data[i + 2] = b;\r\n    } else {\r\n      data[i + 3] = 0; // Fully transparent\r\n    }\r\n  }\r\n  \r\n  ctx.putImageData(imageData, 0, 0);\r\n\r\n  // Convert to data URL\r\n  const dataUrl = canvas.toDataURL('image/png');\r\n\r\n  return {\r\n    dataUrl,\r\n    width: canvasWidth,\r\n    height: canvasHeight,\r\n    offsetX: 0,\r\n    offsetY: 0\r\n  };\r\n}\r\n\r\nfunction drawRectangle(\r\n  ctx: CanvasRenderingContext2D,\r\n  x: number,\r\n  y: number,\r\n  radius: number,\r\n  stretchX: number,\r\n  stretchY: number\r\n) {\r\n  const width = radius * 2 * stretchX;\r\n  const height = radius * 2 * stretchY;\r\n  ctx.fillRect(x - width / 2, y - height / 2, width, height);\r\n}\r\n\r\nfunction drawCircle(\r\n  ctx: CanvasRenderingContext2D,\r\n  x: number,\r\n  y: number,\r\n  radius: number,\r\n  stretchX: number,\r\n  stretchY: number\r\n) {\r\n  ctx.beginPath();\r\n  // For circles with stretch, use ellipse\r\n  if (stretchX === stretchY) {\r\n    ctx.arc(x, y, radius * stretchX, 0, Math.PI * 2);\r\n  } else {\r\n    ctx.ellipse(x, y, radius * stretchX, radius * stretchY, 0, 0, Math.PI * 2);\r\n  }\r\n  ctx.fill();\r\n}\r\n\r\nfunction drawPolygon(\r\n  ctx: CanvasRenderingContext2D,\r\n  x: number,\r\n  y: number,\r\n  radius: number,\r\n  sides: number,\r\n  stretchX: number,\r\n  stretchY: number\r\n) {\r\n  ctx.beginPath();\r\n\r\n  const angle = (Math.PI * 2) / sides;\r\n  let startAngle = -Math.PI / 2;\r\n\r\n  for (let i = 0; i < sides; i++) {\r\n    const currentAngle = startAngle + angle * i;\r\n    const px = x + Math.cos(currentAngle) * radius * stretchX;\r\n    const py = y + Math.sin(currentAngle) * radius * stretchY;\r\n\r\n    if (i === 0) {\r\n      ctx.moveTo(px, py);\r\n    } else {\r\n      ctx.lineTo(px, py);\r\n    }\r\n  }\r\n\r\n  ctx.closePath();\r\n  ctx.fill();\r\n}\r\n\r\nfunction drawStar(\r\n  ctx: CanvasRenderingContext2D,\r\n  x: number,\r\n  y: number,\r\n  radius: number,\r\n  stretchX: number,\r\n  stretchY: number\r\n) {\r\n  const points = 5;\r\n  const outerRadius = radius * stretchX;\r\n  const innerRadius = (radius * 0.4) * stretchX;\r\n\r\n  ctx.beginPath();\r\n\r\n  const angle = (Math.PI * 2) / (points * 2);\r\n  let startAngle = -Math.PI / 2;\r\n\r\n  for (let i = 0; i < points * 2; i++) {\r\n    const currentAngle = startAngle + angle * i;\r\n    const isOuter = i % 2 === 0;\r\n    const r = isOuter ? outerRadius : innerRadius;\r\n\r\n    const px = x + Math.cos(currentAngle) * r;\r\n    const py = y + Math.sin(currentAngle) * r * stretchY;\r\n\r\n    if (i === 0) {\r\n      ctx.moveTo(px, py);\r\n    } else {\r\n      ctx.lineTo(px, py);\r\n    }\r\n  }\r\n\r\n  ctx.closePath();\r\n  ctx.fill();\r\n}\r\n","import useCompositorStore from '../../store/compositorStore';\r\nimport { Layer } from '../../types/compositor.types';\r\nimport { rasterizeShape } from '../../utils/shapeRasterizer';\r\n\r\ninterface ShapePropertiesProps {\r\n  layer: Layer;\r\n}\r\n\r\n/**\r\n * Shape properties component\r\n * Displays and allows editing of shape-specific properties\r\n */\r\nfunction ShapeProperties({ layer }: ShapePropertiesProps) {\r\n  const updateLayer = useCompositorStore((state) => state.updateLayer);\r\n\r\n  if (!layer.shapeType) {\r\n    return null;\r\n  }\r\n\r\n  const handleShapeTypeChange = async (newType: typeof layer.shapeType) => {\r\n    if (!newType) return;\r\n\r\n    try {\r\n      const result = await rasterizeShape({\r\n        shapeType: newType,\r\n        size: layer.shapeSize || 200,\r\n        stretchX: layer.shapeStretchX || 1,\r\n        stretchY: layer.shapeStretchY || 1,\r\n        color: layer.shapeColor || '#FFFFFF',\r\n      });\r\n\r\n      updateLayer(layer.id, {\r\n        imageData: result.dataUrl,\r\n        width: result.width,\r\n        height: result.height,\r\n        x: layer.x - result.offsetX,\r\n        y: layer.y - result.offsetY,\r\n        shapeType: newType,\r\n      } as any);\r\n    } catch (error) {\r\n      console.error('Failed to update shape type:', error);\r\n    }\r\n  };\r\n\r\n  const handleSizeChange = async (newSize: number) => {\r\n    try {\r\n      if (!layer.shapeType) return;\r\n      const result = await rasterizeShape({\r\n        shapeType: layer.shapeType,\r\n        size: newSize,\r\n        stretchX: layer.shapeStretchX || 1,\r\n        stretchY: layer.shapeStretchY || 1,\r\n        color: layer.shapeColor || '#FFFFFF',\r\n      });\r\n\r\n      updateLayer(layer.id, {\r\n        imageData: result.dataUrl,\r\n        width: result.width,\r\n        height: result.height,\r\n        x: layer.x - result.offsetX,\r\n        y: layer.y - result.offsetY,\r\n        shapeSize: newSize,\r\n      } as any);\r\n    } catch (error) {\r\n      console.error('Failed to update shape size:', error);\r\n    }\r\n  };\r\n\r\n  const handleStretchXChange = async (newStretch: number) => {\r\n    try {\r\n      if (!layer.shapeType) return;\r\n      const result = await rasterizeShape({\r\n        shapeType: layer.shapeType,\r\n        size: layer.shapeSize || 200,\r\n        stretchX: newStretch,\r\n        stretchY: layer.shapeStretchY || 1,\r\n        color: layer.shapeColor || '#FFFFFF',\r\n      });\r\n\r\n      updateLayer(layer.id, {\r\n        imageData: result.dataUrl,\r\n        width: result.width,\r\n        height: result.height,\r\n        x: layer.x - result.offsetX,\r\n        y: layer.y - result.offsetY,\r\n        shapeStretchX: newStretch,\r\n      } as any);\r\n    } catch (error) {\r\n      console.error('Failed to update shape stretch X:', error);\r\n    }\r\n  };\r\n\r\n  const handleStretchYChange = async (newStretch: number) => {\r\n    try {\r\n      if (!layer.shapeType) return;\r\n      const result = await rasterizeShape({\r\n        shapeType: layer.shapeType,\r\n        size: layer.shapeSize || 200,\r\n        stretchX: layer.shapeStretchX || 1,\r\n        stretchY: newStretch,\r\n        color: layer.shapeColor || '#FFFFFF',\r\n      });\r\n\r\n      updateLayer(layer.id, {\r\n        imageData: result.dataUrl,\r\n        width: result.width,\r\n        height: result.height,\r\n        x: layer.x - result.offsetY,\r\n        y: layer.y - result.offsetY,\r\n        shapeStretchY: newStretch,\r\n      } as any);\r\n    } catch (error) {\r\n      console.error('Failed to update shape stretch Y:', error);\r\n    }\r\n  };\r\n\r\n  const handleColorChange = async (newColor: string) => {\r\n    try {\r\n      if (!layer.shapeType) return;\r\n      const result = await rasterizeShape({\r\n        shapeType: layer.shapeType,\r\n        size: layer.shapeSize || 200,\r\n        stretchX: layer.shapeStretchX || 1,\r\n        stretchY: layer.shapeStretchY || 1,\r\n        color: newColor,\r\n      });\r\n\r\n      updateLayer(layer.id, {\r\n        imageData: result.dataUrl,\r\n        width: result.width,\r\n        height: result.height,\r\n        x: layer.x - result.offsetX,\r\n        y: layer.y - result.offsetY,\r\n        shapeColor: newColor,\r\n      } as any);\r\n    } catch (error) {\r\n      console.error('Failed to update shape color:', error);\r\n    }\r\n  };\r\n\r\n  const SHAPE_TYPES = ['rectangle', 'circle', 'triangle', 'hexagon', 'octagon', 'star'] as const;\r\n\r\n  return (\r\n    <div className=\"bg-panel-bg rounded p-3 space-y-3\" data-region=\"shape-properties\">\r\n      <div className=\"text-xs font-semibold text-gray-300\">Shape Properties</div>\r\n\r\n      {/* Shape Type */}\r\n      <div>\r\n        <label className=\"text-xs text-gray-400 block mb-1\">Type</label>\r\n        <select\r\n          id=\"select-shape-type\"\r\n          value={layer.shapeType}\r\n          onChange={(e) => handleShapeTypeChange(e.target.value as typeof layer.shapeType)}\r\n          className=\"w-full px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-white focus:outline-none focus:ring-1 focus:ring-blue-400\"\r\n          aria-label=\"Shape type\"\r\n        >\r\n          {SHAPE_TYPES.map((type) => (\r\n            <option key={type} value={type}>\r\n              {type.charAt(0).toUpperCase() + type.slice(1)}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      {/* Size */}\r\n      <div>\r\n        <label className=\"text-xs text-gray-400 block mb-1\">\r\n          Size: {layer.shapeSize || 200}px\r\n        </label>\r\n        <input\r\n          id=\"input-shape-size\"\r\n          type=\"range\"\r\n          min=\"10\"\r\n          max=\"500\"\r\n          value={layer.shapeSize || 200}\r\n          onChange={(e) => handleSizeChange(Number(e.target.value))}\r\n          className=\"w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer\"\r\n          aria-label=\"Shape size\"\r\n        />\r\n      </div>\r\n\r\n      {/* Stretch X */}\r\n      <div>\r\n        <label className=\"text-xs text-gray-400 block mb-1\">\r\n          Stretch X: {(layer.shapeStretchX || 1).toFixed(2)}x\r\n        </label>\r\n        <input\r\n          id=\"input-shape-stretch-x\"\r\n          type=\"range\"\r\n          min=\"0.1\"\r\n          max=\"20\"\r\n          step=\"0.1\"\r\n          value={layer.shapeStretchX || 1}\r\n          onChange={(e) => handleStretchXChange(Number(e.target.value))}\r\n          className=\"w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer\"\r\n          aria-label=\"Shape stretch X\"\r\n        />\r\n      </div>\r\n\r\n      {/* Stretch Y */}\r\n      <div>\r\n        <label className=\"text-xs text-gray-400 block mb-1\">\r\n          Stretch Y: {(layer.shapeStretchY || 1).toFixed(2)}x\r\n        </label>\r\n        <input\r\n          id=\"input-shape-stretch-y\"\r\n          type=\"range\"\r\n          min=\"0.1\"\r\n          max=\"20\"\r\n          step=\"0.1\"\r\n          value={layer.shapeStretchY || 1}\r\n          onChange={(e) => handleStretchYChange(Number(e.target.value))}\r\n          className=\"w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer\"\r\n          aria-label=\"Shape stretch Y\"\r\n        />\r\n      </div>\r\n\r\n      {/* Color */}\r\n      <div>\r\n        <label className=\"text-xs text-gray-400 block mb-1\">Color</label>\r\n        <div className=\"flex gap-2\">\r\n          <input\r\n            id=\"input-shape-color\"\r\n            type=\"color\"\r\n            value={layer.shapeColor || '#FFFFFF'}\r\n            onChange={(e) => handleColorChange(e.target.value)}\r\n            className=\"w-12 h-8 rounded cursor-pointer border border-border\"\r\n            aria-label=\"Shape color\"\r\n          />\r\n          <input\r\n            id=\"input-shape-color-hex\"\r\n            type=\"text\"\r\n            value={layer.shapeColor || '#FFFFFF'}\r\n            onChange={(e) => {\r\n              if (/^#[0-9A-F]{6}$/i.test(e.target.value)) {\r\n                handleColorChange(e.target.value);\r\n              }\r\n            }}\r\n            placeholder=\"#FFFFFF\"\r\n            className=\"flex-1 px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-white focus:outline-none focus:ring-1 focus:ring-blue-400\"\r\n            aria-label=\"Shape color hex value\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Edit Button */}\r\n      <button\r\n        id=\"btn-edit-shape\"\r\n        onClick={() => (window as any).openShapeModal?.(layer)}\r\n        className=\"w-full px-3 py-2 bg-purple-600 hover:bg-purple-700 text-white text-xs font-medium rounded transition-colors\"\r\n        aria-label=\"Edit shape in modal\"\r\n      >\r\n        Edit Shape\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ShapeProperties;\r\n","import { useState, useEffect } from 'react';\r\n\r\n/**\r\n * Detects if the viewport is in portrait mode (height > width).\r\n * Updates on resize and orientation change.\r\n */\r\nexport function usePortraitMode(): boolean {\r\n  const [isPortrait, setIsPortrait] = useState(() => {\r\n    return window.innerHeight > window.innerWidth;\r\n  });\r\n\r\n  useEffect(() => {\r\n    const check = () => setIsPortrait(window.innerHeight > window.innerWidth);\r\n\r\n    window.addEventListener('resize', check);\r\n    window.addEventListener('orientationchange', check);\r\n\r\n    // Also check via matchMedia for more reliable detection\r\n    const mql = window.matchMedia('(orientation: portrait)');\r\n    const handleChange = (e: MediaQueryListEvent) => setIsPortrait(e.matches);\r\n    mql.addEventListener('change', handleChange);\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', check);\r\n      window.removeEventListener('orientationchange', check);\r\n      mql.removeEventListener('change', handleChange);\r\n    };\r\n  }, []);\r\n\r\n  return isPortrait;\r\n}\r\n","import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { usePortraitMode } from '../../hooks/usePortraitMode';\r\n\r\ntype ResizeDirection = 'n' | 's' | 'e' | 'w' | 'nw' | 'ne' | 'sw' | 'se';\r\n\r\ninterface DraggableModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  title: string;\r\n  children: React.ReactNode | ((size: { width: number; height: number }) => React.ReactNode);\r\n  initialPosition?: { x: number; y: number };\r\n  noPadding?: boolean;\r\n  modalId?: string;\r\n}\r\n\r\nconst DraggableModal: React.FC<DraggableModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  title,\r\n  children,\r\n  initialPosition = { x: 100, y: 100 },\r\n  noPadding = false,\r\n  modalId,\r\n}) => {\r\n  const [position, setPosition] = useState(initialPosition);\r\n  const [isDragging, setIsDragging] = useState(false);\r\n  const [size, setSize] = useState({ width: 1100, height: 900 });\r\n  const [isResizing, setIsResizing] = useState(false);\r\n  const dragStartRef = useRef<{ x: number; y: number } | null>(null);\r\n  const resizeStartRef = useRef<{\r\n    x: number; y: number;\r\n    startWidth: number; startHeight: number;\r\n    startPosX: number; startPosY: number;\r\n    direction: ResizeDirection;\r\n  } | null>(null);\r\n\r\n  // Reset position & size to center of screen whenever modal opens.\r\n  // Uses percentage-based sizing so the modal scales naturally:\r\n  //   - Small screens (e.g. 1366768): ~90% of viewport  ~1229691\r\n  //   - Medium screens (19201080): caps at 1100900 (the ideal max)\r\n  //   - Large screens (2560+): stays at 1100900, centered with plenty of room\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      const vw = window.innerWidth;\r\n      const vh = window.innerHeight;\r\n      const w = Math.min(1100, Math.round(vw * 0.9));\r\n      const h = Math.min(900, Math.round(vh * 0.9));\r\n      setSize({ width: w, height: h });\r\n      setPosition({\r\n        x: Math.max(0, Math.round((vw - w) / 2)),\r\n        y: Math.max(0, Math.round((vh - h) / 2)),\r\n      });\r\n    }\r\n  }, [isOpen]);\r\n\r\n  useEffect(() => {\r\n    const handleMouseMove = (e: MouseEvent) => {\r\n      if (isDragging && dragStartRef.current) {\r\n        const dx = e.clientX - dragStartRef.current.x;\r\n        const dy = e.clientY - dragStartRef.current.y;\r\n        \r\n        setPosition((prev) => {\r\n          const newX = prev.x + dx;\r\n          const newY = prev.y + dy;\r\n          // Keep at least 100px of modal visible horizontally, and title bar on screen vertically\r\n          const minX = -(size.width - 100);\r\n          const maxX = window.innerWidth - 100;\r\n          const minY = 0;\r\n          const maxY = window.innerHeight - 40; // 40px ~ title bar height\r\n          return {\r\n            x: Math.max(minX, Math.min(maxX, newX)),\r\n            y: Math.max(minY, Math.min(maxY, newY)),\r\n          };\r\n        });\r\n        \r\n        dragStartRef.current = { x: e.clientX, y: e.clientY };\r\n      }\r\n    };\r\n\r\n    const handleMouseUp = () => {\r\n      setIsDragging(false);\r\n      dragStartRef.current = null;\r\n    };\r\n\r\n    if (isDragging) {\r\n      window.addEventListener('mousemove', handleMouseMove);\r\n      window.addEventListener('mouseup', handleMouseUp);\r\n    }\r\n\r\n    return () => {\r\n      window.removeEventListener('mousemove', handleMouseMove);\r\n      window.removeEventListener('mouseup', handleMouseUp);\r\n    };\r\n  }, [isDragging]);\r\n\r\n  const handleResizeMouseDown = useCallback((direction: ResizeDirection) => (e: React.MouseEvent) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setIsResizing(true);\r\n    resizeStartRef.current = {\r\n      x: e.clientX,\r\n      y: e.clientY,\r\n      startWidth: size.width,\r\n      startHeight: size.height,\r\n      startPosX: position.x,\r\n      startPosY: position.y,\r\n      direction,\r\n    };\r\n  }, [size, position]);\r\n\r\n  useEffect(() => {\r\n    const MIN_W = 400;\r\n    const MIN_H = 300;\r\n\r\n    const handleResizeMouseMove = (e: MouseEvent) => {\r\n      if (isResizing && resizeStartRef.current) {\r\n        const { x: sx, y: sy, startWidth, startHeight, startPosX, startPosY, direction } = resizeStartRef.current;\r\n        const dx = e.clientX - sx;\r\n        const dy = e.clientY - sy;\r\n\r\n        let newW = startWidth;\r\n        let newH = startHeight;\r\n        let newX = startPosX;\r\n        let newY = startPosY;\r\n\r\n        // Horizontal component\r\n        if (direction.includes('e')) {\r\n          newW = Math.max(MIN_W, startWidth + dx);\r\n        } else if (direction.includes('w')) {\r\n          newW = Math.max(MIN_W, startWidth - dx);\r\n          newX = startPosX + startWidth - newW;\r\n        }\r\n\r\n        // Vertical component\r\n        if (direction.includes('s')) {\r\n          newH = Math.max(MIN_H, startHeight + dy);\r\n        } else if (direction.includes('n')) {\r\n          newH = Math.max(MIN_H, startHeight - dy);\r\n          newY = startPosY + startHeight - newH;\r\n        }\r\n\r\n        setSize({ width: newW, height: newH });\r\n        setPosition({ x: newX, y: newY });\r\n      }\r\n    };\r\n\r\n    const handleResizeMouseUp = () => {\r\n      setIsResizing(false);\r\n      resizeStartRef.current = null;\r\n    };\r\n\r\n    if (isResizing) {\r\n      window.addEventListener('mousemove', handleResizeMouseMove);\r\n      window.addEventListener('mouseup', handleResizeMouseUp);\r\n    }\r\n\r\n    return () => {\r\n      window.removeEventListener('mousemove', handleResizeMouseMove);\r\n      window.removeEventListener('mouseup', handleResizeMouseUp);\r\n    };\r\n  }, [isResizing]);\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <MobileOrDraggable\r\n      modalId={modalId}\r\n      title={title}\r\n      onClose={onClose}\r\n      position={position}\r\n      setPosition={setPosition}\r\n      size={size}\r\n      setSize={setSize}\r\n      noPadding={noPadding}\r\n      isDragging={isDragging}\r\n      setIsDragging={setIsDragging}\r\n      dragStartRef={dragStartRef}\r\n      isResizing={isResizing}\r\n      handleResizeMouseDown={handleResizeMouseDown}\r\n    >\r\n      {typeof children === 'function' ? children(size) : children}\r\n    </MobileOrDraggable>\r\n  );\r\n};\r\n\r\n/**\r\n * Wrapper that renders as a fixed centered modal on portrait/mobile,\r\n * or the original draggable positioned modal on desktop/landscape.\r\n */\r\nconst MobileOrDraggable: React.FC<{\r\n  modalId?: string;\r\n  title: string;\r\n  onClose: () => void;\r\n  position: { x: number; y: number };\r\n  setPosition: React.Dispatch<React.SetStateAction<{ x: number; y: number }>>;\r\n  size: { width: number; height: number };\r\n  setSize: React.Dispatch<React.SetStateAction<{ width: number; height: number }>>;\r\n  noPadding: boolean;\r\n  isDragging: boolean;\r\n  setIsDragging: React.Dispatch<React.SetStateAction<boolean>>;\r\n  dragStartRef: React.MutableRefObject<{ x: number; y: number } | null>;\r\n  isResizing: boolean;\r\n  handleResizeMouseDown: (direction: ResizeDirection) => (e: React.MouseEvent) => void;\r\n  children: React.ReactNode;\r\n}> = ({\r\n  modalId, title, onClose, position, size, noPadding,\r\n  setIsDragging, dragStartRef, handleResizeMouseDown, children,\r\n}) => {\r\n  const isPortrait = usePortraitMode();\r\n\r\n  if (isPortrait) {\r\n    // Mobile: centered overlay with backdrop\r\n    return (\r\n      <div className=\"fixed inset-0 z-[300] flex items-center justify-center\">\r\n        {/* Backdrop */}\r\n        <div className=\"absolute inset-0 bg-black/60\" onClick={onClose} />\r\n        {/* Modal */}\r\n        <div\r\n          id={modalId}\r\n          role=\"dialog\"\r\n          aria-modal=\"true\"\r\n          aria-label={title}\r\n          data-region={modalId || 'modal'}\r\n          className=\"relative flex flex-col bg-panel-bg border border-border rounded-lg shadow-2xl overflow-hidden\"\r\n          style={{ width: '95vw', height: '90vh', maxWidth: '1200px', maxHeight: '95vh', zIndex: 301 }}\r\n        >\r\n          {/* Header  not draggable */}\r\n          <div className=\"flex items-center justify-between px-3 py-2 bg-canvas-bg border-b border-border select-none flex-shrink-0\">\r\n            <h3 className=\"text-sm font-semibold text-gray-200\">{title}</h3>\r\n            <button\r\n              id={modalId ? `${modalId}-close` : undefined}\r\n              onClick={onClose}\r\n              className=\"text-gray-400 hover:text-white focus:outline-none p-1 rounded hover:bg-gray-700 transition-colors\"\r\n              aria-label={`Close ${title}`}\r\n            >\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n              </svg>\r\n            </button>\r\n          </div>\r\n          {/* Content */}\r\n          <div className={`${noPadding ? '' : 'p-4'} text-gray-300 ${noPadding ? 'overflow-hidden' : 'overflow-auto'} flex-1`}>\r\n            {children}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Desktop: original draggable behavior\r\n  return (\r\n    <div\r\n      id={modalId}\r\n      role=\"dialog\"\r\n      aria-modal=\"true\"\r\n      aria-label={title}\r\n      data-region={modalId || 'modal'}\r\n      className=\"fixed flex flex-col bg-panel-bg border border-border rounded shadow-lg overflow-hidden\"\r\n      style={{\r\n        left: position.x,\r\n        top: position.y,\r\n        zIndex: 50,\r\n        width: `${size.width}px`,\r\n        height: `${size.height}px`,\r\n        position: 'absolute',\r\n      }}\r\n    >\r\n      {/* Header */}\r\n      <div\r\n        className=\"flex items-center justify-between px-3 py-2 bg-canvas-bg border-b border-border cursor-move select-none\"\r\n        onMouseDown={(e) => {\r\n          setIsDragging(true);\r\n          dragStartRef.current = { x: e.clientX, y: e.clientY };\r\n        }}\r\n      >\r\n        <h3 className=\"text-sm font-semibold text-gray-200\">{title}</h3>\r\n        <button\r\n          id={modalId ? `${modalId}-close` : undefined}\r\n          onClick={onClose}\r\n          className=\"text-gray-400 hover:text-white focus:outline-none p-1 rounded hover:bg-gray-700 transition-colors\"\r\n          aria-label={`Close ${title}`}\r\n        >\r\n          <svg\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n            className=\"h-4 w-4\"\r\n            fill=\"none\"\r\n            viewBox=\"0 0 24 24\"\r\n            stroke=\"currentColor\"\r\n          >\r\n            <path\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n              strokeWidth={2}\r\n              d=\"M6 18L18 6M6 6l12 12\"\r\n            />\r\n          </svg>\r\n        </button>\r\n      </div>\r\n\r\n      {/* Content */}\r\n      <div className={`${noPadding ? '' : 'p-4'} text-gray-300 ${noPadding ? 'overflow-hidden' : 'overflow-auto'} flex-1`}>\r\n        {children}\r\n      </div>\r\n\r\n      {/* Resize handles  edges (invisible, 5px hit area) */}\r\n      <div onMouseDown={handleResizeMouseDown('n')}  className=\"absolute top-0 left-3 right-3 h-[5px] cursor-ns-resize\" />\r\n      <div onMouseDown={handleResizeMouseDown('s')}  className=\"absolute bottom-0 left-3 right-3 h-[5px] cursor-ns-resize\" />\r\n      <div onMouseDown={handleResizeMouseDown('w')}  className=\"absolute left-0 top-3 bottom-3 w-[5px] cursor-ew-resize\" />\r\n      <div onMouseDown={handleResizeMouseDown('e')}  className=\"absolute right-0 top-3 bottom-3 w-[5px] cursor-ew-resize\" />\r\n\r\n      {/* Resize handles  corners (invisible, 88 hit area) */}\r\n      <div onMouseDown={handleResizeMouseDown('nw')} className=\"absolute top-0 left-0 w-3 h-3 cursor-nwse-resize z-10\" />\r\n      <div onMouseDown={handleResizeMouseDown('ne')} className=\"absolute top-0 right-0 w-3 h-3 cursor-nesw-resize z-10\" />\r\n      <div onMouseDown={handleResizeMouseDown('sw')} className=\"absolute bottom-0 left-0 w-3 h-3 cursor-nesw-resize z-10\" />\r\n      <div onMouseDown={handleResizeMouseDown('se')} className=\"absolute bottom-0 right-0 w-3 h-3 cursor-nwse-resize z-10\" />\r\n\r\n      {/* Visual indicator  bottom-right triangle */}\r\n      <div\r\n        onMouseDown={handleResizeMouseDown('se')}\r\n        className=\"absolute bottom-0 right-0 w-4 h-4 cursor-nwse-resize bg-gray-600 hover:bg-gray-500 transition-colors z-10\"\r\n        aria-label=\"Resize modal\"\r\n        role=\"separator\"\r\n        style={{ clipPath: 'polygon(100% 0, 100% 100%, 0 100%)' }}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DraggableModal;\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport DraggableModal from './DraggableModal';\r\nimport { applyTransparencyMask } from '../../utils/imageProcessing';\r\nimport useCompositorStore from '../../store/compositorStore';\r\nimport { Layer } from '../../types/compositor.types';\r\n\r\ninterface TransparencyMaskModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  layer: Layer;\r\n}\r\n\r\nconst TransparencyMaskModal: React.FC<TransparencyMaskModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  layer,\r\n}) => {\r\n  const [threshold, setThreshold] = useState<number>(128);\r\n  const [previewImage, setPreviewImage] = useState<string | null>(null);\r\n  const [isProcessing, setIsProcessing] = useState<boolean>(false);\r\n  const [zoom, setZoom] = useState<number>(1);\r\n  const [imageDimensions, setImageDimensions] = useState<{ width: number; height: number } | null>(null);\r\n  const [useTemplatePalette, setUseTemplatePalette] = useState<boolean>(true);\r\n  const [hasInitialFit, setHasInitialFit] = useState<boolean>(false);\r\n  const previewContainerRef = useRef<HTMLDivElement>(null);\r\n  const imgRef = useRef<HTMLImageElement>(null);\r\n  const updateLayer = useCompositorStore((state) => state.updateLayer);\r\n\r\n  useEffect(() => {\r\n    if (!isOpen || !layer.imageData) return;\r\n\r\n    const timer = setTimeout(async () => {\r\n      setIsProcessing(true);\r\n      try {\r\n        const result = await applyTransparencyMask(layer.imageData, threshold, false);\r\n        setPreviewImage(result);\r\n      } catch (error) {\r\n        console.error('Failed to apply transparency mask:', error);\r\n      } finally {\r\n        setIsProcessing(false);\r\n      }\r\n    }, 100);\r\n\r\n    setHasInitialFit(false);\r\n    return () => clearTimeout(timer);\r\n  }, [threshold, layer.imageData, isOpen]);\r\n\r\n  const handleApply = async () => {\r\n    if (layer.imageData) {\r\n      try {\r\n        const result = await applyTransparencyMask(layer.imageData, threshold, useTemplatePalette);\r\n        updateLayer(layer.id, { imageData: result });\r\n        onClose();\r\n      } catch (error) {\r\n        console.error('Failed to apply transparency mask with palette reduction:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleZoomIn = () => {\r\n    setZoom((prev) => Math.min(prev + 0.25, 3));\r\n  };\r\n\r\n  const handleZoomOut = () => {\r\n    setZoom((prev) => Math.max(prev - 0.25, 0.1));\r\n  };\r\n\r\n  const calculateFitZoom = (width: number, height: number) => {\r\n    if (!previewContainerRef.current) return 1;\r\n    \r\n    const containerWidth = previewContainerRef.current.clientWidth;\r\n    const containerHeight = previewContainerRef.current.clientHeight;\r\n    \r\n    if (containerWidth <= 0 || containerHeight <= 0) return 1;\r\n\r\n    const scaleX = containerWidth / width;\r\n    const scaleY = containerHeight / height;\r\n    \r\n    const newZoom = Math.min(scaleX, scaleY);\r\n    return Math.max(0.1, newZoom * 0.9);\r\n  };\r\n\r\n  const handleResetZoom = () => {\r\n    if (imageDimensions) {\r\n      setZoom(calculateFitZoom(imageDimensions.width, imageDimensions.height));\r\n    } else {\r\n      setZoom(1);\r\n    }\r\n  };\r\n\r\n  const handleImageLoad = (e: React.SyntheticEvent<HTMLImageElement>) => {\r\n    const img = e.currentTarget;\r\n    setImageDimensions({\r\n      width: img.naturalWidth,\r\n      height: img.naturalHeight,\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (imageDimensions && previewContainerRef.current && !hasInitialFit) {\r\n      setTimeout(() => {\r\n        const fitZoom = calculateFitZoom(imageDimensions.width, imageDimensions.height);\r\n        setZoom(fitZoom);\r\n        setHasInitialFit(true);\r\n      }, 100);\r\n    }\r\n  }, [imageDimensions, hasInitialFit]);\r\n\r\n  return (\r\n    <DraggableModal isOpen={isOpen} title=\"Transparency Mask\" onClose={onClose} modalId=\"modal-transparency-mask\">\r\n      <div className=\"flex flex-col h-full p-4 gap-4 text-gray-200\">\r\n        {/* Preview Container with Zoom and Scroll */}\r\n        <div className=\"flex-1 flex flex-col min-h-0 gap-2\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <label className=\"text-sm font-medium\">Preview</label>\r\n            <div className=\"flex items-center gap-2\">\r\n              <button\r\n                id=\"btn-tmask-zoom-out\"\r\n                onClick={handleZoomOut}\r\n                disabled={zoom <= 0.1}\r\n                className=\"p-1 text-gray-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed transition-colors\"\r\n                title=\"Zoom out\"\r\n                aria-label=\"Zoom out\"\r\n              >\r\n                <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM13 10H7\" />\r\n                </svg>\r\n              </button>\r\n              <span className=\"text-xs text-gray-400 min-w-[45px] text-center\">\r\n                {Math.round(zoom * 100)}%\r\n              </span>\r\n              <button\r\n                id=\"btn-tmask-zoom-in\"\r\n                onClick={handleZoomIn}\r\n                disabled={zoom >= 3}\r\n                className=\"p-1 text-gray-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed transition-colors\"\r\n                title=\"Zoom in\"\r\n                aria-label=\"Zoom in\"\r\n              >\r\n                <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v6m3-3H7\" />\r\n                </svg>\r\n              </button>\r\n              <button\r\n                id=\"btn-tmask-zoom-reset\"\r\n                onClick={handleResetZoom}\r\n                className=\"text-xs px-2 py-1 text-gray-400 hover:text-white bg-gray-700 hover:bg-gray-600 rounded transition-colors\"\r\n                title=\"Reset zoom\"\r\n                aria-label=\"Reset zoom\"\r\n              >\r\n                Reset\r\n              </button>\r\n            </div>\r\n          </div>\r\n          <div\r\n            ref={previewContainerRef}\r\n            className=\"flex-1 relative w-full bg-gray-900 rounded border border-gray-700 overflow-auto\"\r\n          >\r\n            {isProcessing && (\r\n              <div className=\"absolute inset-0 flex items-center justify-center bg-black/50 z-10\">\r\n                <span className=\"text-white font-medium\">Processing...</span>\r\n              </div>\r\n            )}\r\n            {previewImage ? (\r\n              <div \r\n                style={{\r\n                  display: 'inline-block',\r\n                  padding: '10px',\r\n                }}\r\n              >\r\n                <img\r\n                  ref={imgRef}\r\n                  src={previewImage}\r\n                  alt=\"Preview\"\r\n                  onLoad={handleImageLoad}\r\n                  style={{\r\n                    width: imageDimensions ? `${imageDimensions.width * zoom}px` : 'auto',\r\n                    height: imageDimensions ? `${imageDimensions.height * zoom}px` : 'auto',\r\n                    transition: 'width 0.1s ease-out, height 0.1s ease-out',\r\n                    maxWidth: 'none',\r\n                  }}\r\n                />\r\n              </div>\r\n            ) : (\r\n              <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                <div className=\"text-gray-500\">No preview available</div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex flex-col gap-4 pt-4 border-t border-gray-700\">\r\n          <div className=\"space-y-2\">\r\n            <div className=\"flex justify-between text-sm\">\r\n              <label htmlFor=\"input-tmask-threshold\">Mask Threshold: {threshold}</label>\r\n            </div>\r\n            <input\r\n              id=\"input-tmask-threshold\"\r\n              type=\"range\"\r\n              min=\"0\"\r\n              max=\"255\"\r\n              value={threshold}\r\n              onChange={(e) => setThreshold(Number(e.target.value))}\r\n              className=\"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-blue-500\"\r\n              aria-label=\"Mask threshold\"\r\n            />\r\n            <p className=\"text-xs text-gray-400\">\r\n              0=Opaque, 255=Transparent\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <input\r\n                id=\"input-tmask-template-colors\"\r\n                type=\"checkbox\"\r\n                checked={useTemplatePalette}\r\n                onChange={(e) => setUseTemplatePalette(e.target.checked)}\r\n                className=\"w-4 h-4 rounded bg-gray-700 border-gray-600 accent-blue-500 cursor-pointer\"\r\n                aria-label=\"Use template colors\"\r\n              />\r\n              <label htmlFor=\"input-tmask-template-colors\" className=\"text-sm text-gray-300 cursor-pointer\">\r\n                Use template colors\r\n              </label>\r\n            </div>\r\n\r\n            <div className=\"flex space-x-2\">\r\n              <button\r\n                id=\"btn-tmask-cancel\"\r\n                onClick={onClose}\r\n                className=\"px-4 py-2 text-sm font-medium text-gray-300 bg-gray-700 rounded hover:bg-gray-600 transition-colors\"\r\n                aria-label=\"Cancel transparency mask\"\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                id=\"btn-tmask-apply\"\r\n                onClick={handleApply}\r\n                disabled={!previewImage || isProcessing}\r\n                className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                aria-label=\"Apply transparency mask\"\r\n              >\r\n                Apply\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </DraggableModal>\r\n  );\r\n};\r\n\r\nexport default TransparencyMaskModal;\r\n","import React, { useEffect, useRef, useState, useCallback } from 'react';\r\nimport DraggableModal from './DraggableModal';\r\nimport useCompositorStore from '../../store/compositorStore';\r\nimport { Layer } from '../../types/compositor.types';\r\nimport { removeBackground as legacyRemoveBackground } from '../../utils/imageProcessing';\r\n\r\ntype Mode = 'ai' | 'click' | 'brush' | 'lasso';\r\n\r\ninterface BgRemovalModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  layer: Layer;\r\n}\r\n\r\n//  Helpers \r\n\r\n/** Convert a data-url string to a Blob */\r\nfunction dataUrlToBlob(dataUrl: string): Blob {\r\n  const [header, b64] = dataUrl.split(',');\r\n  const mime = header.match(/:(.*?);/)?.[1] || 'image/png';\r\n  const bytes = atob(b64);\r\n  const buf = new Uint8Array(bytes.length);\r\n  for (let i = 0; i < bytes.length; i++) buf[i] = bytes.charCodeAt(i);\r\n  return new Blob([buf], { type: mime });\r\n}\r\n\r\n/** Load an HTMLImageElement from a data-url */\r\nfunction loadImage(src: string): Promise<HTMLImageElement> {\r\n  return new Promise((resolve, reject) => {\r\n    const img = new Image();\r\n    img.onload = () => resolve(img);\r\n    img.onerror = reject;\r\n    img.src = src;\r\n  });\r\n}\r\n\r\n/** Canvas  data-url helper */\r\nfunction canvasToDataUrl(canvas: HTMLCanvasElement): string {\r\n  return canvas.toDataURL('image/png');\r\n}\r\n\r\n//  Checkerboard drawing helper \r\nconst CB_TILE = 8;\r\nfunction drawCheckerboard(ctx: CanvasRenderingContext2D, w: number, h: number) {\r\n  for (let y = 0; y < h; y += CB_TILE) {\r\n    for (let x = 0; x < w; x += CB_TILE) {\r\n      ctx.fillStyle = ((x / CB_TILE + y / CB_TILE) % 2 === 0) ? '#3a3a3a' : '#2a2a2a';\r\n      ctx.fillRect(x, y, CB_TILE, CB_TILE);\r\n    }\r\n  }\r\n}\r\n\r\n//  Click-to-Remove (flood fill from clicked point) \r\n\r\nfunction floodFillRemove(\r\n  imageData: string,\r\n  clickX: number,\r\n  clickY: number,\r\n  tolerance: number,\r\n): Promise<string> {\r\n  return new Promise(async (resolve, reject) => {\r\n    try {\r\n      const img = await loadImage(imageData);\r\n      const w = img.naturalWidth;\r\n      const h = img.naturalHeight;\r\n      const canvas = document.createElement('canvas');\r\n      canvas.width = w;\r\n      canvas.height = h;\r\n      const ctx = canvas.getContext('2d')!;\r\n      ctx.drawImage(img, 0, 0);\r\n      const imgD = ctx.getImageData(0, 0, w, h);\r\n      const d = imgD.data;\r\n\r\n      const sx = Math.round(clickX);\r\n      const sy = Math.round(clickY);\r\n      if (sx < 0 || sx >= w || sy < 0 || sy >= h) { resolve(imageData); return; }\r\n\r\n      const baseIdx = (sy * w + sx) * 4;\r\n      const baseR = d[baseIdx], baseG = d[baseIdx + 1], baseB = d[baseIdx + 2];\r\n\r\n      const visited = new Uint8Array(w * h);\r\n      const queue: number[] = [sx, sy]; // flat pairs\r\n\r\n      const tolSq = tolerance * tolerance;\r\n\r\n      while (queue.length > 0) {\r\n        const qy = queue.pop()!;\r\n        const qx = queue.pop()!;\r\n        const idx = qy * w + qx;\r\n        if (visited[idx]) continue;\r\n        visited[idx] = 1;\r\n\r\n        const pi = idx * 4;\r\n        const dr = d[pi] - baseR;\r\n        const dg = d[pi + 1] - baseG;\r\n        const db = d[pi + 2] - baseB;\r\n        if (dr * dr + dg * dg + db * db <= tolSq) {\r\n          d[pi + 3] = 0; // make transparent\r\n          if (qx > 0) queue.push(qx - 1, qy);\r\n          if (qx < w - 1) queue.push(qx + 1, qy);\r\n          if (qy > 0) queue.push(qx, qy - 1);\r\n          if (qy < h - 1) queue.push(qx, qy + 1);\r\n        }\r\n      }\r\n\r\n      ctx.putImageData(imgD, 0, 0);\r\n      resolve(canvasToDataUrl(canvas));\r\n    } catch (e) { reject(e); }\r\n  });\r\n}\r\n\r\n//  Alpha mask helpers for brush mode \r\n\r\n/** \r\n * Build an alpha mask from workingImage.\r\n * Returns Uint8Array of length w*h with alpha values.\r\n */\r\nasync function buildAlphaMask(src: string, w: number, h: number): Promise<Uint8Array> {\r\n  const img = await loadImage(src);\r\n  const cvs = document.createElement('canvas');\r\n  cvs.width = w; cvs.height = h;\r\n  const ctx = cvs.getContext('2d')!;\r\n  ctx.drawImage(img, 0, 0);\r\n  const data = ctx.getImageData(0, 0, w, h).data;\r\n  const mask = new Uint8Array(w * h);\r\n  for (let i = 0; i < mask.length; i++) mask[i] = data[i * 4 + 3];\r\n  return mask;\r\n}\r\n\r\n/** Render originalImage with an alpha mask to produce a data-url */\r\nasync function applyAlphaMask(originalSrc: string, alphaMask: Uint8Array, w: number, h: number): Promise<string> {\r\n  const img = await loadImage(originalSrc);\r\n  const cvs = document.createElement('canvas');\r\n  cvs.width = w; cvs.height = h;\r\n  const ctx = cvs.getContext('2d')!;\r\n  ctx.drawImage(img, 0, 0);\r\n  const imgData = ctx.getImageData(0, 0, w, h);\r\n  for (let i = 0; i < alphaMask.length; i++) {\r\n    imgData.data[i * 4 + 3] = alphaMask[i];\r\n  }\r\n  ctx.putImageData(imgData, 0, 0);\r\n  return canvasToDataUrl(cvs);\r\n}\r\n\r\n//  Component \r\n\r\nconst BgRemovalModal: React.FC<BgRemovalModalProps> = ({ isOpen, onClose, layer }) => {\r\n  const updateLayer = useCompositorStore((state) => state.updateLayer);\r\n\r\n  // Mode & processing state\r\n  const [mode, setMode] = useState<Mode>('click');\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n  const [statusText, setStatusText] = useState<string | null>(null);\r\n  const [errorText, setErrorText] = useState<string | null>(null);\r\n  const [downloadProgress, setDownloadProgress] = useState<number | null>(null);\r\n\r\n  // The working copy of the image (modified by each operation  clean, no checkerboard)\r\n  const [workingImage, setWorkingImage] = useState<string | null>(null);\r\n  // Original image for reset & brush-restore\r\n  const [originalImage, setOriginalImage] = useState<string | null>(null);\r\n\r\n  // Alpha mask for brush mode  tracks what's visible (255) or erased (0)\r\n  const alphaMaskRef = useRef<Uint8Array | null>(null);\r\n\r\n  // Undo / redo history\r\n  const undoStackRef = useRef<string[]>([]);\r\n  const redoStackRef = useRef<string[]>([]);\r\n  const [canUndo, setCanUndo] = useState(false);\r\n  const [canRedo, setCanRedo] = useState(false);\r\n\r\n  /** Push current workingImage onto the undo stack before a destructive change */\r\n  const pushUndo = useCallback((currentImage: string) => {\r\n    undoStackRef.current.push(currentImage);\r\n    redoStackRef.current = []; // clear redo on new action\r\n    setCanUndo(true);\r\n    setCanRedo(false);\r\n  }, []);\r\n\r\n  const handleUndo = useCallback(() => {\r\n    if (undoStackRef.current.length === 0 || !workingImage) return;\r\n    redoStackRef.current.push(workingImage);\r\n    const prev = undoStackRef.current.pop()!;\r\n    setWorkingImage(prev);\r\n    setCanUndo(undoStackRef.current.length > 0);\r\n    setCanRedo(true);\r\n  }, [workingImage]);\r\n\r\n  const handleRedo = useCallback(() => {\r\n    if (redoStackRef.current.length === 0 || !workingImage) return;\r\n    undoStackRef.current.push(workingImage);\r\n    const next = redoStackRef.current.pop()!;\r\n    setWorkingImage(next);\r\n    setCanRedo(redoStackRef.current.length > 0);\r\n    setCanUndo(true);\r\n  }, [workingImage]);\r\n\r\n  // Click-to-remove tolerance\r\n  const [tolerance, setTolerance] = useState(30);\r\n  // Legacy corner-flood heatmap\r\n  const [makeHeatmap, setMakeHeatmap] = useState(false);\r\n\r\n  // Brush settings\r\n  const [brushSize, setBrushSize] = useState(16);\r\n  const [brushMode, setBrushMode] = useState<'erase' | 'restore'>('erase');\r\n  const [isBrushing, setIsBrushing] = useState(false);\r\n\r\n  // Pan & zoom\r\n  const [zoom, setZoom] = useState(1);\r\n  const [pan, setPan] = useState({ x: 0, y: 0 });\r\n  const [isPanning, setIsPanning] = useState(false);\r\n  const panStartRef = useRef({ x: 0, y: 0, panX: 0, panY: 0 });\r\n  const [imgDim, setImgDim] = useState<{ w: number; h: number } | null>(null);\r\n\r\n  // Refs\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const canvasRef = useRef<HTMLCanvasElement>(null);\r\n  const overlayCanvasRef = useRef<HTMLCanvasElement>(null);\r\n  const lastBrushPosRef = useRef<{ x: number; y: number } | null>(null);\r\n  const hasInitialFitRef = useRef(false);\r\n  const brushCursorRef = useRef<HTMLDivElement>(null);\r\n  const origImageDataRef = useRef<ImageData | null>(null);\r\n\r\n  // Lasso state\r\n  const [isLassoing, setIsLassoing] = useState(false);\r\n  const lassoPointsRef = useRef<{ x: number; y: number }[]>([]);\r\n  const [lassoMode, setLassoMode] = useState<'erase' | 'restore'>('erase');\r\n\r\n  //  Init when modal opens \r\n  useEffect(() => {\r\n    if (isOpen && layer?.imageData) {\r\n      setWorkingImage(layer.imageData);\r\n      setOriginalImage(layer.imageData);\r\n      setErrorText(null);\r\n      setStatusText(null);\r\n      setDownloadProgress(null);\r\n      setMakeHeatmap(false);\r\n      setPan({ x: 0, y: 0 });\r\n      alphaMaskRef.current = null;\r\n      undoStackRef.current = [];\r\n      redoStackRef.current = [];\r\n      setCanUndo(false);\r\n      setCanRedo(false);\r\n      hasInitialFitRef.current = false;\r\n    }\r\n  }, [isOpen, layer?.imageData]);\r\n\r\n  //  Keyboard shortcuts (scoped to modal) \r\n  useEffect(() => {\r\n    if (!isOpen) return;\r\n    const handler = (e: KeyboardEvent) => {\r\n      if ((e.ctrlKey || e.metaKey) && !e.altKey) {\r\n        if (e.key === 'z' && !e.shiftKey) {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n          handleUndo();\r\n        } else if ((e.key === 'z' && e.shiftKey) || e.key === 'y') {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n          handleRedo();\r\n        }\r\n      }\r\n    };\r\n    window.addEventListener('keydown', handler, true); // capture phase\r\n    return () => window.removeEventListener('keydown', handler, true);\r\n  }, [isOpen, handleUndo, handleRedo]);\r\n\r\n  //  Draw the working image onto the preview canvas \r\n  const drawPreview = useCallback(async () => {\r\n    const cvs = canvasRef.current;\r\n    if (!cvs || !workingImage) return;\r\n    try {\r\n      const img = await loadImage(workingImage);\r\n      const w = img.naturalWidth;\r\n      const h = img.naturalHeight;\r\n      cvs.width = w;\r\n      cvs.height = h;\r\n      setImgDim({ w, h });\r\n      const ctx = cvs.getContext('2d')!;\r\n      drawCheckerboard(ctx, w, h);\r\n      ctx.drawImage(img, 0, 0);\r\n    } catch { /* ignore */ }\r\n  }, [workingImage]);\r\n\r\n  useEffect(() => { drawPreview(); }, [drawPreview]);\r\n\r\n  // Rebuild alpha mask when workingImage changes\r\n  useEffect(() => {\r\n    if (workingImage && imgDim) {\r\n      buildAlphaMask(workingImage, imgDim.w, imgDim.h).then(mask => {\r\n        alphaMaskRef.current = mask;\r\n      });\r\n    }\r\n  }, [workingImage, imgDim]);\r\n\r\n  // Hide brush cursor when leaving brush mode\r\n  useEffect(() => {\r\n    if (mode !== 'brush' && brushCursorRef.current) {\r\n      brushCursorRef.current.style.display = 'none';\r\n    }\r\n  }, [mode]);\r\n\r\n  // Fit zoom only on initial open (not on every working image change)\r\n  useEffect(() => {\r\n    if (imgDim && containerRef.current && !hasInitialFitRef.current) {\r\n      const cw = containerRef.current.clientWidth;\r\n      const ch = containerRef.current.clientHeight;\r\n      if (cw > 0 && ch > 0) {\r\n        const fit = Math.max(0.05, Math.min(cw / imgDim.w, ch / imgDim.h) * 0.9);\r\n        setZoom(fit);\r\n        // Center the image in the container\r\n        setPan({\r\n          x: (cw - imgDim.w * fit) / 2,\r\n          y: (ch - imgDim.h * fit) / 2,\r\n        });\r\n        hasInitialFitRef.current = true;\r\n      }\r\n    }\r\n  }, [imgDim]);\r\n\r\n  //  AI Auto-Remove \r\n  const handleAiRemove = async () => {\r\n    if (!workingImage) return;\r\n    setIsProcessing(true);\r\n    setErrorText(null);\r\n    setStatusText('Loading AI model (first run downloads ~40 MB)...');\r\n    setDownloadProgress(0);\r\n\r\n    try {\r\n      const { removeBackground: aiRemoveBackground } = await import('@imgly/background-removal');\r\n\r\n      setStatusText('Processing image...');\r\n\r\n      const blob = dataUrlToBlob(workingImage);\r\n      pushUndo(workingImage);\r\n      const resultBlob: Blob = await aiRemoveBackground(blob, {\r\n        model: 'isnet_quint8',\r\n        output: { format: 'image/png', quality: 1 },\r\n        progress: (key: string, current: number, total: number) => {\r\n          if (total > 0) {\r\n            const pct = Math.round((current / total) * 100);\r\n            setDownloadProgress(pct);\r\n            if (key.includes('onnx') || key.includes('model')) {\r\n              setStatusText(`Downloading model... ${pct}%`);\r\n            } else {\r\n              setStatusText(`Processing... ${pct}%`);\r\n            }\r\n          }\r\n        },\r\n      });\r\n\r\n      const reader = new FileReader();\r\n      reader.onload = () => {\r\n        setWorkingImage(reader.result as string);\r\n        setStatusText(null);\r\n        setDownloadProgress(null);\r\n        setIsProcessing(false);\r\n      };\r\n      reader.readAsDataURL(resultBlob);\r\n    } catch (err: any) {\r\n      console.error('AI BG removal failed:', err);\r\n      setErrorText(`AI background removal failed to load: ${err?.message || 'Unknown error'}. Try the Click or Brush tools instead.`);\r\n      setStatusText(null);\r\n      setDownloadProgress(null);\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n\r\n  //  Legacy Corner Flood-Fill (kept as option under click mode) \r\n  const handleLegacyRemove = async () => {\r\n    if (!workingImage) return;\r\n    setIsProcessing(true);\r\n    setErrorText(null);\r\n    setStatusText('Processing...');\r\n    try {\r\n      pushUndo(workingImage);\r\n      const result = await legacyRemoveBackground(workingImage, tolerance, makeHeatmap);\r\n      setWorkingImage(result);\r\n    } catch (err: any) {\r\n      setErrorText(`Corner flood-fill failed: ${err?.message || 'Unknown error'}`);\r\n    } finally {\r\n      setIsProcessing(false);\r\n      setStatusText(null);\r\n    }\r\n  };\r\n\r\n  //  Click-to-Remove handler \r\n  const handleCanvasClick = async (e: React.MouseEvent<HTMLCanvasElement>) => {\r\n    if (mode !== 'click' || isProcessing || !workingImage || !canvasRef.current) return;\r\n\r\n    const rect = canvasRef.current.getBoundingClientRect();\r\n    const scaleX = canvasRef.current.width / rect.width;\r\n    const scaleY = canvasRef.current.height / rect.height;\r\n    const cx = (e.clientX - rect.left) * scaleX;\r\n    const cy = (e.clientY - rect.top) * scaleY;\r\n\r\n    setIsProcessing(true);\r\n    setStatusText('Removing region...');\r\n    try {\r\n      pushUndo(workingImage);\r\n      const result = await floodFillRemove(workingImage, cx, cy, tolerance);\r\n      setWorkingImage(result);\r\n    } catch (err: any) {\r\n      setErrorText(`Click removal failed: ${err?.message || 'Unknown error'}`);\r\n    } finally {\r\n      setIsProcessing(false);\r\n      setStatusText(null);\r\n    }\r\n  };\r\n\r\n  //  Brush handlers \r\n  const getImageCoords = (e: React.MouseEvent<HTMLCanvasElement>) => {\r\n    const cvs = canvasRef.current;\r\n    if (!cvs) return null;\r\n    const rect = cvs.getBoundingClientRect();\r\n    const scaleX = cvs.width / rect.width;\r\n    const scaleY = cvs.height / rect.height;\r\n    return {\r\n      x: (e.clientX - rect.left) * scaleX,\r\n      y: (e.clientY - rect.top) * scaleY,\r\n    };\r\n  };\r\n\r\n  /** Paint one brush dab onto the alpha mask (does NOT redraw canvas) */\r\n  const paintBrushMask = (x: number, y: number, mask: Uint8Array, w: number, h: number, eraseVal: number): { x0: number; y0: number; x1: number; y1: number } => {\r\n    const radius = brushSize / 2;\r\n    const rSq = radius * radius;\r\n    const x0 = Math.max(0, Math.floor(x - radius));\r\n    const y0 = Math.max(0, Math.floor(y - radius));\r\n    const x1 = Math.min(w - 1, Math.ceil(x + radius));\r\n    const y1 = Math.min(h - 1, Math.ceil(y + radius));\r\n\r\n    for (let py = y0; py <= y1; py++) {\r\n      for (let px = x0; px <= x1; px++) {\r\n        const dx = px - x, dy = py - y;\r\n        if (dx * dx + dy * dy <= rSq) {\r\n          mask[py * w + px] = eraseVal;\r\n        }\r\n      }\r\n    }\r\n    return { x0, y0, x1, y1 };\r\n  };\r\n\r\n  /** Composite a dirty rect region onto the canvas from cached pixel data */\r\n  const compositeRegion = (x0: number, y0: number, x1: number, y1: number) => {\r\n    const cvs = canvasRef.current;\r\n    const mask = alphaMaskRef.current;\r\n    const origData = origImageDataRef.current;\r\n    if (!cvs || !mask || !origData || !imgDim) return;\r\n    const { w } = imgDim;\r\n    const ctx = cvs.getContext('2d')!;\r\n    const origPx = origData.data;\r\n\r\n    const regionW = x1 - x0 + 1;\r\n    const regionH = y1 - y0 + 1;\r\n    const compData = ctx.getImageData(x0, y0, regionW, regionH);\r\n    const cd = compData.data;\r\n\r\n    for (let ry = 0; ry < regionH; ry++) {\r\n      const globalY = y0 + ry;\r\n      const rowOffset = globalY * w;\r\n      for (let rx = 0; rx < regionW; rx++) {\r\n        const globalX = x0 + rx;\r\n        const alpha = mask[rowOffset + globalX];\r\n        const pi = (ry * regionW + rx) * 4;\r\n\r\n        if (alpha === 0) {\r\n          const isLight = (Math.floor(globalX / CB_TILE) + Math.floor(globalY / CB_TILE)) % 2 === 0;\r\n          const c = isLight ? 0x3a : 0x2a;\r\n          cd[pi] = c; cd[pi + 1] = c; cd[pi + 2] = c; cd[pi + 3] = 255;\r\n        } else {\r\n          const oi = (globalY * w + globalX) * 4;\r\n          cd[pi] = origPx[oi]; cd[pi + 1] = origPx[oi + 1]; cd[pi + 2] = origPx[oi + 2]; cd[pi + 3] = 255;\r\n        }\r\n      }\r\n    }\r\n    ctx.putImageData(compData, x0, y0);\r\n  };\r\n\r\n  /** Paint one brush dab onto the alpha mask and the canvas */\r\n  const paintBrush = (x: number, y: number) => {\r\n    const mask = alphaMaskRef.current;\r\n    if (!mask || !imgDim) return;\r\n    const { w, h } = imgDim;\r\n    const eraseVal = brushMode === 'erase' ? 0 : 255;\r\n    const { x0, y0, x1, y1 } = paintBrushMask(x, y, mask, w, h, eraseVal);\r\n    compositeRegion(x0, y0, x1, y1);\r\n  };\r\n\r\n  const interpolateBrush = (from: { x: number; y: number }, to: { x: number; y: number }) => {\r\n    const mask = alphaMaskRef.current;\r\n    if (!mask || !imgDim) return;\r\n    const { w, h } = imgDim;\r\n    const eraseVal = brushMode === 'erase' ? 0 : 255;\r\n\r\n    const dx = to.x - from.x;\r\n    const dy = to.y - from.y;\r\n    const dist = Math.sqrt(dx * dx + dy * dy);\r\n    const step = Math.max(1, brushSize / 4);\r\n    const steps = Math.ceil(dist / step);\r\n\r\n    // Accumulate dirty rect across all dabs\r\n    let dirtyX0 = Infinity, dirtyY0 = Infinity, dirtyX1 = -Infinity, dirtyY1 = -Infinity;\r\n    for (let i = 0; i <= steps; i++) {\r\n      const t = steps === 0 ? 0 : i / steps;\r\n      const rect = paintBrushMask(from.x + dx * t, from.y + dy * t, mask, w, h, eraseVal);\r\n      dirtyX0 = Math.min(dirtyX0, rect.x0);\r\n      dirtyY0 = Math.min(dirtyY0, rect.y0);\r\n      dirtyX1 = Math.max(dirtyX1, rect.x1);\r\n      dirtyY1 = Math.max(dirtyY1, rect.y1);\r\n    }\r\n    // Single composite pass for the entire stroke segment\r\n    if (dirtyX0 <= dirtyX1 && dirtyY0 <= dirtyY1) {\r\n      compositeRegion(dirtyX0, dirtyY0, dirtyX1, dirtyY1);\r\n    }\r\n  };\r\n\r\n  // Cache original image AND its pixel data for brush performance\r\n  useEffect(() => {\r\n    if (originalImage) {\r\n      const img = new Image();\r\n      img.onload = () => {\r\n        (window as any).__bgRemovalOrigImg = img;\r\n        // Pre-cache pixel data so paintBrush never creates temp canvases\r\n        const cvs = document.createElement('canvas');\r\n        cvs.width = img.naturalWidth;\r\n        cvs.height = img.naturalHeight;\r\n        const ctx = cvs.getContext('2d')!;\r\n        ctx.drawImage(img, 0, 0);\r\n        origImageDataRef.current = ctx.getImageData(0, 0, img.naturalWidth, img.naturalHeight);\r\n      };\r\n      img.src = originalImage;\r\n    }\r\n    return () => {\r\n      delete (window as any).__bgRemovalOrigImg;\r\n      origImageDataRef.current = null;\r\n    };\r\n  }, [originalImage]);\r\n\r\n  const handleBrushDown = (e: React.MouseEvent<HTMLCanvasElement>) => {\r\n    if (mode !== 'brush' || isProcessing) return;\r\n    if (e.button !== 0) return; // left-click only\r\n    e.preventDefault();\r\n    const pos = getImageCoords(e);\r\n    if (!pos) return;\r\n    setIsBrushing(true);\r\n    lastBrushPosRef.current = pos;\r\n    paintBrush(pos.x, pos.y);\r\n  };\r\n\r\n  const handleBrushMove = (e: React.MouseEvent<HTMLCanvasElement>) => {\r\n    if (!isBrushing || mode !== 'brush') return;\r\n    const pos = getImageCoords(e);\r\n    if (!pos) return;\r\n    if (lastBrushPosRef.current) {\r\n      interpolateBrush(lastBrushPosRef.current, pos);\r\n    }\r\n    lastBrushPosRef.current = pos;\r\n  };\r\n\r\n  const handleBrushUp = () => {\r\n    if (isBrushing && mode === 'brush') {\r\n      // Commit brush strokes: apply alpha mask to produce new workingImage\r\n      commitBrushStrokes();\r\n    }\r\n    setIsBrushing(false);\r\n    lastBrushPosRef.current = null;\r\n  };\r\n\r\n  const commitBrushStrokes = async () => {\r\n    const mask = alphaMaskRef.current;\r\n    if (!mask || !originalImage || !imgDim || !workingImage) return;\r\n    pushUndo(workingImage);\r\n    const result = await applyAlphaMask(originalImage, mask, imgDim.w, imgDim.h);\r\n    setWorkingImage(result);\r\n  };\r\n\r\n  //  Lasso handlers \r\n  const drawLassoOverlay = () => {\r\n    const overlay = overlayCanvasRef.current;\r\n    const cvs = canvasRef.current;\r\n    if (!overlay || !cvs) return;\r\n    overlay.width = cvs.width;\r\n    overlay.height = cvs.height;\r\n    const ctx = overlay.getContext('2d')!;\r\n    ctx.clearRect(0, 0, overlay.width, overlay.height);\r\n    const pts = lassoPointsRef.current;\r\n    if (pts.length < 2) return;\r\n    ctx.beginPath();\r\n    ctx.moveTo(pts[0].x, pts[0].y);\r\n    for (let i = 1; i < pts.length; i++) {\r\n      ctx.lineTo(pts[i].x, pts[i].y);\r\n    }\r\n    // Draw closing line back to start\r\n    ctx.lineTo(pts[0].x, pts[0].y);\r\n    // Fill with semi-transparent overlay\r\n    ctx.fillStyle = lassoMode === 'erase' ? 'rgba(255, 0, 0, 0.15)' : 'rgba(0, 255, 0, 0.15)';\r\n    ctx.fill();\r\n    // Stroke the path\r\n    ctx.strokeStyle = lassoMode === 'erase' ? 'rgba(255, 80, 80, 0.9)' : 'rgba(80, 255, 80, 0.9)';\r\n    ctx.lineWidth = 2;\r\n    ctx.setLineDash([6, 4]);\r\n    ctx.stroke();\r\n  };\r\n\r\n  const handleLassoDown = (e: React.MouseEvent<HTMLCanvasElement>) => {\r\n    if (mode !== 'lasso' || isProcessing) return;\r\n    if (e.button !== 0) return;\r\n    e.preventDefault();\r\n    const pos = getImageCoords(e);\r\n    if (!pos) return;\r\n    setIsLassoing(true);\r\n    lassoPointsRef.current = [pos];\r\n  };\r\n\r\n  const handleLassoMove = (e: React.MouseEvent<HTMLCanvasElement>) => {\r\n    if (!isLassoing || mode !== 'lasso') return;\r\n    const pos = getImageCoords(e);\r\n    if (!pos) return;\r\n    lassoPointsRef.current.push(pos);\r\n    drawLassoOverlay();\r\n  };\r\n\r\n  const handleLassoUp = async () => {\r\n    if (!isLassoing || mode !== 'lasso') return;\r\n    setIsLassoing(false);\r\n    const pts = lassoPointsRef.current;\r\n    if (pts.length < 3 || !imgDim || !workingImage || !originalImage) {\r\n      lassoPointsRef.current = [];\r\n      // Clear overlay\r\n      const overlay = overlayCanvasRef.current;\r\n      if (overlay) {\r\n        const ctx = overlay.getContext('2d');\r\n        if (ctx) ctx.clearRect(0, 0, overlay.width, overlay.height);\r\n      }\r\n      return;\r\n    }\r\n\r\n    const { w, h } = imgDim;\r\n    const mask = alphaMaskRef.current;\r\n    if (!mask) return;\r\n\r\n    // Build a filled polygon mask using an offscreen canvas\r\n    const polyCvs = document.createElement('canvas');\r\n    polyCvs.width = w;\r\n    polyCvs.height = h;\r\n    const polyCtx = polyCvs.getContext('2d')!;\r\n    polyCtx.beginPath();\r\n    polyCtx.moveTo(pts[0].x, pts[0].y);\r\n    for (let i = 1; i < pts.length; i++) {\r\n      polyCtx.lineTo(pts[i].x, pts[i].y);\r\n    }\r\n    polyCtx.closePath();\r\n    polyCtx.fillStyle = '#fff';\r\n    polyCtx.fill();\r\n    const polyData = polyCtx.getImageData(0, 0, w, h).data;\r\n\r\n    // Apply to alpha mask\r\n    const val = lassoMode === 'erase' ? 0 : 255;\r\n    for (let i = 0; i < w * h; i++) {\r\n      if (polyData[i * 4 + 3] > 0) {\r\n        mask[i] = val;\r\n      }\r\n    }\r\n\r\n    pushUndo(workingImage);\r\n    const result = await applyAlphaMask(originalImage, mask, w, h);\r\n    setWorkingImage(result);\r\n\r\n    lassoPointsRef.current = [];\r\n    // Clear overlay\r\n    const overlay = overlayCanvasRef.current;\r\n    if (overlay) {\r\n      const ctx = overlay.getContext('2d');\r\n      if (ctx) ctx.clearRect(0, 0, overlay.width, overlay.height);\r\n    }\r\n  };\r\n\r\n  //  Pan handlers (middle-click or right-click) \r\n  const handleWheel = (e: React.WheelEvent) => {\r\n    e.preventDefault();\r\n    const container = containerRef.current;\r\n    if (!container) return;\r\n    const rect = container.getBoundingClientRect();\r\n    // Mouse position relative to container\r\n    const mx = e.clientX - rect.left;\r\n    const my = e.clientY - rect.top;\r\n    const factor = e.deltaY > 0 ? 1 / 1.12 : 1.12;\r\n    setZoom(prevZoom => {\r\n      const newZoom = Math.max(0.05, Math.min(10, prevZoom * factor));\r\n      const scale = newZoom / prevZoom;\r\n      // Adjust pan so the point under the cursor stays fixed\r\n      setPan(prev => ({\r\n        x: mx - scale * (mx - prev.x),\r\n        y: my - scale * (my - prev.y),\r\n      }));\r\n      return newZoom;\r\n    });\r\n  };\r\n\r\n  const handlePanStart = (e: React.MouseEvent) => {\r\n    if (e.button === 1 || e.button === 2) {\r\n      e.preventDefault();\r\n      setIsPanning(true);\r\n      panStartRef.current = { x: e.clientX, y: e.clientY, panX: pan.x, panY: pan.y };\r\n    }\r\n  };\r\n\r\n  const handlePanMove = (e: React.MouseEvent) => {\r\n    if (!isPanning) return;\r\n    const dx = e.clientX - panStartRef.current.x;\r\n    const dy = e.clientY - panStartRef.current.y;\r\n    setPan({ x: panStartRef.current.panX + dx, y: panStartRef.current.panY + dy });\r\n  };\r\n\r\n  const handlePanEnd = () => {\r\n    setIsPanning(false);\r\n  };\r\n\r\n  //  Mouse handlers dispatch \r\n  const handleCanvasMouseDown = (e: React.MouseEvent<HTMLCanvasElement>) => {\r\n    if (e.button === 1 || e.button === 2) {\r\n      handlePanStart(e);\r\n      return;\r\n    }\r\n    if (mode === 'brush') {\r\n      handleBrushDown(e);\r\n    }\r\n    if (mode === 'lasso') {\r\n      handleLassoDown(e);\r\n    }\r\n  };\r\n\r\n  const handleCanvasMouseMove = (e: React.MouseEvent<HTMLCanvasElement>) => {\r\n    if (isPanning) {\r\n      handlePanMove(e);\r\n      return;\r\n    }\r\n    if (mode === 'brush' && isBrushing) {\r\n      handleBrushMove(e);\r\n    }\r\n    if (mode === 'lasso' && isLassoing) {\r\n      handleLassoMove(e);\r\n    }\r\n  };\r\n\r\n  const handleCanvasMouseUp = () => {\r\n    if (isPanning) {\r\n      handlePanEnd();\r\n      return;\r\n    }\r\n    if (mode === 'brush') {\r\n      handleBrushUp();\r\n    }\r\n    if (mode === 'lasso') {\r\n      handleLassoUp();\r\n    }\r\n  };\r\n\r\n  //  Apply final result \r\n  const handleApply = () => {\r\n    if (!workingImage || workingImage === originalImage) return;\r\n    updateLayer(layer.id, { imageData: workingImage });\r\n    onClose();\r\n  };\r\n\r\n  //  Reset to original \r\n  const handleReset = () => {\r\n    if (originalImage && workingImage) {\r\n      pushUndo(workingImage);\r\n      setWorkingImage(originalImage);\r\n      setErrorText(null);\r\n      setStatusText(null);\r\n      alphaMaskRef.current = null;\r\n    }\r\n  };\r\n\r\n  //  Cursor style \r\n  const getCursorClass = () => {\r\n    if (isPanning) return 'cursor-grabbing';\r\n    if (mode === 'click') return 'cursor-crosshair';\r\n    if (mode === 'brush') return 'cursor-none';\r\n    if (mode === 'lasso') return 'cursor-crosshair';\r\n    return 'cursor-default';\r\n  };\r\n\r\n  //  Render \r\n  return (\r\n    <DraggableModal isOpen={isOpen} title=\"Background Removal\" onClose={onClose} modalId=\"modal-bg-removal\">\r\n      <div className=\"flex flex-col h-full text-gray-200\">\r\n        {/* Mode tabs */}\r\n        <div className=\"flex border-b border-gray-700 bg-gray-800/50\">\r\n          {([\r\n            { key: 'click' as Mode, label: 'Click Remove' },\r\n            { key: 'lasso' as Mode, label: 'Lasso' },\r\n            { key: 'brush' as Mode, label: 'Brush Refine' },\r\n            { key: 'ai' as Mode, label: 'AI Auto' },\r\n          ]).map(({ key, label }) => (\r\n            <button\r\n              key={key}\r\n              onClick={() => setMode(key)}\r\n              className={`flex-1 px-3 py-2.5 text-xs font-medium transition-colors border-b-2 ${\r\n                mode === key\r\n                  ? 'border-blue-500 text-blue-400 bg-gray-700/50'\r\n                  : 'border-transparent text-gray-400 hover:text-gray-200 hover:bg-gray-700/30'\r\n              }`}\r\n            >\r\n              {label}\r\n            </button>\r\n          ))}\r\n        </div>\r\n\r\n        {/* Error banner */}\r\n        {errorText && (\r\n          <div className=\"px-4 py-2 bg-red-900/40 border-b border-red-700 text-xs text-red-300 flex items-start gap-2\">\r\n            <span className=\"font-bold text-red-400 mt-px\">!</span>\r\n            <span className=\"flex-1\">{errorText}</span>\r\n            <button onClick={() => setErrorText(null)} className=\"text-red-400 hover:text-red-200 shrink-0\"></button>\r\n          </div>\r\n        )}\r\n\r\n        {/* Preview area */}\r\n        <div className=\"flex-1 min-h-0 relative\">\r\n          {/* Status overlay */}\r\n          {(isProcessing || statusText) && (\r\n            <div className=\"absolute inset-0 z-20 flex flex-col items-center justify-center bg-black/60 gap-3\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <div className=\"w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin\" />\r\n                <span className=\"text-sm font-medium text-white\">{statusText || 'Processing...'}</span>\r\n              </div>\r\n              {downloadProgress !== null && downloadProgress < 100 && (\r\n                <div className=\"w-48 h-2 bg-gray-700 rounded-full overflow-hidden\">\r\n                  <div\r\n                    className=\"h-full bg-blue-500 transition-all duration-300\"\r\n                    style={{ width: `${downloadProgress}%` }}\r\n                  />\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Preview container with pan & zoom */}\r\n          <div\r\n            ref={containerRef}\r\n            className=\"w-full h-full overflow-hidden bg-gray-900 relative\"\r\n            onWheel={handleWheel}\r\n            onMouseDown={handlePanStart}\r\n            onMouseMove={(e) => {\r\n              handlePanMove(e);\r\n              // Update brush cursor via direct DOM manipulation (no React re-render)\r\n              if (mode === 'brush' && containerRef.current && brushCursorRef.current) {\r\n                const rect = containerRef.current.getBoundingClientRect();\r\n                const cx = e.clientX - rect.left;\r\n                const cy = e.clientY - rect.top;\r\n                const size = brushSize * zoom;\r\n                const el = brushCursorRef.current;\r\n                el.style.left = `${cx - size / 2}px`;\r\n                el.style.top = `${cy - size / 2}px`;\r\n                el.style.width = `${size}px`;\r\n                el.style.height = `${size}px`;\r\n                el.style.display = 'block';\r\n              }\r\n            }}\r\n            onMouseUp={handlePanEnd}\r\n            onMouseLeave={() => {\r\n              handlePanEnd();\r\n              if (brushCursorRef.current) brushCursorRef.current.style.display = 'none';\r\n            }}\r\n            onContextMenu={e => e.preventDefault()}\r\n          >\r\n            <div\r\n              style={{\r\n                transform: `translate(${pan.x}px, ${pan.y}px) scale(${zoom})`,\r\n                transformOrigin: '0 0',\r\n                display: 'inline-block',\r\n                position: 'relative',\r\n              }}\r\n            >\r\n              <canvas\r\n                ref={canvasRef}\r\n                className={getCursorClass()}\r\n                onClick={(mode === 'click' && !isProcessing) ? handleCanvasClick : undefined}\r\n                onMouseDown={handleCanvasMouseDown}\r\n                onMouseMove={handleCanvasMouseMove}\r\n                onMouseUp={handleCanvasMouseUp}\r\n                onMouseLeave={handleCanvasMouseUp}\r\n                style={{ display: 'block', imageRendering: zoom > 2 ? 'pixelated' : 'auto' }}\r\n              />\r\n              {/* Lasso overlay canvas  sits on top of main canvas */}\r\n              <canvas\r\n                ref={overlayCanvasRef}\r\n                style={{\r\n                  position: 'absolute',\r\n                  top: 0,\r\n                  left: 0,\r\n                  width: '100%',\r\n                  height: '100%',\r\n                  pointerEvents: 'none',\r\n                  imageRendering: zoom > 2 ? 'pixelated' : 'auto',\r\n                }}\r\n              />\r\n            </div>\r\n            {/* Brush size cursor overlay  positioned via ref, no React re-renders */}\r\n            <div\r\n              ref={brushCursorRef}\r\n              style={{\r\n                position: 'absolute',\r\n                display: 'none',\r\n                border: '1.5px solid rgba(255, 255, 255, 0.8)',\r\n                borderRadius: '50%',\r\n                pointerEvents: 'none',\r\n                zIndex: 10,\r\n                boxShadow: '0 0 0 1px rgba(0, 0, 0, 0.5)',\r\n                willChange: 'left, top, width, height',\r\n              }}\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Bottom controls */}\r\n        <div className=\"border-t border-gray-700 px-4 py-3 space-y-3\">\r\n          {/* Zoom bar */}\r\n          <div className=\"flex items-center gap-2 text-xs\">\r\n            <button onClick={() => setZoom(z => Math.max(0.05, z - 0.25))} className=\"px-1.5 py-0.5 text-gray-400 hover:text-white bg-gray-700 rounded\"></button>\r\n            <span className=\"text-gray-400 min-w-[40px] text-center\">{Math.round(zoom * 100)}%</span>\r\n            <button onClick={() => setZoom(z => Math.min(10, z + 0.25))} className=\"px-1.5 py-0.5 text-gray-400 hover:text-white bg-gray-700 rounded\">+</button>\r\n            <button\r\n              onClick={() => {\r\n                if (imgDim && containerRef.current) {\r\n                  const fit = Math.min(containerRef.current.clientWidth / imgDim.w, containerRef.current.clientHeight / imgDim.h) * 0.9;\r\n                  setZoom(Math.max(0.05, fit));\r\n                  setPan({ x: 0, y: 0 });\r\n                }\r\n              }}\r\n              className=\"text-gray-400 hover:text-white bg-gray-700 rounded px-2 py-0.5\"\r\n            >\r\n              Fit\r\n            </button>\r\n            <span className=\"text-gray-500 ml-1\">Middle-click to pan, scroll to zoom</span>\r\n          </div>\r\n\r\n          {/* Mode-specific controls */}\r\n          {mode === 'ai' && (\r\n            <div className=\"space-y-2\">\r\n              <p className=\"text-xs text-gray-400\">\r\n                Uses a neural network to automatically detect and remove the background. The model (~40 MB) downloads on first use and is cached by the browser.\r\n              </p>\r\n              <button\r\n                onClick={handleAiRemove}\r\n                disabled={isProcessing}\r\n                className=\"w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n              >\r\n                {isProcessing ? 'Processing...' : 'Remove Background (AI)'}\r\n              </button>\r\n            </div>\r\n          )}\r\n\r\n          {mode === 'click' && (\r\n            <div className=\"space-y-2\">\r\n              <p className=\"text-xs text-gray-400\">\r\n                Click on any region to flood-fill remove it. Adjust tolerance to control how aggressively similar colors are erased.\r\n              </p>\r\n              <div className=\"flex items-center gap-3\">\r\n                <label className=\"text-xs text-gray-400 whitespace-nowrap\">Tolerance: {tolerance}</label>\r\n                <input\r\n                  type=\"range\" min=\"1\" max=\"255\" value={tolerance}\r\n                  onChange={e => setTolerance(Number(e.target.value))}\r\n                  className=\"flex-1 h-1.5 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-blue-500\"\r\n                />\r\n              </div>\r\n              <div className=\"flex items-center gap-3\">\r\n                <button\r\n                  onClick={handleLegacyRemove}\r\n                  disabled={isProcessing}\r\n                  className=\"px-3 py-1.5 text-xs font-medium text-gray-300 bg-gray-700 rounded hover:bg-gray-600 disabled:opacity-50 transition-colors\"\r\n                >\r\n                  Auto-Remove from Corners\r\n                </button>\r\n                <label className=\"flex items-center gap-1.5 text-xs text-gray-400 cursor-pointer\">\r\n                  <input\r\n                    type=\"checkbox\" checked={makeHeatmap}\r\n                    onChange={e => setMakeHeatmap(e.target.checked)}\r\n                    className=\"w-3.5 h-3.5 rounded bg-gray-700 border-gray-600 accent-blue-500\"\r\n                  />\r\n                  Heatmap\r\n                </label>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {mode === 'lasso' && (\r\n            <div className=\"space-y-2\">\r\n              <p className=\"text-xs text-gray-400\">\r\n                Draw a freehand selection around an area to erase or restore it. The region fills when you release the mouse.\r\n              </p>\r\n              <div className=\"flex items-center gap-3\">\r\n                <div className=\"flex rounded overflow-hidden border border-gray-600\">\r\n                  <button\r\n                    onClick={() => setLassoMode('erase')}\r\n                    className={`px-3 py-1.5 text-xs font-medium transition-colors ${\r\n                      lassoMode === 'erase' ? 'bg-red-600 text-white' : 'bg-gray-700 text-gray-300 hover:bg-gray-600'\r\n                    }`}\r\n                  >\r\n                    Erase\r\n                  </button>\r\n                  <button\r\n                    onClick={() => setLassoMode('restore')}\r\n                    className={`px-3 py-1.5 text-xs font-medium transition-colors ${\r\n                      lassoMode === 'restore' ? 'bg-green-600 text-white' : 'bg-gray-700 text-gray-300 hover:bg-gray-600'\r\n                    }`}\r\n                  >\r\n                    Restore\r\n                  </button>\r\n                </div>\r\n                <span className=\"text-xs text-gray-500\">Draw around an area, then release to apply</span>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {mode === 'brush' && (\r\n            <div className=\"space-y-2\">\r\n              <p className=\"text-xs text-gray-400\">\r\n                Paint over areas to erase or restore them. Use after AI or Click removal to refine edges.\r\n              </p>\r\n              <div className=\"flex items-center gap-3\">\r\n                <div className=\"flex rounded overflow-hidden border border-gray-600\">\r\n                  <button\r\n                    onClick={() => setBrushMode('erase')}\r\n                    className={`px-3 py-1.5 text-xs font-medium transition-colors ${\r\n                      brushMode === 'erase' ? 'bg-red-600 text-white' : 'bg-gray-700 text-gray-300 hover:bg-gray-600'\r\n                    }`}\r\n                  >\r\n                    Erase\r\n                  </button>\r\n                  <button\r\n                    onClick={() => setBrushMode('restore')}\r\n                    className={`px-3 py-1.5 text-xs font-medium transition-colors ${\r\n                      brushMode === 'restore' ? 'bg-green-600 text-white' : 'bg-gray-700 text-gray-300 hover:bg-gray-600'\r\n                    }`}\r\n                  >\r\n                    Restore\r\n                  </button>\r\n                </div>\r\n                <label className=\"text-xs text-gray-400 whitespace-nowrap\">Size: {brushSize}px</label>\r\n                <input\r\n                  type=\"range\" min=\"1\" max=\"100\" value={brushSize}\r\n                  onChange={e => setBrushSize(Number(e.target.value))}\r\n                  className=\"flex-1 h-1.5 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-blue-500\"\r\n                />\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Action buttons */}\r\n          <div className=\"flex items-center justify-between pt-1\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <button\r\n                onClick={handleReset}\r\n                disabled={isProcessing || workingImage === originalImage}\r\n                className=\"px-3 py-1.5 text-xs font-medium text-gray-300 bg-gray-700 rounded hover:bg-gray-600 disabled:opacity-30 transition-colors\"\r\n              >\r\n                Reset\r\n              </button>\r\n              <button\r\n                onClick={handleUndo}\r\n                disabled={isProcessing || !canUndo}\r\n                className=\"px-2.5 py-1.5 text-xs font-medium text-gray-300 bg-gray-700 rounded hover:bg-gray-600 disabled:opacity-30 transition-colors\"\r\n                title=\"Undo (Ctrl+Z)\"\r\n              >\r\n                Undo\r\n              </button>\r\n              <button\r\n                onClick={handleRedo}\r\n                disabled={isProcessing || !canRedo}\r\n                className=\"px-2.5 py-1.5 text-xs font-medium text-gray-300 bg-gray-700 rounded hover:bg-gray-600 disabled:opacity-30 transition-colors\"\r\n                title=\"Redo (Ctrl+Y / Ctrl+Shift+Z)\"\r\n              >\r\n                Redo\r\n              </button>\r\n            </div>\r\n            <div className=\"flex gap-2\">\r\n              <button\r\n                onClick={onClose}\r\n                className=\"px-4 py-2 text-sm font-medium text-gray-300 bg-gray-700 rounded hover:bg-gray-600 transition-colors\"\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                onClick={handleApply}\r\n                disabled={isProcessing || workingImage === originalImage}\r\n                className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n              >\r\n                Apply\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </DraggableModal>\r\n  );\r\n};\r\n\r\nexport default BgRemovalModal;\r\n","import React, { useRef, useState, useEffect, useCallback } from 'react';\r\nimport { usePortraitMode } from '../../hooks/usePortraitMode';\r\n\r\ninterface EyedropperModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  imageDataUrl: string;\r\n  onAddColors: (colors: string[]) => void;\r\n}\r\n\r\n/**\r\n * Eyedropper modal for picking colors from the original image.\r\n * Supports zoom/pan. Hover shows color preview, click adds to a pick-list.\r\n */\r\nconst EyedropperModal: React.FC<EyedropperModalProps> = ({ isOpen, onClose, imageDataUrl, onAddColors }) => {\r\n  const canvasRef = useRef<HTMLCanvasElement>(null);\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const imgRef = useRef<HTMLImageElement | null>(null);\r\n\r\n  const isPortrait = usePortraitMode();\r\n  const [pickedColors, setPickedColors] = useState<string[]>([]);\r\n  const [hoverColor, setHoverColor] = useState<string | null>(null);\r\n  const [cursorPos, setCursorPos] = useState<{ x: number; y: number }>({ x: 0, y: 0 });\r\n  const [zoom, setZoom] = useState<number>(1);\r\n  const [pan, setPan] = useState<{ x: number; y: number }>({ x: 0, y: 0 });\r\n  const [isPanning, setIsPanning] = useState(false);\r\n  const [panStart, setPanStart] = useState<{ x: number; y: number }>({ x: 0, y: 0 });\r\n  const [imgLoaded, setImgLoaded] = useState(false);\r\n  const [imgSize, setImgSize] = useState<{ w: number; h: number }>({ w: 0, h: 0 });\r\n\r\n  // Load image once\r\n  useEffect(() => {\r\n    if (!isOpen || !imageDataUrl) return;\r\n    const img = new Image();\r\n    img.onload = () => {\r\n      imgRef.current = img;\r\n      setImgSize({ w: img.naturalWidth, h: img.naturalHeight });\r\n      setImgLoaded(true);\r\n      // Reset state\r\n      setPickedColors([]);\r\n      setZoom(1);\r\n      setPan({ x: 0, y: 0 });\r\n    };\r\n    img.src = imageDataUrl;\r\n  }, [isOpen, imageDataUrl]);\r\n\r\n  // Auto-fit zoom on open\r\n  useEffect(() => {\r\n    if (!imgLoaded || !containerRef.current) return;\r\n    const cw = containerRef.current.clientWidth - 40;\r\n    const ch = containerRef.current.clientHeight - 40;\r\n    if (cw <= 0 || ch <= 0 || imgSize.w <= 0 || imgSize.h <= 0) return;\r\n    const fit = Math.min(cw / imgSize.w, ch / imgSize.h, 4);\r\n    setZoom(fit);\r\n  }, [imgLoaded, imgSize]);\r\n\r\n  // Draw canvas\r\n  const draw = useCallback(() => {\r\n    const canvas = canvasRef.current;\r\n    const container = containerRef.current;\r\n    const img = imgRef.current;\r\n    if (!canvas || !container || !img || !imgLoaded) return;\r\n\r\n    canvas.width = container.clientWidth;\r\n    canvas.height = container.clientHeight;\r\n\r\n    const ctx = canvas.getContext('2d');\r\n    if (!ctx) return;\r\n\r\n    ctx.imageSmoothingEnabled = false;\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n    // Checkerboard background behind image\r\n    const patternSize = 8;\r\n    const pCanvas = document.createElement('canvas');\r\n    pCanvas.width = patternSize * 2;\r\n    pCanvas.height = patternSize * 2;\r\n    const pCtx = pCanvas.getContext('2d')!;\r\n    pCtx.fillStyle = '#3a3a3a';\r\n    pCtx.fillRect(0, 0, patternSize * 2, patternSize * 2);\r\n    pCtx.fillStyle = '#2a2a2a';\r\n    pCtx.fillRect(0, 0, patternSize, patternSize);\r\n    pCtx.fillRect(patternSize, patternSize, patternSize, patternSize);\r\n\r\n    // Center the image\r\n    const drawW = imgSize.w * zoom;\r\n    const drawH = imgSize.h * zoom;\r\n    const ox = (canvas.width - drawW) / 2 + pan.x;\r\n    const oy = (canvas.height - drawH) / 2 + pan.y;\r\n\r\n    // Draw checkerboard under image area\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    ctx.rect(ox, oy, drawW, drawH);\r\n    ctx.clip();\r\n    const pattern = ctx.createPattern(pCanvas, 'repeat');\r\n    if (pattern) {\r\n      ctx.fillStyle = pattern;\r\n      ctx.fillRect(ox, oy, drawW, drawH);\r\n    }\r\n    ctx.restore();\r\n\r\n    // Draw image\r\n    ctx.drawImage(img, ox, oy, drawW, drawH);\r\n  }, [imgLoaded, imgSize, zoom, pan]);\r\n\r\n  useEffect(() => {\r\n    draw();\r\n  }, [draw]);\r\n\r\n  // Resize observer\r\n  useEffect(() => {\r\n    const container = containerRef.current;\r\n    if (!container) return;\r\n    const ro = new ResizeObserver(() => draw());\r\n    ro.observe(container);\r\n    return () => ro.disconnect();\r\n  }, [draw]);\r\n\r\n  // Cache the pixel data to avoid re-creating temp canvas on every mouse move\r\n  const pixelDataRef = useRef<ImageData | null>(null);\r\n  const pixelCanvasSizeRef = useRef<{ w: number; h: number }>({ w: 0, h: 0 });\r\n\r\n  useEffect(() => {\r\n    if (!imgLoaded || !imgRef.current) return;\r\n    const img = imgRef.current;\r\n    const tc = document.createElement('canvas');\r\n    tc.width = img.naturalWidth;\r\n    tc.height = img.naturalHeight;\r\n    const tctx = tc.getContext('2d')!;\r\n    tctx.drawImage(img, 0, 0);\r\n    pixelDataRef.current = tctx.getImageData(0, 0, tc.width, tc.height);\r\n    pixelCanvasSizeRef.current = { w: tc.width, h: tc.height };\r\n  }, [imgLoaded, imageDataUrl]);\r\n\r\n  const getPixelColorFast = useCallback((clientX: number, clientY: number): string | null => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas || !imgLoaded || !pixelDataRef.current) return null;\r\n\r\n    const rect = canvas.getBoundingClientRect();\r\n    const mx = clientX - rect.left;\r\n    const my = clientY - rect.top;\r\n\r\n    const drawW = imgSize.w * zoom;\r\n    const drawH = imgSize.h * zoom;\r\n    const ox = (canvas.width - drawW) / 2 + pan.x;\r\n    const oy = (canvas.height - drawH) / 2 + pan.y;\r\n\r\n    if (mx < ox || mx >= ox + drawW || my < oy || my >= oy + drawH) return null;\r\n\r\n    const imgX = Math.floor((mx - ox) / zoom);\r\n    const imgY = Math.floor((my - oy) / zoom);\r\n\r\n    const pd = pixelDataRef.current;\r\n    const w = pixelCanvasSizeRef.current.w;\r\n    if (imgX < 0 || imgX >= w || imgY < 0 || imgY >= pixelCanvasSizeRef.current.h) return null;\r\n\r\n    const idx = (imgY * w + imgX) * 4;\r\n    const r = pd.data[idx];\r\n    const g = pd.data[idx + 1];\r\n    const b = pd.data[idx + 2];\r\n\r\n    return '#' + [r, g, b].map(c => c.toString(16).padStart(2, '0')).join('').toUpperCase();\r\n  }, [imgLoaded, imgSize, zoom, pan]);\r\n\r\n  const handleMouseMove = (e: React.MouseEvent<HTMLCanvasElement>) => {\r\n    setCursorPos({ x: e.clientX, y: e.clientY });\r\n\r\n    if (isPanning) {\r\n      const dx = e.clientX - panStart.x;\r\n      const dy = e.clientY - panStart.y;\r\n      setPan(prev => ({ x: prev.x + dx, y: prev.y + dy }));\r\n      setPanStart({ x: e.clientX, y: e.clientY });\r\n      setHoverColor(null);\r\n      return;\r\n    }\r\n\r\n    const color = getPixelColorFast(e.clientX, e.clientY);\r\n    setHoverColor(color);\r\n  };\r\n\r\n  const handleMouseDown = (e: React.MouseEvent<HTMLCanvasElement>) => {\r\n    // Middle click or right click to pan\r\n    if (e.button === 1 || e.button === 2) {\r\n      e.preventDefault();\r\n      setIsPanning(true);\r\n      setPanStart({ x: e.clientX, y: e.clientY });\r\n      return;\r\n    }\r\n\r\n    // Left click to pick a color\r\n    if (e.button === 0) {\r\n      const color = getPixelColorFast(e.clientX, e.clientY);\r\n      if (color && !pickedColors.includes(color)) {\r\n        setPickedColors(prev => [...prev, color]);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleMouseUp = () => {\r\n    setIsPanning(false);\r\n  };\r\n\r\n  const handleWheel = (e: React.WheelEvent<HTMLCanvasElement>) => {\r\n    e.preventDefault();\r\n    const delta = e.deltaY > 0 ? -1 : 1;\r\n    setZoom(prev => {\r\n      const newZoom = delta > 0 ? prev * 1.2 : prev / 1.2;\r\n      return Math.max(0.1, Math.min(50, newZoom));\r\n    });\r\n  };\r\n\r\n  const handleRemoveColor = (color: string) => {\r\n    setPickedColors(prev => prev.filter(c => c !== color));\r\n  };\r\n\r\n  const handleSubmit = () => {\r\n    onAddColors(pickedColors);\r\n    onClose();\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-[9999] flex items-center justify-center\" onClick={(e) => { if (e.target === e.currentTarget) onClose(); }}>\r\n      {/* Backdrop */}\r\n      <div className=\"absolute inset-0 bg-black/80\" />\r\n\r\n      {/* Modal */}\r\n      <div className=\"relative z-10 bg-gray-800 border border-gray-600 rounded-lg shadow-2xl flex flex-col overflow-hidden\"\r\n        style={{ width: '90vw', height: '85vh', maxWidth: '1400px' }}\r\n      >\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between px-4 py-3 bg-gray-900 border-b border-gray-700 flex-shrink-0\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <span className=\"text-sm font-semibold text-white\"> Eyedropper  Pick Colors from Image</span>\r\n            <span className=\"text-xs text-gray-500\">Click to pick  Scroll to zoom  Middle-drag to pan</span>\r\n          </div>\r\n          <button onClick={onClose} className=\"text-gray-400 hover:text-white text-lg px-2\" aria-label=\"Close eyedropper\"></button>\r\n        </div>\r\n\r\n        {/* Body */}\r\n        <div className={`${isPortrait ? 'flex flex-col' : 'flex'} flex-1 overflow-hidden`}>\r\n          {/* Canvas area */}\r\n          <div ref={containerRef} className=\"flex-1 relative overflow-hidden bg-gray-950 cursor-crosshair\">\r\n            <canvas\r\n              ref={canvasRef}\r\n              className=\"absolute inset-0\"\r\n              onMouseMove={handleMouseMove}\r\n              onMouseDown={handleMouseDown}\r\n              onMouseUp={handleMouseUp}\r\n              onMouseLeave={() => { setIsPanning(false); setHoverColor(null); }}\r\n              onWheel={handleWheel}\r\n              onContextMenu={(e) => e.preventDefault()}\r\n            />\r\n\r\n            {/* Zoom indicator */}\r\n            <div className=\"absolute top-3 left-3 bg-gray-900/80 border border-gray-700 rounded px-2 py-1 text-xs text-gray-300 pointer-events-none\">\r\n              {Math.round(zoom * 100)}%\r\n            </div>\r\n\r\n            {/* Hover tooltip */}\r\n            {hoverColor && !isPanning && (\r\n              <div\r\n                style={{\r\n                  position: 'fixed',\r\n                  left: cursorPos.x + 20,\r\n                  top: cursorPos.y + 20,\r\n                  zIndex: 99999,\r\n                  pointerEvents: 'none',\r\n                }}\r\n                className=\"bg-gray-900 border border-gray-600 rounded-lg p-2 shadow-xl flex items-center gap-3\"\r\n              >\r\n                <div\r\n                  className=\"w-8 h-8 rounded border border-gray-500 flex-shrink-0\"\r\n                  style={{ backgroundColor: hoverColor }}\r\n                />\r\n                <span className=\"font-mono text-sm text-white font-bold\">{hoverColor}</span>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Picked colors sidebar */}\r\n          <div className={`${isPortrait ? 'h-48 border-t w-full' : 'w-56 border-l'} border-gray-700 flex flex-col bg-gray-800 flex-shrink-0`}>\r\n            <div className=\"px-3 py-2 border-b border-gray-700\">\r\n              <span className=\"text-xs font-semibold text-gray-400 uppercase\">Picked Colors ({pickedColors.length})</span>\r\n            </div>\r\n\r\n            <div className={`flex-1 overflow-y-auto p-2 ${isPortrait ? 'flex flex-wrap gap-1' : 'space-y-1'}`}>\r\n              {pickedColors.length === 0 ? (\r\n                <div className=\"text-xs text-gray-500 text-center py-4 w-full\">Click on the image to pick colors</div>\r\n              ) : (\r\n                pickedColors.map((color, idx) => (\r\n                  <div key={idx} className={`flex items-center gap-2 bg-gray-900 rounded px-2 py-1.5 group ${isPortrait ? 'flex-shrink-0' : ''}`}>\r\n                    <div\r\n                      className=\"w-6 h-6 rounded border border-gray-600 flex-shrink-0\"\r\n                      style={{ backgroundColor: color }}\r\n                    />\r\n                    <span className=\"font-mono text-xs text-white flex-1\">{color}</span>\r\n                    <button\r\n                      onClick={() => handleRemoveColor(color)}\r\n                      className=\"text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity text-sm\"\r\n                      aria-label={`Remove ${color}`}\r\n                    >\r\n                      \r\n                    </button>\r\n                  </div>\r\n                ))\r\n              )}\r\n            </div>\r\n\r\n            <div className={`${isPortrait ? 'flex items-center gap-2 p-2' : 'p-3 space-y-2'} border-t border-gray-700 flex-shrink-0`}>\r\n              <button\r\n                onClick={handleSubmit}\r\n                disabled={pickedColors.length === 0}\r\n                className={`${isPortrait ? 'flex-1' : 'w-full'} px-3 py-2 bg-blue-600 hover:bg-blue-500 disabled:bg-gray-600 disabled:cursor-not-allowed text-white text-sm font-semibold rounded transition-colors`}\r\n              >\r\n                Add Colors to Palette\r\n              </button>\r\n              <button\r\n                onClick={() => setPickedColors([])}\r\n                disabled={pickedColors.length === 0}\r\n                className={`${isPortrait ? 'flex-shrink-0' : 'w-full'} px-3 py-1.5 bg-gray-700 hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed text-gray-300 text-xs rounded transition-colors`}\r\n              >\r\n                Clear All\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EyedropperModal;\r\n","import React, { useState, useCallback } from 'react';\r\n\r\ninterface GeoPixelsPaletteModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onAddColors: (hexColors: string[]) => void;\r\n}\r\n\r\ninterface UserProfile {\r\n  id: number;\r\n  name: string;\r\n  experience: number;\r\n  level: number;\r\n  discordUser?: string;\r\n  xUser?: string;\r\n  redditUser?: string;\r\n  moderator: boolean;\r\n  guildTag?: string;\r\n  isGuildOwner: boolean;\r\n  profileLevel: number;\r\n  bannersLevel: number;\r\n  colors: string;\r\n}\r\n\r\nconst GEOPIXELS_PROFILE_URL = 'https://geopixels.net/GetUserProfile';\r\n\r\n/**\r\n * Convert a decimal integer color value to a hex color string.\r\n * e.g. 16777215 -> \"#FFFFFF\", 0 -> \"#000000\"\r\n */\r\nfunction decimalToHex(dec: number): string {\r\n  return '#' + Math.max(0, Math.min(16777215, dec)).toString(16).padStart(6, '0').toUpperCase();\r\n}\r\n\r\n/**\r\n * Format large numbers with commas.\r\n */\r\nfunction formatNumber(n: number): string {\r\n  return n.toLocaleString();\r\n}\r\n\r\nconst GeoPixelsPaletteModal: React.FC<GeoPixelsPaletteModalProps> = ({ isOpen, onClose, onAddColors }) => {\r\n  const [userId, setUserId] = useState<string>('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [profile, setProfile] = useState<UserProfile | null>(null);\r\n  const [parsedColors, setParsedColors] = useState<string[]>([]);\r\n  const [hoveredColor, setHoveredColor] = useState<string | null>(null);\r\n  const [hoverPos, setHoverPos] = useState<{ x: number; y: number } | null>(null);\r\n\r\n  const handleFetch = useCallback(async () => {\r\n    const id = parseInt(userId.trim() || '3228', 10);\r\n    if (isNaN(id) || id <= 0) {\r\n      setError('Please enter a valid user ID (positive integer).');\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n    setError(null);\r\n    setProfile(null);\r\n    setParsedColors([]);\r\n\r\n    try {\r\n      const response = await fetch(GEOPIXELS_PROFILE_URL, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ targetId: id }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`API returned ${response.status}: ${response.statusText}`);\r\n      }\r\n\r\n      const data: UserProfile = await response.json();\r\n\r\n      if (!data.name) {\r\n        throw new Error('User not found or invalid response.');\r\n      }\r\n\r\n      setProfile(data);\r\n\r\n      // Parse colors\r\n      if (data.colors && typeof data.colors === 'string') {\r\n        const colorInts = data.colors\r\n          .split(',')\r\n          .map(s => s.trim())\r\n          .filter(s => s !== '')\r\n          .map(s => parseInt(s, 10))\r\n          .filter(n => !isNaN(n));\r\n\r\n        // Deduplicate while preserving order\r\n        const seen = new Set<string>();\r\n        const hexColors: string[] = [];\r\n        for (const n of colorInts) {\r\n          const hex = decimalToHex(n);\r\n          if (!seen.has(hex)) {\r\n            seen.add(hex);\r\n            hexColors.push(hex);\r\n          }\r\n        }\r\n        setParsedColors(hexColors);\r\n      }\r\n    } catch (err: any) {\r\n      setError(err.message || 'Failed to fetch user profile.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [userId]);\r\n\r\n  const handleAddPalette = () => {\r\n    if (parsedColors.length > 0) {\r\n      onAddColors(parsedColors);\r\n      onClose();\r\n    }\r\n  };\r\n\r\n  const handleKeyDown = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter') {\r\n      handleFetch();\r\n    }\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-[9999] flex items-center justify-center\">\r\n      {/* Backdrop */}\r\n      <div className=\"absolute inset-0 bg-black/60\" onClick={onClose} />\r\n\r\n      {/* Modal */}\r\n      <div className=\"relative bg-gray-800 border border-gray-600 rounded-lg shadow-2xl w-full max-w-lg max-h-[85vh] flex flex-col overflow-hidden\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between px-4 py-3 bg-gray-900 border-b border-gray-700 flex-shrink-0\">\r\n          <h2 className=\"text-sm font-semibold text-gray-200\"> GeoPixels  Get Your Owned Colors</h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-400 hover:text-white text-lg leading-none px-1\"\r\n            title=\"Close\"\r\n          >\r\n            \r\n          </button>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\r\n          {/* Input */}\r\n          <div className=\"space-y-2\">\r\n            <label className=\"text-xs text-gray-400 block\">\r\n              Enter your GeoPixels User ID to fetch your owned color palette.\r\n            </label>\r\n            <div className=\"flex gap-2\">\r\n              <input\r\n                type=\"text\"\r\n                inputMode=\"numeric\"\r\n                value={userId}\r\n                onChange={(e) => setUserId(e.target.value)}\r\n                onKeyDown={handleKeyDown}\r\n                placeholder=\"3228\"\r\n                className=\"flex-1 bg-gray-900 border border-gray-600 rounded px-3 py-2 text-sm text-gray-200 placeholder-gray-500 focus:border-blue-500 focus:outline-none\"\r\n                autoFocus\r\n              />\r\n              <button\r\n                onClick={handleFetch}\r\n                disabled={isLoading}\r\n                className=\"px-4 py-2 bg-blue-600 hover:bg-blue-500 disabled:bg-gray-600 disabled:cursor-not-allowed text-white text-sm font-medium rounded transition-colors flex items-center gap-2\"\r\n              >\r\n                {isLoading ? (\r\n                  <>\r\n                    <div className=\"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin\" />\r\n                    Fetching...\r\n                  </>\r\n                ) : (\r\n                  'Fetch'\r\n                )}\r\n              </button>\r\n            </div>\r\n            <p className=\"text-xs text-gray-500\">\r\n              Find your ID on <a href=\"https://geopixels.net\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-400 hover:underline\">geopixels.net</a>  it's shown in your profile URL.\r\n            </p>\r\n          </div>\r\n\r\n          {/* Error */}\r\n          {error && (\r\n            <div className=\"bg-red-900/30 border border-red-700 rounded p-3 text-xs text-red-300\">\r\n              {error}\r\n            </div>\r\n          )}\r\n\r\n          {/* Profile + Colors */}\r\n          {profile && (\r\n            <div className=\"space-y-4\">\r\n              {/* User Info Card */}\r\n              <div className=\"bg-gray-900 border border-gray-700 rounded-lg p-4 space-y-3\">\r\n                <div className=\"flex items-start justify-between\">\r\n                  <div>\r\n                    <h3 className=\"text-base font-bold text-white\">{profile.name}</h3>\r\n                    <div className=\"text-xs text-gray-400 mt-0.5\">ID: {profile.id}</div>\r\n                  </div>\r\n                  <div className=\"text-right\">\r\n                    <div className=\"text-sm font-semibold text-yellow-400\">Level {profile.level}</div>\r\n                    <div className=\"text-xs text-gray-500\">{formatNumber(profile.experience)} XP</div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Profile badges / levels */}\r\n                <div className=\"flex gap-3 flex-wrap\">\r\n                  <span className=\"text-xs bg-gray-800 border border-gray-600 rounded px-2 py-0.5 text-gray-300\">\r\n                    Profile Lvl {profile.profileLevel}\r\n                  </span>\r\n                  <span className=\"text-xs bg-gray-800 border border-gray-600 rounded px-2 py-0.5 text-gray-300\">\r\n                    Banners Lvl {profile.bannersLevel}\r\n                  </span>\r\n                  {profile.moderator && (\r\n                    <span className=\"text-xs bg-red-900 border border-red-700 rounded px-2 py-0.5 text-red-300 font-semibold\">\r\n                       Moderator\r\n                    </span>\r\n                  )}\r\n                  {profile.isGuildOwner && (\r\n                    <span className=\"text-xs bg-amber-900 border border-amber-700 rounded px-2 py-0.5 text-amber-300 font-semibold\">\r\n                       Guild Owner\r\n                    </span>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Socials */}\r\n                {(profile.discordUser || profile.xUser || profile.redditUser) && (\r\n                  <div className=\"flex gap-3 flex-wrap text-xs text-gray-400\">\r\n                    {profile.discordUser && (\r\n                      <span title=\"Discord\"> {profile.discordUser}</span>\r\n                    )}\r\n                    {profile.xUser && (\r\n                      <span title=\"X / Twitter\"> @{profile.xUser}</span>\r\n                    )}\r\n                    {profile.redditUser && (\r\n                      <span title=\"Reddit\"> u/{profile.redditUser}</span>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {/* Palette Preview */}\r\n              {parsedColors.length > 0 && (\r\n                <div className=\"space-y-3\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <h4 className=\"text-xs font-semibold text-gray-400 uppercase\">\r\n                      Owned Colors <span className=\"text-gray-500 font-normal\">({parsedColors.length} unique)</span>\r\n                    </h4>\r\n                    <button\r\n                      onClick={() => navigator.clipboard.writeText(parsedColors.join(', '))}\r\n                      className=\"text-gray-400 hover:text-white p-1 rounded hover:bg-gray-700 transition-colors\"\r\n                      title=\"Copy hex palette to clipboard\"\r\n                    >\r\n                      <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-3.5 w-3.5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m2 4h3a2 2 0 012 2v3m-3-3V5a2 2 0 012-2h3.071a2 2 0 011.414.586l1.414 1.414A2 2 0 0118 6.414V9m-3-3h3\" />\r\n                      </svg>\r\n                    </button>\r\n                  </div>\r\n\r\n                  <div className=\"flex flex-wrap gap-0 bg-gray-900 p-1.5 rounded border border-gray-700\">\r\n                    {parsedColors.map((color, idx) => (\r\n                      <div\r\n                        key={idx}\r\n                        className=\"w-5 h-5 cursor-crosshair hover:z-10 hover:scale-150 transition-transform duration-75 border border-transparent hover:border-white\"\r\n                        style={{ backgroundColor: color }}\r\n                        title={color}\r\n                        onMouseEnter={(e) => {\r\n                          setHoveredColor(color);\r\n                          setHoverPos({ x: e.clientX, y: e.clientY });\r\n                        }}\r\n                        onMouseLeave={() => {\r\n                          setHoveredColor(null);\r\n                          setHoverPos(null);\r\n                        }}\r\n                        onMouseMove={(e) => {\r\n                          setHoverPos({ x: e.clientX, y: e.clientY });\r\n                        }}\r\n                      />\r\n                    ))}\r\n                  </div>\r\n\r\n                  {/* Hover Tooltip */}\r\n                  {hoveredColor && hoverPos && (\r\n                    <div\r\n                      style={{\r\n                        position: 'fixed',\r\n                        left: hoverPos.x + 15,\r\n                        top: hoverPos.y + 15,\r\n                        zIndex: 99999,\r\n                        pointerEvents: 'none',\r\n                      }}\r\n                      className=\"bg-gray-900 border border-gray-600 rounded p-2 shadow-xl text-xs min-w-[100px]\"\r\n                    >\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <div\r\n                          className=\"w-4 h-4 border border-gray-500 rounded-sm\"\r\n                          style={{ backgroundColor: hoveredColor }}\r\n                        />\r\n                        <span className=\"font-mono font-bold text-white\">{hoveredColor}</span>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Add button */}\r\n                  <button\r\n                    onClick={handleAddPalette}\r\n                    className=\"w-full px-4 py-2.5 bg-teal-600 hover:bg-teal-500 text-white text-sm font-semibold rounded transition-colors flex items-center justify-center gap-2\"\r\n                  >\r\n                    <span></span>\r\n                    Add Palette to Pixelator\r\n                  </button>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default GeoPixelsPaletteModal;\r\n","import React, { useState, useEffect, useRef, useCallback, useMemo } from 'react';\r\nimport DraggableModal from './DraggableModal';\r\nimport EyedropperModal from './EyedropperModal';\r\nimport GeoPixelsPaletteModal from './GeoPixelsPaletteModal';\r\nimport { usePortraitMode } from '../../hooks/usePortraitMode';\r\nimport useCompositorStore from '../../store/compositorStore';\r\nimport { Layer } from '../../types/compositor.types';\r\nimport PixelatorWorker from '../../workers/pixelator.worker?worker';\r\n\r\ninterface PixelatorModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  layer: Layer;\r\n}\r\n\r\nconst GEOPIXELS_PALETTE = [\r\n  \"#FFFFFF\", \"#F4F59F\", \"#FFCA3A\", \"#FF9F1C\", \"#FF595E\", \"#E71D36\", \"#F3BBC2\", \"#FF85A1\", \"#BD637D\", \"#CDB4DB\", \"#6A4C93\", \"#4D194D\", \"#A8D0DC\", \"#2EC4B6\", \"#1A535C\", \"#6D9DCD\", \"#1982C4\", \"#A1C181\", \"#8AC926\", \"#A0A0A0\", \"#6B4226\", \"#505050\", \"#CFD078\", \"#145A7A\", \"#8B1D24\", \"#C07F7A\", \"#C49A6C\", \"#5B7B1C\", \"#000000\"\r\n];\r\n\r\nconst WPLACE_PALETTE = [\r\n  \"#000000\", \"#3c3c3c\", \"#787878\", \"#aaaaaa\", \"#d2d2d2\", \"#ffffff\", \"#600018\", \"#a50e1e\", \"#ed1c24\", \"#fa8072\", \"#e45c1a\", \"#ff7f27\", \"#f6aa09\", \"#f9dd3b\", \"#fffabc\", \"#9c8431\", \"#c5ad31\", \"#e8d45f\", \"#4a6b3a\", \"#5a944a\", \"#84c573\", \"#0eb968\", \"#13e67b\", \"#87ff5e\", \"#0c816e\", \"#10aea6\", \"#13e1be\", \"#0f799f\", \"#60f7f2\", \"#bbfaf2\", \"#28509e\", \"#4093e4\", \"#7dc7ff\", \"#4d31b8\", \"#6b50f6\", \"#99b1fb\", \"#4a4284\", \"#7a71c4\", \"#b5aef1\", \"#780c99\", \"#aa38b9\", \"#e09ff9\", \"#cb007a\", \"#ec1f80\", \"#f38da9\", \"#9b5249\", \"#d18078\", \"#fab6a4\", \"#684634\", \"#95682a\", \"#dba463\", \"#7b6352\", \"#9c846b\", \"#d6b594\", \"#d18051\", \"#f8b277\", \"#ffc5a5\", \"#6d643f\", \"#948c6b\", \"#cdc59e\", \"#333941\", \"#6d758d\", \"#b3b9d1\"\r\n];\r\n\r\nconst WPLACE_FREE_PALETTE = [\r\n  \"#000000\", \"#3c3c3c\", \"#787878\", \"#d2d2d2\", \"#ffffff\", \"#600018\", \"#ed1c24\", \"#ff7f27\", \"#f6aa09\", \"#f9dd3b\", \"#fffabc\", \"#0eb968\", \"#13e67b\", \"#87ff5e\", \"#0c816e\", \"#10aea6\", \"#13e1be\", \"#60f7f2\", \"#28509e\", \"#4093e4\", \"#6b50f6\", \"#99b1fb\", \"#780c99\", \"#aa38b9\", \"#e09ff9\", \"#cb007a\", \"#ec1f80\", \"#f38da9\", \"#684634\", \"#95682a\", \"#f8b277\"\r\n];\r\n\r\nconst COLOR_MATCH_ALGORITHMS = [\r\n  { value: 'oklab', label: 'OKLab (perceptual)', desc: 'Modern perceptual  best all-round accuracy' },\r\n  { value: 'ciede2000', label: 'CIEDE2000', desc: 'Gold standard  great for skin tones and gradients' },\r\n  { value: 'cie94', label: 'CIE94 (graphics)', desc: 'Industry standard  weights chroma/hue over lightness' },\r\n  { value: 'cie76', label: 'CIE76 (euclidean)', desc: 'Simple Euclidean in Lab space  fast but less accurate' },\r\n  { value: 'redmean', label: 'Redmean (turbo)', desc: 'Fastest  weighted RGB, no color space conversion needed' },\r\n];\r\n\r\nconst DITHER_ALGORITHMS = [\r\n  { value: 'none', label: 'None (Nearest Color)' },\r\n  { value: 'floyd-steinberg', label: 'Floyd-Steinberg' },\r\n  { value: 'burkes', label: 'Burkes' },\r\n  { value: 'stucki', label: 'Stucki' },\r\n  { value: 'sierra-2', label: 'Sierra-2' },\r\n  { value: 'sierra-lite', label: 'Sierra Lite' },\r\n  { value: 'bayer-4x4', label: 'Bayer 4x4' },\r\n  { value: 'bayer-8x8', label: 'Bayer 8x8' },\r\n  { value: 'halftone-dot', label: 'Halftone Dot' },\r\n  { value: 'diagonal-line', label: 'Diagonal Line' },\r\n  { value: 'cross-hatch', label: 'Cross Hatch' },\r\n  { value: 'grid', label: 'Grid' },\r\n];\r\n\r\nconst COMMON_HEIGHTS = [\r\n  64, 100, 128, 150, 200, 250, 256, 300, 350, 400, 450, 500,\r\n  512, 550, 600, 650, 700, 750, 800, 850, 900, 950, 1000\r\n];\r\n\r\nconst PixelatorModal: React.FC<PixelatorModalProps> = ({ isOpen, onClose, layer }) => {\r\n  const updateLayer = useCompositorStore((state) => state.updateLayer);\r\n  const isPortrait = usePortraitMode();\r\n\r\n  // State\r\n  const [targetHeight, setTargetHeight] = useState<number>(128);\r\n  const [originalHeight, setOriginalHeight] = useState<number>(128);\r\n  const [resamplingMethod, setResamplingMethod] = useState<'nearest' | 'bilinear' | 'lanczos'>('bilinear');\r\n  const [ditherMethod, setDitherMethod] = useState<string>('none');\r\n  const [ditherStrength, setDitherStrength] = useState<number>(100);\r\n  const [preprocessingMethod, setPreprocessingMethod] = useState<'none' | 'bilateral' | 'kuwahara' | 'median'>('none');\r\n  const [preprocessingStrength, setPreprocessingStrength] = useState<number>(50);\r\n  const [paletteMode, setPaletteMode] = useState<'geopixels' | 'wplace' | 'wplace-free' | 'custom' | 'geopixels+custom' | 'none'>('geopixels');\r\n  const [customPaletteInput, setCustomPaletteInput] = useState<string>('');\r\n  const [previewImage, setPreviewImage] = useState<string | null>(null);\r\n  const [resultDimensions, setResultDimensions] = useState<{ width: number; height: number } | null>(null);\r\n  const [isProcessing, setIsProcessing] = useState<boolean>(false);\r\n  const [zoom, setZoom] = useState<number>(1);\r\n  const [imageDimensions, setImageDimensions] = useState<{ width: number; height: number } | null>(null);\r\n  const [displayHeight, setDisplayHeight] = useState(String(targetHeight));\r\n  const [isPaletteVisualizationOpen, setIsPaletteVisualizationOpen] = useState(true);\r\n  const [useKmeans, setUseKmeans] = useState<boolean>(false);\r\n  const [kmeansColors, setKmeansColors] = useState<number>(16);\r\n  const [suggestedColors, setSuggestedColors] = useState<string[]>([]);\r\n  const [suggestCount, setSuggestCount] = useState<number>(8);\r\n  const [isSuggesting, setIsSuggesting] = useState<boolean>(false);\r\n  const [preferDistinctColors, setPreferDistinctColors] = useState<boolean>(true);\r\n  const [hasSemiTransparent, setHasSemiTransparent] = useState<boolean>(false);\r\n  const [autoUpdate, setAutoUpdate] = useState<boolean>(true);\r\n  const [colorStats, setColorStats] = useState<Map<string, { count: number, percent: number }>>(new Map());\r\n  const [hoveredColor, setHoveredColor] = useState<string | null>(null);\r\n  const [hoverPos, setHoverPos] = useState<{ x: number, y: number } | null>(null);\r\n  const [generatedPalette, setGeneratedPalette] = useState<string[]>([]);\r\n  const [hasInitialFit, setHasInitialFit] = useState<boolean>(false);\r\n  const [pinFitToScreen, setPinFitToScreen] = useState<boolean>(true);\r\n  const [filterTrivialColors, setFilterTrivialColors] = useState<boolean>(false);\r\n\r\n  // Extra Features State\r\n  const [isExtraFeaturesOpen, setIsExtraFeaturesOpen] = useState<boolean>(false);\r\n  const [brightness, setBrightness] = useState<number>(0);\r\n  const [contrast, setContrast] = useState<number>(0);\r\n  const [saturation, setSaturation] = useState<number>(0);\r\n  const [colorMatchAlgorithm, setColorMatchAlgorithm] = useState<string>('oklab');\r\n  const [preserveDetailThreshold, setPreserveDetailThreshold] = useState<number>(0);\r\n\r\n  // Eyedropper modal state\r\n  const [isEyedropperOpen, setIsEyedropperOpen] = useState<boolean>(false);\r\n\r\n  // GeoPixels palette modal state\r\n  const [isGeoPixelsPaletteOpen, setIsGeoPixelsPaletteOpen] = useState<boolean>(false);\r\n\r\n  const workerRef = useRef<Worker | null>(null);\r\n  const previewContainerRef = useRef<HTMLDivElement>(null);\r\n  const imgRef = useRef<HTMLImageElement>(null);\r\n  const jobIdRef = useRef<number>(0);\r\n\r\n  // Track previous state to restore K-Means when switching back to 'none'\r\n  const wasKmeansEnabledRef = useRef<boolean>(false);\r\n  const prevPaletteModeRef = useRef<string>(paletteMode);\r\n  const debounceTimeRef = useRef<number>(750);\r\n\r\n  const analyzePreviewColors = (imageData: ImageData) => {\r\n    const data = imageData.data;\r\n    const stats = new Map<string, number>();\r\n    let totalPixels = 0;\r\n\r\n    for (let i = 0; i < data.length; i += 4) {\r\n      const r = data[i];\r\n      const g = data[i + 1];\r\n      const b = data[i + 2];\r\n      const a = data[i + 3];\r\n\r\n      if (a === 0) continue; // Skip transparent\r\n\r\n      // Convert to hex\r\n      const hex = `#${((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1).toUpperCase()}`;\r\n      stats.set(hex, (stats.get(hex) || 0) + 1);\r\n      totalPixels++;\r\n    }\r\n\r\n    const result = new Map<string, { count: number, percent: number }>();\r\n    stats.forEach((count, hex) => {\r\n      result.set(hex, {\r\n        count,\r\n        percent: totalPixels > 0 ? (count / totalPixels) * 100 : 0\r\n      });\r\n    });\r\n\r\n    setColorStats(result);\r\n  };\r\n\r\n  // Helper to (re)create worker with message handler\r\n  const createWorker = useCallback(() => {\r\n    workerRef.current?.terminate();\r\n    const w = new PixelatorWorker();\r\n    w.onmessage = (e) => {\r\n      const { type, imageData, message, suggestions, generatedPalette } = e.data;\r\n      if (type === 'success') {\r\n        const canvas = document.createElement('canvas');\r\n        canvas.width = imageData.width;\r\n        canvas.height = imageData.height;\r\n        const ctx = canvas.getContext('2d');\r\n        if (ctx) {\r\n          ctx.putImageData(imageData, 0, 0);\r\n          setImageDimensions({ width: imageData.width, height: imageData.height });\r\n          setResultDimensions({ width: imageData.width, height: imageData.height });\r\n          if (pinFitToScreen) {\r\n            const newZoom = calculateFitZoom(imageData.width, imageData.height);\r\n            setZoom(newZoom);\r\n          }\r\n          setPreviewImage(canvas.toDataURL());\r\n          analyzePreviewColors(imageData);\r\n          if (generatedPalette) {\r\n            setGeneratedPalette(generatedPalette);\r\n          } else {\r\n            setGeneratedPalette([]);\r\n          }\r\n        }\r\n      } else if (type === 'suggestions') {\r\n        setSuggestedColors(suggestions);\r\n        setIsSuggesting(false);\r\n      } else {\r\n        console.error('Pixelator Worker Error:', message);\r\n        setIsSuggesting(false);\r\n      }\r\n      setIsProcessing(false);\r\n    };\r\n    workerRef.current = w;\r\n    return w;\r\n  }, [pinFitToScreen]);\r\n\r\n  // Initialize Worker\r\n  useEffect(() => {\r\n    createWorker();\r\n    return () => {\r\n      workerRef.current?.terminate();\r\n    };\r\n  }, [createWorker]);\r\n\r\n  // Sync display height when targetHeight changes\r\n  useEffect(() => {\r\n    setDisplayHeight(String(targetHeight));\r\n  }, [targetHeight]);\r\n\r\n  // Load cached custom palette on mount\r\n  useEffect(() => {\r\n    const cached = localStorage.getItem('pixelator_custom_palette');\r\n    if (cached) {\r\n      setCustomPaletteInput(cached);\r\n    }\r\n  }, []);\r\n\r\n  // Initialize original height from layer dimensions\r\n  useEffect(() => {\r\n    if (isOpen && layer.imageData) {\r\n      const img = new Image();\r\n      img.onload = () => {\r\n        setOriginalHeight(img.height);\r\n        setTargetHeight(128);\r\n      };\r\n      img.src = layer.imageData;\r\n    }\r\n  }, [isOpen, layer.imageData]);\r\n\r\n  // Save custom palette to localStorage on change\r\n  useEffect(() => {\r\n    if (customPaletteInput.trim()) {\r\n      localStorage.setItem('pixelator_custom_palette', customPaletteInput);\r\n    }\r\n  }, [customPaletteInput]);\r\n\r\n  // Helper to parse custom palette\r\n  const getPalette = useCallback(() => {\r\n    if (paletteMode === 'none') return [];\r\n    if (paletteMode === 'geopixels') return GEOPIXELS_PALETTE;\r\n    if (paletteMode === 'wplace') return WPLACE_PALETTE;\r\n    if (paletteMode === 'wplace-free') return WPLACE_FREE_PALETTE;\r\n\r\n    // Parse custom input\r\n    const rawInput = customPaletteInput.trim();\r\n    let customColors: string[] = [];\r\n\r\n    if (rawInput) {\r\n      // Split by comma, space, or newline to handle various formats\r\n      const parts = rawInput.split(/[\\s,]+/).filter(s => s.trim() !== '');\r\n\r\n      customColors = parts.map(s => {\r\n        const trimmed = s.trim();\r\n\r\n        // Check if it's a decimal integer (e.g. \"16777215\")\r\n        if (/^\\d+$/.test(trimmed)) {\r\n          const decimal = parseInt(trimmed, 10);\r\n          // Ensure it's a valid 24-bit color\r\n          if (decimal >= 0 && decimal <= 16777215) {\r\n            return '#' + decimal.toString(16).padStart(6, '0').toUpperCase();\r\n          }\r\n        }\r\n\r\n        // Check if it's a hex code (e.g. \"#FFFFFF\" or \"FFFFFF\")\r\n        if (/^#?[0-9A-F]{6}$/i.test(trimmed)) {\r\n          return trimmed.startsWith('#') ? trimmed.toUpperCase() : '#' + trimmed.toUpperCase();\r\n        }\r\n\r\n        return null;\r\n      }).filter((c): c is string => c !== null);\r\n    }\r\n\r\n    if (paletteMode === 'custom') return customColors;\r\n    if (paletteMode === 'geopixels+custom') {\r\n      // Merge geopixels base with custom, removing duplicates\r\n      const merged = [...GEOPIXELS_PALETTE];\r\n      for (const color of customColors) {\r\n        if (!merged.includes(color.toUpperCase())) {\r\n          merged.push(color.toUpperCase());\r\n        }\r\n      }\r\n      return merged;\r\n    }\r\n\r\n    return [];\r\n  }, [paletteMode, customPaletteInput]);\r\n\r\n  // Handle K-Means state when palette mode changes\r\n  useEffect(() => {\r\n    // Leaving 'none' mode\r\n    if (prevPaletteModeRef.current === 'none' && paletteMode !== 'none') {\r\n      if (useKmeans) {\r\n        wasKmeansEnabledRef.current = true;\r\n        setUseKmeans(false);\r\n      } else {\r\n        wasKmeansEnabledRef.current = false;\r\n      }\r\n    }\r\n    // Entering 'none' mode\r\n    else if (prevPaletteModeRef.current !== 'none' && paletteMode === 'none') {\r\n      if (wasKmeansEnabledRef.current) {\r\n        setUseKmeans(true);\r\n      }\r\n    }\r\n    // Ensure K-Means is off if not in 'none' mode (cleanup/safety)\r\n    else if (paletteMode !== 'none' && useKmeans) {\r\n      setUseKmeans(false);\r\n    }\r\n\r\n    prevPaletteModeRef.current = paletteMode;\r\n  }, [paletteMode, useKmeans]);\r\n\r\n  // Trigger Processing\r\n  const processImage = useCallback(() => {\r\n    if (!layer.imageData) return;\r\n\r\n    // Cancel any in-flight worker job by terminating and recreating\r\n    createWorker();\r\n    const currentJobId = ++jobIdRef.current;\r\n\r\n    setIsProcessing(true);\r\n\r\n    // Load image to get ImageData\r\n    const img = new Image();\r\n    img.onload = () => {\r\n      // If another processImage call happened while loading, bail out\r\n      if (currentJobId !== jobIdRef.current) return;\r\n\r\n      const canvas = document.createElement('canvas');\r\n      canvas.width = img.width;\r\n      canvas.height = img.height;\r\n      const ctx = canvas.getContext('2d');\r\n      if (!ctx) return;\r\n\r\n      ctx.drawImage(img, 0, 0);\r\n      const imageData = ctx.getImageData(0, 0, img.width, img.height);\r\n\r\n      // Check for semi-transparent pixels\r\n      setHasSemiTransparent(checkForSemiTransparentPixels(imageData));\r\n\r\n      const palette = getPalette();\r\n\r\n      // Calculate target width based on aspect ratio\r\n      const aspectRatio = img.width / img.height;\r\n      const targetWidth = Math.round(targetHeight * aspectRatio);\r\n\r\n      workerRef.current?.postMessage({\r\n        imageData,\r\n        settings: {\r\n          targetWidth,\r\n          targetHeight,\r\n          ditherMethod,\r\n          ditherStrength,\r\n          palette,\r\n          resamplingMethod,\r\n          useKmeans,\r\n          kmeansColors,\r\n          brightness,\r\n          contrast,\r\n          saturation,\r\n          preprocessingMethod,\r\n          preprocessingStrength,\r\n          filterTrivialColors,\r\n          colorMatchAlgorithm,\r\n          preserveDetailThreshold,\r\n          colorStats: filterTrivialColors ? Array.from(colorStats.entries()).map(([c, s]) => ({ color: c, percent: s.percent })) : []\r\n        }\r\n      });\r\n    };\r\n    img.src = layer.imageData;\r\n\r\n  }, [layer.imageData, targetHeight, ditherMethod, ditherStrength, getPalette, resamplingMethod, useKmeans, kmeansColors, brightness, contrast, saturation, preprocessingMethod, preprocessingStrength, filterTrivialColors, colorMatchAlgorithm, preserveDetailThreshold, createWorker]);\r\n\r\n  // Debounced Effect\r\n  useEffect(() => {\r\n    if (!isOpen || !autoUpdate) return;\r\n\r\n    const timer = setTimeout(() => {\r\n      processImage();\r\n      debounceTimeRef.current = 750; // Reset to default after execution\r\n    }, debounceTimeRef.current);\r\n\r\n    return () => clearTimeout(timer);\r\n  }, [\r\n    isOpen,\r\n    autoUpdate,\r\n    targetHeight,\r\n    ditherMethod,\r\n    ditherStrength,\r\n    paletteMode,\r\n    customPaletteInput,\r\n    resamplingMethod,\r\n    useKmeans,\r\n    kmeansColors,\r\n    brightness,\r\n    contrast,\r\n    saturation,\r\n    preprocessingMethod,\r\n    preprocessingStrength,\r\n    filterTrivialColors,\r\n    colorMatchAlgorithm,\r\n    preserveDetailThreshold,\r\n    processImage\r\n  ]);\r\n\r\n  const handleApply = () => {\r\n    if (previewImage && resultDimensions) {\r\n      updateLayer(layer.id, {\r\n        imageData: previewImage,\r\n        width: resultDimensions.width,\r\n        height: resultDimensions.height\r\n      });\r\n      onClose();\r\n    }\r\n  };\r\n\r\n  const calculateFitZoom = useCallback((width: number, height: number) => {\r\n    if (!previewContainerRef.current) return 1;\r\n\r\n    const containerWidth = previewContainerRef.current.clientWidth;\r\n    const containerHeight = previewContainerRef.current.clientHeight;\r\n\r\n    // Add some padding (e.g., 40px total)\r\n    const availableWidth = containerWidth - 40;\r\n    const availableHeight = containerHeight - 40;\r\n\r\n    if (availableWidth <= 0 || availableHeight <= 0) return 1;\r\n\r\n    const scaleX = availableWidth / width;\r\n    const scaleY = availableHeight / height;\r\n\r\n    // Use the smaller scale to ensure it fits entirely\r\n    const newZoom = Math.min(scaleX, scaleY);\r\n\r\n    return Math.max(0.1, newZoom);\r\n  }, []);\r\n\r\n  const handleZoomIn = () => setZoom(prev => Math.min(prev + 0.5, 20));\r\n  const handleZoomOut = () => setZoom(prev => Math.max(prev - 0.5, 0.5));\r\n  const handleZoomReset = () => setZoom(1);\r\n  const handleFitToScreen = useCallback(() => {\r\n    if (!imageDimensions) return;\r\n    setZoom(calculateFitZoom(imageDimensions.width, imageDimensions.height));\r\n  }, [imageDimensions, calculateFitZoom]);\r\n\r\n  // Auto-fit on first load or when pinned\r\n  useEffect(() => {\r\n    if (imageDimensions && previewContainerRef.current) {\r\n      if (!hasInitialFit) {\r\n        // Small delay to ensure layout is stable\r\n        setTimeout(() => {\r\n          handleFitToScreen();\r\n          setHasInitialFit(true);\r\n        }, 50);\r\n      }\r\n    }\r\n  }, [imageDimensions, hasInitialFit, handleFitToScreen]);\r\n\r\n  const handleHeightReset = () => setTargetHeight(originalHeight);\r\n\r\n  const checkForSemiTransparentPixels = (imageData: ImageData): boolean => {\r\n    const data = imageData.data;\r\n    for (let i = 3; i < data.length; i += 4) {\r\n      const alpha = data[i];\r\n      if (alpha > 0 && alpha < 255) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  };\r\n\r\n  const handleImageLoad = (e: React.SyntheticEvent<HTMLImageElement>) => {\r\n    const img = e.currentTarget;\r\n    setImageDimensions({\r\n      width: img.naturalWidth,\r\n      height: img.naturalHeight,\r\n    });\r\n  };\r\n\r\n  const handleSuggestColors = useCallback(() => {\r\n    if (!workerRef.current || !layer.imageData) return;\r\n\r\n    const palette = getPalette();\r\n    if (palette.length === 0) {\r\n      alert('Please select a palette first to find missing colors.');\r\n      return;\r\n    }\r\n\r\n    setIsSuggesting(true);\r\n\r\n    const img = new Image();\r\n    img.onload = () => {\r\n      const canvas = document.createElement('canvas');\r\n      canvas.width = img.width;\r\n      canvas.height = img.height;\r\n      const ctx = canvas.getContext('2d');\r\n      if (!ctx) return;\r\n\r\n      ctx.drawImage(img, 0, 0);\r\n      const imageData = ctx.getImageData(0, 0, img.width, img.height);\r\n\r\n      workerRef.current?.postMessage({\r\n        type: 'suggest',\r\n        imageData,\r\n        settings: {\r\n          palette: getPalette(),\r\n          numSuggestions: suggestCount,\r\n          preferDistinct: preferDistinctColors\r\n        }\r\n      });\r\n    };\r\n    img.src = layer.imageData;\r\n  }, [layer.imageData, getPalette, suggestCount, preferDistinctColors]);\r\n\r\n  const handleAddSuggestedToCustom = () => {\r\n    const existingText = customPaletteInput.trim();\r\n    const newColors = suggestedColors.join(', ');\r\n\r\n    if (existingText === '') {\r\n      setCustomPaletteInput(newColors);\r\n    } else {\r\n      setCustomPaletteInput(`${existingText}, ${newColors}`);\r\n    }\r\n  };\r\n\r\n  const sortedPalette = useMemo(() => {\r\n    let currentPalette = getPalette();\r\n\r\n    // Use generated palette if available and we're in 'none' mode with K-Means\r\n    if (paletteMode === 'none' && useKmeans && generatedPalette.length > 0) {\r\n      currentPalette = generatedPalette;\r\n    }\r\n\r\n    if (colorStats.size === 0) return currentPalette;\r\n\r\n    return [...currentPalette].sort((a, b) => {\r\n      const countA = colorStats.get(a)?.count || 0;\r\n      const countB = colorStats.get(b)?.count || 0;\r\n\r\n      // Sort by count descending\r\n      if (countA !== countB) {\r\n        return countB - countA;\r\n      }\r\n\r\n      // If counts are equal, keep original order (stable sort)\r\n      return 0;\r\n    });\r\n  }, [getPalette, colorStats, generatedPalette, paletteMode, useKmeans]);\r\n\r\n  const handleCopyPalette = () => {\r\n    if (sortedPalette.length > 0) {\r\n      navigator.clipboard.writeText(sortedPalette.join(', '));\r\n    }\r\n  };\r\n\r\n  // Eyedropper: add picked colors to custom palette text field\r\n  const handleEyedropperColors = (colors: string[]) => {\r\n    if (colors.length === 0) return;\r\n    const newColors = colors.join(', ');\r\n    const existing = customPaletteInput.trim();\r\n    if (existing === '') {\r\n      setCustomPaletteInput(newColors);\r\n    } else {\r\n      setCustomPaletteInput(`${existing}, ${newColors}`);\r\n    }\r\n    // Auto-switch to custom or geopixels+custom if not already\r\n    if (paletteMode !== 'custom' && paletteMode !== 'geopixels+custom') {\r\n      debounceTimeRef.current = 100;\r\n      setPaletteMode('geopixels+custom');\r\n    }\r\n  };\r\n\r\n  // GeoPixels palette: add fetched colors to custom palette text field\r\n  const handleGeoPixelsColors = (colors: string[]) => {\r\n    if (colors.length === 0) return;\r\n    const newColors = colors.join(', ');\r\n    const existing = customPaletteInput.trim();\r\n    if (existing === '') {\r\n      setCustomPaletteInput(newColors);\r\n    } else {\r\n      setCustomPaletteInput(`${existing}, ${newColors}`);\r\n    }\r\n    // Auto-switch to geopixels+custom if not already on custom/geopixels+custom\r\n    if (paletteMode !== 'custom' && paletteMode !== 'geopixels+custom') {\r\n      debounceTimeRef.current = 100;\r\n      setPaletteMode('geopixels+custom');\r\n    }\r\n  };\r\n\r\n  // K-Means: Send generated palette colors to Geopixels+Custom text field\r\n  const handleSendKmeansToCustom = () => {\r\n    if (generatedPalette.length === 0) return;\r\n    const newColors = generatedPalette.join(', ');\r\n    const existing = customPaletteInput.trim();\r\n    if (existing === '') {\r\n      setCustomPaletteInput(newColors);\r\n    } else {\r\n      setCustomPaletteInput(`${existing}, ${newColors}`);\r\n    }\r\n    // Switch to Geopixels + Custom mode\r\n    debounceTimeRef.current = 100;\r\n    setPaletteMode('geopixels+custom');\r\n  };\r\n\r\n  return (\r\n    <DraggableModal isOpen={isOpen} title=\"Pixelator\" onClose={onClose} noPadding={true} modalId=\"modal-pixelator\" children={() => (\r\n      <div className={`${isPortrait ? 'flex flex-col-reverse' : 'flex'} text-gray-200 h-full w-full overflow-hidden`}>\r\n        {/* Controls */}\r\n        <div className={`${isPortrait ? 'border-t max-h-[45vh]' : 'w-72 border-r'} border-gray-700 flex-shrink-0 flex flex-col overflow-hidden`}>\r\n          {/* Scrollable content area */}\r\n          <div className=\"overflow-y-auto flex-1 p-4 space-y-6 text-gray-200\">\r\n\r\n            {/* Dimensions */}\r\n            <div className=\"space-y-2\">\r\n              <label className=\"text-xs font-semibold text-gray-400 uppercase\">Dimensions</label>\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex gap-2 items-end\">\r\n                  <div className=\"flex-1\">\r\n                    <label className=\"text-xs text-gray-500\">Height (px)</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      inputMode=\"numeric\"\r\n                      value={displayHeight}\r\n                      onChange={(e) => {\r\n                        // Update display value\r\n                        setDisplayHeight(e.target.value);\r\n                        // Only update state if it's a valid number\r\n                        if (e.target.value !== '' && e.target.value !== '-') {\r\n                          const value = Number(e.target.value);\r\n                          if (!isNaN(value) && value > 0) {\r\n                            setTargetHeight(value);\r\n                          }\r\n                        }\r\n                      }}\r\n                      className=\"w-full bg-gray-800 border border-gray-600 rounded px-2 py-1 text-sm\"\r\n                    />\r\n                  </div>\r\n                  <select\r\n                    className=\"flex-1 bg-gray-800 border border-gray-600 rounded px-2 py-1 text-xs text-gray-400\"\r\n                    onChange={(e) => {\r\n                      if (e.target.value) {\r\n                        debounceTimeRef.current = 100; // Fast update for dropdown\r\n                        setTargetHeight(Number(e.target.value));\r\n                      }\r\n                    }}\r\n                    value={COMMON_HEIGHTS.includes(targetHeight) ? targetHeight : \"\"}\r\n                  >\r\n                    <option value=\"\" disabled>common sizes</option>\r\n                    {COMMON_HEIGHTS.map(h => (\r\n                      <option key={h} value={h}>{h}px</option>\r\n                    ))}\r\n                  </select>\r\n                  <button\r\n                    onClick={handleHeightReset}\r\n                    className=\"text-xs px-2 py-1 text-gray-400 hover:text-white bg-gray-700 hover:bg-gray-600 rounded transition-colors whitespace-nowrap flex-shrink-0\"\r\n                    title=\"Reset height to default\"\r\n                  >\r\n                    Reset\r\n                  </button>\r\n                </div>\r\n\r\n                {resultDimensions && (\r\n                  <div className=\"text-xs text-gray-400 bg-gray-800 px-2 py-1 rounded whitespace-nowrap\">\r\n                    {resultDimensions.width}  {resultDimensions.height} <span className=\"text-gray-600 mx-1\">|</span> {(resultDimensions.width * resultDimensions.height).toLocaleString()} px\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div>\r\n                <label className=\"text-xs text-gray-500\">Resampling</label>\r\n                <select\r\n                  value={resamplingMethod}\r\n                  onChange={(e) => setResamplingMethod(e.target.value as any)}\r\n                  className=\"w-full bg-gray-800 border border-gray-600 rounded px-2 py-1 text-sm\"\r\n                >\r\n                  <option value=\"nearest\">Nearest Neighbor (Sharp)</option>\r\n                  <option value=\"bilinear\">Bilinear (Smooth)</option>\r\n                  <option value=\"lanczos\">Lanczos (High Quality)</option>\r\n                </select>\r\n              </div>\r\n              <div>\r\n                <label className=\"text-xs text-gray-500\">Color Matching</label>\r\n                <select\r\n                  value={colorMatchAlgorithm}\r\n                  onChange={(e) => { debounceTimeRef.current = 100; setColorMatchAlgorithm(e.target.value); }}\r\n                  className=\"w-full bg-gray-800 border border-gray-600 rounded px-2 py-1 text-sm\"\r\n                  title={COLOR_MATCH_ALGORITHMS.find(a => a.value === colorMatchAlgorithm)?.desc}\r\n                >\r\n                  {COLOR_MATCH_ALGORITHMS.map(a => (\r\n                    <option key={a.value} value={a.value}>{a.label}</option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Semi-Transparent Warning */}\r\n            {hasSemiTransparent && (\r\n              <div className=\"bg-yellow-900/30 border border-yellow-700 rounded p-3 flex gap-3\">\r\n                <div className=\"text-yellow-500 text-xl flex-shrink-0\"></div>\r\n                <div className=\"text-xs text-yellow-300\">\r\n                  <p className=\"font-semibold mb-1\">Semi-transparent pixels detected</p>\r\n                  <p>Apply a transparency mask first for better results</p>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Palette */}\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <label className=\"text-xs font-semibold text-gray-400 uppercase\">Palette</label>\r\n                {paletteMode === 'geopixels+custom' && (\r\n                  <div className=\"group relative\">\r\n                    <span className=\"cursor-help text-xs text-blue-400\">Fun Fact?</span>\r\n                    <div className=\"absolute bottom-full right-0 mb-2 w-64 p-2 bg-gray-900 border border-gray-600 rounded shadow-xl text-xs text-gray-300 hidden group-hover:block z-50\">\r\n                      If you play on Geopixels, you can export your palette by typing <code className=\"text-yellow-400\">userData.colors</code> in the browser console. Paste the result here!\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              <div className=\"flex flex-col space-y-1\">\r\n                <label className=\"flex items-center space-x-2 cursor-pointer\">\r\n                  <input\r\n                    type=\"radio\"\r\n                    name=\"palette\"\r\n                    checked={paletteMode === 'geopixels'}\r\n                    onChange={() => { debounceTimeRef.current = 100; setPaletteMode('geopixels'); }}\r\n                  />\r\n                  <span className=\"text-sm\">Geopixels Base</span>\r\n                </label>\r\n                <label className=\"flex items-center space-x-2 cursor-pointer\">\r\n                  <input\r\n                    type=\"radio\"\r\n                    name=\"palette\"\r\n                    checked={paletteMode === 'wplace-free'}\r\n                    onChange={() => { debounceTimeRef.current = 100; setPaletteMode('wplace-free'); }}\r\n                  />\r\n                  <span className=\"text-sm\">WPlace Free <span className=\"text-gray-500 text-xs\">(31 colors)</span></span>\r\n                </label>\r\n                <label className=\"flex items-center space-x-2 cursor-pointer\">\r\n                  <input\r\n                    type=\"radio\"\r\n                    name=\"palette\"\r\n                    checked={paletteMode === 'wplace'}\r\n                    onChange={() => { debounceTimeRef.current = 100; setPaletteMode('wplace'); }}\r\n                  />\r\n                  <span className=\"text-sm\">WPlace All <span className=\"text-gray-500 text-xs\">(63 colors)</span></span>\r\n                </label>\r\n                <label className=\"flex items-center space-x-2 cursor-pointer\">\r\n                  <input\r\n                    type=\"radio\"\r\n                    name=\"palette\"\r\n                    checked={paletteMode === 'custom'}\r\n                    onChange={() => { debounceTimeRef.current = 100; setPaletteMode('custom'); }}\r\n                  />\r\n                  <span className=\"text-sm\">Custom</span>\r\n                </label>\r\n                <label className=\"flex items-center space-x-2 cursor-pointer\">\r\n                  <input\r\n                    type=\"radio\"\r\n                    name=\"palette\"\r\n                    checked={paletteMode === 'geopixels+custom'}\r\n                    onChange={() => { debounceTimeRef.current = 100; setPaletteMode('geopixels+custom'); }}\r\n                  />\r\n                  <span className=\"text-sm\">Geopixels Base + Custom</span>\r\n                </label>\r\n                <label className=\"flex items-center space-x-2 cursor-pointer\">\r\n                  <input\r\n                    type=\"radio\"\r\n                    name=\"palette\"\r\n                    checked={paletteMode === 'none'}\r\n                    onChange={() => { debounceTimeRef.current = 100; setPaletteMode('none'); }}\r\n                  />\r\n                  <span className=\"text-sm\">No Recoloring (Resize Only)</span>\r\n                </label>\r\n              </div>\r\n\r\n              {(paletteMode === 'custom' || paletteMode === 'geopixels+custom') && (\r\n                <div className=\"space-y-2\">\r\n                  <textarea\r\n                    value={customPaletteInput}\r\n                    onChange={(e) => setCustomPaletteInput(e.target.value)}\r\n                    placeholder=\"#FFFFFF, #000000 or 16777215, 0\"\r\n                    className=\"w-full h-24 bg-gray-800 border border-gray-600 rounded p-2 text-xs font-mono\"\r\n                  />\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <button\r\n                      onClick={() => setIsEyedropperOpen(true)}\r\n                      className=\"flex-1 px-3 py-1.5 bg-gray-700 hover:bg-gray-600 text-white text-xs font-medium rounded transition-colors\"\r\n                    >\r\n                      Eyedropper\r\n                    </button>\r\n                    <button\r\n                      onClick={() => setIsGeoPixelsPaletteOpen(true)}\r\n                      className=\"flex-1 px-3 py-1.5 bg-indigo-700 hover:bg-indigo-600 text-white text-xs font-medium rounded transition-colors\"\r\n                      title=\"Fetch your owned colors from GeoPixels\"\r\n                    >\r\n                       My Colors\r\n                    </button>\r\n                    <div className=\"group relative\">\r\n                      <span className=\"cursor-help text-xs text-blue-400\">?</span>\r\n                      <div className=\"absolute bottom-full right-0 mb-2 w-52 p-2 bg-gray-900 border border-gray-600 rounded shadow-xl text-xs text-gray-300 hidden group-hover:block z-50\">\r\n                        Select colors to use from template image\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Palette Visualization */}\r\n              <div className=\"border-t border-gray-700 pt-2\">\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                  <button\r\n                    onClick={() => setIsPaletteVisualizationOpen(!isPaletteVisualizationOpen)}\r\n                    className=\"flex items-center text-xs text-gray-400 hover:text-gray-300\"\r\n                  >\r\n                    <span>Palette Preview</span>\r\n                    <span className=\"ml-1\">{isPaletteVisualizationOpen ? '' : ''}</span>\r\n                  </button>\r\n                  <button\r\n                    onClick={handleCopyPalette}\r\n                    className=\"text-gray-400 hover:text-white p-1 rounded hover:bg-gray-700\"\r\n                    title=\"Copy palette to clipboard\"\r\n                  >\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-3 w-3\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m2 4h3a2 2 0 012 2v3m-3-3V5a2 2 0 012-2h3.071a2 2 0 011.414.586l1.414 1.414A2 2 0 0118 6.414V9m-3-3h3\" />\r\n                    </svg>\r\n                  </button>\r\n                </div>\r\n\r\n                {isPaletteVisualizationOpen && (\r\n                  <div className=\"space-y-2\">\r\n                    <div className=\"flex flex-wrap gap-0 bg-gray-900 p-1 rounded border border-gray-700\">\r\n                      {sortedPalette.length > 0 ? (\r\n                        sortedPalette.map((color, idx) => (\r\n                          <div\r\n                            key={idx}\r\n                            className=\"w-4 h-4 cursor-crosshair hover:z-10 hover:scale-125 transition-transform duration-75 border border-transparent hover:border-white\"\r\n                            style={{ backgroundColor: color }}\r\n                            onMouseEnter={(e) => {\r\n                              setHoveredColor(color);\r\n                              setHoverPos({ x: e.clientX, y: e.clientY });\r\n                            }}\r\n                            onMouseLeave={() => {\r\n                              setHoveredColor(null);\r\n                              setHoverPos(null);\r\n                            }}\r\n                            onMouseMove={(e) => {\r\n                              setHoverPos({ x: e.clientX, y: e.clientY });\r\n                            }}\r\n                          />\r\n                        ))\r\n                      ) : (\r\n                        <div className=\"text-xs text-gray-500 p-2\">No palette selected</div>\r\n                      )}\r\n                    </div>\r\n\r\n                    {/* Hover Tooltip */}\r\n                    {hoveredColor && hoverPos && (\r\n                      <div\r\n                        style={{\r\n                          position: 'fixed',\r\n                          left: hoverPos.x + 15,\r\n                          top: hoverPos.y + 15,\r\n                          zIndex: 9999,\r\n                          pointerEvents: 'none'\r\n                        }}\r\n                        className=\"bg-gray-900 border border-gray-600 rounded p-2 shadow-xl text-xs min-w-[120px]\"\r\n                      >\r\n                        <div className=\"flex items-center gap-2 mb-1 pb-1 border-b border-gray-700\">\r\n                          <div\r\n                            className=\"w-3 h-3 border border-gray-500\"\r\n                            style={{ backgroundColor: hoveredColor }}\r\n                          />\r\n                          <span className=\"font-mono font-bold text-white\">{hoveredColor}</span>\r\n                        </div>\r\n                        {colorStats.has(hoveredColor) ? (\r\n                          <div className=\"text-gray-300 space-y-0.5\">\r\n                            <div className=\"flex justify-between gap-4\">\r\n                              <span>Count:</span>\r\n                              <span className=\"text-white font-mono\">{colorStats.get(hoveredColor)?.count.toLocaleString()}</span>\r\n                            </div>\r\n                            <div className=\"flex justify-between gap-4\">\r\n                              <span>Usage:</span>\r\n                              <span className=\"text-white font-mono\">{colorStats.get(hoveredColor)?.percent.toFixed(2)}%</span>\r\n                            </div>\r\n                          </div>\r\n                        ) : (\r\n                          <div className=\"text-gray-500 italic\">Not used in preview</div>\r\n                        )}\r\n                      </div>\r\n                    )}\r\n\r\n                    {(paletteMode === 'custom' || paletteMode === 'geopixels+custom') && (\r\n                      <div className=\"space-y-2 border-t border-gray-700 pt-2\">\r\n                        <label className=\"flex items-center space-x-2 cursor-pointer\">\r\n                          <input \r\n                            type=\"checkbox\" \r\n                            checked={filterTrivialColors}\r\n                            onChange={(e) => setFilterTrivialColors(e.target.checked)}\r\n                            className=\"rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500 focus:ring-offset-gray-800\"\r\n                            title=\"Ignore colors below 0.1% usage during processing\"\r\n                          />\r\n                          <span className=\"text-xs text-gray-400\">Filter trivial colors (&lt;0.1%)</span>\r\n                        </label>\r\n                        <div className=\"flex items-center justify-between gap-2\">\r\n                          <label className=\"text-xs font-semibold text-gray-400 uppercase whitespace-nowrap\">Suggest Colors</label>\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <input\r\n                              type=\"number\"\r\n                              min=\"1\"\r\n                              max=\"32\"\r\n                              value={suggestCount}\r\n                              onChange={(e) => setSuggestCount(Math.max(1, Math.min(32, Number(e.target.value))))}\r\n                              className=\"w-12 bg-gray-800 border border-gray-600 rounded px-1 py-0.5 text-xs text-center\"\r\n                              title=\"Number of colors to suggest\"\r\n                            />\r\n                            <button\r\n                              onClick={handleSuggestColors}\r\n                              disabled={isSuggesting}\r\n                              className=\"px-3 py-1 bg-blue-600 hover:bg-blue-500 disabled:bg-gray-600 disabled:cursor-not-allowed text-white text-xs rounded transition-colors\"\r\n                            >\r\n                              {isSuggesting ? '...' : 'Go'}\r\n                            </button>\r\n                          </div>\r\n                        </div>\r\n                        <label className=\"flex items-center space-x-2 cursor-pointer\">\r\n                          <input\r\n                            type=\"checkbox\"\r\n                            checked={preferDistinctColors}\r\n                            onChange={(e) => setPreferDistinctColors(e.target.checked)}\r\n                            className=\"rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500 focus:ring-offset-gray-800\"\r\n                            title=\"Prioritize colors that are distinct from each other\"\r\n                          />\r\n                          <span className=\"text-xs text-gray-400\">Prefer distinct color suggestions</span>\r\n                        </label>\r\n\r\n                        {suggestedColors.length > 0 && (\r\n                          <div className=\"space-y-2\">\r\n                            <div className=\"flex flex-wrap gap-1 bg-gray-900 p-2 rounded border border-gray-700\">\r\n                              {suggestedColors.map((color, idx) => (\r\n                                <div\r\n                                  key={idx}\r\n                                  className=\"w-8 h-8 rounded border border-gray-500 cursor-pointer hover:border-white\"\r\n                                  style={{ backgroundColor: color }}\r\n                                  title={`${color} - Click to copy`}\r\n                                  onClick={() => {\r\n                                    navigator.clipboard.writeText(color);\r\n                                  }}\r\n                                />\r\n                              ))}\r\n                            </div>\r\n                            <button\r\n                              onClick={handleAddSuggestedToCustom}\r\n                              className=\"w-full px-2 py-1 bg-gray-700 hover:bg-gray-600 text-white text-xs rounded transition-colors\"\r\n                            >\r\n                              Add to Custom Palette\r\n                            </button>\r\n                          </div>\r\n                        )}\r\n\r\n                        <p className=\"text-xs text-gray-500\">Analyzes the image to find dominant colors missing from your palette.</p>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Dithering */}\r\n            <div className=\"space-y-2\">\r\n              <label className=\"text-xs font-semibold text-gray-400 uppercase\">Dithering</label>\r\n              <select\r\n                value={ditherMethod}\r\n                onChange={(e) => { debounceTimeRef.current = 100; setDitherMethod(e.target.value); }}\r\n                className=\"w-full bg-gray-800 border border-gray-600 rounded px-2 py-1 text-sm\"\r\n              >\r\n                {DITHER_ALGORITHMS.map(algo => (\r\n                  <option key={algo.value} value={algo.value}>{algo.label}</option>\r\n                ))}\r\n              </select>\r\n\r\n              {ditherMethod !== 'none' && (\r\n                <div>\r\n                  <div className=\"flex justify-between text-xs text-gray-500\">\r\n                    <span>Strength</span>\r\n                    <span>{ditherStrength}%</span>\r\n                  </div>\r\n                  <input\r\n                    type=\"range\"\r\n                    min=\"0\"\r\n                    max=\"100\"\r\n                    value={ditherStrength}\r\n                    onChange={(e) => setDitherStrength(Number(e.target.value))}\r\n                    className=\"w-full\"\r\n                  />\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* K-Means Clustering */}\r\n            <div className=\"space-y-2\">\r\n              <div className=\"group relative inline-block w-full\">\r\n                <label className={`flex items-center space-x-2 ${paletteMode !== 'none' ? 'cursor-not-allowed opacity-50' : 'cursor-pointer'}`}>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={useKmeans}\r\n                    onChange={(e) => setUseKmeans(e.target.checked)}\r\n                    disabled={paletteMode !== 'none'}\r\n                  />\r\n                  <span className=\"text-xs font-semibold text-gray-400 uppercase\">K-Means Color Reduction</span>\r\n                </label>\r\n                {paletteMode !== 'none' && (\r\n                  <div className=\"absolute bottom-full left-0 mb-2 w-64 p-2 bg-gray-900 border border-gray-600 rounded shadow-xl text-xs text-gray-300 hidden group-hover:block z-50\">\r\n                    K-Means is only available when \"No Recoloring\" is selected. It's used to reduce the color space when you're not providing a specific palette.\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {useKmeans && (\r\n                <div>\r\n                  <label className=\"text-xs text-gray-500\">Number of Colors</label>\r\n                  <input\r\n                    type=\"number\"\r\n                    min=\"2\"\r\n                    max=\"256\"\r\n                    value={kmeansColors}\r\n                    onChange={(e) => setKmeansColors(Number(e.target.value))}\r\n                    className=\"w-full bg-gray-800 border border-gray-600 rounded px-2 py-1 text-sm\"\r\n                  />\r\n                  <p className=\"text-xs text-gray-500 mt-1\">Reduces image to N dominant colors before applying palette/dithering.</p>\r\n\r\n                  {generatedPalette.length > 0 && (\r\n                    <button\r\n                      onClick={handleSendKmeansToCustom}\r\n                      className=\"w-full mt-2 px-3 py-1.5 bg-teal-700 hover:bg-teal-600 text-white text-xs font-medium rounded transition-colors\"\r\n                      title=\"Send K-Means palette to Geopixels Base + Custom\"\r\n                    >\r\n                      Send Colors to Geopixels Custom Palette\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Extra Features */}\r\n            <div className=\"space-y-2 border-t border-gray-700 pt-2\">\r\n              <button\r\n                onClick={() => setIsExtraFeaturesOpen(!isExtraFeaturesOpen)}\r\n                className=\"flex items-center justify-between w-full text-xs font-semibold text-gray-400 hover:text-gray-300 uppercase\"\r\n              >\r\n                <span>Extra Features</span>\r\n                <span>{isExtraFeaturesOpen ? '' : ''}</span>\r\n              </button>\r\n\r\n              {isExtraFeaturesOpen && (\r\n                <div className=\"space-y-3 pt-2\">\r\n                  <div className=\"border-b border-gray-700 pb-3\">\r\n                    <label className=\"text-xs font-semibold text-gray-400 uppercase mb-2 block\">Pre-processing (Experimental)</label>\r\n                    <select\r\n                      value={preprocessingMethod}\r\n                      onChange={(e) => { debounceTimeRef.current = 100; setPreprocessingMethod(e.target.value as any); }}\r\n                      className=\"w-full bg-gray-800 border border-gray-600 rounded px-2 py-1 text-sm mb-2\"\r\n                      title=\"Apply filters before pixelation to improve results (may impact performance)\"\r\n                    >\r\n                      <option value=\"none\">None</option>\r\n                      <option value=\"kuwahara\">Kuwahara (Oil Paint / Flatten)</option>\r\n                      <option value=\"median\">Median (De-noise / Smooth)</option>\r\n                      <option value=\"bilateral\">Bilateral (Soft Blur)</option>\r\n                    </select>\r\n\r\n                    {preprocessingMethod !== 'none' && (\r\n                      <div>\r\n                        <div className=\"flex justify-between text-xs text-gray-500 mb-2\">\r\n                          <span>Intensity</span>\r\n                          <span>{preprocessingStrength}%</span>\r\n                        </div>\r\n                        <input\r\n                          type=\"range\"\r\n                          min=\"0\"\r\n                          max=\"100\"\r\n                          value={preprocessingStrength}\r\n                          onChange={(e) => { debounceTimeRef.current = 100; setPreprocessingStrength(Number(e.target.value)); }}\r\n                          className=\"w-full\"\r\n                        />\r\n                        <p className=\"text-xs text-gray-500 mt-2\">\r\n                          {preprocessingMethod === 'bilateral' && 'Smooths surfaces while keeping edges. Good for photographs.'}\r\n                          {preprocessingMethod === 'kuwahara' && 'Best for Pixel Art. Creates flat, \"painted\" clusters of color.'}\r\n                          {preprocessingMethod === 'median' && 'Removes noise and small details. Great for cleaning up JPEGs before pixelating.'}\r\n                        </p>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  <div>\r\n                    <div className=\"flex justify-between text-xs text-gray-500\">\r\n                      <span>Brightness</span>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <span>{brightness}</span>\r\n                        <button\r\n                          onClick={() => setBrightness(0)}\r\n                          className=\"text-gray-500 hover:text-white disabled:opacity-0 transition-opacity\"\r\n                          title=\"Reset Brightness\"\r\n                          disabled={brightness === 0}\r\n                        >\r\n                          \r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                    <input\r\n                      type=\"range\"\r\n                      min=\"-100\"\r\n                      max=\"100\"\r\n                      value={brightness}\r\n                      onChange={(e) => setBrightness(Number(e.target.value))}\r\n                      className=\"w-full\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <div className=\"flex justify-between text-xs text-gray-500\">\r\n                      <span>Contrast</span>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <span>{contrast}</span>\r\n                        <button\r\n                          onClick={() => setContrast(0)}\r\n                          className=\"text-gray-500 hover:text-white disabled:opacity-0 transition-opacity\"\r\n                          title=\"Reset Contrast\"\r\n                          disabled={contrast === 0}\r\n                        >\r\n                          \r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                    <input\r\n                      type=\"range\"\r\n                      min=\"-100\"\r\n                      max=\"100\"\r\n                      value={contrast}\r\n                      onChange={(e) => setContrast(Number(e.target.value))}\r\n                      className=\"w-full\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <div className=\"flex justify-between text-xs text-gray-500\">\r\n                      <span>Saturation</span>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <span>{saturation}</span>\r\n                        <button\r\n                          onClick={() => setSaturation(0)}\r\n                          className=\"text-gray-500 hover:text-white disabled:opacity-0 transition-opacity\"\r\n                          title=\"Reset Saturation\"\r\n                          disabled={saturation === 0}\r\n                        >\r\n                          \r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                    <input\r\n                      type=\"range\"\r\n                      min=\"-100\"\r\n                      max=\"100\"\r\n                      value={saturation}\r\n                      onChange={(e) => setSaturation(Number(e.target.value))}\r\n                      className=\"w-full\"\r\n                    />\r\n                  </div>\r\n                  <div className=\"border-t border-gray-700 pt-3\">\r\n                    <div className=\"flex justify-between text-xs text-gray-500\">\r\n                      <span>Preserve Detail</span>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <span>E{preserveDetailThreshold.toFixed(1)}</span>\r\n                        <button\r\n                          onClick={() => setPreserveDetailThreshold(0)}\r\n                          className=\"text-gray-500 hover:text-white disabled:opacity-0 transition-opacity\"\r\n                          title=\"Reset Preserve Detail\"\r\n                          disabled={preserveDetailThreshold === 0}\r\n                        >\r\n                          \r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                    <input\r\n                      type=\"range\"\r\n                      min=\"0\"\r\n                      max=\"5\"\r\n                      step=\"0.1\"\r\n                      value={preserveDetailThreshold}\r\n                      onChange={(e) => { debounceTimeRef.current = 100; setPreserveDetailThreshold(Number(e.target.value)); }}\r\n                      className=\"w-full\"\r\n                    />\r\n                    <p className=\"text-xs text-gray-500 mt-1\">\r\n                      Pixels within this E threshold keep their original color instead of snapping to palette. Higher = more detail preserved.\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Execute button - sticky footer */}\r\n          {!autoUpdate && (\r\n            <div className=\"p-4 border-t border-gray-700 bg-gray-800/30 flex-shrink-0\">\r\n              <button\r\n                onClick={processImage}\r\n                className=\"w-full bg-green-600 hover:bg-green-500 text-white py-2 rounded font-semibold transition-colors flex items-center justify-center gap-2\"\r\n              >\r\n                <span></span>\r\n                <span>Execute</span>\r\n              </button>\r\n            </div>\r\n          )}\r\n\r\n        </div>\r\n\r\n        {/* Right: Preview */}\r\n        <div className=\"flex-1 bg-gray-900 relative overflow-hidden flex flex-col\">\r\n          {/* Zoom Controls */}\r\n          <div className=\"flex items-center justify-between px-4 py-3 bg-gray-800/50 border-b border-gray-700 flex-shrink-0\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <span className=\"text-xs text-gray-400\">Preview</span>\r\n              <label className=\"flex items-center gap-1 cursor-pointer\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={autoUpdate}\r\n                  onChange={(e) => setAutoUpdate(e.target.checked)}\r\n                  className=\"rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500 focus:ring-offset-gray-800\"\r\n                />\r\n                <span className=\"text-xs text-gray-400 select-none\">Auto-update</span>\r\n              </label>\r\n              <label className=\"flex items-center gap-1 cursor-pointer\" title=\"Always fit preview to screen\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={pinFitToScreen}\r\n                  onChange={(e) => setPinFitToScreen(e.target.checked)}\r\n                  className=\"rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500 focus:ring-offset-gray-800\"\r\n                />\r\n                <span className=\"text-xs text-gray-400 select-none\">Pin Fit</span>\r\n              </label>\r\n            </div>\r\n            <div className=\"flex space-x-2 items-center\">\r\n              <button onClick={handleZoomOut} className=\"bg-gray-700 p-1 rounded hover:bg-gray-600 text-sm font-bold\" title=\"Zoom out\"></button>\r\n              <span className=\"bg-gray-700 px-2 py-1 rounded text-sm font-mono min-w-[50px] text-center\">{Math.round(zoom * 100)}%</span>\r\n              <button onClick={handleZoomIn} className=\"bg-gray-700 p-1 rounded hover:bg-gray-600 text-sm font-bold\" title=\"Zoom in\">+</button>\r\n              <button onClick={handleFitToScreen} className=\"bg-gray-700 px-2 py-1 rounded hover:bg-gray-600 text-xs\" title=\"Fit to screen\">Fit</button>\r\n              <button onClick={handleZoomReset} className=\"bg-gray-700 px-2 py-1 rounded hover:bg-gray-600 text-xs\" title=\"Reset zoom\">Reset</button>\r\n            </div>\r\n          </div>\r\n\r\n          {isProcessing && (\r\n            <div className=\"absolute top-14 right-4 z-20 pointer-events-none\">\r\n              <div className=\"bg-gray-900/90 border border-gray-700 text-gray-200 text-xs px-3 py-1.5 rounded shadow-lg flex items-center gap-2\">\r\n                <div className=\"w-2 h-2 bg-blue-500 rounded-full animate-pulse\"></div>\r\n                Generating...\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <div\r\n            ref={previewContainerRef}\r\n            className=\"flex-1 overflow-auto bg-gray-900\"\r\n          >\r\n            {previewImage ? (\r\n              <div\r\n                style={{\r\n                  display: 'inline-block',\r\n                  padding: '20px',\r\n                }}\r\n              >\r\n                <img\r\n                  ref={imgRef}\r\n                  src={previewImage}\r\n                  alt=\"Preview\"\r\n                  onLoad={handleImageLoad}\r\n                  style={{\r\n                    width: imageDimensions ? `${imageDimensions.width * zoom}px` : 'auto',\r\n                    height: imageDimensions ? `${imageDimensions.height * zoom}px` : 'auto',\r\n                    maxWidth: 'none',\r\n                    imageRendering: 'pixelated',\r\n                  }}\r\n                />\r\n              </div>\r\n            ) : (\r\n              <div className=\"absolute inset-0 flex items-center justify-center text-gray-500\">\r\n                Click Execute to generate preview\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Apply Button - Bottom Right */}\r\n          <div className=\"px-4 py-3 bg-gray-800/50 border-t border-gray-700 flex-shrink-0\">\r\n            <button\r\n              onClick={handleApply}\r\n              disabled={!previewImage}\r\n              className=\"w-full bg-blue-600 hover:bg-blue-500 disabled:bg-gray-600 disabled:cursor-not-allowed text-white py-2 rounded font-semibold transition-colors\"\r\n            >\r\n              Apply Pixelation\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Eyedropper Modal */}\r\n        <EyedropperModal\r\n          isOpen={isEyedropperOpen}\r\n          onClose={() => setIsEyedropperOpen(false)}\r\n          imageDataUrl={layer.imageData}\r\n          onAddColors={handleEyedropperColors}\r\n        />\r\n\r\n        {/* GeoPixels Palette Modal */}\r\n        <GeoPixelsPaletteModal\r\n          isOpen={isGeoPixelsPaletteOpen}\r\n          onClose={() => setIsGeoPixelsPaletteOpen(false)}\r\n          onAddColors={handleGeoPixelsColors}\r\n        />\r\n      </div>\r\n    )} />\r\n  );\r\n};\r\n\r\nexport default PixelatorModal;\r\n","import React, { useState, useRef, useEffect } from 'react';\r\nimport DraggableModal from './DraggableModal';\r\nimport useCompositorStore from '../../store/compositorStore';\r\nimport { Layer } from '../../types/compositor.types';\r\n\r\ninterface CropModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  layer: Layer;\r\n}\r\n\r\nconst MIN_SIZE = 5;\r\n\r\nconst CropModal: React.FC<CropModalProps> = ({ isOpen, onClose, layer }) => {\r\n  const updateLayer = useCompositorStore((s) => s.updateLayer);\r\n\r\n  const [previewImage, setPreviewImage] = useState<string | null>(null);\r\n  const [imageDimensions, setImageDimensions] = useState<{ width: number; height: number } | null>(null);\r\n  const [zoom, setZoom] = useState<number>(1);\r\n  const [cropRect, setCropRect] = useState<{ x: number; y: number; width: number; height: number } | null>(null);\r\n  const [hasInitialFit, setHasInitialFit] = useState<boolean>(false);\r\n\r\n  const imgContainerRef = useRef<HTMLDivElement | null>(null);\r\n  const imgRef = useRef<HTMLImageElement | null>(null);\r\n  const previewBoxRef = useRef<HTMLDivElement | null>(null);\r\n  const stateRef = useRef<{ cropRect: any; zoom: number; imageDimensions: any; isDragging: boolean }>({\r\n    cropRect: null,\r\n    zoom: 1,\r\n    imageDimensions: null,\r\n    isDragging: false,\r\n  });\r\n\r\n  useEffect(() => {\r\n    stateRef.current.cropRect = cropRect;\r\n    stateRef.current.zoom = zoom;\r\n    stateRef.current.imageDimensions = imageDimensions;\r\n  }, [cropRect, zoom, imageDimensions]);\r\n\r\n  useEffect(() => {\r\n    if (!isOpen || !layer.imageData) return;\r\n    setPreviewImage(layer.imageData);\r\n    setZoom(1);\r\n    setCropRect(null);\r\n    setHasInitialFit(false);\r\n  }, [isOpen, layer.imageData]);\r\n\r\n  const handleImageLoad = (e: React.SyntheticEvent<HTMLImageElement>) => {\r\n    const img = e.currentTarget;\r\n    const dims = { width: img.naturalWidth, height: img.naturalHeight };\r\n    setImageDimensions(dims);\r\n    setCropRect({ x: 0, y: 0, width: dims.width, height: dims.height });\r\n  };\r\n\r\n  const calculateFitZoom = (width: number, height: number) => {\r\n    if (!previewBoxRef.current) return 1;\r\n    \r\n    const containerWidth = previewBoxRef.current.clientWidth;\r\n    const containerHeight = previewBoxRef.current.clientHeight;\r\n    \r\n    if (containerWidth <= 0 || containerHeight <= 0) return 1;\r\n\r\n    const scaleX = containerWidth / width;\r\n    const scaleY = containerHeight / height;\r\n    \r\n    const newZoom = Math.min(scaleX, scaleY);\r\n    // Scale down slightly to ensure there's a bit of breathing room\r\n    return Math.max(0.1, newZoom * 0.9);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (imageDimensions && previewBoxRef.current && !hasInitialFit) {\r\n      setTimeout(() => {\r\n        const fitZoom = calculateFitZoom(imageDimensions.width, imageDimensions.height);\r\n        setZoom(fitZoom);\r\n        setHasInitialFit(true);\r\n      }, 100);\r\n    }\r\n  }, [imageDimensions, hasInitialFit]);\r\n\r\n  const handleMouseDown = (e: React.MouseEvent, dragType: 'move' | 'nw' | 'n' | 'ne' | 'e' | 'se' | 's' | 'sw' | 'w') => {\r\n    e.preventDefault();\r\n    if (!imgRef.current || !stateRef.current.cropRect || !stateRef.current.imageDimensions) return;\r\n\r\n    stateRef.current.isDragging = true;\r\n    const startX = e.clientX;\r\n    const startY = e.clientY;\r\n    const startRect = { ...stateRef.current.cropRect };\r\n    const currentZoom = stateRef.current.zoom;\r\n    const imageDims = stateRef.current.imageDimensions;\r\n\r\n    const handleMouseMove = (moveEvent: MouseEvent) => {\r\n      if (!stateRef.current.isDragging) return;\r\n\r\n      const deltaX = (moveEvent.clientX - startX) / currentZoom;\r\n      const deltaY = (moveEvent.clientY - startY) / currentZoom;\r\n\r\n      let newRect = { ...startRect };\r\n\r\n      if (dragType === 'move') {\r\n        newRect.x = startRect.x + deltaX;\r\n        newRect.y = startRect.y + deltaY;\r\n      } else {\r\n        // Handle corner/edge resizing\r\n        if (dragType.includes('n')) {\r\n          newRect.y = startRect.y + deltaY;\r\n          newRect.height = startRect.height - deltaY;\r\n        }\r\n        if (dragType.includes('s')) {\r\n          newRect.height = startRect.height + deltaY;\r\n        }\r\n        if (dragType.includes('w')) {\r\n          newRect.x = startRect.x + deltaX;\r\n          newRect.width = startRect.width - deltaX;\r\n        }\r\n        if (dragType.includes('e')) {\r\n          newRect.width = startRect.width + deltaX;\r\n        }\r\n      }\r\n\r\n      // Clamp and validate\r\n      newRect.x = Math.max(0, Math.min(newRect.x, imageDims.width - MIN_SIZE));\r\n      newRect.y = Math.max(0, Math.min(newRect.y, imageDims.height - MIN_SIZE));\r\n      newRect.width = Math.max(MIN_SIZE, Math.min(newRect.width, imageDims.width - newRect.x));\r\n      newRect.height = Math.max(MIN_SIZE, Math.min(newRect.height, imageDims.height - newRect.y));\r\n\r\n      setCropRect(newRect);\r\n      stateRef.current.cropRect = newRect;\r\n    };\r\n\r\n    const handleMouseUp = () => {\r\n      stateRef.current.isDragging = false;\r\n      document.removeEventListener('mousemove', handleMouseMove);\r\n      document.removeEventListener('mouseup', handleMouseUp);\r\n    };\r\n\r\n    document.addEventListener('mousemove', handleMouseMove);\r\n    document.addEventListener('mouseup', handleMouseUp);\r\n  };\r\n\r\n  const handleZoomIn = () => setZoom((z) => Math.min(5, z + 0.25));\r\n  const handleZoomOut = () => setZoom((z) => Math.max(0.1, z - 0.25));\r\n  const handleResetZoom = () => {\r\n    if (imageDimensions) {\r\n      setZoom(calculateFitZoom(imageDimensions.width, imageDimensions.height));\r\n    } else {\r\n      setZoom(1);\r\n    }\r\n  };\r\n\r\n  const findTransparentBounds = async () => {\r\n    if (!previewImage || !imageDimensions) return;\r\n\r\n    const img = new Image();\r\n    img.src = previewImage;\r\n    await new Promise((res) => {\r\n      img.onload = res;\r\n      img.onerror = res;\r\n    });\r\n\r\n    const canvas = document.createElement('canvas');\r\n    canvas.width = imageDimensions.width;\r\n    canvas.height = imageDimensions.height;\r\n    const ctx = canvas.getContext('2d');\r\n    if (!ctx) return;\r\n\r\n    ctx.drawImage(img, 0, 0);\r\n    const imageData = ctx.getImageData(0, 0, imageDimensions.width, imageDimensions.height);\r\n    const data = imageData.data;\r\n\r\n    let minX = imageDimensions.width;\r\n    let minY = imageDimensions.height;\r\n    let maxX = -1;\r\n    let maxY = -1;\r\n\r\n    // Find bounds of non-transparent pixels\r\n    for (let i = 0; i < data.length; i += 4) {\r\n      const alpha = data[i + 3];\r\n      if (alpha > 0) {\r\n        const pixelIndex = i / 4;\r\n        const x = pixelIndex % imageDimensions.width;\r\n        const y = Math.floor(pixelIndex / imageDimensions.width);\r\n\r\n        minX = Math.min(minX, x);\r\n        minY = Math.min(minY, y);\r\n        maxX = Math.max(maxX, x);\r\n        maxY = Math.max(maxY, y);\r\n      }\r\n    }\r\n\r\n    // If no non-transparent pixels found, keep current crop\r\n    if (maxX < minX || maxY < minY) {\r\n      return;\r\n    }\r\n\r\n    const newRect = {\r\n      x: minX,\r\n      y: minY,\r\n      width: maxX - minX + 1,\r\n      height: maxY - minY + 1,\r\n    };\r\n\r\n    setCropRect(newRect);\r\n    stateRef.current.cropRect = newRect;\r\n  };\r\n\r\n  const applyCrop = async () => {\r\n    if (!cropRect || !imageDimensions || !previewImage) return;\r\n    const img = new Image();\r\n    img.src = previewImage;\r\n    await new Promise((res) => { img.onload = res; img.onerror = res; });\r\n\r\n    const canvas = document.createElement('canvas');\r\n    canvas.width = Math.round(cropRect.width);\r\n    canvas.height = Math.round(cropRect.height);\r\n    const ctx = canvas.getContext('2d');\r\n    if (!ctx) return;\r\n    ctx.imageSmoothingQuality = 'high';\r\n    ctx.drawImage(\r\n      img,\r\n      Math.round(cropRect.x),\r\n      Math.round(cropRect.y),\r\n      Math.round(cropRect.width),\r\n      Math.round(cropRect.height),\r\n      0,\r\n      0,\r\n      Math.round(cropRect.width),\r\n      Math.round(cropRect.height)\r\n    );\r\n    const dataUrl = canvas.toDataURL();\r\n    updateLayer(layer.id, { imageData: dataUrl, width: Math.round(cropRect.width), height: Math.round(cropRect.height) });\r\n    onClose();\r\n  };\r\n\r\n  // render\r\n  return (\r\n    <DraggableModal isOpen={isOpen} title=\"Crop\" onClose={onClose} modalId=\"modal-crop\">\r\n      <div className=\"flex flex-col h-full p-4 gap-4 text-gray-200\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <label className=\"text-sm font-medium\">Preview</label>\r\n          <div className=\"flex items-center gap-2\">\r\n            <button\r\n              id=\"btn-crop-zoom-out\"\r\n              onClick={handleZoomOut}\r\n              disabled={zoom <= 0.1}\r\n              className=\"p-1 text-gray-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed transition-colors\"\r\n              title=\"Zoom out\"\r\n              aria-label=\"Zoom out\"\r\n            >\r\n              \r\n            </button>\r\n            <span className=\"text-xs text-gray-400 min-w-[45px] text-center\">{Math.round(zoom * 100)}%</span>\r\n            <button\r\n              id=\"btn-crop-zoom-in\"\r\n              onClick={handleZoomIn}\r\n              disabled={zoom >= 5}\r\n              className=\"p-1 text-gray-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed transition-colors\"\r\n              title=\"Zoom in\"\r\n              aria-label=\"Zoom in\"\r\n            >\r\n              +\r\n            </button>\r\n            <button\r\n              id=\"btn-crop-zoom-reset\"\r\n              onClick={handleResetZoom}\r\n              className=\"text-xs px-2 py-1 text-gray-400 hover:text-white bg-gray-700 hover:bg-gray-600 rounded transition-colors\"\r\n              title=\"Reset zoom\"\r\n              aria-label=\"Reset zoom\"\r\n            >\r\n              Reset\r\n            </button>\r\n            <button\r\n              id=\"btn-crop-auto\"\r\n              onClick={findTransparentBounds}\r\n              className=\"text-xs px-2 py-1 text-cyan-200 bg-cyan-900 hover:bg-cyan-800 rounded transition-colors\"\r\n              title=\"Auto-crop to remove transparent edges\"\r\n              aria-label=\"Auto-crop transparent edges\"\r\n            >\r\n              Auto\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex gap-4 text-xs text-gray-400\">\r\n          <div>\r\n            <span className=\"text-gray-500\">Original:</span> {imageDimensions ? `${imageDimensions.width}${imageDimensions.height}` : ''}\r\n          </div>\r\n          <div>\r\n            <span className=\"text-gray-500\">Crop:</span> {cropRect ? `${Math.round(cropRect.width)}${Math.round(cropRect.height)}` : ''}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex-1 relative w-full bg-gray-900 rounded border border-gray-700 overflow-auto\" ref={previewBoxRef}>\r\n          {previewImage ? (\r\n            <div ref={imgContainerRef} style={{ display: 'inline-block', padding: 10, position: 'relative' }}>\r\n              <img\r\n                ref={imgRef}\r\n                src={previewImage}\r\n                alt=\"Preview\"\r\n                onLoad={handleImageLoad}\r\n                style={{\r\n                  width: imageDimensions ? `${imageDimensions.width * zoom}px` : 'auto',\r\n                  height: imageDimensions ? `${imageDimensions.height * zoom}px` : 'auto',\r\n                  display: 'block',\r\n                  maxWidth: 'none',\r\n                  userSelect: 'none',\r\n                }}\r\n              />\r\n\r\n              {imageDimensions && cropRect && (\r\n                <div\r\n                  style={{\r\n                    position: 'absolute',\r\n                    left: 10 + cropRect.x * zoom,\r\n                    top: 10 + cropRect.y * zoom,\r\n                    width: Math.max(0, cropRect.width * zoom),\r\n                    height: Math.max(0, cropRect.height * zoom),\r\n                    boxSizing: 'border-box',\r\n                    border: '2px dashed rgba(100,200,255,0.8)',\r\n                    pointerEvents: 'none',\r\n                  }}\r\n                >\r\n                  {/* Center move area */}\r\n                  <div\r\n                    onMouseDown={(e) => handleMouseDown(e, 'move')}\r\n                    style={{\r\n                      position: 'absolute',\r\n                      inset: 0,\r\n                      cursor: 'move',\r\n                      pointerEvents: 'auto',\r\n                      background: 'rgba(100,200,255,0.05)',\r\n                    }}\r\n                  />\r\n\r\n                  {/* Handles */}\r\n                  {[\r\n                    { type: 'nw', left: -6, top: -6, cursorStyle: 'nw-resize' },\r\n                    { type: 'n', left: '50%', top: -6, transform: 'translateX(-50%)', cursorStyle: 'n-resize' },\r\n                    { type: 'ne', right: -6, top: -6, cursorStyle: 'ne-resize' },\r\n                    { type: 'e', right: -6, top: '50%', transform: 'translateY(-50%)', cursorStyle: 'e-resize' },\r\n                    { type: 'se', right: -6, bottom: -6, cursorStyle: 'se-resize' },\r\n                    { type: 's', left: '50%', bottom: -6, transform: 'translateX(-50%)', cursorStyle: 's-resize' },\r\n                    { type: 'sw', left: -6, bottom: -6, cursorStyle: 'sw-resize' },\r\n                    { type: 'w', left: -6, top: '50%', transform: 'translateY(-50%)', cursorStyle: 'w-resize' },\r\n                  ].map(({ type, cursorStyle, ...pos }) => (\r\n                    <div\r\n                      key={type}\r\n                      onMouseDown={(e) => handleMouseDown(e, type as any)}\r\n                      style={{\r\n                        position: 'absolute',\r\n                        width: 12,\r\n                        height: 12,\r\n                        background: '#fff',\r\n                        border: '1px solid #000',\r\n                        borderRadius: 2,\r\n                        cursor: cursorStyle,\r\n                        pointerEvents: 'auto',\r\n                        boxSizing: 'border-box',\r\n                        ...(pos as any),\r\n                      }}\r\n                    />\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n          ) : (\r\n            <div className=\"absolute inset-0 flex items-center justify-center\">\r\n              <div className=\"text-gray-500\">No preview available</div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"flex items-center justify-end gap-2 pt-4 border-t border-gray-700\">\r\n          <button\r\n            id=\"btn-crop-cancel\"\r\n            onClick={onClose}\r\n            className=\"px-4 py-2 text-sm font-medium text-gray-300 bg-gray-700 rounded hover:bg-gray-600 transition-colors\"\r\n            aria-label=\"Cancel crop\"\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            id=\"btn-crop-apply\"\r\n            onClick={applyCrop}\r\n            disabled={!cropRect}\r\n            className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n            aria-label=\"Apply crop\"\r\n          >\r\n            Apply\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </DraggableModal>\r\n  );\r\n};\r\n\r\nexport default CropModal;\r\n","import useCompositorStore from '../../store/compositorStore';\r\nimport PositionInputs from './PositionInputs';\r\nimport OpacityControl from './OpacityControl';\r\nimport ColorAnalysis from './ColorAnalysis';\r\nimport ShapeProperties from './ShapeProperties';\r\nimport TransparencyMaskModal from '../Modals/TransparencyMaskModal';\r\nimport BgRemovalModal from '../Modals/BgRemovalModal';\r\nimport PixelatorModal from '../Modals/PixelatorModal';\r\nimport CropModal from '../Modals/CropModal';\r\nimport { useState } from 'react';\r\n\r\n/**\r\n * Property panel component\r\n * Displays properties for selected layers and canvas settings\r\n */\r\nfunction PropertyPanel() {\r\n  const project = useCompositorStore((state) => state.project);\r\n  const selectedLayerIds = useCompositorStore((state) => state.selectedLayerIds);\r\n  const selectedLayers = project.layers.filter((layer) =>\r\n    selectedLayerIds.includes(layer.id)\r\n  );\r\n\r\n  const [isTransparencyModalOpen, setIsTransparencyModalOpen] = useState(false);\r\n  const [isPixelatorModalOpen, setIsPixelatorModalOpen] = useState(false);\r\n  const [isCropModalOpen, setIsCropModalOpen] = useState(false);\r\n  const [isBgRemovalModalOpen, setIsBgRemovalModalOpen] = useState(false);\r\n\r\n  return (\r\n    <div className=\"h-full flex flex-col bg-canvas-bg overflow-hidden\" data-region=\"property-panel\">\r\n      <div className=\"px-3 py-3 border-b border-border\">\r\n        <h2 className=\"text-sm font-semibold text-gray-300\">Properties</h2>\r\n      </div>\r\n\r\n      {/* Content */}\r\n      <div className=\"flex-1 overflow-y-auto\">\r\n        {selectedLayerIds.length === 0 ? (\r\n          <div className=\"p-4 text-center text-sm text-gray-500\">\r\n            <div className=\"mb-2\">No layer selected</div>\r\n            <div className=\"text-xs\">Select a layer to edit properties</div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"p-3 space-y-4\">\r\n            {/* Selected Layers Info */}\r\n            <div className=\"bg-panel-bg rounded p-2 text-xs text-gray-400\">\r\n              <div className=\"font-semibold text-gray-300 mb-1\">Selected</div>\r\n              {selectedLayers.map((layer) => (\r\n                <div key={layer.id} className=\"truncate\">\r\n                  {layer.name}\r\n                </div>\r\n              ))}\r\n            </div>\r\n\r\n            {/* Position Controls (if single layer selected) */}\r\n            {selectedLayerIds.length === 1 && selectedLayers.length > 0 && <PositionInputs layer={selectedLayers[0]} />}\r\n\r\n            {/* Opacity Controls (if single layer selected) */}\r\n            {selectedLayerIds.length === 1 && selectedLayers.length > 0 && <OpacityControl layer={selectedLayers[0]} />}\r\n\r\n            {/* Color Analysis (if single layer selected) */}\r\n            {selectedLayerIds.length === 1 && selectedLayers.length > 0 && <ColorAnalysis layer={selectedLayers[0]} />}\r\n\r\n            {/* Shape Properties (if single shape layer selected) */}\r\n            {selectedLayerIds.length === 1 && selectedLayers.length > 0 && selectedLayers[0].shapeType && (\r\n              <ShapeProperties layer={selectedLayers[0]} />\r\n            )}\r\n\r\n            {/* Layer Modification Menu */}\r\n            {selectedLayerIds.length === 1 && selectedLayers.length > 0 && (\r\n              <div data-region=\"actions-menu\">\r\n                <div className=\"text-xs font-semibold text-gray-300 mb-2\">Modify</div>\r\n                <div className=\"flex flex-col gap-0.5\" id=\"modify-actions\">\r\n                  <button\r\n                    id=\"btn-open-transparency-modal\"\r\n                    onClick={() => setIsTransparencyModalOpen(true)}\r\n                    className=\"flex items-center gap-2 w-full text-left px-2 py-1.5 text-xs text-gray-300 hover:bg-slate-700/50 hover:text-white rounded transition-colors\"\r\n                    aria-label=\"Open transparency masking\"\r\n                  >\r\n                    <svg className=\"w-4 h-4 flex-shrink-0 text-gray-400\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                      <path d=\"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10\" />\r\n                      <path d=\"M12 2v20\" />\r\n                      <path d=\"M22 12H12\" />\r\n                      <path d=\"M19 15l3-3-3-3\" />\r\n                    </svg>\r\n                    <span>Transparency Mask</span>\r\n                  </button>\r\n                  <button\r\n                    id=\"btn-open-crop-modal\"\r\n                    onClick={() => setIsCropModalOpen(true)}\r\n                    className=\"flex items-center gap-2 w-full text-left px-2 py-1.5 text-xs text-gray-300 hover:bg-slate-700/50 hover:text-white rounded transition-colors\"\r\n                    aria-label=\"Open crop tool\"\r\n                  >\r\n                    <svg className=\"w-4 h-4 flex-shrink-0 text-gray-400\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                      <path d=\"M6 2v14a2 2 0 002 2h14\" />\r\n                      <path d=\"M18 22V8a2 2 0 00-2-2H2\" />\r\n                    </svg>\r\n                    <span>Crop</span>\r\n                  </button>\r\n                  <button\r\n                    id=\"btn-open-pixelator-modal\"\r\n                    onClick={() => setIsPixelatorModalOpen(true)}\r\n                    className=\"flex items-center gap-2 w-full text-left px-2 py-1.5 text-xs text-gray-300 hover:bg-slate-700/50 hover:text-white rounded transition-colors\"\r\n                    aria-label=\"Open pixelator / resize\"\r\n                  >\r\n                    <svg className=\"w-4 h-4 flex-shrink-0 text-gray-400\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                      <rect x=\"2\" y=\"2\" width=\"8\" height=\"8\" rx=\"1\" />\r\n                      <rect x=\"14\" y=\"2\" width=\"8\" height=\"8\" rx=\"1\" />\r\n                      <rect x=\"2\" y=\"14\" width=\"8\" height=\"8\" rx=\"1\" />\r\n                      <rect x=\"14\" y=\"14\" width=\"4\" height=\"4\" rx=\"0.5\" />\r\n                    </svg>\r\n                    <span>Pixelator / Resize</span>\r\n                  </button>\r\n                  <button\r\n                    id=\"btn-open-bg-removal-modal\"\r\n                    onClick={() => setIsBgRemovalModalOpen(true)}\r\n                    className=\"flex items-center gap-2 w-full text-left px-2 py-1.5 text-xs text-gray-300 hover:bg-slate-700/50 hover:text-white rounded transition-colors\"\r\n                    aria-label=\"Open background removal\"\r\n                  >\r\n                    <svg className=\"w-4 h-4 flex-shrink-0 text-gray-400\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                      <path d=\"M5 3a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2V5a2 2 0 00-2-2H5z\" />\r\n                      <path d=\"M9 3v18\" />\r\n                      <path d=\"M3 9h6\" />\r\n                      <path d=\"M3 15h6\" />\r\n                    </svg>\r\n                    <span>BG Removal</span>\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Modals */}\r\n            {selectedLayerIds.length === 1 && selectedLayers.length > 0 && (\r\n              <TransparencyMaskModal \r\n                isOpen={isTransparencyModalOpen}\r\n                onClose={() => setIsTransparencyModalOpen(false)}\r\n                layer={selectedLayers[0]}\r\n              />\r\n            )}\r\n\r\n            {selectedLayerIds.length === 1 && selectedLayers.length > 0 && (\r\n              <PixelatorModal \r\n                isOpen={isPixelatorModalOpen}\r\n                onClose={() => setIsPixelatorModalOpen(false)}\r\n                layer={selectedLayers[0]}\r\n              />\r\n            )}\r\n\r\n            {selectedLayerIds.length === 1 && selectedLayers.length > 0 && (\r\n              <BgRemovalModal\r\n                isOpen={isBgRemovalModalOpen}\r\n                onClose={() => setIsBgRemovalModalOpen(false)}\r\n                layer={selectedLayers[0]}\r\n              />\r\n            )}\r\n\r\n            {selectedLayerIds.length === 1 && selectedLayers.length > 0 && (\r\n              <CropModal\r\n                isOpen={isCropModalOpen}\r\n                onClose={() => setIsCropModalOpen(false)}\r\n                layer={selectedLayers[0]}\r\n              />\r\n            )}\r\n\r\n            {/* Bulk Position Controls (if multiple layers selected) */}\r\n            {selectedLayerIds.length > 1 && <BulkPositionControls />}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Canvas Settings moved to Layer panel */}\r\n    </div>\r\n  );\r\n}\r\n\r\n/**\r\n * Bulk position controls for multiple selected layers\r\n */\r\nfunction BulkPositionControls() {\r\n  const moveSelectedLayers = useCompositorStore((state) => state.moveSelectedLayers);\r\n  const selectedLayerIds = useCompositorStore((state) => state.selectedLayerIds);\r\n\r\n  const handleOffset = (deltaX: number, deltaY: number) => {\r\n    console.log(\r\n      `[DEBUG] Moving ${selectedLayerIds.length} layers by (${deltaX}, ${deltaY})`\r\n    );\r\n    moveSelectedLayers(deltaX, deltaY);\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-panel-bg rounded p-3 space-y-3\">\r\n      <div className=\"text-xs font-semibold text-gray-300\">Move Selected</div>\r\n\r\n      <div className=\"grid grid-cols-2 gap-2\">\r\n        <div>\r\n          <label className=\"text-xs text-gray-400 block mb-1\">Offset X</label>\r\n          <input\r\n            id=\"input-bulk-offset-x\"\r\n            type=\"number\"\r\n            defaultValue={0}\r\n            onKeyDown={(e) => {\r\n              if (e.key === 'Enter') {\r\n                const value = parseInt((e.target as HTMLInputElement).value) || 0;\r\n                handleOffset(value, 0);\r\n                (e.target as HTMLInputElement).value = '0';\r\n              }\r\n            }}\r\n            className=\"w-full px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-white focus:outline-none focus:ring-1 focus:ring-blue-400\"\r\n            placeholder=\"Pixels\"\r\n            aria-label=\"Offset X pixels\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"text-xs text-gray-400 block mb-1\">Offset Y</label>\r\n          <input\r\n            id=\"input-bulk-offset-y\"\r\n            type=\"number\"\r\n            defaultValue={0}\r\n            onKeyDown={(e) => {\r\n              if (e.key === 'Enter') {\r\n                const value = parseInt((e.target as HTMLInputElement).value) || 0;\r\n                handleOffset(0, value);\r\n                (e.target as HTMLInputElement).value = '0';\r\n              }\r\n            }}\r\n            className=\"w-full px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-white focus:outline-none focus:ring-1 focus:ring-blue-400\"\r\n            placeholder=\"Pixels\"\r\n            aria-label=\"Offset Y pixels\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"flex gap-1 text-xs\">\r\n        <button\r\n          id=\"btn-bulk-move-left\"\r\n          onClick={() => handleOffset(-1, 0)}\r\n          className=\"flex-1 px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded transition-colors\"\r\n          title=\"Move left 1px (Shift+)\"\r\n          aria-label=\"Move left 1 pixel\"\r\n        >\r\n          \r\n        </button>\r\n        <button\r\n          id=\"btn-bulk-move-right\"\r\n          onClick={() => handleOffset(1, 0)}\r\n          className=\"flex-1 px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded transition-colors\"\r\n          title=\"Move right 1px (Shift+)\"\r\n          aria-label=\"Move right 1 pixel\"\r\n        >\r\n          \r\n        </button>\r\n        <button\r\n          id=\"btn-bulk-move-up\"\r\n          onClick={() => handleOffset(0, -1)}\r\n          className=\"flex-1 px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded transition-colors\"\r\n          title=\"Move up 1px (Shift+)\"\r\n          aria-label=\"Move up 1 pixel\"\r\n        >\r\n          \r\n        </button>\r\n        <button\r\n          id=\"btn-bulk-move-down\"\r\n          onClick={() => handleOffset(0, 1)}\r\n          className=\"flex-1 px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded transition-colors\"\r\n          title=\"Move down 1px (Shift+)\"\r\n          aria-label=\"Move down 1 pixel\"\r\n        >\r\n          \r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default PropertyPanel;\r\n","import useCompositorStore from '../../store/compositorStore';\r\n\r\n/**\r\n * Zoom controls component\r\n * Provides zoom in/out, reset, and preset zoom levels\r\n */\r\nfunction ZoomControls() {\r\n  const viewport = useCompositorStore((state) => state.project.viewport);\r\n  const canvas = useCompositorStore((state) => state.project.canvas);\r\n  const setViewport = useCompositorStore((state) => state.setViewport);\r\n\r\n  const ZOOM_LEVELS = [25, 33, 50, 66, 75, 100, 125, 150, 200, 400, 800, 1600, 3200];\r\n\r\n  const calculateFitZoom = (): number => {\r\n    // Find the canvas container element\r\n    const container = document.querySelector('[data-region=\"canvas\"]');\r\n    if (!container) {\r\n      return 100; // Fallback to 100%\r\n    }\r\n\r\n    const containerWidth = container.clientWidth;\r\n    const containerHeight = container.clientHeight;\r\n\r\n    if (containerWidth <= 0 || containerHeight <= 0) {\r\n      return 100;\r\n    }\r\n\r\n    if (canvas.width <= 0 || canvas.height <= 0) {\r\n      return 100;\r\n    }\r\n\r\n    const scaleX = containerWidth / canvas.width;\r\n    const scaleY = containerHeight / canvas.height;\r\n\r\n    const fitZoom = Math.min(scaleX, scaleY) * 100;\r\n    // Snap to a preset zoom level, then go one level smaller for better visibility\r\n    const nearestZoom = ZOOM_LEVELS.reduce((prev, curr) =>\r\n      Math.abs(curr - fitZoom) < Math.abs(prev - fitZoom) ? curr : prev\r\n    );\r\n    \r\n    // Find the index of nearest zoom and go one level smaller for better visibility\r\n    const nearestIndex = ZOOM_LEVELS.indexOf(nearestZoom);\r\n    const resetZoom = nearestIndex > 0 ? ZOOM_LEVELS[nearestIndex - 1] : nearestZoom;\r\n\r\n    return resetZoom;\r\n  };\r\n\r\n  const handleZoom = (zoomLevel: number) => {\r\n    // console.log(`[DEBUG] Zoom level changed to ${zoomLevel}%`);\r\n    setViewport({ zoom: zoomLevel });\r\n  };\r\n\r\n  const handleZoomIn = () => {\r\n    const currentZoom = viewport.zoom;\r\n    const nextZoom = ZOOM_LEVELS.find((z) => z > currentZoom) || ZOOM_LEVELS[ZOOM_LEVELS.length - 1];\r\n    handleZoom(nextZoom);\r\n  };\r\n\r\n  const handleZoomOut = () => {\r\n    const currentZoom = viewport.zoom;\r\n    const nextZoom = [...ZOOM_LEVELS].reverse().find((z) => z < currentZoom) || ZOOM_LEVELS[0];\r\n    handleZoom(nextZoom);\r\n  };\r\n\r\n  const handleResetZoom = () => {\r\n    const fitZoom = calculateFitZoom();\r\n    setViewport({ zoom: fitZoom, panX: 0, panY: 0 });\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex items-center gap-2 bg-canvas-bg rounded px-2 py-1\" data-region=\"zoom-controls\">\r\n      <button\r\n        id=\"btn-zoom-out\"\r\n        onClick={handleZoomOut}\r\n        className=\"px-2 py-1 text-sm font-medium text-gray-300 hover:text-white bg-panel-bg hover:bg-gray-700 rounded transition-colors\"\r\n        title=\"Zoom Out\"\r\n        aria-label=\"Zoom out\"\r\n      >\r\n        \r\n      </button>\r\n\r\n      <div className=\"relative group\">\r\n        <button\r\n          id=\"btn-zoom-level\"\r\n          className=\"px-3 py-1 text-sm font-medium text-gray-300 hover:text-white bg-panel-bg hover:bg-gray-700 rounded transition-colors min-w-16 text-right\"\r\n          title=\"Click to select zoom level\"\r\n          aria-label={`Current zoom: ${viewport.zoom}%`}\r\n        >\r\n          {viewport.zoom}%\r\n        </button>\r\n\r\n        {/* Dropdown menu */}\r\n        <div className=\"absolute right-0 mt-1 w-24 bg-panel-bg border border-border rounded shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50\">\r\n          {ZOOM_LEVELS.map((zoom) => (\r\n            <button\r\n              key={zoom}\r\n              id={`btn-zoom-preset-${zoom}`}\r\n              onClick={() => handleZoom(zoom)}\r\n              className={`w-full text-left px-3 py-1 text-sm transition-colors ${\r\n                viewport.zoom === zoom\r\n                  ? 'bg-blue-600 text-white'\r\n                  : 'text-gray-300 hover:text-white hover:bg-gray-700'\r\n              }`}\r\n              aria-label={`Set zoom to ${zoom}%`}\r\n            >\r\n              {zoom}%\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      <button\r\n        id=\"btn-zoom-in\"\r\n        onClick={handleZoomIn}\r\n        className=\"px-2 py-1 text-sm font-medium text-gray-300 hover:text-white bg-panel-bg hover:bg-gray-700 rounded transition-colors\"\r\n        title=\"Zoom In\"\r\n        aria-label=\"Zoom in\"\r\n      >\r\n        +\r\n      </button>\r\n\r\n      <div className=\"w-px h-4 bg-border\"></div>\r\n\r\n      <button\r\n        id=\"btn-zoom-reset\"\r\n        onClick={handleResetZoom}\r\n        className=\"px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-300 hover:bg-gray-700 rounded transition-colors\"\r\n        title=\"Fit canvas to screen\"\r\n        aria-label=\"Fit canvas to screen\"\r\n      >\r\n        Reset\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ZoomControls;\r\n","/**\r\n * IndexedDB-based local project storage\r\n * Allows saving/loading multiple projects in the browser\r\n */\r\n\r\nconst DB_NAME = 'pixelconnect_projects';\r\nconst DB_VERSION = 1;\r\nconst STORE_NAME = 'projects';\r\n\r\nexport interface SavedProjectMeta {\r\n  id: string;\r\n  name: string;\r\n  savedAt: string;\r\n  sizeBytes: number;\r\n  thumbnailDataUrl?: string;\r\n  layerCount: number;\r\n  canvasWidth: number;\r\n  canvasHeight: number;\r\n}\r\n\r\nexport interface SavedProject extends SavedProjectMeta {\r\n  /** The full serialized JSON string */\r\n  projectJson: string;\r\n}\r\n\r\nfunction openDB(): Promise<IDBDatabase> {\r\n  return new Promise((resolve, reject) => {\r\n    const req = indexedDB.open(DB_NAME, DB_VERSION);\r\n    req.onupgradeneeded = () => {\r\n      const db = req.result;\r\n      if (!db.objectStoreNames.contains(STORE_NAME)) {\r\n        db.createObjectStore(STORE_NAME, { keyPath: 'id' });\r\n      }\r\n    };\r\n    req.onsuccess = () => resolve(req.result);\r\n    req.onerror = () => reject(req.error);\r\n  });\r\n}\r\n\r\n/** List all saved projects (metadata only, no full JSON payload) */\r\nexport async function listSavedProjects(): Promise<SavedProjectMeta[]> {\r\n  const db = await openDB();\r\n  return new Promise((resolve, reject) => {\r\n    const tx = db.transaction(STORE_NAME, 'readonly');\r\n    const store = tx.objectStore(STORE_NAME);\r\n    const req = store.getAll();\r\n    req.onsuccess = () => {\r\n      const results: SavedProjectMeta[] = (req.result as SavedProject[]).map(\r\n        ({ id, name, savedAt, sizeBytes, thumbnailDataUrl, layerCount, canvasWidth, canvasHeight }) => ({\r\n          id, name, savedAt, sizeBytes, thumbnailDataUrl, layerCount, canvasWidth, canvasHeight,\r\n        })\r\n      );\r\n      // Sort newest first\r\n      results.sort((a, b) => new Date(b.savedAt).getTime() - new Date(a.savedAt).getTime());\r\n      resolve(results);\r\n    };\r\n    req.onerror = () => reject(req.error);\r\n  });\r\n}\r\n\r\n/** Save a project (overwrite if same id) */\r\nexport async function saveProjectLocal(entry: SavedProject): Promise<void> {\r\n  const db = await openDB();\r\n  return new Promise((resolve, reject) => {\r\n    const tx = db.transaction(STORE_NAME, 'readwrite');\r\n    const store = tx.objectStore(STORE_NAME);\r\n    store.put(entry);\r\n    tx.oncomplete = () => resolve();\r\n    tx.onerror = () => reject(tx.error);\r\n  });\r\n}\r\n\r\n/** Load a full saved project by id */\r\nexport async function loadProjectLocal(id: string): Promise<SavedProject | undefined> {\r\n  const db = await openDB();\r\n  return new Promise((resolve, reject) => {\r\n    const tx = db.transaction(STORE_NAME, 'readonly');\r\n    const store = tx.objectStore(STORE_NAME);\r\n    const req = store.get(id);\r\n    req.onsuccess = () => resolve(req.result as SavedProject | undefined);\r\n    req.onerror = () => reject(req.error);\r\n  });\r\n}\r\n\r\n/** Delete a saved project */\r\nexport async function deleteProjectLocal(id: string): Promise<void> {\r\n  const db = await openDB();\r\n  return new Promise((resolve, reject) => {\r\n    const tx = db.transaction(STORE_NAME, 'readwrite');\r\n    const store = tx.objectStore(STORE_NAME);\r\n    store.delete(id);\r\n    tx.oncomplete = () => resolve();\r\n    tx.onerror = () => reject(tx.error);\r\n  });\r\n}\r\n\r\n/** Rename a saved project */\r\nexport async function renameProjectLocal(id: string, newName: string): Promise<void> {\r\n  const db = await openDB();\r\n  return new Promise((resolve, reject) => {\r\n    const tx = db.transaction(STORE_NAME, 'readwrite');\r\n    const store = tx.objectStore(STORE_NAME);\r\n    const req = store.get(id);\r\n    req.onsuccess = () => {\r\n      const entry = req.result as SavedProject | undefined;\r\n      if (!entry) { reject(new Error('Project not found')); return; }\r\n      entry.name = newName;\r\n      store.put(entry);\r\n    };\r\n    tx.oncomplete = () => resolve();\r\n    tx.onerror = () => reject(tx.error);\r\n  });\r\n}\r\n\r\n/** Generate a small thumbnail from project layers */\r\nexport function generateThumbnail(\r\n  layers: { imageData: string; x: number; y: number; width: number; height: number; visible: boolean; opacity: number; zIndex: number }[],\r\n  canvasWidth: number,\r\n  canvasHeight: number,\r\n  maxSize: number = 128,\r\n): Promise<string> {\r\n  return new Promise((resolve) => {\r\n    const canvas = document.createElement('canvas');\r\n    const scale = Math.min(maxSize / canvasWidth, maxSize / canvasHeight, 1);\r\n    canvas.width = Math.round(canvasWidth * scale);\r\n    canvas.height = Math.round(canvasHeight * scale);\r\n    const ctx = canvas.getContext('2d')!;\r\n    ctx.scale(scale, scale);\r\n\r\n    const sorted = [...layers].filter(l => l.visible).sort((a, b) => a.zIndex - b.zIndex);\r\n    let loaded = 0;\r\n\r\n    if (sorted.length === 0) {\r\n      resolve(canvas.toDataURL('image/png'));\r\n      return;\r\n    }\r\n\r\n    sorted.forEach((layer) => {\r\n      const img = new Image();\r\n      img.onload = () => {\r\n        loaded++;\r\n        if (loaded === sorted.length) {\r\n          // Draw in order\r\n          sorted.forEach((l) => {\r\n            const li = new Image();\r\n            li.src = l.imageData;\r\n            ctx.globalAlpha = l.opacity;\r\n            ctx.drawImage(li, l.x, l.y, l.width, l.height);\r\n          });\r\n          ctx.globalAlpha = 1;\r\n          resolve(canvas.toDataURL('image/png'));\r\n        }\r\n      };\r\n      img.onerror = () => {\r\n        loaded++;\r\n        if (loaded === sorted.length) resolve(canvas.toDataURL('image/png'));\r\n      };\r\n      img.src = layer.imageData;\r\n    });\r\n  });\r\n}\r\n\r\n/** Format byte size to human-readable string */\r\nexport function formatBytes(bytes: number): string {\r\n  if (bytes < 1024) return `${bytes} B`;\r\n  if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\r\n  return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\r\n}\r\n","import { useRef, useEffect, useState, useCallback } from 'react';\r\nimport useCompositorStore from '../../store/compositorStore';\r\nimport { serializeProject, deserializeProject, exportCanvasToPNG } from '../../utils/projectSerializer';\r\nimport {\r\n  listSavedProjects, saveProjectLocal, loadProjectLocal, deleteProjectLocal,\r\n  renameProjectLocal, generateThumbnail, formatBytes,\r\n  SavedProjectMeta, SavedProject,\r\n} from '../../utils/projectStorage';\r\n\r\n/**\r\n * File operations component\r\n * Handles save/load project, export, new project\r\n * Save & Load are dropdowns; includes local (IndexedDB) project storage\r\n */\r\nfunction FileOperations() {\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n  const [exportScale, setExportScale] = useState(1);\r\n  const [saveOpen, setSaveOpen] = useState(false);\r\n  const [loadOpen, setLoadOpen] = useState(false);\r\n  const [showSavedProjects, setShowSavedProjects] = useState(false);\r\n\r\n  const project = useCompositorStore((state) => state.project);\r\n  const resetProject = useCompositorStore((state) => state.resetProject);\r\n  const loadProject = useCompositorStore((state) => state.loadProject);\r\n  const markClean = useCompositorStore((state) => state.markClean);\r\n\r\n  // Close dropdowns when clicking outside\r\n  const saveRef = useRef<HTMLDivElement>(null);\r\n  const loadRef = useRef<HTMLDivElement>(null);\r\n  useEffect(() => {\r\n    const handler = (e: MouseEvent) => {\r\n      if (saveRef.current && !saveRef.current.contains(e.target as Node)) setSaveOpen(false);\r\n      if (loadRef.current && !loadRef.current.contains(e.target as Node)) setLoadOpen(false);\r\n    };\r\n    document.addEventListener('mousedown', handler);\r\n    return () => document.removeEventListener('mousedown', handler);\r\n  }, []);\r\n\r\n  // Keyboard shortcuts for save/load\r\n  useEffect(() => {\r\n    const handleKeyDown = (event: KeyboardEvent) => {\r\n      const isCtrlOrCmd = event.ctrlKey || event.metaKey;\r\n      if (isCtrlOrCmd && event.key === 's') {\r\n        event.preventDefault();\r\n        handleSaveProjectFile();\r\n      }\r\n      if (isCtrlOrCmd && event.key === 'o') {\r\n        event.preventDefault();\r\n        fileInputRef.current?.click();\r\n      }\r\n    };\r\n    window.addEventListener('keydown', handleKeyDown);\r\n    return () => window.removeEventListener('keydown', handleKeyDown);\r\n  }, [project]);\r\n\r\n  //  Save handlers \r\n\r\n  /** Export project as .pixcomp file download */\r\n  const handleSaveProjectFile = async () => {\r\n    setSaveOpen(false);\r\n    try {\r\n      const projectJson = serializeProject(project);\r\n      const blob = new Blob([projectJson], { type: 'application/json' });\r\n      const url = URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = `${project.projectName || 'untitled'}.pixcomp`;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n      URL.revokeObjectURL(url);\r\n      markClean();\r\n    } catch (error) {\r\n      alert(`Error saving project: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n    }\r\n  };\r\n\r\n  /** Export canvas as PNG */\r\n  const handleExportPNG = async () => {\r\n    setSaveOpen(false);\r\n    try {\r\n      const blob = await exportCanvasToPNG(\r\n        project.layers, project.canvas.width, project.canvas.height,\r\n        exportScale, project.canvas.backgroundColor,\r\n      );\r\n      const url = URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = `${project.projectName || 'composite'}_${exportScale}x.png`;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n      URL.revokeObjectURL(url);\r\n    } catch (error) {\r\n      alert(`Error exporting PNG: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n    }\r\n  };\r\n\r\n  /** Save project to IndexedDB */\r\n  const handleSaveLocal = async () => {\r\n    setSaveOpen(false);\r\n    try {\r\n      const projectJson = serializeProject(project);\r\n      const sizeBytes = new Blob([projectJson]).size;\r\n      const thumbnail = await generateThumbnail(\r\n        project.layers, project.canvas.width, project.canvas.height,\r\n      );\r\n      const entry: SavedProject = {\r\n        id: `proj_${Date.now()}_${Math.random().toString(36).substr(2, 6)}`,\r\n        name: project.projectName || 'Untitled',\r\n        savedAt: new Date().toISOString(),\r\n        sizeBytes,\r\n        thumbnailDataUrl: thumbnail,\r\n        layerCount: project.layers.length,\r\n        canvasWidth: project.canvas.width,\r\n        canvasHeight: project.canvas.height,\r\n        projectJson,\r\n      };\r\n      await saveProjectLocal(entry);\r\n      markClean();\r\n      alert(`Project saved locally: ${entry.name}`);\r\n    } catch (error) {\r\n      alert(`Error saving locally: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n    }\r\n  };\r\n\r\n  //  Load handlers \r\n\r\n  /** Open file picker */\r\n  const handleLoadFile = () => {\r\n    setLoadOpen(false);\r\n    fileInputRef.current?.click();\r\n  };\r\n\r\n  /** Show saved projects modal */\r\n  const handleLoadLocal = () => {\r\n    setLoadOpen(false);\r\n    setShowSavedProjects(true);\r\n  };\r\n\r\n  /** Actually load from file input */\r\n  const handleFileInputChange = async (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const files = event.target.files;\r\n    if (!files || files.length === 0) return;\r\n\r\n    for (const file of Array.from(files)) {\r\n      if (file.name.toLowerCase().endsWith('.pixcomp') || file.name.toLowerCase().endsWith('.json')) {\r\n        try {\r\n          const text = await file.text();\r\n          const projectData = await deserializeProject(text);\r\n          loadProject(projectData);\r\n          markClean();\r\n        } catch (error) {\r\n          alert(`Error loading project: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n        }\r\n      } else if (file.type.startsWith('image/')) {\r\n        try {\r\n          const dataUrl = await new Promise<string>((resolve, reject) => {\r\n            const reader = new FileReader();\r\n            reader.onload = (e) => resolve(e.target?.result as string);\r\n            reader.onerror = () => reject(new Error('Failed to read file'));\r\n            reader.readAsDataURL(file);\r\n          });\r\n          const img = new Image();\r\n          img.src = dataUrl;\r\n          await new Promise<void>((resolve, reject) => {\r\n            img.onload = () => resolve();\r\n            img.onerror = () => reject(new Error('Failed to load image'));\r\n          });\r\n          const addLayer = useCompositorStore.getState().addLayer;\r\n          addLayer({\r\n            name: file.name,\r\n            imageData: dataUrl,\r\n            x: 0, y: 0,\r\n            zIndex: useCompositorStore.getState().project.layers.length,\r\n            visible: true, locked: false, opacity: 1.0,\r\n            width: img.naturalWidth, height: img.naturalHeight,\r\n          });\r\n        } catch (error) {\r\n          alert(`Error loading image ${file.name}: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n        }\r\n      }\r\n    }\r\n    if (fileInputRef.current) fileInputRef.current.value = '';\r\n  };\r\n\r\n  /** Create new project */\r\n  const handleNewProject = () => {\r\n    if (useCompositorStore.getState().isDirty) {\r\n      if (!window.confirm('You have unsaved changes. Create new project anyway?')) return;\r\n    }\r\n    resetProject();\r\n  };\r\n\r\n  /** Load a saved project from the modal */\r\n  const handleLoadSavedProject = async (id: string) => {\r\n    try {\r\n      const entry = await loadProjectLocal(id);\r\n      if (!entry) { alert('Project not found'); return; }\r\n      const projectData = await deserializeProject(entry.projectJson);\r\n      loadProject(projectData);\r\n      markClean();\r\n      setShowSavedProjects(false);\r\n    } catch (error) {\r\n      alert(`Error loading project: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"flex items-center gap-1\" data-region=\"file-operations\">\r\n        {/* New */}\r\n        <button\r\n          onClick={handleNewProject}\r\n          className=\"px-3 py-1 text-sm font-medium text-gray-300 hover:text-white bg-panel-bg hover:bg-gray-700 rounded transition-colors\"\r\n          title=\"New project\"\r\n        >\r\n          New\r\n        </button>\r\n\r\n        {/* Save dropdown */}\r\n        <div ref={saveRef} className=\"relative\">\r\n          <button\r\n            onClick={() => { setSaveOpen(!saveOpen); setLoadOpen(false); }}\r\n            className=\"px-3 py-1 text-sm font-medium text-gray-300 hover:text-white bg-panel-bg hover:bg-gray-700 rounded transition-colors flex items-center gap-1\"\r\n            title=\"Save options\"\r\n          >\r\n            Save\r\n            <svg className=\"w-3 h-3\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={2}><path d=\"M19 9l-7 7-7-7\" /></svg>\r\n          </button>\r\n          {saveOpen && (\r\n            <div className=\"absolute left-0 mt-1 w-52 bg-panel-bg border border-border rounded shadow-lg z-50\">\r\n              <button\r\n                onClick={handleSaveProjectFile}\r\n                className=\"w-full text-left px-3 py-2 text-sm text-gray-300 hover:text-white hover:bg-gray-700 transition-colors rounded-t\"\r\n              >\r\n                <div className=\"font-medium\">Export Project</div>\r\n                <div className=\"text-xs text-gray-500\">.pixcomp file download</div>\r\n              </button>\r\n              <button\r\n                onClick={handleExportPNG}\r\n                className=\"w-full text-left px-3 py-2 text-sm text-gray-300 hover:text-white hover:bg-gray-700 transition-colors\"\r\n              >\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div className=\"font-medium\">Export Image</div>\r\n                  <select\r\n                    onClick={(e) => e.stopPropagation()}\r\n                    value={exportScale}\r\n                    onChange={(e) => setExportScale(parseInt(e.target.value))}\r\n                    className=\"bg-gray-700 text-xs rounded px-1 py-0.5 text-gray-300 border border-gray-600\"\r\n                  >\r\n                    {[1, 2, 4, 8].map(s => <option key={s} value={s}>{s}x</option>)}\r\n                  </select>\r\n                </div>\r\n                <div className=\"text-xs text-gray-500\">PNG at {exportScale}x scale</div>\r\n              </button>\r\n              <div className=\"border-t border-border\" />\r\n              <button\r\n                onClick={handleSaveLocal}\r\n                className=\"w-full text-left px-3 py-2 text-sm text-gray-300 hover:text-white hover:bg-gray-700 transition-colors rounded-b\"\r\n              >\r\n                <div className=\"font-medium\">Save Local</div>\r\n                <div className=\"text-xs text-gray-500\">Store in browser cache</div>\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Load dropdown */}\r\n        <div ref={loadRef} className=\"relative\">\r\n          <button\r\n            onClick={() => { setLoadOpen(!loadOpen); setSaveOpen(false); }}\r\n            className=\"px-3 py-1 text-sm font-medium text-gray-300 hover:text-white bg-panel-bg hover:bg-gray-700 rounded transition-colors flex items-center gap-1\"\r\n            title=\"Load options (Ctrl+O)\"\r\n          >\r\n            Load\r\n            <svg className=\"w-3 h-3\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={2}><path d=\"M19 9l-7 7-7-7\" /></svg>\r\n          </button>\r\n          {loadOpen && (\r\n            <div className=\"absolute left-0 mt-1 w-52 bg-panel-bg border border-border rounded shadow-lg z-50\">\r\n              <button\r\n                onClick={handleLoadFile}\r\n                className=\"w-full text-left px-3 py-2 text-sm text-gray-300 hover:text-white hover:bg-gray-700 transition-colors rounded-t\"\r\n              >\r\n                <div className=\"font-medium\">Load File</div>\r\n                <div className=\"text-xs text-gray-500\">.pixcomp, PNG, GIF, BMP, JPEG</div>\r\n              </button>\r\n              <div className=\"border-t border-border\" />\r\n              <button\r\n                onClick={handleLoadLocal}\r\n                className=\"w-full text-left px-3 py-2 text-sm text-gray-300 hover:text-white hover:bg-gray-700 transition-colors rounded-b\"\r\n              >\r\n                <div className=\"font-medium\">Load Local</div>\r\n                <div className=\"text-xs text-gray-500\">From browser cache</div>\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <input\r\n          ref={fileInputRef}\r\n          type=\"file\"\r\n          multiple\r\n          accept=\".pixcomp,.json,image/png,image/gif,image/bmp,image/jpeg\"\r\n          onChange={handleFileInputChange}\r\n          className=\"hidden\"\r\n        />\r\n      </div>\r\n\r\n      {/* Saved Projects Modal */}\r\n      {showSavedProjects && (\r\n        <SavedProjectsModal\r\n          onClose={() => setShowSavedProjects(false)}\r\n          onLoad={handleLoadSavedProject}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\n//  Saved Projects Modal \r\n\r\nfunction SavedProjectsModal({ onClose, onLoad }: { onClose: () => void; onLoad: (id: string) => void }) {\r\n  const [projects, setProjects] = useState<SavedProjectMeta[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [renamingId, setRenamingId] = useState<string | null>(null);\r\n  const [renameValue, setRenameValue] = useState('');\r\n\r\n  const refresh = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const list = await listSavedProjects();\r\n      setProjects(list);\r\n    } catch (e) {\r\n      console.error('Failed to list saved projects:', e);\r\n    }\r\n    setLoading(false);\r\n  }, []);\r\n\r\n  useEffect(() => { refresh(); }, [refresh]);\r\n\r\n  const handleDelete = async (id: string, name: string) => {\r\n    if (!window.confirm(`Delete saved project \"${name}\"?`)) return;\r\n    await deleteProjectLocal(id);\r\n    refresh();\r\n  };\r\n\r\n  const handleRenameStart = (id: string, currentName: string) => {\r\n    setRenamingId(id);\r\n    setRenameValue(currentName);\r\n  };\r\n\r\n  const handleRenameSubmit = async (id: string) => {\r\n    if (renameValue.trim()) {\r\n      await renameProjectLocal(id, renameValue.trim());\r\n      refresh();\r\n    }\r\n    setRenamingId(null);\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-[400] flex items-center justify-center\">\r\n      <div className=\"absolute inset-0 bg-black/60\" onClick={onClose} />\r\n      <div className=\"relative bg-panel-bg border border-border rounded-lg shadow-2xl w-[600px] max-h-[80vh] overflow-hidden flex flex-col\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between px-5 py-3 border-b border-border\">\r\n          <h2 className=\"text-sm font-semibold text-gray-200\">Saved Projects (Local)</h2>\r\n          <button onClick={onClose} className=\"text-gray-400 hover:text-white p-1 rounded hover:bg-gray-700\">\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n            </svg>\r\n          </button>\r\n        </div>\r\n\r\n        {/* Body */}\r\n        <div className=\"overflow-y-auto flex-1 p-4\">\r\n          {loading ? (\r\n            <div className=\"text-center text-gray-400 py-8\">Loading...</div>\r\n          ) : projects.length === 0 ? (\r\n            <div className=\"text-center text-gray-500 py-12\">\r\n              <div className=\"text-3xl mb-2\"></div>\r\n              <div className=\"text-sm\">No saved projects yet</div>\r\n              <div className=\"text-xs text-gray-600 mt-1\">Use Save  Save Local to store projects in your browser</div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-2\">\r\n              {projects.map((p) => (\r\n                <div\r\n                  key={p.id}\r\n                  className=\"flex items-center gap-3 p-3 bg-gray-800/50 hover:bg-gray-700/50 rounded-lg transition-colors group\"\r\n                >\r\n                  {/* Thumbnail */}\r\n                  <div className=\"w-14 h-14 rounded bg-gray-900 overflow-hidden flex-shrink-0 border border-gray-700\">\r\n                    {p.thumbnailDataUrl ? (\r\n                      <img src={p.thumbnailDataUrl} alt=\"\" className=\"w-full h-full object-contain\" style={{ imageRendering: 'pixelated' }} />\r\n                    ) : (\r\n                      <div className=\"w-full h-full flex items-center justify-center text-gray-600 text-lg\">?</div>\r\n                    )}\r\n                  </div>\r\n\r\n                  {/* Info */}\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    {renamingId === p.id ? (\r\n                      <input\r\n                        autoFocus\r\n                        value={renameValue}\r\n                        onChange={(e) => setRenameValue(e.target.value)}\r\n                        onBlur={() => handleRenameSubmit(p.id)}\r\n                        onKeyDown={(e) => {\r\n                          if (e.key === 'Enter') handleRenameSubmit(p.id);\r\n                          if (e.key === 'Escape') setRenamingId(null);\r\n                        }}\r\n                        className=\"bg-gray-900 border border-blue-500 rounded px-2 py-0.5 text-sm text-white w-full focus:outline-none focus:ring-1 focus:ring-blue-400\"\r\n                      />\r\n                    ) : (\r\n                      <div className=\"text-sm font-medium text-gray-200 truncate\">{p.name}</div>\r\n                    )}\r\n                    <div className=\"text-xs text-gray-500 mt-0.5\">\r\n                      {formatBytes(p.sizeBytes)}  {p.layerCount} layer{p.layerCount !== 1 ? 's' : ''}  {p.canvasWidth}{p.canvasHeight}\r\n                    </div>\r\n                    <div className=\"text-xs text-gray-600\">\r\n                      {new Date(p.savedAt).toLocaleDateString()} {new Date(p.savedAt).toLocaleTimeString()}\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Actions */}\r\n                  <div className=\"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0\">\r\n                    <button\r\n                      onClick={() => onLoad(p.id)}\r\n                      className=\"px-3 py-1.5 text-xs font-medium bg-blue-600 hover:bg-blue-500 text-white rounded transition-colors\"\r\n                      title=\"Load this project\"\r\n                    >\r\n                      Load\r\n                    </button>\r\n                    <button\r\n                      onClick={() => handleRenameStart(p.id, p.name)}\r\n                      className=\"p-1.5 text-gray-400 hover:text-white hover:bg-gray-600 rounded transition-colors\"\r\n                      title=\"Rename\"\r\n                    >\r\n                      <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-3.5 w-3.5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={2}>\r\n                        <path d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\" />\r\n                      </svg>\r\n                    </button>\r\n                    <button\r\n                      onClick={() => handleDelete(p.id, p.name)}\r\n                      className=\"p-1.5 text-gray-400 hover:text-red-400 hover:bg-gray-600 rounded transition-colors\"\r\n                      title=\"Delete\"\r\n                    >\r\n                      <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-3.5 w-3.5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={2}>\r\n                        <path d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n                      </svg>\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default FileOperations;\r\n","import useCompositorStore from '../../store/compositorStore';\r\n\r\n/**\r\n * Undo/Redo controls component\r\n */\r\nfunction HistoryControls() {\r\n  const history = useCompositorStore((state) => state.history);\r\n  const undo = useCompositorStore((state) => state.undo);\r\n  const redo = useCompositorStore((state) => state.redo);\r\n\r\n  const canUndo = history.past.length > 0;\r\n  const canRedo = history.future.length > 0;\r\n\r\n  const handleUndo = () => {\r\n    // console.log('[DEBUG] Undo clicked');\r\n    undo();\r\n  };\r\n\r\n  const handleRedo = () => {\r\n    // console.log('[DEBUG] Redo clicked');\r\n    redo();\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex items-center gap-1\" data-region=\"history-controls\">\r\n      <button\r\n        id=\"btn-undo\"\r\n        onClick={handleUndo}\r\n        disabled={!canUndo}\r\n        className={`px-3 py-1 text-sm font-medium rounded transition-colors ${\r\n          canUndo\r\n            ? 'text-gray-300 hover:text-white bg-panel-bg hover:bg-gray-700'\r\n            : 'text-gray-600 bg-panel-bg cursor-not-allowed opacity-50'\r\n        }`}\r\n        title={`Undo (${history.past.length} operation${history.past.length !== 1 ? 's' : ''} available) - Ctrl+Z`}\r\n        aria-label=\"Undo\"\r\n      >\r\n        \r\n      </button>\r\n\r\n      <button\r\n        id=\"btn-redo\"\r\n        onClick={handleRedo}\r\n        disabled={!canRedo}\r\n        className={`px-3 py-1 text-sm font-medium rounded transition-colors ${\r\n          canRedo\r\n            ? 'text-gray-300 hover:text-white bg-panel-bg hover:bg-gray-700'\r\n            : 'text-gray-600 bg-panel-bg cursor-not-allowed opacity-50'\r\n        }`}\r\n        title={`Redo (${history.future.length} operation${history.future.length !== 1 ? 's' : ''} available) - Ctrl+Shift+Z`}\r\n        aria-label=\"Redo\"\r\n      >\r\n        \r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default HistoryControls;\r\n","import { useEffect } from 'react';\r\nimport useCompositorStore from '../../store/compositorStore';\r\nimport { savePreferences, loadPreferences } from '../../hooks/useLocalStorage';\r\n\r\n/**\r\n * Grid toggle button component\r\n * Simple toggle for enabling/disabling the pixel grid with density control\r\n */\r\nfunction GridToggle() {\r\n  const gridEnabled = useCompositorStore((state) => state.project.grid.enabled);\r\n  const gridDensity = useCompositorStore((state) => state.project.grid.density);\r\n  const toggleGrid = useCompositorStore((state) => state.toggleGrid);\r\n  const setGridDensity = useCompositorStore((state) => state.setGridDensity);\r\n\r\n  // Sync grid settings to localStorage\r\n  useEffect(() => {\r\n    const preferences = loadPreferences();\r\n    preferences.gridEnabled = gridEnabled;\r\n    preferences.gridDensity = gridDensity;\r\n    savePreferences(preferences);\r\n  }, [gridEnabled, gridDensity]);\r\n\r\n  return (\r\n    <div className=\"flex items-center gap-1\" data-region=\"grid-toggle\">\r\n      <button\r\n        id=\"btn-toggle-grid\"\r\n        onClick={toggleGrid}\r\n        className={`px-2 py-1 rounded transition-colors ${\r\n          gridEnabled\r\n            ? 'bg-gray-600 text-white hover:bg-gray-500'\r\n            : 'bg-gray-700 text-gray-300 hover:bg-gray-600'\r\n        }`}\r\n        title=\"Toggle pixel grid (shows lines between pixels)\"\r\n        aria-label={gridEnabled ? 'Disable pixel grid' : 'Enable pixel grid'}\r\n        aria-pressed={gridEnabled}\r\n      >\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={2}>\r\n          <path d=\"M3 3v18h18\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\r\n          <path d=\"M3 9h18M3 15h18M9 3v18M15 3v18\" strokeLinecap=\"round\" />\r\n        </svg>\r\n      </button>\r\n\r\n      {gridEnabled && (\r\n        <div className=\"flex items-center gap-1\">\r\n          <label className=\"text-xs text-gray-400\">Density:</label>\r\n          <input\r\n            id=\"input-grid-density\"\r\n            type=\"range\"\r\n            min=\"1\"\r\n            max=\"8\"\r\n            value={gridDensity}\r\n            onChange={(e) => setGridDensity(parseInt(e.target.value))}\r\n            className=\"w-24 h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer\"\r\n            title={`Grid density: every ${gridDensity} pixel(s)`}\r\n            aria-label=\"Grid density\"\r\n          />\r\n          <span className=\"text-xs text-gray-400 w-6\">{gridDensity}</span>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default GridToggle;\r\n","import { useState, useEffect, Fragment } from 'react';\r\nimport useCompositorStore from '../../store/compositorStore';\r\nimport { savePreferences, loadPreferences } from '../../hooks/useLocalStorage';\r\nimport ZoomControls from './ZoomControls';\r\nimport FileOperations from './FileOperations';\r\nimport HistoryControls from './HistoryControls';\r\nimport GridToggle from './GridToggle';\r\nimport { usePortraitMode } from '../../hooks/usePortraitMode';\r\n\r\n/**\r\n * Top toolbar component\r\n * Contains project name, file operations, zoom controls\r\n */\r\nfunction Toolbar({ onHelpClick }: { onHelpClick?: () => void }) {\r\n  const project = useCompositorStore((state) => state.project);\r\n  const setProjectName = useCompositorStore((state) => state.setProjectName);\r\n  const showSelectionBorders = useCompositorStore((state) => state.ui.showSelectionBorders);\r\n  const toggleSelectionBorders = useCompositorStore((state) => state.toggleSelectionBorders);\r\n  const showSelectionTools = useCompositorStore((state) => state.ui.showSelectionTools);\r\n  const toggleSelectionTools = useCompositorStore((state) => state.toggleSelectionTools);\r\n  const borderAnimationSpeed = useCompositorStore((state) => state.ui.selectionBorderAnimationSpeed);\r\n  const setSelectionBorderAnimationSpeed = useCompositorStore((state) => state.setSelectionBorderAnimationSpeed);\r\n  const [isEditingName, setIsEditingName] = useState(false);\r\n  const [showShortcuts, setShowShortcuts] = useState(false);\r\n  const [tempName, setTempName] = useState(project.projectName);\r\n  const isPortrait = usePortraitMode();\r\n\r\n  // Sync border settings to localStorage\r\n  useEffect(() => {\r\n    const preferences = loadPreferences();\r\n    preferences.showSelectionBorders = showSelectionBorders;\r\n    preferences.selectionBorderAnimationSpeed = borderAnimationSpeed;\r\n    savePreferences(preferences);\r\n  }, [showSelectionBorders, borderAnimationSpeed]);\r\n\r\n  const handleNameSave = () => {\r\n    if (tempName.trim()) {\r\n      setProjectName(tempName.trim());\r\n      // console.log(`[DEBUG] Project name updated to: ${tempName.trim()}`);\r\n    } else {\r\n      setTempName(project.projectName);\r\n    }\r\n    setIsEditingName(false);\r\n  };\r\n\r\n  const handleKeyDown = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter') {\r\n      handleNameSave();\r\n    } else if (e.key === 'Escape') {\r\n      setTempName(project.projectName);\r\n      setIsEditingName(false);\r\n    }\r\n  };\r\n\r\n  // Shared grid/border/tools controls  rendered in different locations based on orientation\r\n  const gridBorderToolsControls = (\r\n    <>\r\n      <GridToggle />\r\n      {/* Hidden: Borders toggle + animation speed (code preserved) */}\r\n      {false && (\r\n        <>\r\n          <div className=\"w-px h-6 bg-border\"></div>\r\n          <button\r\n            id=\"btn-toggle-borders\"\r\n            onClick={toggleSelectionBorders}\r\n            title={showSelectionBorders ? 'Hide selection borders' : 'Show selection borders'}\r\n            aria-label={showSelectionBorders ? 'Hide selection borders' : 'Show selection borders'}\r\n            aria-pressed={showSelectionBorders}\r\n            className={`px-3 py-1 rounded transition-colors text-sm font-medium ${\r\n              showSelectionBorders\r\n                ? 'bg-gray-600 text-white hover:bg-gray-500'\r\n                : 'bg-gray-700 text-gray-300 hover:bg-gray-600'\r\n            }`}\r\n          >\r\n            Borders\r\n          </button>\r\n          {showSelectionBorders && (\r\n            <div className=\"flex items-center gap-2\">\r\n              <label className=\"text-xs text-gray-400 whitespace-nowrap\">Speed:</label>\r\n              <input\r\n                id=\"input-border-speed\"\r\n                type=\"range\"\r\n                min=\"0\"\r\n                max=\"1\"\r\n                step=\"0.1\"\r\n                value={borderAnimationSpeed}\r\n                onChange={(e) => setSelectionBorderAnimationSpeed(parseFloat(e.target.value))}\r\n                className=\"w-24 h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer\"\r\n                title=\"Border animation speed (0 = static, 1 = max speed)\"\r\n                aria-label=\"Border animation speed\"\r\n              />\r\n            </div>\r\n          )}\r\n          <div className=\"w-px h-6 bg-border\"></div>\r\n          <button\r\n            id=\"btn-toggle-tools\"\r\n            onClick={toggleSelectionTools}\r\n            title={showSelectionTools ? 'Hide selection tools' : 'Show selection tools'}\r\n            aria-label={showSelectionTools ? 'Hide selection tools' : 'Show selection tools'}\r\n            aria-pressed={showSelectionTools}\r\n            className={`px-3 py-1 rounded transition-colors text-sm font-medium ${\r\n              showSelectionTools\r\n                ? 'bg-gray-600 text-white hover:bg-gray-500'\r\n                : 'bg-gray-700 text-gray-300 hover:bg-gray-600'\r\n            }`}\r\n          >\r\n            Tools\r\n          </button>\r\n        </>\r\n      )}\r\n    </>\r\n  );\r\n\r\n  return (\r\n    <>\r\n    <div className=\"bg-panel-bg border-b border-border px-4 py-2\" data-region=\"toolbar\">\r\n      {/* Row 1 */}\r\n      <div className=\"flex items-center gap-2 flex-wrap\">\r\n        {/* Branding + Name */}\r\n        <div className=\"flex items-center gap-3 min-w-0\">\r\n          <div className=\"text-lg font-semibold whitespace-nowrap\">\r\n            <span className=\"text-red-500\">Pi</span><span className=\"text-sky-400 hidden sm:inline\">xelConnect</span>\r\n          </div>\r\n          <div className=\"text-gray-500 hidden sm:block\">|</div>\r\n        \r\n        {isEditingName ? (\r\n          <input\r\n            id=\"input-project-name\"\r\n            autoFocus\r\n            type=\"text\"\r\n            value={tempName}\r\n            onChange={(e) => setTempName(e.target.value)}\r\n            onBlur={handleNameSave}\r\n            onKeyDown={handleKeyDown}\r\n            className=\"flex-1 px-2 py-1 bg-canvas-bg border border-blue-500 rounded text-sm text-white focus:outline-none focus:ring-2 focus:ring-blue-400\"\r\n            placeholder=\"Project name...\"\r\n            aria-label=\"Project name\"\r\n          />\r\n        ) : (\r\n          <button\r\n            id=\"btn-rename-project\"\r\n            onClick={() => {\r\n              setTempName(project.projectName);\r\n              setIsEditingName(true);\r\n            }}\r\n            className=\"flex-1 text-left px-2 py-1 text-gray-300 hover:text-white hover:bg-canvas-bg rounded transition-colors truncate\"\r\n            title=\"Click to rename project\"\r\n            aria-label=\"Rename project\"\r\n          >\r\n            {project.projectName}\r\n          </button>\r\n        )}\r\n        </div>\r\n\r\n        {/* File + History */}\r\n        <div className=\"flex items-center gap-2\">\r\n          <FileOperations />\r\n          <div className=\"w-px h-6 bg-border\"></div>\r\n          <HistoryControls />\r\n          <div className=\"w-px h-6 bg-border\"></div>\r\n          <button\r\n            onClick={() => setShowShortcuts(true)}\r\n            className=\"px-2 py-1 rounded text-sm font-medium text-gray-300 hover:text-white hover:bg-gray-700 transition-colors\"\r\n            title=\"Keyboard shortcuts\"\r\n            aria-label=\"Keyboard shortcuts\"\r\n          >\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={2}>\r\n              <rect x=\"2\" y=\"6\" width=\"20\" height=\"12\" rx=\"2\" />\r\n              <path d=\"M6 10h0m4 0h0m4 0h0m4 0h0M8 14h8\" strokeLinecap=\"round\" />\r\n            </svg>\r\n          </button>\r\n          {onHelpClick && (\r\n            <>\r\n              <button\r\n                onClick={onHelpClick}\r\n                className=\"px-2 py-1 rounded text-sm font-bold text-blue-400 hover:text-white hover:bg-gray-700 transition-colors\"\r\n                title=\"Open tutorial\"\r\n                aria-label=\"Open tutorial\"\r\n              >\r\n                ?\r\n              </button>\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        {/* Desktop: Grid/Borders/Tools + Zoom all on row 1 */}\r\n        {!isPortrait && (\r\n          <>\r\n            <div className=\"w-px h-6 bg-border\"></div>\r\n            <div className=\"flex items-center gap-2\">\r\n              {gridBorderToolsControls}\r\n            </div>\r\n            <div className=\"flex items-center gap-2 ml-auto\">\r\n              <ZoomControls />\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n\r\n      {/* Row 2: Portrait only  Grid/Borders/Tools + Zoom */}\r\n      {isPortrait && (\r\n        <div className=\"flex items-center gap-2 flex-wrap mt-2 pt-2 border-t border-border justify-between\">\r\n          <div className=\"flex items-center gap-2 flex-wrap\">\r\n            {gridBorderToolsControls}\r\n          </div>\r\n          <ZoomControls />\r\n        </div>\r\n      )}\r\n    </div>\r\n\r\n    {/* Keyboard Shortcuts Modal */}\r\n    {showShortcuts && (\r\n      <div className=\"fixed inset-0 z-[400] flex items-center justify-center\">\r\n        <div className=\"absolute inset-0 bg-black/60\" onClick={() => setShowShortcuts(false)} />\r\n        <div className=\"relative bg-panel-bg border border-border rounded-lg shadow-2xl w-[520px] max-h-[80vh] overflow-hidden flex flex-col\">\r\n          <div className=\"flex items-center justify-between px-5 py-3 border-b border-border\">\r\n            <h2 className=\"text-sm font-semibold text-gray-200\">Keyboard Shortcuts</h2>\r\n            <button onClick={() => setShowShortcuts(false)} className=\"text-gray-400 hover:text-white p-1 rounded hover:bg-gray-700\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" /></svg>\r\n            </button>\r\n          </div>\r\n          <div className=\"overflow-y-auto p-5 space-y-4 text-sm\">\r\n            <ShortcutSection title=\"General\">\r\n              <Shortcut keys=\"Ctrl + S\" desc=\"Save project\" />\r\n              <Shortcut keys=\"Ctrl + O\" desc=\"Open / load project\" />\r\n              <Shortcut keys=\"Ctrl + Z\" desc=\"Undo\" />\r\n              <Shortcut keys=\"Ctrl + Shift + Z\" desc=\"Redo\" />\r\n              <Shortcut keys=\"Ctrl + Y\" desc=\"Redo (alt)\" />\r\n            </ShortcutSection>\r\n            <ShortcutSection title=\"Layers\">\r\n              <Shortcut keys=\"Ctrl + A\" desc=\"Select all layers\" />\r\n              <Shortcut keys=\"Ctrl + D\" desc=\"Deselect all\" />\r\n              <Shortcut keys=\"Ctrl + C\" desc=\"Copy selected layers\" />\r\n              <Shortcut keys=\"Ctrl + V\" desc=\"Paste from clipboard\" />\r\n              <Shortcut keys=\"Delete / Backspace\" desc=\"Delete selected layers\" />\r\n              <Shortcut keys=\"Shift +  / \" desc=\"Reorder layer up / down\" />\r\n            </ShortcutSection>\r\n            <ShortcutSection title=\"Movement\">\r\n              <Shortcut keys=\"Arrow keys\" desc=\"Nudge selected layer (1 px)\" />\r\n              <Shortcut keys=\"Hold arrow keys\" desc=\"Continuous nudge\" />\r\n            </ShortcutSection>\r\n            <ShortcutSection title=\"Viewport\">\r\n              <Shortcut keys=\"+ / \" desc=\"Zoom in / out\" />\r\n              <Shortcut keys=\"0\" desc=\"Reset zoom to 100%\" />\r\n              <Shortcut keys=\"Scroll wheel\" desc=\"Zoom in / out (canvas)\" />\r\n              <Shortcut keys=\"Middle-click drag\" desc=\"Pan canvas\" />\r\n              <Shortcut keys=\"Space + drag\" desc=\"Pan canvas\" />\r\n            </ShortcutSection>\r\n            <ShortcutSection title=\"Other\">\r\n              <Shortcut keys=\"Ctrl + Shift + D\" desc=\"Debug history modal\" />\r\n              <Shortcut keys=\"Drop image file\" desc=\"Add as new layer\" />\r\n            </ShortcutSection>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )}\r\n    </>\r\n  );\r\n}\r\n\r\nfunction ShortcutSection({ title, children }: { title: string; children: React.ReactNode }) {\r\n  return (\r\n    <div>\r\n      <h3 className=\"text-xs font-semibold text-gray-400 uppercase mb-2\">{title}</h3>\r\n      <div className=\"space-y-1.5\">{children}</div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction Shortcut({ keys, desc }: { keys: string; desc: string }) {\r\n  return (\r\n    <div className=\"flex items-center justify-between\">\r\n      <span className=\"text-gray-300\">{desc}</span>\r\n      <span className=\"flex gap-1\">\r\n        {keys.split(' + ').map((k, i) => (\r\n          <Fragment key={i}>\r\n            {i > 0 && <span className=\"text-gray-500\">+</span>}\r\n            <kbd className=\"px-1.5 py-0.5 bg-gray-700 border border-gray-600 rounded text-xs font-mono text-gray-200\">{k.trim()}</kbd>\r\n          </Fragment>\r\n        ))}\r\n      </span>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Toolbar;\r\n","/**\r\n * Debug History Modal - Shows the undo/redo history stack\r\n * Accessible via Ctrl+Shift+D\r\n */\r\n\r\nimport { useState } from 'react';\r\nimport useCompositorStore from '../../store/compositorStore';\r\nimport { ProjectData } from '../../types/compositor.types';\r\n\r\ninterface DebugHistoryModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n}\r\n\r\nexport function DebugHistoryModal({ isOpen, onClose }: DebugHistoryModalProps) {\r\n  const history = useCompositorStore((state) => state.history);\r\n  const project = useCompositorStore((state) => state.project);\r\n  const [expandedIndex, setExpandedIndex] = useState<string | null>(null);\r\n\r\n  if (!isOpen) return null;\r\n\r\n  const getProjectSummary = (proj: ProjectData): string => {\r\n    return `${proj.projectName} | ${proj.layers.length} layer(s) | Modified: ${new Date(proj.modified).toLocaleTimeString()}`;\r\n  };\r\n\r\n  const getLayerChanges = (proj1: ProjectData, proj2: ProjectData): string[] => {\r\n    const changes: string[] = [];\r\n\r\n    // Check layer count\r\n    if (proj1.layers.length !== proj2.layers.length) {\r\n      changes.push(`Layer count: ${proj1.layers.length}  ${proj2.layers.length}`);\r\n    }\r\n\r\n    // Check layer properties\r\n    for (let i = 0; i < Math.max(proj1.layers.length, proj2.layers.length); i++) {\r\n      const layer1 = proj1.layers[i];\r\n      const layer2 = proj2.layers[i];\r\n\r\n      if (!layer1) {\r\n        changes.push(`Layer ${i}: removed`);\r\n      } else if (!layer2) {\r\n        changes.push(`Layer ${i}: added (${layer1.name})`);\r\n      } else if (\r\n        layer1.x !== layer2.x ||\r\n        layer1.y !== layer2.y ||\r\n        layer1.width !== layer2.width ||\r\n        layer1.height !== layer2.height\r\n      ) {\r\n        changes.push(\r\n          `${layer1.name}: (${layer1.x}, ${layer1.y})  (${layer2.x}, ${layer2.y})`\r\n        );\r\n      }\r\n    }\r\n\r\n    return changes.length > 0 ? changes : ['No layer changes'];\r\n  };\r\n\r\n  const handleKeyDown = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Escape') {\r\n      onClose();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\"\r\n      onClick={onClose}\r\n      onKeyDown={handleKeyDown}\r\n      role=\"dialog\"\r\n      aria-modal=\"true\"\r\n      aria-label=\"Debug History Modal\"\r\n      tabIndex={0}\r\n    >\r\n      <div\r\n        className=\"bg-slate-900 border border-slate-700 rounded-lg shadow-2xl w-full max-w-2xl max-h-[80vh] flex flex-col\"\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        {/* Header */}\r\n        <div className=\"bg-slate-800 px-6 py-4 border-b border-slate-700 flex justify-between items-center\">\r\n          <h2 className=\"text-lg font-semibold text-white flex items-center gap-2\">\r\n            <span className=\"text-yellow-400\"></span>\r\n            Debug History\r\n          </h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-slate-400 hover:text-white transition-colors\"\r\n            aria-label=\"Close debug menu\"\r\n          >\r\n            \r\n          </button>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"flex-1 overflow-hidden flex flex-col\">\r\n          <div className=\"flex-1 overflow-auto p-4 space-y-2\">\r\n            {/* Current Project State */}\r\n            <div className=\"bg-slate-800 rounded p-3 border border-slate-700 sticky top-0\">\r\n              <div className=\"text-sm font-semibold text-cyan-400 mb-1\">Current State</div>\r\n              <div className=\"text-xs text-slate-300\">\r\n                {getProjectSummary(project)}\r\n              </div>\r\n            </div>\r\n\r\n            {/* History Stack */}\r\n            {history.past.length === 0 && history.future.length === 0 ? (\r\n              <div className=\"text-center text-slate-400 py-8\">\r\n                <p className=\"text-sm\">No history entries yet</p>\r\n              </div>\r\n            ) : (\r\n              <>\r\n                {/* Past History */}\r\n                {history.past.length > 0 && (\r\n                  <div>\r\n                    <div className=\"text-xs font-semibold text-green-400 mb-2 px-1\">\r\n                      UNDO STACK ({history.past.length})\r\n                    </div>\r\n                    <div className=\"space-y-1\">\r\n                      {history.past.map((entry, idx) => (\r\n                        <div key={`past-${idx}`}>\r\n                          <button\r\n                            onClick={() =>\r\n                              setExpandedIndex(\r\n                                expandedIndex === `past-${idx}` ? null : `past-${idx}`\r\n                              )\r\n                            }\r\n                            className=\"w-full text-left bg-slate-800 hover:bg-slate-700 rounded px-3 py-2 text-xs transition-colors border border-slate-700 hover:border-slate-600\"\r\n                          >\r\n                            <div className=\"flex items-center gap-2\">\r\n                              <span className=\"text-green-400\"></span>\r\n                              <span className=\"text-slate-300 flex-1\">\r\n                                {getProjectSummary(entry)}\r\n                              </span>\r\n                              <span className=\"text-slate-500\">\r\n                                {expandedIndex === `past-${idx}` ? '' : ''}\r\n                              </span>\r\n                            </div>\r\n                          </button>\r\n\r\n                          {/* Expanded Details */}\r\n                          {expandedIndex === `past-${idx}` && (\r\n                            <div className=\"bg-slate-800/50 border-l-2 border-green-400 ml-4 mt-1 p-2 rounded text-xs text-slate-300 space-y-1\">\r\n                              {getLayerChanges(\r\n                                history.past[idx + 1] || project,\r\n                                entry\r\n                              ).map((change, changeIdx) => (\r\n                                <div key={changeIdx} className=\"text-slate-400\">\r\n                                   {change}\r\n                                </div>\r\n                              ))}\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Future History */}\r\n                {history.future.length > 0 && (\r\n                  <div>\r\n                    <div className=\"text-xs font-semibold text-blue-400 mb-2 px-1 mt-4\">\r\n                      REDO STACK ({history.future.length})\r\n                    </div>\r\n                    <div className=\"space-y-1\">\r\n                      {history.future.map((entry, idx) => (\r\n                        <div key={`future-${idx}`}>\r\n                          <button\r\n                            onClick={() =>\r\n                              setExpandedIndex(\r\n                                expandedIndex === `future-${idx}` ? null : `future-${idx}`\r\n                              )\r\n                            }\r\n                            className=\"w-full text-left bg-slate-800 hover:bg-slate-700 rounded px-3 py-2 text-xs transition-colors border border-slate-700 hover:border-slate-600\"\r\n                          >\r\n                            <div className=\"flex items-center gap-2\">\r\n                              <span className=\"text-blue-400\"></span>\r\n                              <span className=\"text-slate-300 flex-1\">\r\n                                {getProjectSummary(entry)}\r\n                              </span>\r\n                              <span className=\"text-slate-500\">\r\n                                {expandedIndex === `future-${idx}` ? '' : ''}\r\n                              </span>\r\n                            </div>\r\n                          </button>\r\n\r\n                          {/* Expanded Details */}\r\n                          {expandedIndex === `future-${idx}` && (\r\n                            <div className=\"bg-slate-800/50 border-l-2 border-blue-400 ml-4 mt-1 p-2 rounded text-xs text-slate-300 space-y-1\">\r\n                              {getLayerChanges(\r\n                                project,\r\n                                entry\r\n                              ).map((change, changeIdx) => (\r\n                                <div key={changeIdx} className=\"text-slate-400\">\r\n                                   {change}\r\n                                </div>\r\n                              ))}\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </>\r\n            )}\r\n          </div>\r\n\r\n          {/* Footer */}\r\n          <div className=\"bg-slate-800 px-6 py-3 border-t border-slate-700 text-xs text-slate-400\">\r\n            <div className=\"flex justify-between\">\r\n              <span>Stack size: {history.past.length + history.future.length}</span>\r\n              <span>Max steps: {history.maxSteps}</span>\r\n            </div>\r\n            <div className=\"text-slate-500 text-xs mt-1\">Press ESC or click overlay to close</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default DebugHistoryModal;\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport DraggableModal from './DraggableModal';\r\nimport useCompositorStore from '../../store/compositorStore';\r\nimport { Layer } from '../../types/compositor.types';\r\nimport { ALL_FONTS, SYSTEM_FONTS } from '../../utils/fonts';\r\nimport { rasterizeText } from '../../utils/textRasterizer';\r\n\r\ninterface TextLayerModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  existingLayer?: Layer; // If provided, we're editing an existing text layer\r\n}\r\n\r\nconst CANVAS_PREVIEW_LAYER_ID = '__text_canvas_preview__';\r\n\r\nconst TextLayerModal: React.FC<TextLayerModalProps> = ({ isOpen, onClose, existingLayer }) => {\r\n  const addLayer = useCompositorStore((state) => state.addLayer);\r\n  const updateLayer = useCompositorStore((state) => state.updateLayer);\r\n  const removeLayer = useCompositorStore((state) => state.removeLayer);\r\n  \r\n  // State\r\n  const [text, setText] = useState<string>('Enter your text here');\r\n  const [fontSize, setFontSize] = useState<number>(48);\r\n  const [fontFamily, setFontFamily] = useState<string>(SYSTEM_FONTS[0].value);\r\n  const [color, setColor] = useState<string>('#FFCDD2');\r\n  const [textAlign, setTextAlign] = useState<'left' | 'center' | 'right'>('left');\r\n  const [previewImage, setPreviewImage] = useState<string | null>(null);\r\n  const [isProcessing, setIsProcessing] = useState<boolean>(false);\r\n  const [fontSearch, setFontSearch] = useState<string>('');\r\n  const [isFontDropdownOpen, setIsFontDropdownOpen] = useState<boolean>(false);\r\n  const [previewOnCanvas, setPreviewOnCanvas] = useState<boolean>(false);\r\n  const [disableTransparency, setDisableTransparency] = useState<boolean>(true);\r\n  const [lineHeight, setLineHeight] = useState<number>(1.2);\r\n  const [letterSpacing, setLetterSpacing] = useState<number>(0);\r\n  const [fontWeight, setFontWeight] = useState<'normal' | 'bold' | 'lighter'>('normal');\r\n  const [previewX, setPreviewX] = useState<number>(0);\r\n  const [previewY, setPreviewY] = useState<number>(0);\r\n  \r\n  const dropdownRef = useRef<HTMLDivElement>(null);\r\n  const previewUpdateTimeoutRef = useRef<number | null>(null);\r\n  const originalVisibilityRef = useRef<boolean>(true);\r\n  \r\n  // Load existing layer data if editing\r\n  useEffect(() => {\r\n    if (existingLayer && existingLayer.textContent !== undefined) {\r\n      setText(existingLayer.textContent);\r\n      setFontSize(existingLayer.fontSize || 48);\r\n      setFontFamily(existingLayer.fontFamily || SYSTEM_FONTS[0].value);\r\n      setColor(existingLayer.fontColor || '#FFCDD2');\r\n      setTextAlign(existingLayer.textAlign || 'left');\r\n      setDisableTransparency(existingLayer.disableTransparency || false);\r\n      setLineHeight((existingLayer as any).lineHeight || 1.2);\r\n      setLetterSpacing((existingLayer as any).letterSpacing || 0);\r\n      setFontWeight((existingLayer as any).fontWeight || 'normal');\r\n      setPreviewX(existingLayer.x);\r\n      setPreviewY(existingLayer.y);\r\n      originalVisibilityRef.current = existingLayer.visible;\r\n    }\r\n  }, [existingLayer]);\r\n  \r\n  // Auto-generate preview when inputs change (only if modal is open)\r\n  useEffect(() => {\r\n    if (!isOpen || !text.trim()) {\r\n      return;\r\n    }\r\n    generatePreview();\r\n  }, [text, fontSize, fontFamily, color, textAlign, disableTransparency, lineHeight, letterSpacing, fontWeight, isOpen]);\r\n  \r\n  // Handle canvas preview\r\n  useEffect(() => {\r\n    if (previewOnCanvas && text.trim() && previewImage) {\r\n      // Hide existing layer immediately to avoid duplicates\r\n      if (existingLayer) {\r\n        const currentLayers = useCompositorStore.getState().project.layers;\r\n        const currentLayer = currentLayers.find(l => l.id === existingLayer.id);\r\n        if (currentLayer && currentLayer.visible) {\r\n          updateLayer(existingLayer.id, { visible: false });\r\n        }\r\n      }\r\n      \r\n      updateCanvasPreview();\r\n    } else {\r\n      removeCanvasPreview();\r\n    }\r\n  }, [previewOnCanvas, previewImage, text, previewX, previewY]);\r\n\r\n  // Sync preview position from store (handles dragging on canvas)\r\n  useEffect(() => {\r\n    if (!previewOnCanvas) return;\r\n\r\n    const unsubscribe = useCompositorStore.subscribe((state) => {\r\n      const previewLayer = state.project.layers.find(l => l.id === CANVAS_PREVIEW_LAYER_ID);\r\n      if (previewLayer) {\r\n        // Only update if position changed significantly to avoid loops\r\n        if (Math.abs(previewLayer.x - previewX) > 0.1 || Math.abs(previewLayer.y - previewY) > 0.1) {\r\n          setPreviewX(previewLayer.x);\r\n          setPreviewY(previewLayer.y);\r\n        }\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      unsubscribe();\r\n    };\r\n  }, [previewOnCanvas, previewX, previewY]);\r\n  \r\n  // Clean up canvas preview when modal closes\r\n  useEffect(() => {\r\n    if (!isOpen) {\r\n      removeCanvasPreview();\r\n    }\r\n  }, [isOpen]);\r\n  \r\n  // Close dropdown when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\r\n        setIsFontDropdownOpen(false);\r\n      }\r\n    };\r\n    \r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, []);\r\n  \r\n  const generatePreview = async () => {\r\n    if (!text.trim()) return;\r\n    \r\n    setIsProcessing(true);\r\n    \r\n    try {\r\n      const result = await rasterizeText({\r\n        text,\r\n        fontSize,\r\n        fontFamily,\r\n        color,\r\n        textAlign,\r\n        lineHeight,\r\n        disableTransparency,\r\n        letterSpacing,\r\n        fontWeight\r\n      });\r\n      \r\n      setPreviewImage(result.dataUrl);\r\n    } catch (error) {\r\n      console.error('Failed to generate text preview:', error);\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n  \r\n  const updateCanvasPreview = () => {\r\n    if (!previewImage || !previewOnCanvas) return;\r\n    \r\n    // Cancel any pending preview update\r\n    if (previewUpdateTimeoutRef.current !== null) {\r\n      clearTimeout(previewUpdateTimeoutRef.current);\r\n    }\r\n    \r\n    // Debounce the preview update to avoid race conditions\r\n    previewUpdateTimeoutRef.current = window.setTimeout(() => {\r\n      // Create temporary image to get dimensions\r\n      const img = new Image();\r\n      img.src = previewImage;\r\n      img.onload = () => {\r\n        // Double-check for existing preview after image loads\r\n        const latestLayers = useCompositorStore.getState().project.layers;\r\n        const stillExists = latestLayers.find(l => l.id === CANVAS_PREVIEW_LAYER_ID);\r\n        \r\n        if (stillExists) {\r\n          // Update existing preview layer\r\n          updateLayer(CANVAS_PREVIEW_LAYER_ID, {\r\n            imageData: previewImage,\r\n            width: img.naturalWidth,\r\n            height: img.naturalHeight,\r\n            opacity: 0.7, // Slightly transparent to indicate it's a preview\r\n            x: previewX,\r\n            y: previewY\r\n          });\r\n        } else if (previewOnCanvas) {\r\n          // Only create new preview layer if preview is still enabled and doesn't exist\r\n          const previewLayer: Layer = {\r\n            id: CANVAS_PREVIEW_LAYER_ID,\r\n            name: ' Canvas Preview (Temporary)',\r\n            imageData: previewImage,\r\n            x: previewX,\r\n            y: previewY,\r\n            zIndex: Date.now() + 1000000, // Very high z-index to appear on top\r\n            visible: true,\r\n            locked: false, // Allow dragging for positioning\r\n            opacity: 0.7,\r\n            width: img.naturalWidth,\r\n            height: img.naturalHeight\r\n          };\r\n          addLayer(previewLayer);\r\n        }\r\n      };\r\n    }, 50); // Small debounce delay\r\n  };\r\n  \r\n  const removeCanvasPreview = () => {\r\n    // Cancel any pending preview update\r\n    if (previewUpdateTimeoutRef.current !== null) {\r\n      clearTimeout(previewUpdateTimeoutRef.current);\r\n      previewUpdateTimeoutRef.current = null;\r\n    }\r\n    \r\n    const currentLayers = useCompositorStore.getState().project.layers;\r\n    const existingPreview = currentLayers.find(l => l.id === CANVAS_PREVIEW_LAYER_ID);\r\n    if (existingPreview) {\r\n      removeLayer(CANVAS_PREVIEW_LAYER_ID);\r\n    }\r\n\r\n    // Always restore existing layer visibility if we're editing a layer\r\n    // (we may have hidden it to show the preview)\r\n    if (existingLayer) {\r\n      const currentLayer = currentLayers.find(l => l.id === existingLayer.id);\r\n      if (currentLayer && !currentLayer.visible) {\r\n        updateLayer(existingLayer.id, { visible: true });\r\n      }\r\n    }\r\n  };\r\n  \r\n  const handleCreate = async () => {\r\n    if (!text.trim()) {\r\n      alert('Please enter some text');\r\n      return;\r\n    }\r\n    \r\n    setIsProcessing(true);\r\n    \r\n    try {\r\n      const result = await rasterizeText({\r\n        text,\r\n        fontSize,\r\n        fontFamily,\r\n        color,\r\n        textAlign,\r\n        lineHeight,\r\n        disableTransparency,\r\n        letterSpacing,\r\n        fontWeight\r\n      } as any);\r\n      \r\n      // Use preview position if canvas preview is enabled, otherwise use 0,0\r\n      const layerX = previewOnCanvas ? previewX : 0;\r\n      const layerY = previewOnCanvas ? previewY : 0;\r\n      \r\n      if (existingLayer) {\r\n        // Update existing layer\r\n        updateLayer(existingLayer.id, {\r\n          imageData: result.dataUrl,\r\n          width: result.width,\r\n          height: result.height,\r\n          x: layerX,\r\n          y: layerY,\r\n          textContent: text,\r\n          fontSize,\r\n          fontFamily,\r\n          fontColor: color,\r\n          textAlign,\r\n          disableTransparency,\r\n          name: existingLayer.name, // Keep existing name\r\n          ...(lineHeight !== 1.2 && { lineHeight }),\r\n          ...(letterSpacing !== 0 && { letterSpacing }),\r\n          ...(fontWeight !== 'normal' && { fontWeight })\r\n        } as any);\r\n      } else {\r\n        // Create new layer\r\n        const newLayer: Layer = {\r\n          id: crypto.randomUUID(),\r\n          name: `Text: ${text.substring(0, 20)}${text.length > 20 ? '...' : ''}`,\r\n          imageData: result.dataUrl,\r\n          x: layerX,\r\n          y: layerY,\r\n          zIndex: Date.now(),\r\n          visible: true,\r\n          locked: false,\r\n          opacity: 1,\r\n          width: result.width,\r\n          height: result.height,\r\n          textContent: text,\r\n          fontSize,\r\n          fontFamily,\r\n          fontColor: color,\r\n          textAlign,\r\n          disableTransparency,\r\n          ...(lineHeight !== 1.2 && { lineHeight }),\r\n          ...(letterSpacing !== 0 && { letterSpacing }),\r\n          ...(fontWeight !== 'normal' && { fontWeight })\r\n        } as any;\r\n        \r\n        addLayer(newLayer);\r\n      }\r\n      \r\n      // Remove canvas preview before closing\r\n      removeCanvasPreview();\r\n      onClose();\r\n    } catch (error) {\r\n      console.error('Failed to create text layer:', error);\r\n      alert('Failed to create text layer. Please try again.');\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n  \r\n  // Filter fonts based on search\r\n  const filteredFonts = ALL_FONTS.filter(font =>\r\n    font.name.toLowerCase().includes(fontSearch.toLowerCase())\r\n  );\r\n  \r\n  // Group filtered fonts by category\r\n  const filteredSystemFonts = filteredFonts.filter(f => f.category === 'system');\r\n  const filteredGoogleFonts = filteredFonts.filter(f => f.category === 'google');\r\n  \r\n  // Get selected font name for display\r\n  const selectedFont = ALL_FONTS.find(f => f.value === fontFamily);\r\n  \r\n  return (\r\n    <DraggableModal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title={existingLayer ? 'Edit Text Layer' : 'Create Text Layer'}\r\n      noPadding={true}\r\n      modalId=\"modal-text-layer\"\r\n    >\r\n      <div className=\"flex text-gray-200 h-full w-full overflow-hidden\">\r\n        {/* Left: Controls */}\r\n        <div className=\"w-80 border-r border-gray-700 flex-shrink-0 flex flex-col overflow-hidden bg-gray-800\">\r\n          <div className=\"overflow-y-auto flex-1 p-4 space-y-5\">\r\n            \r\n            {/* Text Input */}\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex justify-between items-center\">\r\n                <label className=\"text-xs font-semibold text-gray-400 uppercase\">Content</label>\r\n                <span className=\"text-xs text-gray-500\">{text.length} chars</span>\r\n              </div>\r\n              <textarea\r\n                value={text}\r\n                onChange={(e) => setText(e.target.value)}\r\n                placeholder=\"Enter text...\"\r\n                className=\"w-full h-20 px-3 py-2 bg-gray-900 border border-gray-600 rounded text-white text-sm resize-none focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n              />\r\n              <button\r\n                onClick={() => navigator.clipboard.writeText(text)}\r\n                disabled={!text.trim()}\r\n                className=\"w-full py-1 text-xs text-gray-400 hover:text-white bg-gray-700 hover:bg-gray-600 rounded transition-colors\"\r\n              >\r\n                Copy Text\r\n              </button>\r\n            </div>\r\n\r\n            {/* Font Settings */}\r\n            <div className=\"space-y-3 border-t border-gray-700 pt-3\">\r\n              <label className=\"text-xs font-semibold text-gray-400 uppercase\">Typography</label>\r\n              \r\n              {/* Font Family */}\r\n              <div className=\"relative\" ref={dropdownRef}>\r\n                <button\r\n                  onClick={() => setIsFontDropdownOpen(!isFontDropdownOpen)}\r\n                  className=\"w-full px-3 py-1.5 bg-gray-900 border border-gray-600 rounded text-white text-sm text-left flex items-center justify-between hover:bg-gray-700\"\r\n                >\r\n                  <span className=\"truncate\">{selectedFont?.name || 'Arial'}</span>\r\n                  <span className=\"text-gray-500 text-xs\"></span>\r\n                </button>\r\n                \r\n                {isFontDropdownOpen && (\r\n                  <div className=\"absolute top-full left-0 right-0 mt-1 bg-gray-800 border border-gray-600 rounded shadow-xl z-50 max-h-60 overflow-y-auto\">\r\n                    <div className=\"p-2 sticky top-0 bg-gray-800 border-b border-gray-700\">\r\n                      <input\r\n                        type=\"text\"\r\n                        value={fontSearch}\r\n                        onChange={(e) => setFontSearch(e.target.value)}\r\n                        placeholder=\"Search...\"\r\n                        className=\"w-full px-2 py-1 bg-gray-900 border border-gray-600 rounded text-white text-xs focus:outline-none focus:border-blue-500\"\r\n                        onClick={(e) => e.stopPropagation()}\r\n                        autoFocus\r\n                      />\r\n                    </div>\r\n                    {filteredSystemFonts.length > 0 && (\r\n                      <div>\r\n                        <div className=\"px-2 py-1 text-[10px] font-bold text-gray-500 uppercase bg-gray-800/50\">System</div>\r\n                        {filteredSystemFonts.map(font => (\r\n                          <button\r\n                            key={font.value}\r\n                            onClick={() => {\r\n                              setFontFamily(font.value);\r\n                              setIsFontDropdownOpen(false);\r\n                              setFontSearch('');\r\n                            }}\r\n                            className={`w-full px-3 py-1.5 text-left text-sm hover:bg-blue-600 hover:text-white ${fontFamily === font.value ? 'bg-blue-600 text-white' : 'text-gray-300'}`}\r\n                            style={{ fontFamily: font.value }}\r\n                          >\r\n                            {font.name}\r\n                          </button>\r\n                        ))}\r\n                      </div>\r\n                    )}\r\n                    {filteredGoogleFonts.length > 0 && (\r\n                      <div>\r\n                        <div className=\"px-2 py-1 text-[10px] font-bold text-gray-500 uppercase bg-gray-800/50 border-t border-gray-700\">Google Fonts</div>\r\n                        {filteredGoogleFonts.map(font => (\r\n                          <button\r\n                            key={font.value}\r\n                            onClick={() => {\r\n                              setFontFamily(font.value);\r\n                              setIsFontDropdownOpen(false);\r\n                              setFontSearch('');\r\n                            }}\r\n                            className={`w-full px-3 py-1.5 text-left text-sm hover:bg-blue-600 hover:text-white ${fontFamily === font.value ? 'bg-blue-600 text-white' : 'text-gray-300'}`}\r\n                            style={{ fontFamily: font.value }}\r\n                          >\r\n                            {font.name}\r\n                          </button>\r\n                        ))}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {/* Size & Weight */}\r\n              <div className=\"grid grid-cols-2 gap-2\">\r\n                <div>\r\n                  <label className=\"text-[10px] text-gray-500 mb-1 block\">Size</label>\r\n                  <input\r\n                    type=\"number\"\r\n                    value={fontSize}\r\n                    onChange={(e) => setFontSize(Math.max(1, Math.min(2000, parseInt(e.target.value) || 48)))}\r\n                    className=\"w-full px-2 py-1 bg-gray-900 border border-gray-600 rounded text-white text-sm\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label className=\"text-[10px] text-gray-500 mb-1 block\">Weight</label>\r\n                  <select \r\n                    value={fontWeight}\r\n                    onChange={(e) => setFontWeight(e.target.value as any)}\r\n                    className=\"w-full px-2 py-1 bg-gray-900 border border-gray-600 rounded text-white text-sm\"\r\n                  >\r\n                    <option value=\"lighter\">Light</option>\r\n                    <option value=\"normal\">Normal</option>\r\n                    <option value=\"bold\">Bold</option>\r\n                  </select>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Quick Sizes */}\r\n              <div className=\"flex flex-wrap gap-1\">\r\n                {[16, 24, 32, 48, 64, 96].map(size => (\r\n                  <button\r\n                    key={size}\r\n                    onClick={() => setFontSize(size)}\r\n                    className={`px-2 py-0.5 rounded text-[10px] border transition-colors ${\r\n                      fontSize === size\r\n                        ? 'bg-blue-600 border-blue-500 text-white'\r\n                        : 'bg-gray-700 border-gray-600 text-gray-400 hover:bg-gray-600 hover:text-gray-200'\r\n                    }`}\r\n                  >\r\n                    {size}\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Appearance */}\r\n            <div className=\"space-y-3 border-t border-gray-700 pt-3\">\r\n              <label className=\"text-xs font-semibold text-gray-400 uppercase\">Appearance</label>\r\n              \r\n              {/* Color */}\r\n              <div className=\"flex gap-2\">\r\n                <input\r\n                  type=\"color\"\r\n                  value={color}\r\n                  onChange={(e) => setColor(e.target.value)}\r\n                  className=\"w-8 h-8 rounded cursor-pointer bg-transparent border-0 p-0\"\r\n                />\r\n                <input\r\n                  type=\"text\"\r\n                  value={color}\r\n                  onChange={(e) => setColor(e.target.value)}\r\n                  className=\"flex-1 px-2 py-1 bg-gray-900 border border-gray-600 rounded text-white text-sm font-mono uppercase\"\r\n                />\r\n              </div>\r\n              \r\n              {/* Color Presets */}\r\n              <div className=\"space-y-1\">\r\n                {[\r\n                  // Grayscale\r\n                  ['#FFFFFF', '#E0E0E0', '#C0C0C0', '#A0A0A0', '#808080', '#606060', '#404040', '#202020', '#000000'],\r\n                  // Reds\r\n                  ['#FFCDD2', '#EF9A9A', '#E57373', '#EF5350', '#F44336', '#E53935', '#D32F2F', '#C62828', '#B71C1C'],\r\n                  // Oranges\r\n                  ['#FFE0B2', '#FFCC80', '#FFB74D', '#FFA726', '#FF9800', '#FB8C00', '#F57C00', '#EF6C00', '#E65100'],\r\n                  // Yellows\r\n                  ['#FFF9C4', '#FFF59D', '#FFF176', '#FFEE58', '#FFEB3B', '#FDD835', '#FBC02D', '#F9A825', '#F57F17'],\r\n                  // Greens\r\n                  ['#C8E6C9', '#A5D6A7', '#81C784', '#66BB6A', '#4CAF50', '#43A047', '#388E3C', '#2E7D32', '#1B5E20'],\r\n                  // Cyans/Teals\r\n                  ['#B2EBF2', '#80DEEA', '#4DD0E1', '#26C6DA', '#00BCD4', '#00ACC1', '#0097A7', '#00838F', '#006064'],\r\n                  // Blues\r\n                  ['#BBDEFB', '#90CAF9', '#64B5F6', '#42A5F5', '#2196F3', '#1E88E5', '#1976D2', '#1565C0', '#0D47A1'],\r\n                  // Purples\r\n                  ['#E1BEE7', '#CE93D8', '#BA68C8', '#AB47BC', '#9C27B0', '#8E24AA', '#7B1FA2', '#6A1B9A', '#4A148C'],\r\n                  // Pinks\r\n                  ['#F8BBD0', '#F48FB1', '#F06292', '#EC407A', '#E91E63', '#D81B60', '#C2185B', '#AD1457', '#880E4F'],\r\n                ].map((row, i) => (\r\n                  <div key={i} className=\"flex gap-1\">\r\n                    {row.map(preset => (\r\n                      <button\r\n                        key={preset}\r\n                        onClick={() => setColor(preset)}\r\n                        className={`flex-1 aspect-square rounded-sm border ${color === preset ? 'border-white scale-110 z-10' : 'border-gray-600 hover:border-gray-400'}`}\r\n                        style={{ backgroundColor: preset }}\r\n                        title={preset}\r\n                      />\r\n                    ))}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n\r\n              {/* Alignment */}\r\n              <div>\r\n                <label className=\"text-[10px] text-gray-500 mb-1 block\">Alignment</label>\r\n                <div className=\"bg-gray-900 rounded border border-gray-600 p-0.5 flex\">\r\n                  {(['left', 'center', 'right'] as const).map(align => (\r\n                    <button\r\n                      key={align}\r\n                      onClick={() => setTextAlign(align)}\r\n                      className={`flex-1 py-1 rounded text-xs capitalize ${textAlign === align ? 'bg-gray-700 text-white shadow-sm' : 'text-gray-400 hover:text-gray-300'}`}\r\n                      title={`Align ${align}`}\r\n                    >\r\n                      {align}\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Spacing */}\r\n            <div className=\"space-y-3 border-t border-gray-700 pt-3\">\r\n              <label className=\"text-xs font-semibold text-gray-400 uppercase\">Spacing</label>\r\n              \r\n              <div className=\"space-y-3\">\r\n                <div>\r\n                  <div className=\"flex justify-between text-[10px] text-gray-500 mb-1\">\r\n                    <span>Line Height</span>\r\n                    <span>{lineHeight.toFixed(1)}</span>\r\n                  </div>\r\n                  <input\r\n                    type=\"range\"\r\n                    min=\"0.8\"\r\n                    max=\"2.0\"\r\n                    step=\"0.1\"\r\n                    value={lineHeight}\r\n                    onChange={(e) => setLineHeight(parseFloat(e.target.value))}\r\n                    className=\"w-full h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <div className=\"flex justify-between text-[10px] text-gray-500 mb-1\">\r\n                    <span>Letter Spacing</span>\r\n                    <span>{letterSpacing}px</span>\r\n                  </div>\r\n                  <input\r\n                    type=\"range\"\r\n                    min=\"-5\"\r\n                    max=\"10\"\r\n                    step=\"0.5\"\r\n                    value={letterSpacing}\r\n                    onChange={(e) => setLetterSpacing(parseFloat(e.target.value))}\r\n                    className=\"w-full h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer\"\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Options */}\r\n            <div className=\"pt-2\">\r\n              <label className=\"flex items-center gap-2 text-xs text-gray-300 cursor-pointer hover:text-white select-none\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={disableTransparency}\r\n                  onChange={(e) => setDisableTransparency(e.target.checked)}\r\n                  className=\"rounded bg-gray-700 border-gray-600 text-blue-600 focus:ring-offset-gray-800\"\r\n                />\r\n                <span>Pixel Perfect (No AA)</span>\r\n              </label>\r\n            </div>\r\n\r\n          </div>\r\n\r\n          {/* Footer Actions */}\r\n          <div className=\"p-4 border-t border-gray-700 bg-gray-800/50\">\r\n            <button\r\n              onClick={handleCreate}\r\n              disabled={isProcessing || !text.trim()}\r\n              className=\"w-full py-2 bg-blue-600 hover:bg-blue-500 disabled:bg-gray-700 disabled:text-gray-500 rounded text-white font-semibold transition-colors text-sm\"\r\n            >\r\n              {existingLayer ? 'Update Layer' : 'Create Layer'}\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Right: Preview */}\r\n        <div className=\"flex-1 bg-gray-900 relative flex flex-col min-w-0\">\r\n          {/* Preview Header */}\r\n          <div className=\"h-10 border-b border-gray-700 flex items-center justify-between px-4 bg-gray-800/30\">\r\n            <span className=\"text-xs font-semibold text-gray-400 uppercase\">Preview</span>\r\n            <label className=\"flex items-center gap-2 text-xs text-gray-400 cursor-pointer hover:text-gray-200 select-none\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={previewOnCanvas}\r\n                onChange={(e) => setPreviewOnCanvas(e.target.checked)}\r\n                className=\"rounded bg-gray-700 border-gray-600 text-blue-600 focus:ring-offset-gray-800\"\r\n              />\r\n              <span>Show on Canvas</span>\r\n            </label>\r\n          </div>\r\n\r\n          {/* Preview Area */}\r\n          <div className=\"flex-1 overflow-auto flex items-center justify-center p-8 bg-[url('/grid-pattern.png')] bg-repeat\">\r\n            {isProcessing ? (\r\n              <div className=\"flex items-center gap-2 text-gray-400 text-sm\">\r\n                <div className=\"w-2 h-2 bg-blue-500 rounded-full animate-pulse\"></div>\r\n                Rendering...\r\n              </div>\r\n            ) : previewImage ? (\r\n              <div className=\"relative\">\r\n                <img\r\n                  src={previewImage}\r\n                  alt=\"Text preview\"\r\n                  className=\"max-w-full max-h-full object-contain\"\r\n                  style={{ imageRendering: 'pixelated' }}\r\n                />\r\n              </div>\r\n            ) : (\r\n              <div className=\"text-gray-600 text-sm italic\">\r\n                Enter text to generate preview\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </DraggableModal>\r\n  );\r\n};\r\n\r\nexport default TextLayerModal;\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport DraggableModal from './DraggableModal';\r\nimport useCompositorStore from '../../store/compositorStore';\r\nimport { Layer } from '../../types/compositor.types';\r\nimport { rasterizeShape } from '../../utils/shapeRasterizer';\r\n\r\ninterface ShapeModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  existingLayer?: Layer;\r\n}\r\n\r\nconst CANVAS_PREVIEW_LAYER_ID = '__shape_canvas_preview__';\r\nconst SHAPE_TYPES = ['rectangle', 'circle', 'triangle', 'hexagon', 'octagon', 'star'] as const;\r\n\r\nconst ShapeModal: React.FC<ShapeModalProps> = ({ isOpen, onClose, existingLayer }) => {\r\n  const addLayer = useCompositorStore((state) => state.addLayer);\r\n  const updateLayer = useCompositorStore((state) => state.updateLayer);\r\n  const removeLayer = useCompositorStore((state) => state.removeLayer);\r\n\r\n  const [shapeType, setShapeType] = useState<'rectangle' | 'circle' | 'triangle' | 'hexagon' | 'octagon' | 'star'>('rectangle');\r\n  const [size, setSize] = useState<number>(200);\r\n  const [stretchX, setStretchX] = useState<number>(1);\r\n  const [stretchY, setStretchY] = useState<number>(1);\r\n  const [color, setColor] = useState<string>('#FFFFFF');\r\n  const [previewImage, setPreviewImage] = useState<string | null>(null);\r\n  const [isProcessing, setIsProcessing] = useState<boolean>(false);\r\n  const [previewOnCanvas, setPreviewOnCanvas] = useState<boolean>(true);\r\n  const [previewX, setPreviewX] = useState<number>(0);\r\n  const [previewY, setPreviewY] = useState<number>(0);\r\n\r\n  const previewUpdateTimeoutRef = useRef<number | null>(null);\r\n  const originalVisibilityRef = useRef<boolean>(true);\r\n\r\n  // Load existing layer data if editing\r\n  useEffect(() => {\r\n    if (existingLayer && existingLayer.shapeType !== undefined) {\r\n      setShapeType(existingLayer.shapeType);\r\n      setSize(existingLayer.shapeSize || 200);\r\n      setStretchX(existingLayer.shapeStretchX || 1);\r\n      setStretchY(existingLayer.shapeStretchY || 1);\r\n      setColor(existingLayer.shapeColor || '#FFFFFF');\r\n      setPreviewX(existingLayer.x);\r\n      setPreviewY(existingLayer.y);\r\n      originalVisibilityRef.current = existingLayer.visible;\r\n    }\r\n  }, [existingLayer]);\r\n  // Auto-generate preview when inputs change (only if modal is open)\r\n  useEffect(() => {\r\n    if (!isOpen) return;\r\n    generatePreview();\r\n  }, [shapeType, size, stretchX, stretchY, color, isOpen]);\r\n\r\n  // Handle canvas preview\r\n  useEffect(() => {\r\n    if (previewOnCanvas && previewImage) {\r\n      // Hide existing layer immediately to avoid duplicates\r\n      if (existingLayer) {\r\n        const currentLayers = useCompositorStore.getState().project.layers;\r\n        const currentLayer = currentLayers.find(l => l.id === existingLayer.id);\r\n        if (currentLayer && currentLayer.visible) {\r\n          updateLayer(existingLayer.id, { visible: false });\r\n        }\r\n      }\r\n\r\n      updateCanvasPreview();\r\n    } else {\r\n      removeCanvasPreview();\r\n    }\r\n  }, [previewOnCanvas, previewImage, previewX, previewY]);\r\n\r\n  // Sync preview position from store (handles dragging on canvas)\r\n  useEffect(() => {\r\n    if (!previewOnCanvas) return;\r\n\r\n    const unsubscribe = useCompositorStore.subscribe((state) => {\r\n      const previewLayer = state.project.layers.find(l => l.id === CANVAS_PREVIEW_LAYER_ID);\r\n      if (previewLayer) {\r\n        // Only update if position changed significantly to avoid loops\r\n        if (Math.abs(previewLayer.x - previewX) > 0.1 || Math.abs(previewLayer.y - previewY) > 0.1) {\r\n          setPreviewX(previewLayer.x);\r\n          setPreviewY(previewLayer.y);\r\n        }\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      unsubscribe();\r\n    };\r\n  }, [previewOnCanvas, previewX, previewY]);\r\n\r\n  // Clean up canvas preview when modal closes\r\n  useEffect(() => {\r\n    if (!isOpen) {\r\n      removeCanvasPreview();\r\n    }\r\n  }, [isOpen]);\r\n\r\n  const generatePreview = async () => {\r\n    setIsProcessing(true);\r\n\r\n    try {\r\n      const result = await rasterizeShape({\r\n        shapeType,\r\n        size,\r\n        stretchX,\r\n        stretchY,\r\n        color,\r\n      });\r\n\r\n      setPreviewImage(result.dataUrl);\r\n    } catch (error) {\r\n      console.error('Failed to generate shape preview:', error);\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n\r\n  const updateCanvasPreview = () => {\r\n    if (!previewImage || !previewOnCanvas) return;\r\n\r\n    // Cancel any pending preview update\r\n    if (previewUpdateTimeoutRef.current !== null) {\r\n      clearTimeout(previewUpdateTimeoutRef.current);\r\n    }\r\n\r\n    // Debounce the preview update to avoid race conditions\r\n    previewUpdateTimeoutRef.current = window.setTimeout(() => {\r\n      const img = new Image();\r\n      img.src = previewImage;\r\n      img.onload = () => {\r\n        const latestLayers = useCompositorStore.getState().project.layers;\r\n        const stillExists = latestLayers.find(l => l.id === CANVAS_PREVIEW_LAYER_ID);\r\n\r\n        if (stillExists) {\r\n          // Update existing preview layer\r\n          updateLayer(CANVAS_PREVIEW_LAYER_ID, {\r\n            imageData: previewImage,\r\n            width: img.naturalWidth,\r\n            height: img.naturalHeight,\r\n            opacity: 0.7,\r\n            x: previewX,\r\n            y: previewY\r\n          });\r\n        } else if (previewOnCanvas) {\r\n          // Only create new preview layer if preview is still enabled and doesn't exist\r\n          const previewLayer: Layer = {\r\n            id: CANVAS_PREVIEW_LAYER_ID,\r\n            name: ' Canvas Preview (Temporary)',\r\n            imageData: previewImage,\r\n            x: previewX,\r\n            y: previewY,\r\n            zIndex: Date.now() + 1000000,\r\n            visible: true,\r\n            locked: false, // Allow dragging\r\n            opacity: 0.7,\r\n            width: img.naturalWidth,\r\n            height: img.naturalHeight\r\n          };\r\n          addLayer(previewLayer);\r\n        }\r\n      };\r\n    }, 50);\r\n  };\r\n\r\n  const removeCanvasPreview = () => {\r\n    if (previewUpdateTimeoutRef.current !== null) {\r\n      clearTimeout(previewUpdateTimeoutRef.current);\r\n      previewUpdateTimeoutRef.current = null;\r\n    }\r\n\r\n    const currentLayers = useCompositorStore.getState().project.layers;\r\n    const preview = currentLayers.find(l => l.id === CANVAS_PREVIEW_LAYER_ID);\r\n\r\n    if (preview) {\r\n      removeLayer(CANVAS_PREVIEW_LAYER_ID);\r\n    }\r\n\r\n    // Restore original layer visibility if we were editing\r\n    if (existingLayer) {\r\n      const currentLayer = useCompositorStore\r\n        .getState()\r\n        .project.layers.find(l => l.id === existingLayer.id);\r\n      if (currentLayer && !currentLayer.visible) {\r\n        updateLayer(existingLayer.id, { visible: originalVisibilityRef.current });\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleCreateShape = async () => {\r\n    if (!previewImage) return;\r\n\r\n    setIsProcessing(true);\r\n\r\n    try {\r\n      const result = await rasterizeShape({\r\n        shapeType,\r\n        size,\r\n        stretchX,\r\n        stretchY,\r\n        color,\r\n      });\r\n\r\n      const layerX = previewOnCanvas ? previewX : -result.offsetX;\r\n      const layerY = previewOnCanvas ? previewY : -result.offsetY;\r\n\r\n      if (existingLayer) {\r\n        // Update existing layer\r\n        updateLayer(existingLayer.id, {\r\n          imageData: result.dataUrl,\r\n          width: result.width,\r\n          height: result.height,\r\n          x: layerX,\r\n          y: layerY,\r\n          shapeType,\r\n          shapeSize: size,\r\n          shapeStretchX: stretchX,\r\n          shapeStretchY: stretchY,\r\n          shapeColor: color,\r\n          name: existingLayer.name,\r\n        } as any);\r\n      } else {\r\n        // Create new layer\r\n        const newLayer: Layer = {\r\n          id: crypto.randomUUID(),\r\n          name: `Shape: ${shapeType}`,\r\n          imageData: result.dataUrl,\r\n          x: layerX,\r\n          y: layerY,\r\n          zIndex: Date.now(),\r\n          visible: true,\r\n          locked: false,\r\n          opacity: 1,\r\n          width: result.width,\r\n          height: result.height,\r\n          shapeType,\r\n          shapeSize: size,\r\n          shapeStretchX: stretchX,\r\n          shapeStretchY: stretchY,\r\n          shapeColor: color,\r\n        } as any;\r\n\r\n        addLayer(newLayer);\r\n      }\r\n\r\n      // Remove canvas preview before closing\r\n      removeCanvasPreview();\r\n      onClose();\r\n    } catch (error) {\r\n      console.error('Failed to create shape layer:', error);\r\n      alert('Failed to create shape layer. Please try again.');\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <DraggableModal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title={existingLayer ? 'Edit Shape Layer' : 'Create Shape Layer'}\r\n      noPadding={true}\r\n      modalId=\"modal-shape\"\r\n    >\r\n      <div className=\"flex text-gray-200 h-full w-full overflow-hidden\">\r\n        {/* Left: Controls */}\r\n        <div className=\"w-80 border-r border-gray-700 flex-shrink-0 flex flex-col overflow-hidden bg-gray-800\">\r\n          <div className=\"overflow-y-auto flex-1 p-4 space-y-4\">\r\n            \r\n            {/* Shape Type Selection */}\r\n            <div className=\"space-y-2\">\r\n              <label className=\"text-xs font-semibold text-gray-400 uppercase\">Shape</label>\r\n              <div className=\"grid grid-cols-3 gap-1\">\r\n                {SHAPE_TYPES.map((type) => (\r\n                  <button\r\n                    key={type}\r\n                    onClick={() => setShapeType(type)}\r\n                    className={`px-2 py-2 text-[10px] font-medium rounded transition-colors capitalize ${\r\n                      shapeType === type\r\n                        ? 'bg-blue-600 text-white'\r\n                        : 'bg-gray-700 text-gray-300 hover:bg-gray-600'\r\n                    }`}\r\n                  >\r\n                    {type}\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Size Control */}\r\n            <div className=\"space-y-2 border-t border-gray-700 pt-3\">\r\n              <label className=\"text-xs font-semibold text-gray-400 uppercase\">Size</label>\r\n              <div className=\"space-y-1\">\r\n                <input\r\n                  type=\"range\"\r\n                  min=\"1\"\r\n                  max=\"500\"\r\n                  value={size}\r\n                  onChange={(e) => setSize(Number(e.target.value))}\r\n                  className=\"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer\"\r\n                />\r\n                <div className=\"flex items-center gap-2\">\r\n                  <span className=\"text-xs text-gray-500\">{size}px</span>\r\n                  <input\r\n                    type=\"number\"\r\n                    value={size}\r\n                    onChange={(e) => setSize(Math.max(1, Math.min(500, parseInt(e.target.value) || size)))}\r\n                    className=\"flex-1 px-2 py-1 bg-gray-900 border border-gray-600 rounded text-xs text-white\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              {/* Quick Sizes */}\r\n              <div className=\"flex flex-wrap gap-1\">\r\n                {[50, 100, 150, 200, 300, 400].map(s => (\r\n                  <button\r\n                    key={s}\r\n                    onClick={() => setSize(s)}\r\n                    className={`px-2 py-0.5 rounded text-[10px] border transition-colors ${\r\n                      size === s\r\n                        ? 'bg-blue-600 border-blue-500 text-white'\r\n                        : 'bg-gray-700 border-gray-600 text-gray-400 hover:bg-gray-600'\r\n                    }`}\r\n                  >\r\n                    {s}\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Stretch Controls - Horizontal and Vertical */}\r\n            <div className=\"space-y-2 border-t border-gray-700 pt-3\">\r\n              <div className=\"flex justify-between items-center\">\r\n                <label className=\"text-xs font-semibold text-gray-400 uppercase\">Stretch</label>\r\n                <button \r\n                  onClick={() => { setStretchX(1); setStretchY(1); }}\r\n                  className=\"text-[10px] text-blue-400 hover:text-blue-300\"\r\n                >\r\n                  Reset\r\n                </button>\r\n              </div>\r\n              \r\n              {/* Horizontal Stretch */}\r\n              <div className=\"space-y-1\">\r\n                <div className=\"flex justify-between text-[10px] text-gray-500\">\r\n                  <span>Horizontal</span>\r\n                  <span>{stretchX.toFixed(2)}x</span>\r\n                </div>\r\n                <input\r\n                  type=\"range\"\r\n                  min=\"0.1\"\r\n                  max=\"20\"\r\n                  step=\"0.1\"\r\n                  value={stretchX}\r\n                  onChange={(e) => setStretchX(Number(e.target.value))}\r\n                  className=\"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer\"\r\n                />\r\n              </div>\r\n\r\n              {/* Vertical Stretch */}\r\n              <div className=\"space-y-1\">\r\n                <div className=\"flex justify-between text-[10px] text-gray-500\">\r\n                  <span>Vertical</span>\r\n                  <span>{stretchY.toFixed(2)}x</span>\r\n                </div>\r\n                <input\r\n                  type=\"range\"\r\n                  min=\"0.1\"\r\n                  max=\"20\"\r\n                  step=\"0.1\"\r\n                  value={stretchY}\r\n                  onChange={(e) => setStretchY(Number(e.target.value))}\r\n                  className=\"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Appearance */}\r\n            <div className=\"space-y-3 border-t border-gray-700 pt-3\">\r\n              <label className=\"text-xs font-semibold text-gray-400 uppercase\">Appearance</label>\r\n              \r\n              {/* Color */}\r\n              <div className=\"flex gap-2\">\r\n                <input\r\n                  type=\"color\"\r\n                  value={color}\r\n                  onChange={(e) => setColor(e.target.value)}\r\n                  className=\"w-8 h-8 rounded cursor-pointer bg-transparent border-0 p-0\"\r\n                />\r\n                <input\r\n                  type=\"text\"\r\n                  value={color}\r\n                  onChange={(e) => setColor(e.target.value)}\r\n                  className=\"flex-1 px-2 py-1 bg-gray-900 border border-gray-600 rounded text-white text-sm font-mono uppercase\"\r\n                />\r\n              </div>\r\n              \r\n              {/* Color Presets */}\r\n              <div className=\"space-y-1\">\r\n                {[\r\n                  // Grayscale\r\n                  ['#FFFFFF', '#E0E0E0', '#C0C0C0', '#A0A0A0', '#808080', '#606060', '#404040', '#202020', '#000000'],\r\n                  // Reds\r\n                  ['#FFCDD2', '#EF9A9A', '#E57373', '#EF5350', '#F44336', '#E53935', '#D32F2F', '#C62828', '#B71C1C'],\r\n                  // Oranges\r\n                  ['#FFE0B2', '#FFCC80', '#FFB74D', '#FFA726', '#FF9800', '#FB8C00', '#F57C00', '#EF6C00', '#E65100'],\r\n                  // Yellows\r\n                  ['#FFF9C4', '#FFF59D', '#FFF176', '#FFEE58', '#FFEB3B', '#FDD835', '#FBC02D', '#F9A825', '#F57F17'],\r\n                  // Greens\r\n                  ['#C8E6C9', '#A5D6A7', '#81C784', '#66BB6A', '#4CAF50', '#43A047', '#388E3C', '#2E7D32', '#1B5E20'],\r\n                  // Cyans/Teals\r\n                  ['#B2EBF2', '#80DEEA', '#4DD0E1', '#26C6DA', '#00BCD4', '#00ACC1', '#0097A7', '#00838F', '#006064'],\r\n                  // Blues\r\n                  ['#BBDEFB', '#90CAF9', '#64B5F6', '#42A5F5', '#2196F3', '#1E88E5', '#1976D2', '#1565C0', '#0D47A1'],\r\n                  // Purples\r\n                  ['#E1BEE7', '#CE93D8', '#BA68C8', '#AB47BC', '#9C27B0', '#8E24AA', '#7B1FA2', '#6A1B9A', '#4A148C'],\r\n                  // Pinks\r\n                  ['#F8BBD0', '#F48FB1', '#F06292', '#EC407A', '#E91E63', '#D81B60', '#C2185B', '#AD1457', '#880E4F'],\r\n                ].map((row, i) => (\r\n                  <div key={i} className=\"flex gap-1\">\r\n                    {row.map(preset => (\r\n                      <button\r\n                        key={preset}\r\n                        onClick={() => setColor(preset)}\r\n                        className={`flex-1 aspect-square rounded-sm border ${color === preset ? 'border-white scale-110 z-10' : 'border-gray-600 hover:border-gray-400'}`}\r\n                        style={{ backgroundColor: preset }}\r\n                        title={preset}\r\n                      />\r\n                    ))}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Canvas Preview Toggle */}\r\n            <div className=\"space-y-2 border-t border-gray-700 pt-3\">\r\n              <label className=\"flex items-center gap-2 text-xs font-semibold text-gray-400 uppercase cursor-pointer\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={previewOnCanvas}\r\n                  onChange={(e) => setPreviewOnCanvas(e.target.checked)}\r\n                  className=\"rounded cursor-pointer\"\r\n                />\r\n                Preview on Canvas\r\n              </label>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Buttons */}\r\n          <div className=\"border-t border-gray-700 p-3 space-y-2\">\r\n            <button\r\n              onClick={handleCreateShape}\r\n              disabled={isProcessing}\r\n              className=\"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-xs font-semibold rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed uppercase\"\r\n            >\r\n              {isProcessing ? 'Processing...' : existingLayer ? 'Update' : 'Create'}\r\n            </button>\r\n            <button\r\n              onClick={onClose}\r\n              className=\"w-full px-4 py-2 bg-gray-700 hover:bg-gray-600 text-gray-300 text-xs font-semibold rounded transition-colors uppercase\"\r\n            >\r\n              Cancel\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Right: Preview */}\r\n        <div className=\"flex-1 bg-gray-900 relative flex flex-col min-w-0\">\r\n          {/* Preview Header */}\r\n          <div className=\"h-10 border-b border-gray-700 flex items-center justify-between px-4 bg-gray-800/30\">\r\n            <span className=\"text-xs font-semibold text-gray-400 uppercase\">Preview</span>\r\n            <label className=\"flex items-center gap-2 text-xs text-gray-400 cursor-pointer hover:text-gray-200 select-none\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={previewOnCanvas}\r\n                onChange={(e) => setPreviewOnCanvas(e.target.checked)}\r\n                className=\"rounded bg-gray-700 border-gray-600 text-blue-600 focus:ring-offset-gray-800\"\r\n              />\r\n              <span>Show on Canvas</span>\r\n            </label>\r\n          </div>\r\n\r\n          {/* Preview Area */}\r\n          <div className=\"flex-1 overflow-auto flex items-center justify-center p-8 bg-[url('/grid-pattern.png')] bg-repeat\">\r\n            {isProcessing ? (\r\n              <div className=\"flex items-center gap-2 text-gray-400 text-sm\">\r\n                <div className=\"w-2 h-2 bg-blue-500 rounded-full animate-pulse\"></div>\r\n                Rendering...\r\n              </div>\r\n            ) : previewImage ? (\r\n              <div className=\"relative\">\r\n                <img\r\n                  src={previewImage}\r\n                  alt=\"Shape preview\"\r\n                  className=\"max-w-full max-h-full object-contain\"\r\n                  style={{ imageRendering: 'pixelated' }}\r\n                />\r\n              </div>\r\n            ) : (\r\n              <div className=\"text-gray-600 text-sm italic\">\r\n                Configure shape to generate preview\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </DraggableModal>\r\n  );\r\n};\r\n\r\nexport default ShapeModal;\r\n","/**\r\n * Custom hook for handling keyboard shortcuts\r\n * Implements all essential shortcuts from the requirements\r\n */\r\n\r\nimport { useEffect, useRef } from 'react';\r\nimport useCompositorStore from '../store/compositorStore';\r\n\r\nexport function useKeyboardShortcuts() {\r\n  const project = useCompositorStore((state) => state.project);\r\n  const selectedLayerIds = useCompositorStore((state) => state.selectedLayerIds);\r\n  const selectAllLayers = useCompositorStore((state) => state.selectAllLayers);\r\n  const deselectAllLayers = useCompositorStore((state) => state.deselectAllLayers);\r\n  const deleteSelectedLayers = useCompositorStore((state) => state.deleteSelectedLayers);\r\n  const moveSelectedLayers = useCompositorStore((state) => state.moveSelectedLayers);\r\n  const setViewport = useCompositorStore((state) => state.setViewport);\r\n  const undo = useCompositorStore((state) => state.undo);\r\n  const redo = useCompositorStore((state) => state.redo);\r\n  const copySelectedLayers = useCompositorStore((state) => state.copySelectedLayers);\r\n  const copySelectedLayersToClipboard = useCompositorStore((state) => state.copySelectedLayersToClipboard);\r\n  const pasteSelectedLayers = useCompositorStore((state) => state.pasteSelectedLayers);\r\n  const pasteFromClipboard = useCompositorStore((state) => state.pasteFromClipboard);\r\n  const reorderSelectedLayers = useCompositorStore((state) => state.reorderSelectedLayers);\r\n\r\n  const isPanningRef = useRef(false);\r\n  const panStartXRef = useRef(0);\r\n  const panStartYRef = useRef(0);\r\n  const keysHeldRef = useRef<Set<string>>(new Set());\r\n  const movementIntervalRef = useRef<number | null>(null);\r\n\r\n  // Handle continuous movement when keys are held\r\n  const startContinuousMovement = () => {\r\n    if (movementIntervalRef.current !== null) return;\r\n    if (selectedLayerIds.length === 0) return;\r\n\r\n    movementIntervalRef.current = window.setInterval(() => {\r\n      let totalDx = 0;\r\n      let totalDy = 0;\r\n\r\n      const movements: Record<string, [number, number]> = {\r\n        ArrowUp: [0, -1],\r\n        ArrowDown: [0, 1],\r\n        ArrowLeft: [-1, 0],\r\n        ArrowRight: [1, 0],\r\n      };\r\n\r\n      // Check all arrow keys\r\n      for (const [key, [dx, dy]] of Object.entries(movements)) {\r\n        if (keysHeldRef.current.has(key)) {\r\n          totalDx += dx;\r\n          totalDy += dy;\r\n        }\r\n      }\r\n\r\n      // Check shift for 10px nudges\r\n      if (keysHeldRef.current.has('ShiftLeft') || keysHeldRef.current.has('ShiftRight')) {\r\n        totalDx *= 10;\r\n        totalDy *= 10;\r\n      }\r\n\r\n      if (totalDx !== 0 || totalDy !== 0) {\r\n        moveSelectedLayers(totalDx, totalDy);\r\n      }\r\n    }, 50); // 50ms per movement\r\n  };\r\n\r\n  const stopContinuousMovement = () => {\r\n    if (movementIntervalRef.current !== null) {\r\n      clearInterval(movementIntervalRef.current);\r\n      movementIntervalRef.current = null;\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const handleKeyDown = (event: KeyboardEvent) => {\r\n      // Ignore if typing in an input field\r\n      if (event.target instanceof HTMLInputElement || event.target instanceof HTMLTextAreaElement) {\r\n        // Allow Ctrl+S and Ctrl+O even in input fields\r\n        if (!((event.ctrlKey || event.metaKey) && (event.key === 's' || event.key === 'o'))) {\r\n          return;\r\n        }\r\n      }\r\n\r\n      const isCtrlOrCmd = event.ctrlKey || event.metaKey;\r\n      const isShift = event.shiftKey;\r\n\r\n      // Spacebar: Start pan mode\r\n      if (event.code === 'Space' && !event.repeat) {\r\n        event.preventDefault();\r\n        isPanningRef.current = true;\r\n        // console.log('[DEBUG] Pan mode activated (Spacebar)');\r\n        return;\r\n      }\r\n\r\n      // Shift + Up/Down: Reorder selected layers (check BEFORE adding to keysHeld)\r\n      if (isShift && !isCtrlOrCmd && (event.key === 'ArrowUp' || event.key === 'ArrowDown')) {\r\n        if (selectedLayerIds.length > 0) {\r\n          event.preventDefault();\r\n          const direction = event.key === 'ArrowUp' ? 'up' : 'down';\r\n          // console.log(`[DEBUG] Reorder layers triggered by Shift+${event.key} - moving ${direction}`);\r\n          reorderSelectedLayers(direction);\r\n        }\r\n        return;\r\n      }\r\n\r\n      // Arrow keys for nudging (add to held keys for continuous movement)\r\n      // Only if NOT shift (since shift is for layer reordering)\r\n      if (!isShift && ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(event.key)) {\r\n        event.preventDefault();\r\n        keysHeldRef.current.add(event.key);\r\n        if (keysHeldRef.current.has('ShiftLeft') || keysHeldRef.current.has('ShiftRight')) {\r\n          keysHeldRef.current.add('ShiftLeft');\r\n        }\r\n        startContinuousMovement();\r\n        return;\r\n      }\r\n\r\n      // Track Shift key for 10px movement\r\n      if (event.key === 'Shift') {\r\n        keysHeldRef.current.add(event.code);\r\n        return;\r\n      }\r\n\r\n      // Ctrl/Cmd + Z: Undo\r\n      if (isCtrlOrCmd && event.key.toLowerCase() === 'z' && !isShift) {\r\n        event.preventDefault();\r\n        // console.log('[DEBUG] Undo triggered by Ctrl+Z');\r\n        undo();\r\n        return;\r\n      }\r\n\r\n      // Ctrl/Cmd + Shift + Z: Redo\r\n      if (isCtrlOrCmd && event.key.toLowerCase() === 'z' && isShift) {\r\n        event.preventDefault();\r\n        // console.log('[DEBUG] Redo triggered by Ctrl+Shift+Z');\r\n        redo();\r\n        return;\r\n      }\r\n\r\n      // Ctrl/Cmd + Y: Redo (auxiliary binding)\r\n      if (isCtrlOrCmd && event.key.toLowerCase() === 'y') {\r\n        event.preventDefault();\r\n        // console.log('[DEBUG] Redo triggered by Ctrl+Y');\r\n        redo();\r\n        return;\r\n      }\r\n\r\n      // Delete / Backspace: Remove selected layers\r\n      if (event.key === 'Delete' || event.key === 'Backspace') {\r\n        if (selectedLayerIds.length > 0) {\r\n          event.preventDefault();\r\n          const confirmed = window.confirm(\r\n            `Delete ${selectedLayerIds.length} layer${selectedLayerIds.length !== 1 ? 's' : ''}?`\r\n          );\r\n          if (confirmed) {\r\n            // console.log(`[DEBUG] Delete triggered by ${event.key} - removing ${selectedLayerIds.length} layer(s)`);\r\n            deleteSelectedLayers();\r\n          }\r\n        }\r\n        return;\r\n      }\r\n\r\n      // Ctrl/Cmd + A: Select all layers\r\n      if (isCtrlOrCmd && event.key === 'a') {\r\n        event.preventDefault();\r\n        if (project.layers.length > 0) {\r\n          // console.log('[DEBUG] Select all triggered by Ctrl+A');\r\n          selectAllLayers();\r\n        }\r\n        return;\r\n      }\r\n\r\n      // Ctrl/Cmd + D: Deselect all layers\r\n      if (isCtrlOrCmd && event.key === 'd') {\r\n        event.preventDefault();\r\n        // console.log('[DEBUG] Deselect all triggered by Ctrl+D');\r\n        deselectAllLayers();\r\n        return;\r\n      }\r\n\r\n      // Ctrl/Cmd + C: Copy selected layers\r\n      if (isCtrlOrCmd && event.key === 'c') {\r\n        if (selectedLayerIds.length > 0) {\r\n          event.preventDefault();\r\n          // console.log(`[DEBUG] Copy triggered by Ctrl+C - copying ${selectedLayerIds.length} layer(s)`);\r\n          copySelectedLayers();\r\n          copySelectedLayersToClipboard();\r\n        }\r\n        return;\r\n      }\r\n\r\n      // Ctrl/Cmd + V: Paste from clipboard\r\n      if (isCtrlOrCmd && event.key === 'v') {\r\n        event.preventDefault();\r\n        pasteFromClipboard();\r\n        return;\r\n      }\r\n\r\n      // +/-: Zoom in/out\r\n      if ((event.key === '+' || event.key === '=') && !isCtrlOrCmd) {\r\n        event.preventDefault();\r\n        const currentZoom = project.viewport.zoom;\r\n        const zoomLevels = [25, 50, 100, 200, 400, 800, 1600];\r\n        const nextZoom = zoomLevels.find((z) => z > currentZoom) || zoomLevels[zoomLevels.length - 1];\r\n        // console.log(`[DEBUG] Zoom in triggered by + - ${currentZoom}% -> ${nextZoom}%`);\r\n        setViewport({ zoom: nextZoom });\r\n        return;\r\n      }\r\n\r\n      if (event.key === '-' && !isCtrlOrCmd) {\r\n        event.preventDefault();\r\n        const currentZoom = project.viewport.zoom;\r\n        const zoomLevels = [25, 50, 100, 200, 400, 800, 1600];\r\n        const nextZoom = [...zoomLevels].reverse().find((z) => z < currentZoom) || zoomLevels[0];\r\n        // console.log(`[DEBUG] Zoom out triggered by - - ${currentZoom}% -> ${nextZoom}%`);\r\n        setViewport({ zoom: nextZoom });\r\n        return;\r\n      }\r\n\r\n      // 0: Reset zoom to 100%\r\n      if (event.key === '0') {\r\n        event.preventDefault();\r\n        // console.log('[DEBUG] Reset zoom triggered by 0 key');\r\n        setViewport({ zoom: 100 });\r\n        return;\r\n      }\r\n    };\r\n\r\n    const handleKeyUp = (event: KeyboardEvent) => {\r\n      // Spacebar: Stop pan mode\r\n      if (event.code === 'Space') {\r\n        isPanningRef.current = false;\r\n        // console.log('[DEBUG] Pan mode deactivated (Spacebar released)');\r\n      }\r\n\r\n      // Remove from held keys tracking\r\n      keysHeldRef.current.delete(event.key);\r\n      keysHeldRef.current.delete(event.code);\r\n\r\n      // Stop continuous movement if no more arrow keys held\r\n      const hasArrows = ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].some(\r\n        (key) => keysHeldRef.current.has(key)\r\n      );\r\n      if (!hasArrows) {\r\n        stopContinuousMovement();\r\n      }\r\n    };\r\n\r\n    const handleMouseDown = (event: MouseEvent) => {\r\n      if (isPanningRef.current) {\r\n        panStartXRef.current = event.clientX;\r\n        panStartYRef.current = event.clientY;\r\n        // console.log('[DEBUG] Pan drag started');\r\n      }\r\n    };\r\n\r\n    const handleMouseMove = (event: MouseEvent) => {\r\n      if (isPanningRef.current && (event.buttons & 1) === 1) {\r\n        const deltaX = event.clientX - panStartXRef.current;\r\n        const deltaY = event.clientY - panStartYRef.current;\r\n\r\n        const zoom = project.viewport.zoom / 100;\r\n        const panDeltaX = -deltaX / zoom;\r\n        const panDeltaY = -deltaY / zoom;\r\n\r\n        setViewport({\r\n          panX: project.viewport.panX + panDeltaX,\r\n          panY: project.viewport.panY + panDeltaY,\r\n        });\r\n\r\n        panStartXRef.current = event.clientX;\r\n        panStartYRef.current = event.clientY;\r\n\r\n        // console.log(`[DEBUG] Panning - delta (${panDeltaX}, ${panDeltaY})`);\r\n      }\r\n    };\r\n\r\n    window.addEventListener('keydown', handleKeyDown);\r\n    window.addEventListener('keyup', handleKeyUp);\r\n    window.addEventListener('mousedown', handleMouseDown);\r\n    window.addEventListener('mousemove', handleMouseMove);\r\n\r\n    return () => {\r\n      window.removeEventListener('keydown', handleKeyDown);\r\n      window.removeEventListener('keyup', handleKeyUp);\r\n      window.removeEventListener('mousedown', handleMouseDown);\r\n      window.removeEventListener('mousemove', handleMouseMove);\r\n      stopContinuousMovement();\r\n    };\r\n  }, [\r\n    selectedLayerIds,\r\n    project,\r\n    selectAllLayers,\r\n    deselectAllLayers,\r\n    deleteSelectedLayers,\r\n    moveSelectedLayers,\r\n    setViewport,\r\n    undo,\r\n    redo,\r\n    copySelectedLayers,\r\n    copySelectedLayersToClipboard,\r\n    pasteSelectedLayers,\r\n    pasteFromClipboard,\r\n    reorderSelectedLayers,\r\n  ]);\r\n}\r\n\r\nexport default useKeyboardShortcuts;\r\n","/**\r\n * Custom hook for automatic history tracking\r\n * Debounces and tracks significant state changes\r\n * EXCLUDES viewport changes (pan/zoom) as those are UI navigation state, not project state\r\n */\r\n\r\nimport { useEffect, useRef } from 'react';\r\nimport useCompositorStore from '../store/compositorStore';\r\nimport { ProjectData } from '../types/compositor.types';\r\n\r\n/**\r\n * Creates a comparison object excluding viewport to avoid tracking nav changes\r\n */\r\nfunction getProjectWithoutViewport(project: ProjectData): Omit<ProjectData, 'viewport'> {\r\n  const { viewport, ...rest } = project;\r\n  return rest;\r\n}\r\n\r\nexport function useAutoHistory() {\r\n  const project = useCompositorStore((state) => state.project);\r\n  const pushHistory = useCompositorStore((state) => state.pushHistory);\r\n  const lastHistoryPushAt = useCompositorStore((state) => state._lastHistoryPushAt);\r\n  const lastProjectRef = useRef(project);\r\n  const debounceTimerRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n  useEffect(() => {\r\n    // Clear any pending debounce\r\n    if (debounceTimerRef.current) {\r\n      clearTimeout(debounceTimerRef.current);\r\n    }\r\n\r\n    // Check if project actually changed (excluding viewport which is just UI navigation state)\r\n    const projectWithoutViewport = getProjectWithoutViewport(project);\r\n    const lastProjectWithoutViewport = getProjectWithoutViewport(lastProjectRef.current);\r\n    const projectChanged = JSON.stringify(projectWithoutViewport) !== JSON.stringify(lastProjectWithoutViewport);\r\n\r\n    if (projectChanged) {\r\n      // Skip if history was just manually pushed (e.g., stopDraggingLayer)\r\n      // Give it 100ms window to avoid double-pushing\r\n      if (lastHistoryPushAt && Date.now() - lastHistoryPushAt < 100) {\r\n        lastProjectRef.current = project;\r\n        return;\r\n      }\r\n\r\n      // Debounce history push by 500ms\r\n      debounceTimerRef.current = setTimeout(() => {\r\n        pushHistory();\r\n        lastProjectRef.current = project;\r\n      }, 500);\r\n    }\r\n\r\n    return () => {\r\n      if (debounceTimerRef.current) {\r\n        clearTimeout(debounceTimerRef.current);\r\n      }\r\n    };\r\n  }, [project, pushHistory, lastHistoryPushAt]);\r\n}\r\n\r\nexport default useAutoHistory;\r\n","/**\r\n * Hook for managing debug menu visibility\r\n * Opens/closes via Ctrl+Shift+D keyboard shortcut\r\n */\r\n\r\nimport { useState, useEffect } from 'react';\r\n\r\nexport function useDebugMenu() {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      // Ctrl+Shift+D (or Cmd+Shift+D on Mac)\r\n      if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'D') {\r\n        e.preventDefault();\r\n        setIsOpen((prev) => !prev);\r\n      }\r\n    };\r\n\r\n    window.addEventListener('keydown', handleKeyDown);\r\n    return () => window.removeEventListener('keydown', handleKeyDown);\r\n  }, []);\r\n\r\n  return {\r\n    isOpen,\r\n    setIsOpen,\r\n    toggle: () => setIsOpen((prev) => !prev),\r\n  };\r\n}\r\n\r\nexport default useDebugMenu;\r\n","import { ProjectData } from '../types/compositor.types';\r\nimport { serializeProject, deserializeProject } from './projectSerializer';\r\n\r\nconst DB_NAME = 'PixelConnectDB';\r\nconst STORE_NAME = 'projects';\r\nconst KEY = 'current_project';\r\nconst DB_VERSION = 1;\r\n\r\nexport const initDB = (): Promise<IDBDatabase> => {\r\n  return new Promise((resolve, reject) => {\r\n    const request = indexedDB.open(DB_NAME, DB_VERSION);\r\n\r\n    request.onerror = () => reject(request.error);\r\n    request.onsuccess = () => resolve(request.result);\r\n\r\n    request.onupgradeneeded = (event) => {\r\n      const db = (event.target as IDBOpenDBRequest).result;\r\n      if (!db.objectStoreNames.contains(STORE_NAME)) {\r\n        db.createObjectStore(STORE_NAME);\r\n      }\r\n    };\r\n  });\r\n};\r\n\r\nexport const saveToCache = async (project: ProjectData): Promise<void> => {\r\n  try {\r\n    const db = await initDB();\r\n    const serialized = serializeProject(project);\r\n    \r\n    return new Promise((resolve, reject) => {\r\n      const transaction = db.transaction(STORE_NAME, 'readwrite');\r\n      const store = transaction.objectStore(STORE_NAME);\r\n      const request = store.put(serialized, KEY);\r\n\r\n      request.onsuccess = () => resolve();\r\n      request.onerror = () => reject(request.error);\r\n    });\r\n  } catch (error) {\r\n    console.error('Failed to save to cache:', error);\r\n  }\r\n};\r\n\r\nexport const loadFromCache = async (): Promise<ProjectData | null> => {\r\n  try {\r\n    const db = await initDB();\r\n    \r\n    return new Promise((resolve, reject) => {\r\n      const transaction = db.transaction(STORE_NAME, 'readonly');\r\n      const store = transaction.objectStore(STORE_NAME);\r\n      const request = store.get(KEY);\r\n\r\n      request.onsuccess = async () => {\r\n        const result = request.result;\r\n        if (result) {\r\n          try {\r\n            const project = await deserializeProject(result);\r\n            resolve(project);\r\n          } catch (e) {\r\n            reject(e);\r\n          }\r\n        } else {\r\n          resolve(null);\r\n        }\r\n      };\r\n      request.onerror = () => reject(request.error);\r\n    });\r\n  } catch (error) {\r\n    console.error('Failed to load from cache:', error);\r\n    return null;\r\n  }\r\n};\r\n\r\nexport const clearCache = async (): Promise<void> => {\r\n  try {\r\n    const db = await initDB();\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = db.transaction(STORE_NAME, 'readwrite');\r\n      const store = transaction.objectStore(STORE_NAME);\r\n      const request = store.delete(KEY);\r\n      \r\n      request.onsuccess = () => resolve();\r\n      request.onerror = () => reject(request.error);\r\n    });\r\n  } catch (error) {\r\n    console.error('Failed to clear cache:', error);\r\n  }\r\n};\r\n","import { useEffect, useRef } from 'react';\r\nimport useCompositorStore from '../store/compositorStore';\r\nimport { saveToCache, loadFromCache } from '../utils/autoSave';\r\n\r\nconst AUTO_SAVE_DELAY = 2000; // 2 seconds debounce\r\n\r\nexport function useAutoSave() {\r\n  const project = useCompositorStore((state) => state.project);\r\n  const loadProject = useCompositorStore((state) => state.loadProject);\r\n  const timeoutRef = useRef<ReturnType<typeof setTimeout>>();\r\n  const isLoadedRef = useRef(false);\r\n\r\n  // Load from cache on mount\r\n  useEffect(() => {\r\n    const init = async () => {\r\n      if (isLoadedRef.current) return;\r\n      \r\n      try {\r\n        const cachedProject = await loadFromCache();\r\n        if (cachedProject) {\r\n          console.log('[AutoSave] Restoring cached project...');\r\n          // Filter out preview layers before loading\r\n          const filtered = {\r\n            ...cachedProject,\r\n            layers: cachedProject.layers.filter(\r\n              l => l.id !== '__text_canvas_preview__' && l.id !== '__shape_canvas_preview__'\r\n            )\r\n          };\r\n          loadProject(filtered);\r\n        }\r\n      } catch (error) {\r\n        console.error('[AutoSave] Failed to restore project:', error);\r\n      } finally {\r\n        isLoadedRef.current = true;\r\n      }\r\n    };\r\n    \r\n    init();\r\n  }, [loadProject]);\r\n\r\n  // Save to cache when project changes\r\n  useEffect(() => {\r\n    if (!isLoadedRef.current) return; // Don't save before initial load attempt\r\n    \r\n    if (timeoutRef.current) {\r\n      clearTimeout(timeoutRef.current);\r\n    }\r\n\r\n    timeoutRef.current = setTimeout(() => {\r\n      // Filter out preview layers before saving\r\n      const projectToSave = {\r\n        ...project,\r\n        layers: project.layers.filter(\r\n          l => l.id !== '__text_canvas_preview__' && l.id !== '__shape_canvas_preview__'\r\n        )\r\n      };\r\n      // console.log('[AutoSave] Saving project to cache...');\r\n      saveToCache(projectToSave);\r\n    }, AUTO_SAVE_DELAY);\r\n\r\n    return () => {\r\n      if (timeoutRef.current) {\r\n        clearTimeout(timeoutRef.current);\r\n      }\r\n    };\r\n  }, [project]);\r\n}\r\n","import { useEffect, useRef, useCallback } from 'react';\r\nimport useCompositorStore from '../store/compositorStore';\r\n\r\nconst ZOOM_LEVELS = [25, 33, 50, 66, 75, 100, 125, 150, 200, 400, 800, 1600, 3200];\r\n\r\n/**\r\n * Calculate the best zoom level to fit the canvas in the container\r\n */\r\nfunction calculateFitZoom(canvasWidth: number, canvasHeight: number): number {\r\n  const container = document.querySelector('[data-region=\"canvas\"]');\r\n  if (!container) return 100;\r\n\r\n  const containerWidth = container.clientWidth;\r\n  const containerHeight = container.clientHeight;\r\n\r\n  if (containerWidth <= 0 || containerHeight <= 0 || canvasWidth <= 0 || canvasHeight <= 0) {\r\n    return 100;\r\n  }\r\n\r\n  const scaleX = containerWidth / canvasWidth;\r\n  const scaleY = containerHeight / canvasHeight;\r\n\r\n  const fitZoom = Math.min(scaleX, scaleY) * 100;\r\n  const nearestZoom = ZOOM_LEVELS.reduce((prev, curr) =>\r\n    Math.abs(curr - fitZoom) < Math.abs(prev - fitZoom) ? curr : prev\r\n  );\r\n\r\n  // Go one level smaller for breathing room\r\n  const nearestIndex = ZOOM_LEVELS.indexOf(nearestZoom);\r\n  return nearestIndex > 0 ? ZOOM_LEVELS[nearestIndex - 1] : nearestZoom;\r\n}\r\n\r\n/**\r\n * Hook that automatically resets zoom to fit canvas when the first layer is added\r\n * to an empty canvas. Also auto-crops canvas to layers on first layer add.\r\n * Exposes window.fitCanvasToScreen() for other components.\r\n */\r\nexport function useAutoResetZoom() {\r\n  const layers = useCompositorStore((state) => state.project.layers);\r\n  const cropCanvasToLayers = useCompositorStore((state) => state.cropCanvasToLayers);\r\n  const hadLayersRef = useRef(false);\r\n\r\n  // Fit-to-screen function that reads latest state\r\n  const fitCanvasToScreen = useCallback(() => {\r\n    // Defer to let DOM/state settle\r\n    setTimeout(() => {\r\n      const state = useCompositorStore.getState();\r\n      const fitZoom = calculateFitZoom(state.project.canvas.width, state.project.canvas.height);\r\n      state.setViewport({ zoom: fitZoom, panX: 0, panY: 0 });\r\n    }, 50);\r\n  }, []);\r\n\r\n  // Expose globally so CanvasSettings (and others) can invoke after crop\r\n  useEffect(() => {\r\n    (window as any).fitCanvasToScreen = fitCanvasToScreen;\r\n    return () => { delete (window as any).fitCanvasToScreen; };\r\n  }, [fitCanvasToScreen]);\r\n\r\n  useEffect(() => {\r\n    const hasLayers = layers.length > 0;\r\n\r\n    // Trigger crop + zoom reset when transitioning from no layers to having layers\r\n    if (hasLayers && !hadLayersRef.current) {\r\n      hadLayersRef.current = true;\r\n\r\n      // First crop the canvas to fit the layers, then fit-to-screen\r\n      const timer = setTimeout(() => {\r\n        cropCanvasToLayers();\r\n\r\n        // After crop state settles, fit zoom\r\n        setTimeout(() => {\r\n          const state = useCompositorStore.getState();\r\n          const fitZoom = calculateFitZoom(state.project.canvas.width, state.project.canvas.height);\r\n          state.setViewport({ zoom: fitZoom, panX: 0, panY: 0 });\r\n        }, 50);\r\n      }, 50);\r\n\r\n      return () => clearTimeout(timer);\r\n    }\r\n\r\n    // Reset flag when all layers are removed\r\n    if (!hasLayers) {\r\n      hadLayersRef.current = false;\r\n    }\r\n  }, [layers.length, cropCanvasToLayers]);\r\n}\r\n","import { useState, useEffect, useCallback } from 'react';\r\nimport { usePortraitMode } from '../../hooks/usePortraitMode';\r\n\r\nexport interface TutorialStep {\r\n  /** CSS selector for the element to highlight (null = center screen) */\r\n  target: string | null;\r\n  /** Mobile-specific selector override */\r\n  mobileTarget?: string | null;\r\n  /** Title shown in the tooltip card */\r\n  title: string;\r\n  /** Description body */\r\n  description: string;\r\n  /** Where to place the tooltip relative to the spotlight */\r\n  placement?: 'top' | 'bottom' | 'left' | 'right' | 'center';\r\n  /** Mobile placement override */\r\n  mobilePlacement?: 'top' | 'bottom' | 'left' | 'right' | 'center';\r\n  /** Called when this step becomes active */\r\n  onEnter?: () => void;\r\n  /** Called when leaving this step */\r\n  onExit?: () => void;\r\n}\r\n\r\nconst DESKTOP_STEPS: TutorialStep[] = [\r\n  {\r\n    target: null,\r\n    title: 'Welcome to PixelConnect',\r\n    description: 'A pixel-art compositor and image editor. This quick tour will walk you through the key features. Press Next to continue or Skip to dismiss.',\r\n    placement: 'center',\r\n  },\r\n  {\r\n    target: '[data-region=\"toolbar\"]',\r\n    title: 'Toolbar',\r\n    description: 'Your main control bar. Rename your project, save/load files, undo/redo, toggle the grid overlay, selection borders, and layer tools from here.',\r\n    placement: 'bottom',\r\n  },\r\n  {\r\n    target: '[data-region=\"layer-panel\"]',\r\n    title: 'Layers Panel',\r\n    description: 'All your layers live here. Drag to reorder, click the eye to toggle visibility, or use the lock icon. Use the + buttons at the bottom to add image, text, or shape layers.',\r\n    placement: 'right',\r\n  },\r\n  {\r\n    target: '[data-region=\"canvas\"]',\r\n    title: 'Canvas',\r\n    description: 'Your workspace. Click a layer to select it, drag to move. Middle-click (or two-finger) to pan, scroll wheel (or pinch) to zoom. Drop images here to add them as layers.',\r\n    placement: 'bottom',\r\n  },\r\n  {\r\n    target: '[data-region=\"property-panel\"]',\r\n    title: 'Properties Panel',\r\n    description: 'Adjust the selected layer\\'s opacity, position, and dimensions. Change canvas size, background color, and shadow settings at the bottom.',\r\n    placement: 'left',\r\n  },\r\n  {\r\n    target: '[data-region=\"actions-menu\"]',\r\n    title: 'Modify Tools',\r\n    description: 'With a layer selected, these tools are always available:\\n\\n Transparency Mask  Remove a chosen color and make it transparent.\\n Crop  Trim the layer to a smaller region.\\n Pixelator / Resize  Resize an image or convert it into pixel art with palette matching and dithering.\\n BG Removal  Remove backgrounds with click, brush, or AI tools.',\r\n    placement: 'left',\r\n  },\r\n  {\r\n    target: '[data-region=\"zoom-controls\"]',\r\n    title: 'Zoom Controls',\r\n    description: 'Zoom in/out with preset levels or use Fit to Screen to auto-center everything. The keyboard shortcut Ctrl+0 also resets zoom.',\r\n    placement: 'bottom',\r\n  },\r\n  {\r\n    target: '[data-region=\"file-operations\"]',\r\n    title: 'Save & Export',\r\n    description: 'Save projects as .pixcomp files to reload later. Export to PNG for sharing. Your work also auto-saves to the browser\\'s local storage.',\r\n    placement: 'bottom',\r\n  },\r\n  {\r\n    target: null,\r\n    title: 'Keyboard Shortcuts',\r\n    description: 'Ctrl+Z / Ctrl+Y  Undo/Redo\\nCtrl+S  Save project\\nDelete  Remove selected layers\\nArrow keys  Nudge selected layers\\nCtrl+Click  Multi-select layers',\r\n    placement: 'center',\r\n  },\r\n  {\r\n    target: null,\r\n    title: 'You\\'re all set!',\r\n    description: 'Drop an image onto the canvas to get started, or use the Pixelator tool (in File menu) to convert images to pixel art. You can reopen this tour anytime from the ? button.',\r\n    placement: 'center',\r\n  },\r\n];\r\n\r\nconst MOBILE_STEPS: TutorialStep[] = [\r\n  {\r\n    target: null,\r\n    title: 'Welcome to PixelConnect',\r\n    description: 'A pixel-art compositor and image editor, optimized for mobile. This quick tour will show you around. Tap Next to continue.',\r\n    placement: 'center',\r\n  },\r\n  {\r\n    target: '[data-region=\"toolbar\"]',\r\n    title: 'Toolbar',\r\n    description: 'Two rows: top has project name, file ops, and undo/redo. Bottom row has grid, borders, tools toggles, and zoom controls.',\r\n    placement: 'bottom',\r\n  },\r\n  {\r\n    target: '[data-region=\"canvas\"]',\r\n    title: 'Canvas',\r\n    description: 'One-finger to pan, pinch to zoom. Tap a layer to select it, then drag to move. Drop or upload images to add layers.',\r\n    placement: 'center',\r\n  },\r\n  {\r\n    target: '#btn-mobile-layers-toggle',\r\n    title: 'Layers Panel ()',\r\n    description: 'Tap the  button in the bottom-left corner to open the layers drawer. Reorder layers, toggle visibility, and create text or shape layers from here.',\r\n    placement: 'top',\r\n  },\r\n  {\r\n    target: '#btn-mobile-properties-toggle',\r\n    title: 'Properties Panel ()',\r\n    description: 'Tap the  button in the bottom-right corner. Adjust opacity, position, canvas size, and background color.',\r\n    placement: 'top',\r\n  },\r\n  {\r\n    target: '#btn-mobile-properties-toggle',\r\n    title: 'Modify Tools',\r\n    description: 'With a layer selected, open Properties () to find the Modify section with these tools:\\n\\n Transparency Mask  Remove a color and make it transparent.\\n Crop  Trim the layer to a smaller region.\\n Pixelator / Resize  Resize an image or convert it to pixel art with palette matching and dithering.\\n BG Removal  Remove backgrounds with click, brush, or AI tools.',\r\n    placement: 'top',\r\n  },\r\n  {\r\n    target: '[data-region=\"zoom-controls\"]',\r\n    title: 'Zoom Controls',\r\n    description: 'Use Fit to Screen to auto-center your canvas, or tap +/ for fine control. Pinch gestures work on the canvas too.',\r\n    placement: 'top',\r\n  },\r\n  {\r\n    target: null,\r\n    title: 'You\\'re all set!',\r\n    description: 'Drop an image onto the canvas to get started, or use the Pixelator tool (in the file menu) to convert images to pixel art. Reopen this tour anytime from the ? button in the toolbar.',\r\n    placement: 'center',\r\n  },\r\n];\r\n\r\nconst LOCALSTORAGE_KEY = 'pixelconnect_tutorial_seen';\r\n\r\ninterface TutorialOverlayProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n}\r\n\r\nfunction TutorialOverlay({ isOpen, onClose }: TutorialOverlayProps) {\r\n  const isPortrait = usePortraitMode();\r\n  const steps = isPortrait ? MOBILE_STEPS : DESKTOP_STEPS;\r\n  const [currentStep, setCurrentStep] = useState(0);\r\n  const [spotlightRect, setSpotlightRect] = useState<DOMRect | null>(null);\r\n\r\n  const step = steps[currentStep];\r\n\r\n  // Compute spotlight rect for the current step's target\r\n  const updateSpotlight = useCallback(() => {\r\n    if (!isOpen) return;\r\n    const selector = (isPortrait && step.mobileTarget !== undefined) ? step.mobileTarget : step.target;\r\n    if (!selector) {\r\n      setSpotlightRect(null);\r\n      return;\r\n    }\r\n    const el = document.querySelector(selector);\r\n    if (el) {\r\n      setSpotlightRect(el.getBoundingClientRect());\r\n    } else {\r\n      setSpotlightRect(null);\r\n    }\r\n  }, [isOpen, step, isPortrait]);\r\n\r\n  useEffect(() => {\r\n    updateSpotlight();\r\n    window.addEventListener('resize', updateSpotlight);\r\n    return () => window.removeEventListener('resize', updateSpotlight);\r\n  }, [updateSpotlight]);\r\n\r\n  // Reset step when opened\r\n  useEffect(() => {\r\n    if (isOpen) setCurrentStep(0);\r\n  }, [isOpen]);\r\n\r\n  // Fire onEnter/onExit callbacks when the active step changes\r\n  useEffect(() => {\r\n    if (!isOpen) return;\r\n    step.onEnter?.();\r\n    return () => {\r\n      step.onExit?.();\r\n    };\r\n  }, [currentStep, isOpen]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  if (!isOpen) return null;\r\n\r\n  const handleNext = () => {\r\n    if (currentStep < steps.length - 1) {\r\n      setCurrentStep(currentStep + 1);\r\n    } else {\r\n      handleFinish();\r\n    }\r\n  };\r\n\r\n  const handlePrev = () => {\r\n    if (currentStep > 0) setCurrentStep(currentStep - 1);\r\n  };\r\n\r\n  const handleFinish = () => {\r\n    localStorage.setItem(LOCALSTORAGE_KEY, 'true');\r\n    onClose();\r\n  };\r\n\r\n  const placement = (isPortrait && step.mobilePlacement) ? step.mobilePlacement : (step.placement || 'bottom');\r\n\r\n  // Compute tooltip position  always clamped to stay in viewport\r\n  const getTooltipStyle = (): React.CSSProperties => {\r\n    if (!spotlightRect || placement === 'center') {\r\n      return {\r\n        position: 'fixed',\r\n        top: '50%',\r\n        left: '50%',\r\n        transform: 'translate(-50%, -50%)',\r\n      };\r\n    }\r\n\r\n    const pad = 16;\r\n    const tooltipW = Math.min(360, window.innerWidth - 32);\r\n    const tooltipH = 280; // approximate max height of tooltip card\r\n    const vw = window.innerWidth;\r\n    const vh = window.innerHeight;\r\n\r\n    // Clamp helpers\r\n    const clampX = (x: number) => Math.max(16, Math.min(x, vw - tooltipW - 16));\r\n    const clampY = (y: number) => Math.max(16, Math.min(y, vh - tooltipH - 16));\r\n\r\n    let style: React.CSSProperties;\r\n\r\n    switch (placement) {\r\n      case 'bottom':\r\n        style = {\r\n          position: 'fixed',\r\n          top: clampY(spotlightRect.bottom + pad),\r\n          left: clampX(spotlightRect.left),\r\n          maxWidth: tooltipW,\r\n        };\r\n        break;\r\n      case 'top':\r\n        style = {\r\n          position: 'fixed',\r\n          top: clampY(spotlightRect.top - pad - tooltipH),\r\n          left: clampX(spotlightRect.left),\r\n          maxWidth: tooltipW,\r\n        };\r\n        break;\r\n      case 'right': {\r\n        const idealLeft = spotlightRect.right + pad;\r\n        // If tooltip would overflow right, fall back to placing inside the spotlight area or centered\r\n        const left = idealLeft + tooltipW > vw ? clampX(spotlightRect.left + 16) : idealLeft;\r\n        style = {\r\n          position: 'fixed',\r\n          top: clampY(spotlightRect.top + (spotlightRect.height - tooltipH) / 2),\r\n          left,\r\n          maxWidth: tooltipW,\r\n        };\r\n        break;\r\n      }\r\n      case 'left': {\r\n        const idealRight = vw - spotlightRect.left + pad;\r\n        // If tooltip would overflow left, fall back\r\n        const useRight = spotlightRect.left - pad - tooltipW < 0 ? undefined : idealRight;\r\n        style = {\r\n          position: 'fixed',\r\n          top: clampY(spotlightRect.top + (spotlightRect.height - tooltipH) / 2),\r\n          ...(useRight !== undefined\r\n            ? { right: useRight, maxWidth: tooltipW }\r\n            : { left: clampX(spotlightRect.right - tooltipW), maxWidth: tooltipW }),\r\n        };\r\n        break;\r\n      }\r\n      default:\r\n        style = {\r\n          position: 'fixed',\r\n          top: '50%',\r\n          left: '50%',\r\n          transform: 'translate(-50%, -50%)',\r\n        };\r\n    }\r\n\r\n    return style;\r\n  };\r\n\r\n  // Build spotlight clip-path (inverted rectangle cutout)\r\n  const getOverlayStyle = (): React.CSSProperties => {\r\n    if (!spotlightRect) return {};\r\n    const p = 6; // padding around element\r\n    const x = spotlightRect.left - p;\r\n    const y = spotlightRect.top - p;\r\n    const w = spotlightRect.width + p * 2;\r\n    const h = spotlightRect.height + p * 2;\r\n    const r = 8; // border radius\r\n    // Invert: full-screen polygon with a rounded-rect hole via inset\r\n    return {\r\n      clipPath: `polygon(\r\n        0% 0%, 100% 0%, 100% 100%, 0% 100%, 0% 0%,\r\n        ${x}px ${y + r}px,\r\n        ${x + r}px ${y}px,\r\n        ${x + w - r}px ${y}px,\r\n        ${x + w}px ${y + r}px,\r\n        ${x + w}px ${y + h - r}px,\r\n        ${x + w - r}px ${y + h}px,\r\n        ${x + r}px ${y + h}px,\r\n        ${x}px ${y + h - r}px,\r\n        ${x}px ${y + r}px\r\n      )`,\r\n    };\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-[400]\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Tutorial\">\r\n      {/* Dark overlay with spotlight cutout */}\r\n      <div\r\n        className=\"absolute inset-0 bg-black/70 transition-all duration-300\"\r\n        style={getOverlayStyle()}\r\n        onClick={handleFinish}\r\n      />\r\n\r\n      {/* Spotlight border glow */}\r\n      {spotlightRect && (\r\n        <div\r\n          className=\"absolute border-2 border-blue-400/60 rounded-lg pointer-events-none transition-all duration-300\"\r\n          style={{\r\n            left: spotlightRect.left - 6,\r\n            top: spotlightRect.top - 6,\r\n            width: spotlightRect.width + 12,\r\n            height: spotlightRect.height + 12,\r\n            boxShadow: '0 0 20px rgba(96, 165, 250, 0.3)',\r\n          }}\r\n        />\r\n      )}\r\n\r\n      {/* Tooltip card */}\r\n      <div\r\n        className=\"bg-gray-900 border border-gray-600 rounded-xl shadow-2xl p-5 z-[401] text-gray-200\"\r\n        style={{ ...getTooltipStyle(), maxWidth: Math.min(380, window.innerWidth - 32) }}\r\n      >\r\n        {/* Step counter */}\r\n        <div className=\"flex items-center justify-between mb-3\">\r\n          <span className=\"text-xs text-gray-500 font-mono\">{currentStep + 1} / {steps.length}</span>\r\n          <button\r\n            onClick={handleFinish}\r\n            className=\"text-xs text-gray-500 hover:text-gray-300 transition-colors\"\r\n          >\r\n            Skip tour\r\n          </button>\r\n        </div>\r\n\r\n        {/* Title */}\r\n        <h3 className=\"text-base font-bold text-white mb-2\">{step.title}</h3>\r\n\r\n        {/* Description */}\r\n        <p className=\"text-sm text-gray-300 leading-relaxed whitespace-pre-line mb-4\">{step.description}</p>\r\n\r\n        {/* Progress dots */}\r\n        <div className=\"flex items-center justify-center gap-1.5 mb-4\">\r\n          {steps.map((_, i) => (\r\n            <div\r\n              key={i}\r\n              className={`w-2 h-2 rounded-full transition-colors ${\r\n                i === currentStep ? 'bg-blue-500' : i < currentStep ? 'bg-blue-800' : 'bg-gray-600'\r\n              }`}\r\n            />\r\n          ))}\r\n        </div>\r\n\r\n        {/* Navigation buttons */}\r\n        <div className=\"flex items-center justify-between gap-3\">\r\n          <button\r\n            onClick={handlePrev}\r\n            disabled={currentStep === 0}\r\n            className=\"px-4 py-2 text-sm font-medium rounded-lg transition-colors disabled:opacity-30 disabled:cursor-not-allowed bg-gray-700 hover:bg-gray-600 text-gray-200\"\r\n          >\r\n            Previous\r\n          </button>\r\n          <button\r\n            onClick={handleNext}\r\n            className=\"px-4 py-2 text-sm font-semibold rounded-lg transition-colors bg-blue-600 hover:bg-blue-500 text-white\"\r\n          >\r\n            {currentStep === steps.length - 1 ? 'Finish' : 'Next'}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport function useTutorialFirstVisit() {\r\n  const [showTutorial, setShowTutorial] = useState(false);\r\n  const [isFirstVisit, setIsFirstVisit] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const seen = localStorage.getItem(LOCALSTORAGE_KEY);\r\n    if (!seen) {\r\n      setIsFirstVisit(true);\r\n      // Small delay to let the app render first\r\n      const timer = setTimeout(() => setShowTutorial(true), 800);\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, []);\r\n\r\n  return { showTutorial, setShowTutorial, isFirstVisit };\r\n}\r\n\r\nexport default TutorialOverlay;\r\n","import { useEffect, useState, useCallback, useRef } from 'react';\r\nimport Canvas from './components/Canvas/Canvas';\r\nimport LayerPanel from './components/LayerPanel/LayerPanel';\r\nimport PropertyPanel from './components/PropertyPanel/PropertyPanel';\r\nimport Toolbar from './components/Toolbar/Toolbar';\r\nimport DebugHistoryModal from './components/DebugMenu/DebugHistoryModal';\r\nimport TextLayerModal from './components/Modals/TextLayerModal';\r\nimport ShapeModal from './components/Modals/ShapeModal';\r\nimport useCompositorStore from './store/compositorStore';\r\nimport useKeyboardShortcuts from './hooks/useKeyboardShortcuts';\r\nimport useAutoHistory from './hooks/useAutoHistory';\r\nimport useDebugMenu from './hooks/useDebugMenu';\r\nimport { useAutoSave } from './hooks/useAutoSave';\r\nimport { useAutoResetZoom } from './hooks/useAutoResetZoom';\r\nimport { useInitializePreferences } from './hooks/useLocalStorage';\r\nimport { usePortraitMode } from './hooks/usePortraitMode';\r\nimport { Layer } from './types/compositor.types';\r\nimport TutorialOverlay, { useTutorialFirstVisit } from './components/Tutorial/TutorialOverlay';\r\n\r\n/**\r\n * Main application component\r\n * Manages layout and global event handling\r\n */\r\nfunction App() {\r\n  const project = useCompositorStore((state) => state.project);\r\n  const isDirty = useCompositorStore((state) => state.isDirty);\r\n  \r\n  // Text layer modal state\r\n  const [isTextModalOpen, setIsTextModalOpen] = useState(false);\r\n  const [editingTextLayer, setEditingTextLayer] = useState<Layer | undefined>(undefined);\r\n  \r\n  // Shape layer modal state\r\n  const [isShapeModalOpen, setIsShapeModalOpen] = useState(false);\r\n  const [editingShapeLayer, setEditingShapeLayer] = useState<Layer | undefined>(undefined);\r\n\r\n  // Portrait/mobile layout\r\n  const isPortrait = usePortraitMode();\r\n  const { showTutorial, setShowTutorial, isFirstVisit } = useTutorialFirstVisit();\r\n  const [showLayersDrawer, setShowLayersDrawer] = useState(false);\r\n  const [showPropertiesDrawer, setShowPropertiesDrawer] = useState(false);\r\n\r\n  // Initialize preferences from localStorage\r\n  useInitializePreferences();\r\n\r\n  // Initialize keyboard shortcuts\r\n  useKeyboardShortcuts();\r\n\r\n  // Initialize automatic history tracking\r\n  useAutoHistory();\r\n\r\n  // Initialize auto-save\r\n  useAutoSave();\r\n\r\n  // Load sample image on first visit\r\n  const addLayer = useCompositorStore((state) => state.addLayer);\r\n  const selectLayer = useCompositorStore((state) => state.selectLayer);\r\n  useEffect(() => {\r\n    if (!isFirstVisit) return;\r\n    // Small delay to let auto-save attempt finish first\r\n    const timer = setTimeout(async () => {\r\n      // Only load if canvas is still empty (no auto-save restored)\r\n      if (useCompositorStore.getState().project.layers.length > 0) return;\r\n      try {\r\n        const resp = await fetch('/kanoe.jpg');\r\n        if (!resp.ok) return;\r\n        const blob = await resp.blob();\r\n        const dataUrl = await new Promise<string>((resolve) => {\r\n          const reader = new FileReader();\r\n          reader.onload = () => resolve(reader.result as string);\r\n          reader.readAsDataURL(blob);\r\n        });\r\n        const img = new Image();\r\n        img.src = dataUrl;\r\n        await new Promise<void>((resolve) => { img.onload = () => resolve(); });\r\n        addLayer({\r\n          name: 'kanoe.jpg',\r\n          imageData: dataUrl,\r\n          x: 0,\r\n          y: 0,\r\n          zIndex: 0,\r\n          visible: true,\r\n          locked: false,\r\n          opacity: 1.0,\r\n          width: img.naturalWidth,\r\n          height: img.naturalHeight,\r\n        });\r\n        // Select the layer so the properties panel shows Actions\r\n        const layers = useCompositorStore.getState().project.layers;\r\n        if (layers.length > 0) {\r\n          selectLayer(layers[layers.length - 1].id, false);\r\n        }\r\n      } catch {\r\n        // Silently fail  it's just a demo image\r\n      }\r\n    }, 500);\r\n    return () => clearTimeout(timer);\r\n  }, [isFirstVisit, addLayer, selectLayer]);\r\n\r\n  // Initialize auto-reset zoom when first layer is added\r\n  useAutoResetZoom();\r\n\r\n  //  Drag-and-drop for image files (canvas area only) \r\n  const [isDroppingFile, setIsDroppingFile] = useState(false);\r\n  const canvasDropRef = useRef<HTMLDivElement>(null);\r\n\r\n  const handleDroppedFiles = useCallback(async (files: FileList) => {\r\n    for (const file of Array.from(files)) {\r\n      if (!file.type.startsWith('image/')) continue;\r\n      try {\r\n        const dataUrl = await new Promise<string>((resolve, reject) => {\r\n          const reader = new FileReader();\r\n          reader.onload = (e) => resolve(e.target?.result as string);\r\n          reader.onerror = () => reject(new Error('Failed to read file'));\r\n          reader.readAsDataURL(file);\r\n        });\r\n        const img = new Image();\r\n        img.src = dataUrl;\r\n        await new Promise<void>((resolve, reject) => {\r\n          img.onload = () => resolve();\r\n          img.onerror = () => reject(new Error('Failed to load image'));\r\n        });\r\n        const store = useCompositorStore.getState();\r\n        store.addLayer({\r\n          name: file.name,\r\n          imageData: dataUrl,\r\n          x: 0,\r\n          y: 0,\r\n          zIndex: store.project.layers.length,\r\n          visible: true,\r\n          locked: false,\r\n          opacity: 1.0,\r\n          width: img.naturalWidth,\r\n          height: img.naturalHeight,\r\n        });\r\n        // Select the newly added layer\r\n        const layers = useCompositorStore.getState().project.layers;\r\n        if (layers.length > 0) {\r\n          useCompositorStore.getState().selectLayer(layers[layers.length - 1].id, false);\r\n        }\r\n      } catch (err) {\r\n        console.error(`Error loading dropped image ${file.name}:`, err);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    let counter = 0;\r\n\r\n    // Show overlay when files are dragged anywhere over the window\r\n    const onDragEnter = (e: DragEvent) => {\r\n      e.preventDefault();\r\n      counter++;\r\n      if (e.dataTransfer?.types.includes('Files')) {\r\n        setIsDroppingFile(true);\r\n      }\r\n    };\r\n    const onDragOver = (e: DragEvent) => {\r\n      e.preventDefault();\r\n      if (e.dataTransfer) {\r\n        // Show 'copy' cursor when over canvas area, 'none' elsewhere\r\n        const el = canvasDropRef.current;\r\n        if (el && el.contains(e.target as Node)) {\r\n          e.dataTransfer.dropEffect = 'copy';\r\n        } else {\r\n          e.dataTransfer.dropEffect = 'none';\r\n        }\r\n      }\r\n    };\r\n    const onDragLeave = (e: DragEvent) => {\r\n      e.preventDefault();\r\n      counter--;\r\n      if (counter <= 0) {\r\n        counter = 0;\r\n        setIsDroppingFile(false);\r\n      }\r\n    };\r\n    const onDrop = (e: DragEvent) => {\r\n      e.preventDefault();\r\n      counter = 0;\r\n      setIsDroppingFile(false);\r\n      // Only accept drop if it landed on the canvas area\r\n      const el = canvasDropRef.current;\r\n      if (el && el.contains(e.target as Node) && e.dataTransfer?.files && e.dataTransfer.files.length > 0) {\r\n        handleDroppedFiles(e.dataTransfer.files);\r\n      }\r\n    };\r\n\r\n    window.addEventListener('dragenter', onDragEnter);\r\n    window.addEventListener('dragover', onDragOver);\r\n    window.addEventListener('dragleave', onDragLeave);\r\n    window.addEventListener('drop', onDrop);\r\n    return () => {\r\n      window.removeEventListener('dragenter', onDragEnter);\r\n      window.removeEventListener('dragover', onDragOver);\r\n      window.removeEventListener('dragleave', onDragLeave);\r\n      window.removeEventListener('drop', onDrop);\r\n    };\r\n  }, [handleDroppedFiles]);\r\n\r\n  // Initialize debug menu\r\n  const { isOpen: isDebugMenuOpen, setIsOpen: setIsDebugMenuOpen } = useDebugMenu();\r\n  \r\n  // Handle opening text modal for new or existing layer\r\n  const handleOpenTextModal = (layer?: Layer) => {\r\n    setEditingTextLayer(layer);\r\n    setIsTextModalOpen(true);\r\n  };\r\n  \r\n  const handleCloseTextModal = () => {\r\n    setIsTextModalOpen(false);\r\n    setEditingTextLayer(undefined);\r\n  };\r\n  \r\n  // Handle opening shape modal for new or existing layer\r\n  const handleOpenShapeModal = (layer?: Layer) => {\r\n    setEditingShapeLayer(layer);\r\n    setIsShapeModalOpen(true);\r\n  };\r\n  \r\n  const handleCloseShapeModal = () => {\r\n    setIsShapeModalOpen(false);\r\n    setEditingShapeLayer(undefined);\r\n  };\r\n  \r\n  // Expose text modal handler globally so Toolbar and LayerItem can access it\r\n  useEffect(() => {\r\n    (window as any).openTextLayerModal = handleOpenTextModal;\r\n    return () => {\r\n      delete (window as any).openTextLayerModal;\r\n    };\r\n  }, []);\r\n  \r\n  // Expose shape modal handler globally so Toolbar and LayerItem can access it\r\n  useEffect(() => {\r\n    (window as any).openShapeModal = handleOpenShapeModal;\r\n    return () => {\r\n      delete (window as any).openShapeModal;\r\n    };\r\n  }, []);\r\n\r\n  // Handle unsaved changes warning\r\n  useEffect(() => {\r\n    const handleBeforeUnload = (e: BeforeUnloadEvent) => {\r\n      if (isDirty) {\r\n        e.preventDefault();\r\n        e.returnValue = '';\r\n        console.warn('[DEBUG] Unsaved changes detected - warning user before closing');\r\n      }\r\n    };\r\n\r\n    window.addEventListener('beforeunload', handleBeforeUnload);\r\n    return () => window.removeEventListener('beforeunload', handleBeforeUnload);\r\n  }, [isDirty]);\r\n\r\n  // Update document title with project name and dirty indicator\r\n  useEffect(() => {\r\n    const title = isDirty \r\n      ? ` ${project.projectName} - PixelConnect`\r\n      : `${project.projectName} - PixelConnect`;\r\n    document.title = title;\r\n  }, [project.projectName, isDirty]);\r\n\r\n  return (\r\n    <div className=\"h-screen flex flex-col bg-canvas-bg text-white overflow-hidden\">\r\n      {/* Top Toolbar */}\r\n      <Toolbar onHelpClick={() => setShowTutorial(true)} />\r\n\r\n      {/* Main Content Area */}\r\n      <div className=\"flex flex-1 gap-0 overflow-hidden relative\">\r\n        {isPortrait ? (\r\n          <>\r\n            {/* Portrait: Canvas fills full width, panels are overlay drawers */}\r\n            <div ref={canvasDropRef} className=\"flex-1 overflow-hidden relative\">\r\n              <Canvas />\r\n              {isDroppingFile && (\r\n                <div className=\"absolute inset-0 z-[300] bg-black/60 flex items-center justify-center pointer-events-none rounded\">\r\n                  <div className=\"border-4 border-dashed border-blue-400 rounded-2xl px-12 py-10 bg-gray-900/80 text-center\">\r\n                    <div className=\"text-5xl mb-3\"></div>\r\n                    <div className=\"text-xl font-semibold text-blue-300\">Drop image(s) here</div>\r\n                    <div className=\"text-sm text-gray-400 mt-1\">PNG, JPG, GIF, WebP, SVG</div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Hamburger buttons - bottom corners */}\r\n            <button\r\n              id=\"btn-mobile-layers-toggle\"\r\n              onClick={() => { setShowLayersDrawer(!showLayersDrawer); setShowPropertiesDrawer(false); }}\r\n              className={`fixed bottom-4 left-4 z-[200] w-12 h-12 rounded-full shadow-lg flex items-center justify-center text-lg transition-colors ${\r\n                showLayersDrawer ? 'bg-blue-600 text-white' : 'bg-gray-700 text-gray-200 hover:bg-gray-600'\r\n              }`}\r\n              aria-label={showLayersDrawer ? 'Close layers panel' : 'Open layers panel'}\r\n            >\r\n              \r\n            </button>\r\n            <button\r\n              id=\"btn-mobile-properties-toggle\"\r\n              onClick={() => { setShowPropertiesDrawer(!showPropertiesDrawer); setShowLayersDrawer(false); }}\r\n              className={`fixed bottom-4 right-4 z-[200] w-12 h-12 rounded-full shadow-lg flex items-center justify-center text-lg transition-colors ${\r\n                showPropertiesDrawer ? 'bg-blue-600 text-white' : 'bg-gray-700 text-gray-200 hover:bg-gray-600'\r\n              }`}\r\n              aria-label={showPropertiesDrawer ? 'Close properties panel' : 'Open properties panel'}\r\n            >\r\n              \r\n            </button>\r\n\r\n            {/* Layers Drawer Overlay */}\r\n            {showLayersDrawer && (\r\n              <>\r\n                <div className=\"fixed inset-0 bg-black/50 z-[150]\" onClick={() => setShowLayersDrawer(false)} />\r\n                <div id=\"mobile-layers-drawer\" className=\"fixed top-16 left-0 bottom-0 w-72 bg-panel-bg border-r border-border z-[160] overflow-hidden flex flex-col animate-slide-in-left shadow-2xl\">\r\n                  <div className=\"flex items-center justify-between px-3 py-2 border-b border-border\">\r\n                    <span className=\"text-sm font-semibold text-gray-300\">Layers</span>\r\n                    <button onClick={() => setShowLayersDrawer(false)} className=\"text-gray-400 hover:text-white text-lg px-1\"></button>\r\n                  </div>\r\n                  <div className=\"flex-1 overflow-hidden\">\r\n                    <LayerPanel />\r\n                  </div>\r\n                </div>\r\n              </>\r\n            )}\r\n\r\n            {/* Properties Drawer Overlay */}\r\n            {showPropertiesDrawer && (\r\n              <>\r\n                <div className=\"fixed inset-0 bg-black/50 z-[150]\" onClick={() => setShowPropertiesDrawer(false)} />\r\n                <div id=\"mobile-properties-drawer\" className=\"fixed top-16 right-0 bottom-0 w-72 bg-panel-bg border-l border-border z-[160] overflow-hidden flex flex-col animate-slide-in-right shadow-2xl\">\r\n                  <div className=\"flex items-center justify-between px-3 py-2 border-b border-border\">\r\n                    <span className=\"text-sm font-semibold text-gray-300\">Properties</span>\r\n                    <button onClick={() => setShowPropertiesDrawer(false)} className=\"text-gray-400 hover:text-white text-lg px-1\"></button>\r\n                  </div>\r\n                  <div className=\"flex-1 overflow-hidden\">\r\n                    <PropertyPanel />\r\n                  </div>\r\n                </div>\r\n              </>\r\n            )}\r\n          </>\r\n        ) : (\r\n          <>\r\n            {/* Landscape: Normal three-column layout */}\r\n            <div className=\"w-64 border-r border-border overflow-hidden flex flex-col\">\r\n              <LayerPanel />\r\n            </div>\r\n            <div ref={canvasDropRef} className=\"flex-1 overflow-hidden relative\">\r\n              <Canvas />\r\n              {isDroppingFile && (\r\n                <div className=\"absolute inset-0 z-[300] bg-black/60 flex items-center justify-center pointer-events-none rounded\">\r\n                  <div className=\"border-4 border-dashed border-blue-400 rounded-2xl px-12 py-10 bg-gray-900/80 text-center\">\r\n                    <div className=\"text-5xl mb-3\"></div>\r\n                    <div className=\"text-xl font-semibold text-blue-300\">Drop image(s) here</div>\r\n                    <div className=\"text-sm text-gray-400 mt-1\">PNG, JPG, GIF, WebP, SVG</div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n            <div className=\"w-64 border-l border-border overflow-hidden flex flex-col\">\r\n              <PropertyPanel />\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n\r\n      {/* Debug History Modal (Ctrl+Shift+D) */}\r\n      <DebugHistoryModal\r\n        isOpen={isDebugMenuOpen}\r\n        onClose={() => setIsDebugMenuOpen(false)}\r\n      />\r\n      \r\n      {/* Text Layer Modal */}\r\n      <TextLayerModal\r\n        isOpen={isTextModalOpen}\r\n        onClose={handleCloseTextModal}\r\n        existingLayer={editingTextLayer}\r\n      />\r\n      \r\n      {/* Shape Layer Modal */}\r\n      <ShapeModal\r\n        isOpen={isShapeModalOpen}\r\n        onClose={handleCloseShapeModal}\r\n        existingLayer={editingShapeLayer}\r\n      />\r\n\r\n      {/* Tutorial Overlay */}\r\n      <TutorialOverlay\r\n        isOpen={showTutorial}\r\n        onClose={() => setShowTutorial(false)}\r\n      />\r\n\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react'\r\nimport ReactDOM from 'react-dom/client'\r\nimport App from './App.tsx'\r\nimport './index.css'\r\n\r\nReactDOM.createRoot(document.getElementById('root')!).render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n)\r\n"],"file":"index-DeUdoOR2.js"}