(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))d(f);new MutationObserver(f=>{for(const y of f)if(y.type==="childList")for(const m of y.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&d(m)}).observe(document,{childList:!0,subtree:!0});function l(f){const y={};return f.integrity&&(y.integrity=f.integrity),f.referrerPolicy&&(y.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?y.credentials="include":f.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function d(f){if(f.ep)return;f.ep=!0;const y=l(f);fetch(f.href,y)}})();function Fa(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var pa={exports:{}},fo={},ha={exports:{}},Se={};var su;function kf(){if(su)return Se;su=1;var i=Symbol.for("react.element"),c=Symbol.for("react.portal"),l=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),m=Symbol.for("react.context"),b=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),x=Symbol.iterator;function C(S){return S===null||typeof S!="object"?null:(S=x&&S[x]||S["@@iterator"],typeof S=="function"?S:null)}var D={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,P={};function F(S,I,ee){this.props=S,this.context=I,this.refs=P,this.updater=ee||D}F.prototype.isReactComponent={},F.prototype.setState=function(S,I){if(typeof S!="object"&&typeof S!="function"&&S!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,S,I,"setState")},F.prototype.forceUpdate=function(S){this.updater.enqueueForceUpdate(this,S,"forceUpdate")};function M(){}M.prototype=F.prototype;function B(S,I,ee){this.props=S,this.context=I,this.refs=P,this.updater=ee||D}var se=B.prototype=new M;se.constructor=B,v(se,F.prototype),se.isPureReactComponent=!0;var Y=Array.isArray,z=Object.prototype.hasOwnProperty,U={current:null},K={key:!0,ref:!0,__self:!0,__source:!0};function V(S,I,ee){var ue,he={},ye=null,je=null;if(I!=null)for(ue in I.ref!==void 0&&(je=I.ref),I.key!==void 0&&(ye=""+I.key),I)z.call(I,ue)&&!K.hasOwnProperty(ue)&&(he[ue]=I[ue]);var be=arguments.length-2;if(be===1)he.children=ee;else if(1<be){for(var Ne=Array(be),ze=0;ze<be;ze++)Ne[ze]=arguments[ze+2];he.children=Ne}if(S&&S.defaultProps)for(ue in be=S.defaultProps,be)he[ue]===void 0&&(he[ue]=be[ue]);return{$$typeof:i,type:S,key:ye,ref:je,props:he,_owner:U.current}}function $(S,I){return{$$typeof:i,type:S.type,key:I,ref:S.ref,props:S.props,_owner:S._owner}}function O(S){return typeof S=="object"&&S!==null&&S.$$typeof===i}function re(S){var I={"=":"=0",":":"=2"};return"$"+S.replace(/[=:]/g,function(ee){return I[ee]})}var le=/\/+/g;function Q(S,I){return typeof S=="object"&&S!==null&&S.key!=null?re(""+S.key):I.toString(36)}function X(S,I,ee,ue,he){var ye=typeof S;(ye==="undefined"||ye==="boolean")&&(S=null);var je=!1;if(S===null)je=!0;else switch(ye){case"string":case"number":je=!0;break;case"object":switch(S.$$typeof){case i:case c:je=!0}}if(je)return je=S,he=he(je),S=ue===""?"."+Q(je,0):ue,Y(he)?(ee="",S!=null&&(ee=S.replace(le,"$&/")+"/"),X(he,I,ee,"",function(ze){return ze})):he!=null&&(O(he)&&(he=$(he,ee+(!he.key||je&&je.key===he.key?"":(""+he.key).replace(le,"$&/")+"/")+S)),I.push(he)),1;if(je=0,ue=ue===""?".":ue+":",Y(S))for(var be=0;be<S.length;be++){ye=S[be];var Ne=ue+Q(ye,be);je+=X(ye,I,ee,Ne,he)}else if(Ne=C(S),typeof Ne=="function")for(S=Ne.call(S),be=0;!(ye=S.next()).done;)ye=ye.value,Ne=ue+Q(ye,be++),je+=X(ye,I,ee,Ne,he);else if(ye==="object")throw I=String(S),Error("Objects are not valid as a React child (found: "+(I==="[object Object]"?"object with keys {"+Object.keys(S).join(", ")+"}":I)+"). If you meant to render a collection of children, use an array instead.");return je}function G(S,I,ee){if(S==null)return S;var ue=[],he=0;return X(S,ue,"","",function(ye){return I.call(ee,ye,he++)}),ue}function H(S){if(S._status===-1){var I=S._result;I=I(),I.then(function(ee){(S._status===0||S._status===-1)&&(S._status=1,S._result=ee)},function(ee){(S._status===0||S._status===-1)&&(S._status=2,S._result=ee)}),S._status===-1&&(S._status=0,S._result=I)}if(S._status===1)return S._result.default;throw S._result}var ie={current:null},j={transition:null},W={ReactCurrentDispatcher:ie,ReactCurrentBatchConfig:j,ReactCurrentOwner:U};function A(){throw Error("act(...) is not supported in production builds of React.")}return Se.Children={map:G,forEach:function(S,I,ee){G(S,function(){I.apply(this,arguments)},ee)},count:function(S){var I=0;return G(S,function(){I++}),I},toArray:function(S){return G(S,function(I){return I})||[]},only:function(S){if(!O(S))throw Error("React.Children.only expected to receive a single React element child.");return S}},Se.Component=F,Se.Fragment=l,Se.Profiler=f,Se.PureComponent=B,Se.StrictMode=d,Se.Suspense=h,Se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W,Se.act=A,Se.cloneElement=function(S,I,ee){if(S==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+S+".");var ue=v({},S.props),he=S.key,ye=S.ref,je=S._owner;if(I!=null){if(I.ref!==void 0&&(ye=I.ref,je=U.current),I.key!==void 0&&(he=""+I.key),S.type&&S.type.defaultProps)var be=S.type.defaultProps;for(Ne in I)z.call(I,Ne)&&!K.hasOwnProperty(Ne)&&(ue[Ne]=I[Ne]===void 0&&be!==void 0?be[Ne]:I[Ne])}var Ne=arguments.length-2;if(Ne===1)ue.children=ee;else if(1<Ne){be=Array(Ne);for(var ze=0;ze<Ne;ze++)be[ze]=arguments[ze+2];ue.children=be}return{$$typeof:i,type:S.type,key:he,ref:ye,props:ue,_owner:je}},Se.createContext=function(S){return S={$$typeof:m,_currentValue:S,_currentValue2:S,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},S.Provider={$$typeof:y,_context:S},S.Consumer=S},Se.createElement=V,Se.createFactory=function(S){var I=V.bind(null,S);return I.type=S,I},Se.createRef=function(){return{current:null}},Se.forwardRef=function(S){return{$$typeof:b,render:S}},Se.isValidElement=O,Se.lazy=function(S){return{$$typeof:g,_payload:{_status:-1,_result:S},_init:H}},Se.memo=function(S,I){return{$$typeof:p,type:S,compare:I===void 0?null:I}},Se.startTransition=function(S){var I=j.transition;j.transition={};try{S()}finally{j.transition=I}},Se.unstable_act=A,Se.useCallback=function(S,I){return ie.current.useCallback(S,I)},Se.useContext=function(S){return ie.current.useContext(S)},Se.useDebugValue=function(){},Se.useDeferredValue=function(S){return ie.current.useDeferredValue(S)},Se.useEffect=function(S,I){return ie.current.useEffect(S,I)},Se.useId=function(){return ie.current.useId()},Se.useImperativeHandle=function(S,I,ee){return ie.current.useImperativeHandle(S,I,ee)},Se.useInsertionEffect=function(S,I){return ie.current.useInsertionEffect(S,I)},Se.useLayoutEffect=function(S,I){return ie.current.useLayoutEffect(S,I)},Se.useMemo=function(S,I){return ie.current.useMemo(S,I)},Se.useReducer=function(S,I,ee){return ie.current.useReducer(S,I,ee)},Se.useRef=function(S){return ie.current.useRef(S)},Se.useState=function(S){return ie.current.useState(S)},Se.useSyncExternalStore=function(S,I,ee){return ie.current.useSyncExternalStore(S,I,ee)},Se.useTransition=function(){return ie.current.useTransition()},Se.version="18.3.1",Se}var lu;function po(){return lu||(lu=1,ha.exports=kf()),ha.exports}var au;function Ef(){if(au)return fo;au=1;var i=po(),c=Symbol.for("react.element"),l=Symbol.for("react.fragment"),d=Object.prototype.hasOwnProperty,f=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,y={key:!0,ref:!0,__self:!0,__source:!0};function m(b,h,p){var g,x={},C=null,D=null;p!==void 0&&(C=""+p),h.key!==void 0&&(C=""+h.key),h.ref!==void 0&&(D=h.ref);for(g in h)d.call(h,g)&&!y.hasOwnProperty(g)&&(x[g]=h[g]);if(b&&b.defaultProps)for(g in h=b.defaultProps,h)x[g]===void 0&&(x[g]=h[g]);return{$$typeof:c,type:b,key:C,ref:D,props:x,_owner:f.current}}return fo.Fragment=l,fo.jsx=m,fo.jsxs=m,fo}var iu;function Df(){return iu||(iu=1,pa.exports=Ef()),pa.exports}var o=Df(),N=po();const Du=Fa(N);var ks={},ga={exports:{}},dt={},ma={exports:{}},xa={};var cu;function Pf(){return cu||(cu=1,(function(i){function c(j,W){var A=j.length;j.push(W);e:for(;0<A;){var S=A-1>>>1,I=j[S];if(0<f(I,W))j[S]=W,j[A]=I,A=S;else break e}}function l(j){return j.length===0?null:j[0]}function d(j){if(j.length===0)return null;var W=j[0],A=j.pop();if(A!==W){j[0]=A;e:for(var S=0,I=j.length,ee=I>>>1;S<ee;){var ue=2*(S+1)-1,he=j[ue],ye=ue+1,je=j[ye];if(0>f(he,A))ye<I&&0>f(je,he)?(j[S]=je,j[ye]=A,S=ye):(j[S]=he,j[ue]=A,S=ue);else if(ye<I&&0>f(je,A))j[S]=je,j[ye]=A,S=ye;else break e}}return W}function f(j,W){var A=j.sortIndex-W.sortIndex;return A!==0?A:j.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var y=performance;i.unstable_now=function(){return y.now()}}else{var m=Date,b=m.now();i.unstable_now=function(){return m.now()-b}}var h=[],p=[],g=1,x=null,C=3,D=!1,v=!1,P=!1,F=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function se(j){for(var W=l(p);W!==null;){if(W.callback===null)d(p);else if(W.startTime<=j)d(p),W.sortIndex=W.expirationTime,c(h,W);else break;W=l(p)}}function Y(j){if(P=!1,se(j),!v)if(l(h)!==null)v=!0,H(z);else{var W=l(p);W!==null&&ie(Y,W.startTime-j)}}function z(j,W){v=!1,P&&(P=!1,M(V),V=-1),D=!0;var A=C;try{for(se(W),x=l(h);x!==null&&(!(x.expirationTime>W)||j&&!re());){var S=x.callback;if(typeof S=="function"){x.callback=null,C=x.priorityLevel;var I=S(x.expirationTime<=W);W=i.unstable_now(),typeof I=="function"?x.callback=I:x===l(h)&&d(h),se(W)}else d(h);x=l(h)}if(x!==null)var ee=!0;else{var ue=l(p);ue!==null&&ie(Y,ue.startTime-W),ee=!1}return ee}finally{x=null,C=A,D=!1}}var U=!1,K=null,V=-1,$=5,O=-1;function re(){return!(i.unstable_now()-O<$)}function le(){if(K!==null){var j=i.unstable_now();O=j;var W=!0;try{W=K(!0,j)}finally{W?Q():(U=!1,K=null)}}else U=!1}var Q;if(typeof B=="function")Q=function(){B(le)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,G=X.port2;X.port1.onmessage=le,Q=function(){G.postMessage(null)}}else Q=function(){F(le,0)};function H(j){K=j,U||(U=!0,Q())}function ie(j,W){V=F(function(){j(i.unstable_now())},W)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(j){j.callback=null},i.unstable_continueExecution=function(){v||D||(v=!0,H(z))},i.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<j?Math.floor(1e3/j):5},i.unstable_getCurrentPriorityLevel=function(){return C},i.unstable_getFirstCallbackNode=function(){return l(h)},i.unstable_next=function(j){switch(C){case 1:case 2:case 3:var W=3;break;default:W=C}var A=C;C=W;try{return j()}finally{C=A}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(j,W){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var A=C;C=j;try{return W()}finally{C=A}},i.unstable_scheduleCallback=function(j,W,A){var S=i.unstable_now();switch(typeof A=="object"&&A!==null?(A=A.delay,A=typeof A=="number"&&0<A?S+A:S):A=S,j){case 1:var I=-1;break;case 2:I=250;break;case 5:I=1073741823;break;case 4:I=1e4;break;default:I=5e3}return I=A+I,j={id:g++,callback:W,priorityLevel:j,startTime:A,expirationTime:I,sortIndex:-1},A>S?(j.sortIndex=A,c(p,j),l(h)===null&&j===l(p)&&(P?(M(V),V=-1):P=!0,ie(Y,A-S))):(j.sortIndex=I,c(h,j),v||D||(v=!0,H(z))),j},i.unstable_shouldYield=re,i.unstable_wrapCallback=function(j){var W=C;return function(){var A=C;C=W;try{return j.apply(this,arguments)}finally{C=A}}}})(xa)),xa}var uu;function Ff(){return uu||(uu=1,ma.exports=Pf()),ma.exports}var du;function Lf(){if(du)return dt;du=1;var i=po(),c=Ff();function l(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d=new Set,f={};function y(e,t){m(e,t),m(e+"Capture",t)}function m(e,t){for(f[e]=t,e=0;e<t.length;e++)d.add(t[e])}var b=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},x={};function C(e){return h.call(x,e)?!0:h.call(g,e)?!1:p.test(e)?x[e]=!0:(g[e]=!0,!1)}function D(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function v(e,t,n,r){if(t===null||typeof t>"u"||D(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function P(e,t,n,r,s,a,u){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=u}var F={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){F[e]=new P(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];F[t]=new P(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){F[e]=new P(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){F[e]=new P(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){F[e]=new P(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){F[e]=new P(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){F[e]=new P(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){F[e]=new P(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){F[e]=new P(e,5,!1,e.toLowerCase(),null,!1,!1)});var M=/[\-:]([a-z])/g;function B(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(M,B);F[t]=new P(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(M,B);F[t]=new P(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(M,B);F[t]=new P(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){F[e]=new P(e,1,!1,e.toLowerCase(),null,!1,!1)}),F.xlinkHref=new P("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){F[e]=new P(e,1,!1,e.toLowerCase(),null,!0,!0)});function se(e,t,n,r){var s=F.hasOwnProperty(t)?F[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(v(t,n,s,r)&&(n=null),r||s===null?C(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Y=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,z=Symbol.for("react.element"),U=Symbol.for("react.portal"),K=Symbol.for("react.fragment"),V=Symbol.for("react.strict_mode"),$=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),re=Symbol.for("react.context"),le=Symbol.for("react.forward_ref"),Q=Symbol.for("react.suspense"),X=Symbol.for("react.suspense_list"),G=Symbol.for("react.memo"),H=Symbol.for("react.lazy"),ie=Symbol.for("react.offscreen"),j=Symbol.iterator;function W(e){return e===null||typeof e!="object"?null:(e=j&&e[j]||e["@@iterator"],typeof e=="function"?e:null)}var A=Object.assign,S;function I(e){if(S===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);S=t&&t[1]||""}return`
`+S+e}var ee=!1;function ue(e,t){if(!e||ee)return"";ee=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(R){var r=R}Reflect.construct(e,[],t)}else{try{t.call()}catch(R){r=R}e.call(t.prototype)}else{try{throw Error()}catch(R){r=R}e()}}catch(R){if(R&&r&&typeof R.stack=="string"){for(var s=R.stack.split(`
`),a=r.stack.split(`
`),u=s.length-1,w=a.length-1;1<=u&&0<=w&&s[u]!==a[w];)w--;for(;1<=u&&0<=w;u--,w--)if(s[u]!==a[w]){if(u!==1||w!==1)do if(u--,w--,0>w||s[u]!==a[w]){var k=`
`+s[u].replace(" at new "," at ");return e.displayName&&k.includes("<anonymous>")&&(k=k.replace("<anonymous>",e.displayName)),k}while(1<=u&&0<=w);break}}}finally{ee=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?I(e):""}function he(e){switch(e.tag){case 5:return I(e.type);case 16:return I("Lazy");case 13:return I("Suspense");case 19:return I("SuspenseList");case 0:case 2:case 15:return e=ue(e.type,!1),e;case 11:return e=ue(e.type.render,!1),e;case 1:return e=ue(e.type,!0),e;default:return""}}function ye(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case K:return"Fragment";case U:return"Portal";case $:return"Profiler";case V:return"StrictMode";case Q:return"Suspense";case X:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case re:return(e.displayName||"Context")+".Consumer";case O:return(e._context.displayName||"Context")+".Provider";case le:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case G:return t=e.displayName||null,t!==null?t:ye(e.type)||"Memo";case H:t=e._payload,e=e._init;try{return ye(e(t))}catch{}}return null}function je(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ye(t);case 8:return t===V?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function be(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ne(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function ze(e){var t=Ne(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(u){r=""+u,a.call(this,u)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(u){r=""+u},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function bt(e){e._valueTracker||(e._valueTracker=ze(e))}function sn(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Ne(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function te(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Me(e,t){var n=t.checked;return A({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function De(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=be(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Te(e,t){t=t.checked,t!=null&&se(e,"checked",t,!1)}function br(e,t){Te(e,t);var n=be(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Yn(e,t.type,n):t.hasOwnProperty("defaultValue")&&Yn(e,t.type,be(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Yt(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Yn(e,t,n){(t!=="number"||te(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Vt=Array.isArray;function Mt(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+be(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function En(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(l(91));return A({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Nr(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(l(92));if(Vt(n)){if(1<n.length)throw Error(l(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:be(n)}}function Cr(e,t){var n=be(t.value),r=be(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function ho(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function kr(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Er(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?kr(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var _t,go=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e})(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(_t=_t||document.createElement("div"),_t.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=_t.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Xt(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Dn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ln=["Webkit","ms","Moz","O"];Object.keys(Dn).forEach(function(e){ln.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Dn[t]=Dn[e]})});function Dr(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Dn.hasOwnProperty(e)&&Dn[e]?(""+t).trim():t+"px"}function Gt(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Dr(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var mo=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Rt(e,t){if(t){if(mo[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(l(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(l(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(l(61))}if(t.style!=null&&typeof t.style!="object")throw Error(l(62))}}function Vn(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mt=null;function Zt(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Pr=null,zt=null,Tt=null;function st(e){if(e=Kr(e)){if(typeof Pr!="function")throw Error(l(280));var t=e.stateNode;t&&(t=Uo(t),Pr(e.stateNode,e.type,t))}}function xo(e){zt?Tt?Tt.push(e):Tt=[e]:zt=e}function At(){if(zt){var e=zt,t=Tt;if(Tt=zt=null,st(e),t)for(e=0;e<t.length;e++)st(t[e])}}function Xn(e,t){return e(t)}function yo(){}var Pn=!1;function vo(e,t,n){if(Pn)return e(t,n);Pn=!0;try{return Xn(e,t,n)}finally{Pn=!1,(zt!==null||Tt!==null)&&(yo(),At())}}function Fn(e,t){var n=e.stateNode;if(n===null)return null;var r=Uo(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(l(231,t,typeof n));return n}var Fr=!1;if(b)try{var Kt={};Object.defineProperty(Kt,"passive",{get:function(){Fr=!0}}),window.addEventListener("test",Kt,Kt),window.removeEventListener("test",Kt,Kt)}catch{Fr=!1}function Ls(e,t,n,r,s,a,u,w,k){var R=Array.prototype.slice.call(arguments,3);try{t.apply(n,R)}catch(q){this.onError(q)}}var Ln=!1,Gn=null,Zn=!1,Lr=null,Kn={onError:function(e){Ln=!0,Gn=e}};function Is(e,t,n,r,s,a,u,w,k){Ln=!1,Gn=null,Ls.apply(Kn,arguments)}function J(e,t,n,r,s,a,u,w,k){if(Is.apply(this,arguments),Ln){if(Ln){var R=Gn;Ln=!1,Gn=null}else throw Error(l(198));Zn||(Zn=!0,Lr=R)}}function ge(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function we(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ke(e){if(ge(e)!==e)throw Error(l(188))}function Ae(e){var t=e.alternate;if(!t){if(t=ge(e),t===null)throw Error(l(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var a=s.alternate;if(a===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===n)return ke(s),e;if(a===r)return ke(s),t;a=a.sibling}throw Error(l(188))}if(n.return!==r.return)n=s,r=a;else{for(var u=!1,w=s.child;w;){if(w===n){u=!0,n=s,r=a;break}if(w===r){u=!0,r=s,n=a;break}w=w.sibling}if(!u){for(w=a.child;w;){if(w===n){u=!0,n=a,r=s;break}if(w===r){u=!0,r=a,n=s;break}w=w.sibling}if(!u)throw Error(l(189))}}if(n.alternate!==r)throw Error(l(190))}if(n.tag!==3)throw Error(l(188));return n.stateNode.current===n?e:t}function _e(e){return e=Ae(e),e!==null?nt(e):null}function nt(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=nt(e);if(t!==null)return t;e=e.sibling}return null}var Nt=c.unstable_scheduleCallback,Ot=c.unstable_cancelCallback,Ma=c.unstable_shouldYield,wo=c.unstable_requestPaint,$e=c.unstable_now,Au=c.unstable_getCurrentPriorityLevel,Ms=c.unstable_ImmediatePriority,_a=c.unstable_UserBlockingPriority,jo=c.unstable_NormalPriority,Ou=c.unstable_LowPriority,Ra=c.unstable_IdlePriority,So=null,Bt=null;function Bu(e){if(Bt&&typeof Bt.onCommitFiberRoot=="function")try{Bt.onCommitFiberRoot(So,e,void 0,(e.current.flags&128)===128)}catch{}}var Ct=Math.clz32?Math.clz32:Hu,Uu=Math.log,$u=Math.LN2;function Hu(e){return e>>>=0,e===0?32:31-(Uu(e)/$u|0)|0}var bo=64,No=4194304;function Ir(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Co(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,a=e.pingedLanes,u=n&268435455;if(u!==0){var w=u&~s;w!==0?r=Ir(w):(a&=u,a!==0&&(r=Ir(a)))}else u=n&~s,u!==0?r=Ir(u):a!==0&&(r=Ir(a));if(r===0)return 0;if(t!==0&&t!==r&&(t&s)===0&&(s=r&-r,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if((r&4)!==0&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Ct(t),s=1<<n,r|=e[n],t&=~s;return r}function Wu(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yu(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var u=31-Ct(a),w=1<<u,k=s[u];k===-1?((w&n)===0||(w&r)!==0)&&(s[u]=Wu(w,t)):k<=t&&(e.expiredLanes|=w),a&=~w}}function _s(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function za(){var e=bo;return bo<<=1,(bo&4194240)===0&&(bo=64),e}function Rs(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Mr(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ct(t),e[t]=n}function Vu(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-Ct(n),a=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~a}}function zs(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Ct(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var Pe=0;function Ta(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var Aa,Ts,Oa,Ba,Ua,As=!1,ko=[],an=null,cn=null,un=null,_r=new Map,Rr=new Map,dn=[],Xu="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $a(e,t){switch(e){case"focusin":case"focusout":an=null;break;case"dragenter":case"dragleave":cn=null;break;case"mouseover":case"mouseout":un=null;break;case"pointerover":case"pointerout":_r.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rr.delete(t.pointerId)}}function zr(e,t,n,r,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[s]},t!==null&&(t=Kr(t),t!==null&&Ts(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Gu(e,t,n,r,s){switch(t){case"focusin":return an=zr(an,e,t,n,r,s),!0;case"dragenter":return cn=zr(cn,e,t,n,r,s),!0;case"mouseover":return un=zr(un,e,t,n,r,s),!0;case"pointerover":var a=s.pointerId;return _r.set(a,zr(_r.get(a)||null,e,t,n,r,s)),!0;case"gotpointercapture":return a=s.pointerId,Rr.set(a,zr(Rr.get(a)||null,e,t,n,r,s)),!0}return!1}function Ha(e){var t=In(e.target);if(t!==null){var n=ge(t);if(n!==null){if(t=n.tag,t===13){if(t=we(n),t!==null){e.blockedOn=t,Ua(e.priority,function(){Oa(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Eo(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Bs(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);mt=r,n.target.dispatchEvent(r),mt=null}else return t=Kr(n),t!==null&&Ts(t),e.blockedOn=n,!1;t.shift()}return!0}function Wa(e,t,n){Eo(e)&&n.delete(t)}function Zu(){As=!1,an!==null&&Eo(an)&&(an=null),cn!==null&&Eo(cn)&&(cn=null),un!==null&&Eo(un)&&(un=null),_r.forEach(Wa),Rr.forEach(Wa)}function Tr(e,t){e.blockedOn===t&&(e.blockedOn=null,As||(As=!0,c.unstable_scheduleCallback(c.unstable_NormalPriority,Zu)))}function Ar(e){function t(s){return Tr(s,e)}if(0<ko.length){Tr(ko[0],e);for(var n=1;n<ko.length;n++){var r=ko[n];r.blockedOn===e&&(r.blockedOn=null)}}for(an!==null&&Tr(an,e),cn!==null&&Tr(cn,e),un!==null&&Tr(un,e),_r.forEach(t),Rr.forEach(t),n=0;n<dn.length;n++)r=dn[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<dn.length&&(n=dn[0],n.blockedOn===null);)Ha(n),n.blockedOn===null&&dn.shift()}var Qn=Y.ReactCurrentBatchConfig,Do=!0;function Ku(e,t,n,r){var s=Pe,a=Qn.transition;Qn.transition=null;try{Pe=1,Os(e,t,n,r)}finally{Pe=s,Qn.transition=a}}function Qu(e,t,n,r){var s=Pe,a=Qn.transition;Qn.transition=null;try{Pe=4,Os(e,t,n,r)}finally{Pe=s,Qn.transition=a}}function Os(e,t,n,r){if(Do){var s=Bs(e,t,n,r);if(s===null)rl(e,t,r,Po,n),$a(e,r);else if(Gu(s,e,t,n,r))r.stopPropagation();else if($a(e,r),t&4&&-1<Xu.indexOf(e)){for(;s!==null;){var a=Kr(s);if(a!==null&&Aa(a),a=Bs(e,t,n,r),a===null&&rl(e,t,r,Po,n),a===s)break;s=a}s!==null&&r.stopPropagation()}else rl(e,t,r,null,n)}}var Po=null;function Bs(e,t,n,r){if(Po=null,e=Zt(r),e=In(e),e!==null)if(t=ge(e),t===null)e=null;else if(n=t.tag,n===13){if(e=we(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Po=e,null}function Ya(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Au()){case Ms:return 1;case _a:return 4;case jo:case Ou:return 16;case Ra:return 536870912;default:return 16}default:return 16}}var fn=null,Us=null,Fo=null;function Va(){if(Fo)return Fo;var e,t=Us,n=t.length,r,s="value"in fn?fn.value:fn.textContent,a=s.length;for(e=0;e<n&&t[e]===s[e];e++);var u=n-e;for(r=1;r<=u&&t[n-r]===s[a-r];r++);return Fo=s.slice(e,1<r?1-r:void 0)}function Lo(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Io(){return!0}function Xa(){return!1}function ft(e){function t(n,r,s,a,u){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=a,this.target=u,this.currentTarget=null;for(var w in e)e.hasOwnProperty(w)&&(n=e[w],this[w]=n?n(a):a[w]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Io:Xa,this.isPropagationStopped=Xa,this}return A(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Io)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Io)},persist:function(){},isPersistent:Io}),t}var Jn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$s=ft(Jn),Or=A({},Jn,{view:0,detail:0}),Ju=ft(Or),Hs,Ws,Br,Mo=A({},Or,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Vs,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Br&&(Br&&e.type==="mousemove"?(Hs=e.screenX-Br.screenX,Ws=e.screenY-Br.screenY):Ws=Hs=0,Br=e),Hs)},movementY:function(e){return"movementY"in e?e.movementY:Ws}}),Ga=ft(Mo),qu=A({},Mo,{dataTransfer:0}),ed=ft(qu),td=A({},Or,{relatedTarget:0}),Ys=ft(td),nd=A({},Jn,{animationName:0,elapsedTime:0,pseudoElement:0}),rd=ft(nd),od=A({},Jn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),sd=ft(od),ld=A({},Jn,{data:0}),Za=ft(ld),ad={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},id={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ud(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=cd[e])?!!t[e]:!1}function Vs(){return ud}var dd=A({},Or,{key:function(e){if(e.key){var t=ad[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Lo(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?id[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Vs,charCode:function(e){return e.type==="keypress"?Lo(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Lo(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),fd=ft(dd),pd=A({},Mo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ka=ft(pd),hd=A({},Or,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Vs}),gd=ft(hd),md=A({},Jn,{propertyName:0,elapsedTime:0,pseudoElement:0}),xd=ft(md),yd=A({},Mo,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),vd=ft(yd),wd=[9,13,27,32],Xs=b&&"CompositionEvent"in window,Ur=null;b&&"documentMode"in document&&(Ur=document.documentMode);var jd=b&&"TextEvent"in window&&!Ur,Qa=b&&(!Xs||Ur&&8<Ur&&11>=Ur),Ja=" ",qa=!1;function ei(e,t){switch(e){case"keyup":return wd.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ti(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var qn=!1;function Sd(e,t){switch(e){case"compositionend":return ti(t);case"keypress":return t.which!==32?null:(qa=!0,Ja);case"textInput":return e=t.data,e===Ja&&qa?null:e;default:return null}}function bd(e,t){if(qn)return e==="compositionend"||!Xs&&ei(e,t)?(e=Va(),Fo=Us=fn=null,qn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Qa&&t.locale!=="ko"?null:t.data;default:return null}}var Nd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ni(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Nd[e.type]:t==="textarea"}function ri(e,t,n,r){xo(r),t=Ao(t,"onChange"),0<t.length&&(n=new $s("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var $r=null,Hr=null;function Cd(e){ji(e,0)}function _o(e){var t=or(e);if(sn(t))return e}function kd(e,t){if(e==="change")return t}var oi=!1;if(b){var Gs;if(b){var Zs="oninput"in document;if(!Zs){var si=document.createElement("div");si.setAttribute("oninput","return;"),Zs=typeof si.oninput=="function"}Gs=Zs}else Gs=!1;oi=Gs&&(!document.documentMode||9<document.documentMode)}function li(){$r&&($r.detachEvent("onpropertychange",ai),Hr=$r=null)}function ai(e){if(e.propertyName==="value"&&_o(Hr)){var t=[];ri(t,Hr,e,Zt(e)),vo(Cd,t)}}function Ed(e,t,n){e==="focusin"?(li(),$r=t,Hr=n,$r.attachEvent("onpropertychange",ai)):e==="focusout"&&li()}function Dd(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return _o(Hr)}function Pd(e,t){if(e==="click")return _o(t)}function Fd(e,t){if(e==="input"||e==="change")return _o(t)}function Ld(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var kt=typeof Object.is=="function"?Object.is:Ld;function Wr(e,t){if(kt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!h.call(t,s)||!kt(e[s],t[s]))return!1}return!0}function ii(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ci(e,t){var n=ii(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ii(n)}}function ui(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?ui(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function di(){for(var e=window,t=te();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=te(e.document)}return t}function Ks(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Id(e){var t=di(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ui(n.ownerDocument.documentElement,n)){if(r!==null&&Ks(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,a=Math.min(r.start,s);r=r.end===void 0?a:Math.min(r.end,s),!e.extend&&a>r&&(s=r,r=a,a=s),s=ci(n,a);var u=ci(n,r);s&&u&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==u.node||e.focusOffset!==u.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(u.node,u.offset)):(t.setEnd(u.node,u.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Md=b&&"documentMode"in document&&11>=document.documentMode,er=null,Qs=null,Yr=null,Js=!1;function fi(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Js||er==null||er!==te(r)||(r=er,"selectionStart"in r&&Ks(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Yr&&Wr(Yr,r)||(Yr=r,r=Ao(Qs,"onSelect"),0<r.length&&(t=new $s("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=er)))}function Ro(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var tr={animationend:Ro("Animation","AnimationEnd"),animationiteration:Ro("Animation","AnimationIteration"),animationstart:Ro("Animation","AnimationStart"),transitionend:Ro("Transition","TransitionEnd")},qs={},pi={};b&&(pi=document.createElement("div").style,"AnimationEvent"in window||(delete tr.animationend.animation,delete tr.animationiteration.animation,delete tr.animationstart.animation),"TransitionEvent"in window||delete tr.transitionend.transition);function zo(e){if(qs[e])return qs[e];if(!tr[e])return e;var t=tr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in pi)return qs[e]=t[n];return e}var hi=zo("animationend"),gi=zo("animationiteration"),mi=zo("animationstart"),xi=zo("transitionend"),yi=new Map,vi="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function pn(e,t){yi.set(e,t),y(t,[e])}for(var el=0;el<vi.length;el++){var tl=vi[el],_d=tl.toLowerCase(),Rd=tl[0].toUpperCase()+tl.slice(1);pn(_d,"on"+Rd)}pn(hi,"onAnimationEnd"),pn(gi,"onAnimationIteration"),pn(mi,"onAnimationStart"),pn("dblclick","onDoubleClick"),pn("focusin","onFocus"),pn("focusout","onBlur"),pn(xi,"onTransitionEnd"),m("onMouseEnter",["mouseout","mouseover"]),m("onMouseLeave",["mouseout","mouseover"]),m("onPointerEnter",["pointerout","pointerover"]),m("onPointerLeave",["pointerout","pointerover"]),y("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),y("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),y("onBeforeInput",["compositionend","keypress","textInput","paste"]),y("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),y("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),y("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zd=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vr));function wi(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,J(r,t,void 0,e),e.currentTarget=null}function ji(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var u=r.length-1;0<=u;u--){var w=r[u],k=w.instance,R=w.currentTarget;if(w=w.listener,k!==a&&s.isPropagationStopped())break e;wi(s,w,R),a=k}else for(u=0;u<r.length;u++){if(w=r[u],k=w.instance,R=w.currentTarget,w=w.listener,k!==a&&s.isPropagationStopped())break e;wi(s,w,R),a=k}}}if(Zn)throw e=Lr,Zn=!1,Lr=null,e}function Le(e,t){var n=t[cl];n===void 0&&(n=t[cl]=new Set);var r=e+"__bubble";n.has(r)||(Si(t,e,2,!1),n.add(r))}function nl(e,t,n){var r=0;t&&(r|=4),Si(n,e,r,t)}var To="_reactListening"+Math.random().toString(36).slice(2);function Xr(e){if(!e[To]){e[To]=!0,d.forEach(function(n){n!=="selectionchange"&&(zd.has(n)||nl(n,!1,e),nl(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[To]||(t[To]=!0,nl("selectionchange",!1,t))}}function Si(e,t,n,r){switch(Ya(t)){case 1:var s=Ku;break;case 4:s=Qu;break;default:s=Os}n=s.bind(null,t,n,e),s=void 0,!Fr||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function rl(e,t,n,r,s){var a=r;if((t&1)===0&&(t&2)===0&&r!==null)e:for(;;){if(r===null)return;var u=r.tag;if(u===3||u===4){var w=r.stateNode.containerInfo;if(w===s||w.nodeType===8&&w.parentNode===s)break;if(u===4)for(u=r.return;u!==null;){var k=u.tag;if((k===3||k===4)&&(k=u.stateNode.containerInfo,k===s||k.nodeType===8&&k.parentNode===s))return;u=u.return}for(;w!==null;){if(u=In(w),u===null)return;if(k=u.tag,k===5||k===6){r=a=u;continue e}w=w.parentNode}}r=r.return}vo(function(){var R=a,q=Zt(n),ne=[];e:{var Z=yi.get(e);if(Z!==void 0){var ae=$s,de=e;switch(e){case"keypress":if(Lo(n)===0)break e;case"keydown":case"keyup":ae=fd;break;case"focusin":de="focus",ae=Ys;break;case"focusout":de="blur",ae=Ys;break;case"beforeblur":case"afterblur":ae=Ys;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ae=Ga;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ae=ed;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ae=gd;break;case hi:case gi:case mi:ae=rd;break;case xi:ae=xd;break;case"scroll":ae=Ju;break;case"wheel":ae=vd;break;case"copy":case"cut":case"paste":ae=sd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ae=Ka}var fe=(t&4)!==0,He=!fe&&e==="scroll",L=fe?Z!==null?Z+"Capture":null:Z;fe=[];for(var E=R,_;E!==null;){_=E;var oe=_.stateNode;if(_.tag===5&&oe!==null&&(_=oe,L!==null&&(oe=Fn(E,L),oe!=null&&fe.push(Gr(E,oe,_)))),He)break;E=E.return}0<fe.length&&(Z=new ae(Z,de,null,n,q),ne.push({event:Z,listeners:fe}))}}if((t&7)===0){e:{if(Z=e==="mouseover"||e==="pointerover",ae=e==="mouseout"||e==="pointerout",Z&&n!==mt&&(de=n.relatedTarget||n.fromElement)&&(In(de)||de[Qt]))break e;if((ae||Z)&&(Z=q.window===q?q:(Z=q.ownerDocument)?Z.defaultView||Z.parentWindow:window,ae?(de=n.relatedTarget||n.toElement,ae=R,de=de?In(de):null,de!==null&&(He=ge(de),de!==He||de.tag!==5&&de.tag!==6)&&(de=null)):(ae=null,de=R),ae!==de)){if(fe=Ga,oe="onMouseLeave",L="onMouseEnter",E="mouse",(e==="pointerout"||e==="pointerover")&&(fe=Ka,oe="onPointerLeave",L="onPointerEnter",E="pointer"),He=ae==null?Z:or(ae),_=de==null?Z:or(de),Z=new fe(oe,E+"leave",ae,n,q),Z.target=He,Z.relatedTarget=_,oe=null,In(q)===R&&(fe=new fe(L,E+"enter",de,n,q),fe.target=_,fe.relatedTarget=He,oe=fe),He=oe,ae&&de)t:{for(fe=ae,L=de,E=0,_=fe;_;_=nr(_))E++;for(_=0,oe=L;oe;oe=nr(oe))_++;for(;0<E-_;)fe=nr(fe),E--;for(;0<_-E;)L=nr(L),_--;for(;E--;){if(fe===L||L!==null&&fe===L.alternate)break t;fe=nr(fe),L=nr(L)}fe=null}else fe=null;ae!==null&&bi(ne,Z,ae,fe,!1),de!==null&&He!==null&&bi(ne,He,de,fe,!0)}}e:{if(Z=R?or(R):window,ae=Z.nodeName&&Z.nodeName.toLowerCase(),ae==="select"||ae==="input"&&Z.type==="file")var pe=kd;else if(ni(Z))if(oi)pe=Fd;else{pe=Dd;var me=Ed}else(ae=Z.nodeName)&&ae.toLowerCase()==="input"&&(Z.type==="checkbox"||Z.type==="radio")&&(pe=Pd);if(pe&&(pe=pe(e,R))){ri(ne,pe,n,q);break e}me&&me(e,Z,R),e==="focusout"&&(me=Z._wrapperState)&&me.controlled&&Z.type==="number"&&Yn(Z,"number",Z.value)}switch(me=R?or(R):window,e){case"focusin":(ni(me)||me.contentEditable==="true")&&(er=me,Qs=R,Yr=null);break;case"focusout":Yr=Qs=er=null;break;case"mousedown":Js=!0;break;case"contextmenu":case"mouseup":case"dragend":Js=!1,fi(ne,n,q);break;case"selectionchange":if(Md)break;case"keydown":case"keyup":fi(ne,n,q)}var xe;if(Xs)e:{switch(e){case"compositionstart":var ve="onCompositionStart";break e;case"compositionend":ve="onCompositionEnd";break e;case"compositionupdate":ve="onCompositionUpdate";break e}ve=void 0}else qn?ei(e,n)&&(ve="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(ve="onCompositionStart");ve&&(Qa&&n.locale!=="ko"&&(qn||ve!=="onCompositionStart"?ve==="onCompositionEnd"&&qn&&(xe=Va()):(fn=q,Us="value"in fn?fn.value:fn.textContent,qn=!0)),me=Ao(R,ve),0<me.length&&(ve=new Za(ve,e,null,n,q),ne.push({event:ve,listeners:me}),xe?ve.data=xe:(xe=ti(n),xe!==null&&(ve.data=xe)))),(xe=jd?Sd(e,n):bd(e,n))&&(R=Ao(R,"onBeforeInput"),0<R.length&&(q=new Za("onBeforeInput","beforeinput",null,n,q),ne.push({event:q,listeners:R}),q.data=xe))}ji(ne,t)})}function Gr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ao(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=Fn(e,n),a!=null&&r.unshift(Gr(e,a,s)),a=Fn(e,t),a!=null&&r.push(Gr(e,a,s))),e=e.return}return r}function nr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function bi(e,t,n,r,s){for(var a=t._reactName,u=[];n!==null&&n!==r;){var w=n,k=w.alternate,R=w.stateNode;if(k!==null&&k===r)break;w.tag===5&&R!==null&&(w=R,s?(k=Fn(n,a),k!=null&&u.unshift(Gr(n,k,w))):s||(k=Fn(n,a),k!=null&&u.push(Gr(n,k,w)))),n=n.return}u.length!==0&&e.push({event:t,listeners:u})}var Td=/\r\n?/g,Ad=/\u0000|\uFFFD/g;function Ni(e){return(typeof e=="string"?e:""+e).replace(Td,`
`).replace(Ad,"")}function Oo(e,t,n){if(t=Ni(t),Ni(e)!==t&&n)throw Error(l(425))}function Bo(){}var ol=null,sl=null;function ll(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var al=typeof setTimeout=="function"?setTimeout:void 0,Od=typeof clearTimeout=="function"?clearTimeout:void 0,Ci=typeof Promise=="function"?Promise:void 0,Bd=typeof queueMicrotask=="function"?queueMicrotask:typeof Ci<"u"?function(e){return Ci.resolve(null).then(e).catch(Ud)}:al;function Ud(e){setTimeout(function(){throw e})}function il(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),Ar(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Ar(t)}function hn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function ki(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var rr=Math.random().toString(36).slice(2),Ut="__reactFiber$"+rr,Zr="__reactProps$"+rr,Qt="__reactContainer$"+rr,cl="__reactEvents$"+rr,$d="__reactListeners$"+rr,Hd="__reactHandles$"+rr;function In(e){var t=e[Ut];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Qt]||n[Ut]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=ki(e);e!==null;){if(n=e[Ut])return n;e=ki(e)}return t}e=n,n=e.parentNode}return null}function Kr(e){return e=e[Ut]||e[Qt],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function or(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(l(33))}function Uo(e){return e[Zr]||null}var ul=[],sr=-1;function gn(e){return{current:e}}function Ie(e){0>sr||(e.current=ul[sr],ul[sr]=null,sr--)}function Fe(e,t){sr++,ul[sr]=e.current,e.current=t}var mn={},Je=gn(mn),lt=gn(!1),Mn=mn;function lr(e,t){var n=e.type.contextTypes;if(!n)return mn;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in n)s[a]=t[a];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function at(e){return e=e.childContextTypes,e!=null}function $o(){Ie(lt),Ie(Je)}function Ei(e,t,n){if(Je.current!==mn)throw Error(l(168));Fe(Je,t),Fe(lt,n)}function Di(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(l(108,je(e)||"Unknown",s));return A({},n,r)}function Ho(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||mn,Mn=Je.current,Fe(Je,e),Fe(lt,lt.current),!0}function Pi(e,t,n){var r=e.stateNode;if(!r)throw Error(l(169));n?(e=Di(e,t,Mn),r.__reactInternalMemoizedMergedChildContext=e,Ie(lt),Ie(Je),Fe(Je,e)):Ie(lt),Fe(lt,n)}var Jt=null,Wo=!1,dl=!1;function Fi(e){Jt===null?Jt=[e]:Jt.push(e)}function Wd(e){Wo=!0,Fi(e)}function xn(){if(!dl&&Jt!==null){dl=!0;var e=0,t=Pe;try{var n=Jt;for(Pe=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Jt=null,Wo=!1}catch(s){throw Jt!==null&&(Jt=Jt.slice(e+1)),Nt(Ms,xn),s}finally{Pe=t,dl=!1}}return null}var ar=[],ir=0,Yo=null,Vo=0,xt=[],yt=0,_n=null,qt=1,en="";function Rn(e,t){ar[ir++]=Vo,ar[ir++]=Yo,Yo=e,Vo=t}function Li(e,t,n){xt[yt++]=qt,xt[yt++]=en,xt[yt++]=_n,_n=e;var r=qt;e=en;var s=32-Ct(r)-1;r&=~(1<<s),n+=1;var a=32-Ct(t)+s;if(30<a){var u=s-s%5;a=(r&(1<<u)-1).toString(32),r>>=u,s-=u,qt=1<<32-Ct(t)+s|n<<s|r,en=a+e}else qt=1<<a|n<<s|r,en=e}function fl(e){e.return!==null&&(Rn(e,1),Li(e,1,0))}function pl(e){for(;e===Yo;)Yo=ar[--ir],ar[ir]=null,Vo=ar[--ir],ar[ir]=null;for(;e===_n;)_n=xt[--yt],xt[yt]=null,en=xt[--yt],xt[yt]=null,qt=xt[--yt],xt[yt]=null}var pt=null,ht=null,Re=!1,Et=null;function Ii(e,t){var n=St(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Mi(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,pt=e,ht=hn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,pt=e,ht=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=_n!==null?{id:qt,overflow:en}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=St(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,pt=e,ht=null,!0):!1;default:return!1}}function hl(e){return(e.mode&1)!==0&&(e.flags&128)===0}function gl(e){if(Re){var t=ht;if(t){var n=t;if(!Mi(e,t)){if(hl(e))throw Error(l(418));t=hn(n.nextSibling);var r=pt;t&&Mi(e,t)?Ii(r,n):(e.flags=e.flags&-4097|2,Re=!1,pt=e)}}else{if(hl(e))throw Error(l(418));e.flags=e.flags&-4097|2,Re=!1,pt=e}}}function _i(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;pt=e}function Xo(e){if(e!==pt)return!1;if(!Re)return _i(e),Re=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ll(e.type,e.memoizedProps)),t&&(t=ht)){if(hl(e))throw Ri(),Error(l(418));for(;t;)Ii(e,t),t=hn(t.nextSibling)}if(_i(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){ht=hn(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}ht=null}}else ht=pt?hn(e.stateNode.nextSibling):null;return!0}function Ri(){for(var e=ht;e;)e=hn(e.nextSibling)}function cr(){ht=pt=null,Re=!1}function ml(e){Et===null?Et=[e]:Et.push(e)}var Yd=Y.ReactCurrentBatchConfig;function Qr(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(l(309));var r=n.stateNode}if(!r)throw Error(l(147,e));var s=r,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(u){var w=s.refs;u===null?delete w[a]:w[a]=u},t._stringRef=a,t)}if(typeof e!="string")throw Error(l(284));if(!n._owner)throw Error(l(290,e))}return e}function Go(e,t){throw e=Object.prototype.toString.call(t),Error(l(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function zi(e){var t=e._init;return t(e._payload)}function Ti(e){function t(L,E){if(e){var _=L.deletions;_===null?(L.deletions=[E],L.flags|=16):_.push(E)}}function n(L,E){if(!e)return null;for(;E!==null;)t(L,E),E=E.sibling;return null}function r(L,E){for(L=new Map;E!==null;)E.key!==null?L.set(E.key,E):L.set(E.index,E),E=E.sibling;return L}function s(L,E){return L=Cn(L,E),L.index=0,L.sibling=null,L}function a(L,E,_){return L.index=_,e?(_=L.alternate,_!==null?(_=_.index,_<E?(L.flags|=2,E):_):(L.flags|=2,E)):(L.flags|=1048576,E)}function u(L){return e&&L.alternate===null&&(L.flags|=2),L}function w(L,E,_,oe){return E===null||E.tag!==6?(E=aa(_,L.mode,oe),E.return=L,E):(E=s(E,_),E.return=L,E)}function k(L,E,_,oe){var pe=_.type;return pe===K?q(L,E,_.props.children,oe,_.key):E!==null&&(E.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===H&&zi(pe)===E.type)?(oe=s(E,_.props),oe.ref=Qr(L,E,_),oe.return=L,oe):(oe=ys(_.type,_.key,_.props,null,L.mode,oe),oe.ref=Qr(L,E,_),oe.return=L,oe)}function R(L,E,_,oe){return E===null||E.tag!==4||E.stateNode.containerInfo!==_.containerInfo||E.stateNode.implementation!==_.implementation?(E=ia(_,L.mode,oe),E.return=L,E):(E=s(E,_.children||[]),E.return=L,E)}function q(L,E,_,oe,pe){return E===null||E.tag!==7?(E=Hn(_,L.mode,oe,pe),E.return=L,E):(E=s(E,_),E.return=L,E)}function ne(L,E,_){if(typeof E=="string"&&E!==""||typeof E=="number")return E=aa(""+E,L.mode,_),E.return=L,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case z:return _=ys(E.type,E.key,E.props,null,L.mode,_),_.ref=Qr(L,null,E),_.return=L,_;case U:return E=ia(E,L.mode,_),E.return=L,E;case H:var oe=E._init;return ne(L,oe(E._payload),_)}if(Vt(E)||W(E))return E=Hn(E,L.mode,_,null),E.return=L,E;Go(L,E)}return null}function Z(L,E,_,oe){var pe=E!==null?E.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return pe!==null?null:w(L,E,""+_,oe);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case z:return _.key===pe?k(L,E,_,oe):null;case U:return _.key===pe?R(L,E,_,oe):null;case H:return pe=_._init,Z(L,E,pe(_._payload),oe)}if(Vt(_)||W(_))return pe!==null?null:q(L,E,_,oe,null);Go(L,_)}return null}function ae(L,E,_,oe,pe){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return L=L.get(_)||null,w(E,L,""+oe,pe);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case z:return L=L.get(oe.key===null?_:oe.key)||null,k(E,L,oe,pe);case U:return L=L.get(oe.key===null?_:oe.key)||null,R(E,L,oe,pe);case H:var me=oe._init;return ae(L,E,_,me(oe._payload),pe)}if(Vt(oe)||W(oe))return L=L.get(_)||null,q(E,L,oe,pe,null);Go(E,oe)}return null}function de(L,E,_,oe){for(var pe=null,me=null,xe=E,ve=E=0,Ze=null;xe!==null&&ve<_.length;ve++){xe.index>ve?(Ze=xe,xe=null):Ze=xe.sibling;var Ee=Z(L,xe,_[ve],oe);if(Ee===null){xe===null&&(xe=Ze);break}e&&xe&&Ee.alternate===null&&t(L,xe),E=a(Ee,E,ve),me===null?pe=Ee:me.sibling=Ee,me=Ee,xe=Ze}if(ve===_.length)return n(L,xe),Re&&Rn(L,ve),pe;if(xe===null){for(;ve<_.length;ve++)xe=ne(L,_[ve],oe),xe!==null&&(E=a(xe,E,ve),me===null?pe=xe:me.sibling=xe,me=xe);return Re&&Rn(L,ve),pe}for(xe=r(L,xe);ve<_.length;ve++)Ze=ae(xe,L,ve,_[ve],oe),Ze!==null&&(e&&Ze.alternate!==null&&xe.delete(Ze.key===null?ve:Ze.key),E=a(Ze,E,ve),me===null?pe=Ze:me.sibling=Ze,me=Ze);return e&&xe.forEach(function(kn){return t(L,kn)}),Re&&Rn(L,ve),pe}function fe(L,E,_,oe){var pe=W(_);if(typeof pe!="function")throw Error(l(150));if(_=pe.call(_),_==null)throw Error(l(151));for(var me=pe=null,xe=E,ve=E=0,Ze=null,Ee=_.next();xe!==null&&!Ee.done;ve++,Ee=_.next()){xe.index>ve?(Ze=xe,xe=null):Ze=xe.sibling;var kn=Z(L,xe,Ee.value,oe);if(kn===null){xe===null&&(xe=Ze);break}e&&xe&&kn.alternate===null&&t(L,xe),E=a(kn,E,ve),me===null?pe=kn:me.sibling=kn,me=kn,xe=Ze}if(Ee.done)return n(L,xe),Re&&Rn(L,ve),pe;if(xe===null){for(;!Ee.done;ve++,Ee=_.next())Ee=ne(L,Ee.value,oe),Ee!==null&&(E=a(Ee,E,ve),me===null?pe=Ee:me.sibling=Ee,me=Ee);return Re&&Rn(L,ve),pe}for(xe=r(L,xe);!Ee.done;ve++,Ee=_.next())Ee=ae(xe,L,ve,Ee.value,oe),Ee!==null&&(e&&Ee.alternate!==null&&xe.delete(Ee.key===null?ve:Ee.key),E=a(Ee,E,ve),me===null?pe=Ee:me.sibling=Ee,me=Ee);return e&&xe.forEach(function(Cf){return t(L,Cf)}),Re&&Rn(L,ve),pe}function He(L,E,_,oe){if(typeof _=="object"&&_!==null&&_.type===K&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case z:e:{for(var pe=_.key,me=E;me!==null;){if(me.key===pe){if(pe=_.type,pe===K){if(me.tag===7){n(L,me.sibling),E=s(me,_.props.children),E.return=L,L=E;break e}}else if(me.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===H&&zi(pe)===me.type){n(L,me.sibling),E=s(me,_.props),E.ref=Qr(L,me,_),E.return=L,L=E;break e}n(L,me);break}else t(L,me);me=me.sibling}_.type===K?(E=Hn(_.props.children,L.mode,oe,_.key),E.return=L,L=E):(oe=ys(_.type,_.key,_.props,null,L.mode,oe),oe.ref=Qr(L,E,_),oe.return=L,L=oe)}return u(L);case U:e:{for(me=_.key;E!==null;){if(E.key===me)if(E.tag===4&&E.stateNode.containerInfo===_.containerInfo&&E.stateNode.implementation===_.implementation){n(L,E.sibling),E=s(E,_.children||[]),E.return=L,L=E;break e}else{n(L,E);break}else t(L,E);E=E.sibling}E=ia(_,L.mode,oe),E.return=L,L=E}return u(L);case H:return me=_._init,He(L,E,me(_._payload),oe)}if(Vt(_))return de(L,E,_,oe);if(W(_))return fe(L,E,_,oe);Go(L,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,E!==null&&E.tag===6?(n(L,E.sibling),E=s(E,_),E.return=L,L=E):(n(L,E),E=aa(_,L.mode,oe),E.return=L,L=E),u(L)):n(L,E)}return He}var ur=Ti(!0),Ai=Ti(!1),Zo=gn(null),Ko=null,dr=null,xl=null;function yl(){xl=dr=Ko=null}function vl(e){var t=Zo.current;Ie(Zo),e._currentValue=t}function wl(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function fr(e,t){Ko=e,xl=dr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(it=!0),e.firstContext=null)}function vt(e){var t=e._currentValue;if(xl!==e)if(e={context:e,memoizedValue:t,next:null},dr===null){if(Ko===null)throw Error(l(308));dr=e,Ko.dependencies={lanes:0,firstContext:e}}else dr=dr.next=e;return t}var zn=null;function jl(e){zn===null?zn=[e]:zn.push(e)}function Oi(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,jl(t)):(n.next=s.next,s.next=n),t.interleaved=n,tn(e,r)}function tn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var yn=!1;function Sl(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Bi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function nn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function vn(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,(Ce&2)!==0){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,tn(e,n)}return s=r.interleaved,s===null?(t.next=t,jl(r)):(t.next=s.next,s.next=t),r.interleaved=t,tn(e,n)}function Qo(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,zs(e,n)}}function Ui(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var u={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?s=a=u:a=a.next=u,n=n.next}while(n!==null);a===null?s=a=t:a=a.next=t}else s=a=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Jo(e,t,n,r){var s=e.updateQueue;yn=!1;var a=s.firstBaseUpdate,u=s.lastBaseUpdate,w=s.shared.pending;if(w!==null){s.shared.pending=null;var k=w,R=k.next;k.next=null,u===null?a=R:u.next=R,u=k;var q=e.alternate;q!==null&&(q=q.updateQueue,w=q.lastBaseUpdate,w!==u&&(w===null?q.firstBaseUpdate=R:w.next=R,q.lastBaseUpdate=k))}if(a!==null){var ne=s.baseState;u=0,q=R=k=null,w=a;do{var Z=w.lane,ae=w.eventTime;if((r&Z)===Z){q!==null&&(q=q.next={eventTime:ae,lane:0,tag:w.tag,payload:w.payload,callback:w.callback,next:null});e:{var de=e,fe=w;switch(Z=t,ae=n,fe.tag){case 1:if(de=fe.payload,typeof de=="function"){ne=de.call(ae,ne,Z);break e}ne=de;break e;case 3:de.flags=de.flags&-65537|128;case 0:if(de=fe.payload,Z=typeof de=="function"?de.call(ae,ne,Z):de,Z==null)break e;ne=A({},ne,Z);break e;case 2:yn=!0}}w.callback!==null&&w.lane!==0&&(e.flags|=64,Z=s.effects,Z===null?s.effects=[w]:Z.push(w))}else ae={eventTime:ae,lane:Z,tag:w.tag,payload:w.payload,callback:w.callback,next:null},q===null?(R=q=ae,k=ne):q=q.next=ae,u|=Z;if(w=w.next,w===null){if(w=s.shared.pending,w===null)break;Z=w,w=Z.next,Z.next=null,s.lastBaseUpdate=Z,s.shared.pending=null}}while(!0);if(q===null&&(k=ne),s.baseState=k,s.firstBaseUpdate=R,s.lastBaseUpdate=q,t=s.shared.interleaved,t!==null){s=t;do u|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);On|=u,e.lanes=u,e.memoizedState=ne}}function $i(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(l(191,s));s.call(r)}}}var Jr={},$t=gn(Jr),qr=gn(Jr),eo=gn(Jr);function Tn(e){if(e===Jr)throw Error(l(174));return e}function bl(e,t){switch(Fe(eo,t),Fe(qr,e),Fe($t,Jr),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Er(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Er(t,e)}Ie($t),Fe($t,t)}function pr(){Ie($t),Ie(qr),Ie(eo)}function Hi(e){Tn(eo.current);var t=Tn($t.current),n=Er(t,e.type);t!==n&&(Fe(qr,e),Fe($t,n))}function Nl(e){qr.current===e&&(Ie($t),Ie(qr))}var Oe=gn(0);function qo(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Cl=[];function kl(){for(var e=0;e<Cl.length;e++)Cl[e]._workInProgressVersionPrimary=null;Cl.length=0}var es=Y.ReactCurrentDispatcher,El=Y.ReactCurrentBatchConfig,An=0,Be=null,Ye=null,Xe=null,ts=!1,to=!1,no=0,Vd=0;function qe(){throw Error(l(321))}function Dl(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!kt(e[n],t[n]))return!1;return!0}function Pl(e,t,n,r,s,a){if(An=a,Be=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,es.current=e===null||e.memoizedState===null?Kd:Qd,e=n(r,s),to){a=0;do{if(to=!1,no=0,25<=a)throw Error(l(301));a+=1,Xe=Ye=null,t.updateQueue=null,es.current=Jd,e=n(r,s)}while(to)}if(es.current=os,t=Ye!==null&&Ye.next!==null,An=0,Xe=Ye=Be=null,ts=!1,t)throw Error(l(300));return e}function Fl(){var e=no!==0;return no=0,e}function Ht(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xe===null?Be.memoizedState=Xe=e:Xe=Xe.next=e,Xe}function wt(){if(Ye===null){var e=Be.alternate;e=e!==null?e.memoizedState:null}else e=Ye.next;var t=Xe===null?Be.memoizedState:Xe.next;if(t!==null)Xe=t,Ye=e;else{if(e===null)throw Error(l(310));Ye=e,e={memoizedState:Ye.memoizedState,baseState:Ye.baseState,baseQueue:Ye.baseQueue,queue:Ye.queue,next:null},Xe===null?Be.memoizedState=Xe=e:Xe=Xe.next=e}return Xe}function ro(e,t){return typeof t=="function"?t(e):t}function Ll(e){var t=wt(),n=t.queue;if(n===null)throw Error(l(311));n.lastRenderedReducer=e;var r=Ye,s=r.baseQueue,a=n.pending;if(a!==null){if(s!==null){var u=s.next;s.next=a.next,a.next=u}r.baseQueue=s=a,n.pending=null}if(s!==null){a=s.next,r=r.baseState;var w=u=null,k=null,R=a;do{var q=R.lane;if((An&q)===q)k!==null&&(k=k.next={lane:0,action:R.action,hasEagerState:R.hasEagerState,eagerState:R.eagerState,next:null}),r=R.hasEagerState?R.eagerState:e(r,R.action);else{var ne={lane:q,action:R.action,hasEagerState:R.hasEagerState,eagerState:R.eagerState,next:null};k===null?(w=k=ne,u=r):k=k.next=ne,Be.lanes|=q,On|=q}R=R.next}while(R!==null&&R!==a);k===null?u=r:k.next=w,kt(r,t.memoizedState)||(it=!0),t.memoizedState=r,t.baseState=u,t.baseQueue=k,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do a=s.lane,Be.lanes|=a,On|=a,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Il(e){var t=wt(),n=t.queue;if(n===null)throw Error(l(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,a=t.memoizedState;if(s!==null){n.pending=null;var u=s=s.next;do a=e(a,u.action),u=u.next;while(u!==s);kt(a,t.memoizedState)||(it=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Wi(){}function Yi(e,t){var n=Be,r=wt(),s=t(),a=!kt(r.memoizedState,s);if(a&&(r.memoizedState=s,it=!0),r=r.queue,Ml(Gi.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||Xe!==null&&Xe.memoizedState.tag&1){if(n.flags|=2048,oo(9,Xi.bind(null,n,r,s,t),void 0,null),Ge===null)throw Error(l(349));(An&30)!==0||Vi(n,t,s)}return s}function Vi(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Be.updateQueue,t===null?(t={lastEffect:null,stores:null},Be.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Xi(e,t,n,r){t.value=n,t.getSnapshot=r,Zi(t)&&Ki(e)}function Gi(e,t,n){return n(function(){Zi(t)&&Ki(e)})}function Zi(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!kt(e,n)}catch{return!0}}function Ki(e){var t=tn(e,1);t!==null&&Lt(t,e,1,-1)}function Qi(e){var t=Ht();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ro,lastRenderedState:e},t.queue=e,e=e.dispatch=Zd.bind(null,Be,e),[t.memoizedState,e]}function oo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Be.updateQueue,t===null?(t={lastEffect:null,stores:null},Be.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Ji(){return wt().memoizedState}function ns(e,t,n,r){var s=Ht();Be.flags|=e,s.memoizedState=oo(1|t,n,void 0,r===void 0?null:r)}function rs(e,t,n,r){var s=wt();r=r===void 0?null:r;var a=void 0;if(Ye!==null){var u=Ye.memoizedState;if(a=u.destroy,r!==null&&Dl(r,u.deps)){s.memoizedState=oo(t,n,a,r);return}}Be.flags|=e,s.memoizedState=oo(1|t,n,a,r)}function qi(e,t){return ns(8390656,8,e,t)}function Ml(e,t){return rs(2048,8,e,t)}function ec(e,t){return rs(4,2,e,t)}function tc(e,t){return rs(4,4,e,t)}function nc(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function rc(e,t,n){return n=n!=null?n.concat([e]):null,rs(4,4,nc.bind(null,t,e),n)}function _l(){}function oc(e,t){var n=wt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Dl(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function sc(e,t){var n=wt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Dl(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function lc(e,t,n){return(An&21)===0?(e.baseState&&(e.baseState=!1,it=!0),e.memoizedState=n):(kt(n,t)||(n=za(),Be.lanes|=n,On|=n,e.baseState=!0),t)}function Xd(e,t){var n=Pe;Pe=n!==0&&4>n?n:4,e(!0);var r=El.transition;El.transition={};try{e(!1),t()}finally{Pe=n,El.transition=r}}function ac(){return wt().memoizedState}function Gd(e,t,n){var r=bn(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ic(e))cc(t,n);else if(n=Oi(e,t,n,r),n!==null){var s=ot();Lt(n,e,r,s),uc(n,t,r)}}function Zd(e,t,n){var r=bn(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ic(e))cc(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var u=t.lastRenderedState,w=a(u,n);if(s.hasEagerState=!0,s.eagerState=w,kt(w,u)){var k=t.interleaved;k===null?(s.next=s,jl(t)):(s.next=k.next,k.next=s),t.interleaved=s;return}}catch{}n=Oi(e,t,s,r),n!==null&&(s=ot(),Lt(n,e,r,s),uc(n,t,r))}}function ic(e){var t=e.alternate;return e===Be||t!==null&&t===Be}function cc(e,t){to=ts=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function uc(e,t,n){if((n&4194240)!==0){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,zs(e,n)}}var os={readContext:vt,useCallback:qe,useContext:qe,useEffect:qe,useImperativeHandle:qe,useInsertionEffect:qe,useLayoutEffect:qe,useMemo:qe,useReducer:qe,useRef:qe,useState:qe,useDebugValue:qe,useDeferredValue:qe,useTransition:qe,useMutableSource:qe,useSyncExternalStore:qe,useId:qe,unstable_isNewReconciler:!1},Kd={readContext:vt,useCallback:function(e,t){return Ht().memoizedState=[e,t===void 0?null:t],e},useContext:vt,useEffect:qi,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,ns(4194308,4,nc.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ns(4194308,4,e,t)},useInsertionEffect:function(e,t){return ns(4,2,e,t)},useMemo:function(e,t){var n=Ht();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Ht();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Gd.bind(null,Be,e),[r.memoizedState,e]},useRef:function(e){var t=Ht();return e={current:e},t.memoizedState=e},useState:Qi,useDebugValue:_l,useDeferredValue:function(e){return Ht().memoizedState=e},useTransition:function(){var e=Qi(!1),t=e[0];return e=Xd.bind(null,e[1]),Ht().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Be,s=Ht();if(Re){if(n===void 0)throw Error(l(407));n=n()}else{if(n=t(),Ge===null)throw Error(l(349));(An&30)!==0||Vi(r,t,n)}s.memoizedState=n;var a={value:n,getSnapshot:t};return s.queue=a,qi(Gi.bind(null,r,a,e),[e]),r.flags|=2048,oo(9,Xi.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=Ht(),t=Ge.identifierPrefix;if(Re){var n=en,r=qt;n=(r&~(1<<32-Ct(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=no++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Vd++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Qd={readContext:vt,useCallback:oc,useContext:vt,useEffect:Ml,useImperativeHandle:rc,useInsertionEffect:ec,useLayoutEffect:tc,useMemo:sc,useReducer:Ll,useRef:Ji,useState:function(){return Ll(ro)},useDebugValue:_l,useDeferredValue:function(e){var t=wt();return lc(t,Ye.memoizedState,e)},useTransition:function(){var e=Ll(ro)[0],t=wt().memoizedState;return[e,t]},useMutableSource:Wi,useSyncExternalStore:Yi,useId:ac,unstable_isNewReconciler:!1},Jd={readContext:vt,useCallback:oc,useContext:vt,useEffect:Ml,useImperativeHandle:rc,useInsertionEffect:ec,useLayoutEffect:tc,useMemo:sc,useReducer:Il,useRef:Ji,useState:function(){return Il(ro)},useDebugValue:_l,useDeferredValue:function(e){var t=wt();return Ye===null?t.memoizedState=e:lc(t,Ye.memoizedState,e)},useTransition:function(){var e=Il(ro)[0],t=wt().memoizedState;return[e,t]},useMutableSource:Wi,useSyncExternalStore:Yi,useId:ac,unstable_isNewReconciler:!1};function Dt(e,t){if(e&&e.defaultProps){t=A({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Rl(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:A({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var ss={isMounted:function(e){return(e=e._reactInternals)?ge(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ot(),s=bn(e),a=nn(r,s);a.payload=t,n!=null&&(a.callback=n),t=vn(e,a,s),t!==null&&(Lt(t,e,s,r),Qo(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ot(),s=bn(e),a=nn(r,s);a.tag=1,a.payload=t,n!=null&&(a.callback=n),t=vn(e,a,s),t!==null&&(Lt(t,e,s,r),Qo(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ot(),r=bn(e),s=nn(n,r);s.tag=2,t!=null&&(s.callback=t),t=vn(e,s,r),t!==null&&(Lt(t,e,r,n),Qo(t,e,r))}};function dc(e,t,n,r,s,a,u){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,a,u):t.prototype&&t.prototype.isPureReactComponent?!Wr(n,r)||!Wr(s,a):!0}function fc(e,t,n){var r=!1,s=mn,a=t.contextType;return typeof a=="object"&&a!==null?a=vt(a):(s=at(t)?Mn:Je.current,r=t.contextTypes,a=(r=r!=null)?lr(e,s):mn),t=new t(n,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ss,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function pc(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ss.enqueueReplaceState(t,t.state,null)}function zl(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Sl(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=vt(a):(a=at(t)?Mn:Je.current,s.context=lr(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Rl(e,t,a,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&ss.enqueueReplaceState(s,s.state,null),Jo(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function hr(e,t){try{var n="",r=t;do n+=he(r),r=r.return;while(r);var s=n}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function Tl(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Al(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var qd=typeof WeakMap=="function"?WeakMap:Map;function hc(e,t,n){n=nn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){fs||(fs=!0,ql=r),Al(e,t)},n}function gc(e,t,n){n=nn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){Al(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){Al(e,t),typeof r!="function"&&(jn===null?jn=new Set([this]):jn.add(this));var u=t.stack;this.componentDidCatch(t.value,{componentStack:u!==null?u:""})}),n}function mc(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new qd;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=hf.bind(null,e,t,n),t.then(e,e))}function xc(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function yc(e,t,n,r,s){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=nn(-1,1),t.tag=2,vn(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=s,e)}var ef=Y.ReactCurrentOwner,it=!1;function rt(e,t,n,r){t.child=e===null?Ai(t,null,n,r):ur(t,e.child,n,r)}function vc(e,t,n,r,s){n=n.render;var a=t.ref;return fr(t,s),r=Pl(e,t,n,r,a,s),n=Fl(),e!==null&&!it?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,rn(e,t,s)):(Re&&n&&fl(t),t.flags|=1,rt(e,t,r,s),t.child)}function wc(e,t,n,r,s){if(e===null){var a=n.type;return typeof a=="function"&&!la(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=a,jc(e,t,a,r,s)):(e=ys(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,(e.lanes&s)===0){var u=a.memoizedProps;if(n=n.compare,n=n!==null?n:Wr,n(u,r)&&e.ref===t.ref)return rn(e,t,s)}return t.flags|=1,e=Cn(a,r),e.ref=t.ref,e.return=t,t.child=e}function jc(e,t,n,r,s){if(e!==null){var a=e.memoizedProps;if(Wr(a,r)&&e.ref===t.ref)if(it=!1,t.pendingProps=r=a,(e.lanes&s)!==0)(e.flags&131072)!==0&&(it=!0);else return t.lanes=e.lanes,rn(e,t,s)}return Ol(e,t,n,r,s)}function Sc(e,t,n){var r=t.pendingProps,s=r.children,a=e!==null?e.memoizedState:null;if(r.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Fe(mr,gt),gt|=n;else{if((n&1073741824)===0)return e=a!==null?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Fe(mr,gt),gt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,Fe(mr,gt),gt|=r}else a!==null?(r=a.baseLanes|n,t.memoizedState=null):r=n,Fe(mr,gt),gt|=r;return rt(e,t,s,n),t.child}function bc(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ol(e,t,n,r,s){var a=at(n)?Mn:Je.current;return a=lr(t,a),fr(t,s),n=Pl(e,t,n,r,a,s),r=Fl(),e!==null&&!it?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,rn(e,t,s)):(Re&&r&&fl(t),t.flags|=1,rt(e,t,n,s),t.child)}function Nc(e,t,n,r,s){if(at(n)){var a=!0;Ho(t)}else a=!1;if(fr(t,s),t.stateNode===null)as(e,t),fc(t,n,r),zl(t,n,r,s),r=!0;else if(e===null){var u=t.stateNode,w=t.memoizedProps;u.props=w;var k=u.context,R=n.contextType;typeof R=="object"&&R!==null?R=vt(R):(R=at(n)?Mn:Je.current,R=lr(t,R));var q=n.getDerivedStateFromProps,ne=typeof q=="function"||typeof u.getSnapshotBeforeUpdate=="function";ne||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(w!==r||k!==R)&&pc(t,u,r,R),yn=!1;var Z=t.memoizedState;u.state=Z,Jo(t,r,u,s),k=t.memoizedState,w!==r||Z!==k||lt.current||yn?(typeof q=="function"&&(Rl(t,n,q,r),k=t.memoizedState),(w=yn||dc(t,n,w,r,Z,k,R))?(ne||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount()),typeof u.componentDidMount=="function"&&(t.flags|=4194308)):(typeof u.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=k),u.props=r,u.state=k,u.context=R,r=w):(typeof u.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{u=t.stateNode,Bi(e,t),w=t.memoizedProps,R=t.type===t.elementType?w:Dt(t.type,w),u.props=R,ne=t.pendingProps,Z=u.context,k=n.contextType,typeof k=="object"&&k!==null?k=vt(k):(k=at(n)?Mn:Je.current,k=lr(t,k));var ae=n.getDerivedStateFromProps;(q=typeof ae=="function"||typeof u.getSnapshotBeforeUpdate=="function")||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(w!==ne||Z!==k)&&pc(t,u,r,k),yn=!1,Z=t.memoizedState,u.state=Z,Jo(t,r,u,s);var de=t.memoizedState;w!==ne||Z!==de||lt.current||yn?(typeof ae=="function"&&(Rl(t,n,ae,r),de=t.memoizedState),(R=yn||dc(t,n,R,r,Z,de,k)||!1)?(q||typeof u.UNSAFE_componentWillUpdate!="function"&&typeof u.componentWillUpdate!="function"||(typeof u.componentWillUpdate=="function"&&u.componentWillUpdate(r,de,k),typeof u.UNSAFE_componentWillUpdate=="function"&&u.UNSAFE_componentWillUpdate(r,de,k)),typeof u.componentDidUpdate=="function"&&(t.flags|=4),typeof u.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof u.componentDidUpdate!="function"||w===e.memoizedProps&&Z===e.memoizedState||(t.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||w===e.memoizedProps&&Z===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=de),u.props=r,u.state=de,u.context=k,r=R):(typeof u.componentDidUpdate!="function"||w===e.memoizedProps&&Z===e.memoizedState||(t.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||w===e.memoizedProps&&Z===e.memoizedState||(t.flags|=1024),r=!1)}return Bl(e,t,n,r,a,s)}function Bl(e,t,n,r,s,a){bc(e,t);var u=(t.flags&128)!==0;if(!r&&!u)return s&&Pi(t,n,!1),rn(e,t,a);r=t.stateNode,ef.current=t;var w=u&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&u?(t.child=ur(t,e.child,null,a),t.child=ur(t,null,w,a)):rt(e,t,w,a),t.memoizedState=r.state,s&&Pi(t,n,!0),t.child}function Cc(e){var t=e.stateNode;t.pendingContext?Ei(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Ei(e,t.context,!1),bl(e,t.containerInfo)}function kc(e,t,n,r,s){return cr(),ml(s),t.flags|=256,rt(e,t,n,r),t.child}var Ul={dehydrated:null,treeContext:null,retryLane:0};function $l(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ec(e,t,n){var r=t.pendingProps,s=Oe.current,a=!1,u=(t.flags&128)!==0,w;if((w=u)||(w=e!==null&&e.memoizedState===null?!1:(s&2)!==0),w?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Fe(Oe,s&1),e===null)return gl(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(u=r.children,e=r.fallback,a?(r=t.mode,a=t.child,u={mode:"hidden",children:u},(r&1)===0&&a!==null?(a.childLanes=0,a.pendingProps=u):a=vs(u,r,0,null),e=Hn(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=$l(n),t.memoizedState=Ul,e):Hl(t,u));if(s=e.memoizedState,s!==null&&(w=s.dehydrated,w!==null))return tf(e,t,u,r,w,s,n);if(a){a=r.fallback,u=t.mode,s=e.child,w=s.sibling;var k={mode:"hidden",children:r.children};return(u&1)===0&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=k,t.deletions=null):(r=Cn(s,k),r.subtreeFlags=s.subtreeFlags&14680064),w!==null?a=Cn(w,a):(a=Hn(a,u,n,null),a.flags|=2),a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,u=e.child.memoizedState,u=u===null?$l(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},a.memoizedState=u,a.childLanes=e.childLanes&~n,t.memoizedState=Ul,r}return a=e.child,e=a.sibling,r=Cn(a,{mode:"visible",children:r.children}),(t.mode&1)===0&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Hl(e,t){return t=vs({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ls(e,t,n,r){return r!==null&&ml(r),ur(t,e.child,null,n),e=Hl(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function tf(e,t,n,r,s,a,u){if(n)return t.flags&256?(t.flags&=-257,r=Tl(Error(l(422))),ls(e,t,u,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=r.fallback,s=t.mode,r=vs({mode:"visible",children:r.children},s,0,null),a=Hn(a,s,u,null),a.flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,(t.mode&1)!==0&&ur(t,e.child,null,u),t.child.memoizedState=$l(u),t.memoizedState=Ul,a);if((t.mode&1)===0)return ls(e,t,u,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var w=r.dgst;return r=w,a=Error(l(419)),r=Tl(a,r,void 0),ls(e,t,u,r)}if(w=(u&e.childLanes)!==0,it||w){if(r=Ge,r!==null){switch(u&-u){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=(s&(r.suspendedLanes|u))!==0?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,tn(e,s),Lt(r,e,s,-1))}return sa(),r=Tl(Error(l(421))),ls(e,t,u,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=gf.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,ht=hn(s.nextSibling),pt=t,Re=!0,Et=null,e!==null&&(xt[yt++]=qt,xt[yt++]=en,xt[yt++]=_n,qt=e.id,en=e.overflow,_n=t),t=Hl(t,r.children),t.flags|=4096,t)}function Dc(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),wl(e.return,t,n)}function Wl(e,t,n,r,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=s)}function Pc(e,t,n){var r=t.pendingProps,s=r.revealOrder,a=r.tail;if(rt(e,t,r.children,n),r=Oe.current,(r&2)!==0)r=r&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Dc(e,n,t);else if(e.tag===19)Dc(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Fe(Oe,r),(t.mode&1)===0)t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&qo(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Wl(t,!1,s,n,a);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&qo(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Wl(t,!0,n,null,a);break;case"together":Wl(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function as(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function rn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),On|=t.lanes,(n&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(l(153));if(t.child!==null){for(e=t.child,n=Cn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Cn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function nf(e,t,n){switch(t.tag){case 3:Cc(t),cr();break;case 5:Hi(t);break;case 1:at(t.type)&&Ho(t);break;case 4:bl(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Fe(Zo,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Fe(Oe,Oe.current&1),t.flags|=128,null):(n&t.child.childLanes)!==0?Ec(e,t,n):(Fe(Oe,Oe.current&1),e=rn(e,t,n),e!==null?e.sibling:null);Fe(Oe,Oe.current&1);break;case 19:if(r=(n&t.childLanes)!==0,(e.flags&128)!==0){if(r)return Pc(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Fe(Oe,Oe.current),r)break;return null;case 22:case 23:return t.lanes=0,Sc(e,t,n)}return rn(e,t,n)}var Fc,Yl,Lc,Ic;Fc=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Yl=function(){},Lc=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Tn($t.current);var a=null;switch(n){case"input":s=Me(e,s),r=Me(e,r),a=[];break;case"select":s=A({},s,{value:void 0}),r=A({},r,{value:void 0}),a=[];break;case"textarea":s=En(e,s),r=En(e,r),a=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Bo)}Rt(n,r);var u;n=null;for(R in s)if(!r.hasOwnProperty(R)&&s.hasOwnProperty(R)&&s[R]!=null)if(R==="style"){var w=s[R];for(u in w)w.hasOwnProperty(u)&&(n||(n={}),n[u]="")}else R!=="dangerouslySetInnerHTML"&&R!=="children"&&R!=="suppressContentEditableWarning"&&R!=="suppressHydrationWarning"&&R!=="autoFocus"&&(f.hasOwnProperty(R)?a||(a=[]):(a=a||[]).push(R,null));for(R in r){var k=r[R];if(w=s?.[R],r.hasOwnProperty(R)&&k!==w&&(k!=null||w!=null))if(R==="style")if(w){for(u in w)!w.hasOwnProperty(u)||k&&k.hasOwnProperty(u)||(n||(n={}),n[u]="");for(u in k)k.hasOwnProperty(u)&&w[u]!==k[u]&&(n||(n={}),n[u]=k[u])}else n||(a||(a=[]),a.push(R,n)),n=k;else R==="dangerouslySetInnerHTML"?(k=k?k.__html:void 0,w=w?w.__html:void 0,k!=null&&w!==k&&(a=a||[]).push(R,k)):R==="children"?typeof k!="string"&&typeof k!="number"||(a=a||[]).push(R,""+k):R!=="suppressContentEditableWarning"&&R!=="suppressHydrationWarning"&&(f.hasOwnProperty(R)?(k!=null&&R==="onScroll"&&Le("scroll",e),a||w===k||(a=[])):(a=a||[]).push(R,k))}n&&(a=a||[]).push("style",n);var R=a;(t.updateQueue=R)&&(t.flags|=4)}},Ic=function(e,t,n,r){n!==r&&(t.flags|=4)};function so(e,t){if(!Re)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function et(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function rf(e,t,n){var r=t.pendingProps;switch(pl(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return et(t),null;case 1:return at(t.type)&&$o(),et(t),null;case 3:return r=t.stateNode,pr(),Ie(lt),Ie(Je),kl(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Xo(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Et!==null&&(na(Et),Et=null))),Yl(e,t),et(t),null;case 5:Nl(t);var s=Tn(eo.current);if(n=t.type,e!==null&&t.stateNode!=null)Lc(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(l(166));return et(t),null}if(e=Tn($t.current),Xo(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[Ut]=t,r[Zr]=a,e=(t.mode&1)!==0,n){case"dialog":Le("cancel",r),Le("close",r);break;case"iframe":case"object":case"embed":Le("load",r);break;case"video":case"audio":for(s=0;s<Vr.length;s++)Le(Vr[s],r);break;case"source":Le("error",r);break;case"img":case"image":case"link":Le("error",r),Le("load",r);break;case"details":Le("toggle",r);break;case"input":De(r,a),Le("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Le("invalid",r);break;case"textarea":Nr(r,a),Le("invalid",r)}Rt(n,a),s=null;for(var u in a)if(a.hasOwnProperty(u)){var w=a[u];u==="children"?typeof w=="string"?r.textContent!==w&&(a.suppressHydrationWarning!==!0&&Oo(r.textContent,w,e),s=["children",w]):typeof w=="number"&&r.textContent!==""+w&&(a.suppressHydrationWarning!==!0&&Oo(r.textContent,w,e),s=["children",""+w]):f.hasOwnProperty(u)&&w!=null&&u==="onScroll"&&Le("scroll",r)}switch(n){case"input":bt(r),Yt(r,a,!0);break;case"textarea":bt(r),ho(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=Bo)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{u=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kr(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=u.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),n==="select"&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[Ut]=t,e[Zr]=r,Fc(e,t,!1,!1),t.stateNode=e;e:{switch(u=Vn(n,r),n){case"dialog":Le("cancel",e),Le("close",e),s=r;break;case"iframe":case"object":case"embed":Le("load",e),s=r;break;case"video":case"audio":for(s=0;s<Vr.length;s++)Le(Vr[s],e);s=r;break;case"source":Le("error",e),s=r;break;case"img":case"image":case"link":Le("error",e),Le("load",e),s=r;break;case"details":Le("toggle",e),s=r;break;case"input":De(e,r),s=Me(e,r),Le("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=A({},r,{value:void 0}),Le("invalid",e);break;case"textarea":Nr(e,r),s=En(e,r),Le("invalid",e);break;default:s=r}Rt(n,s),w=s;for(a in w)if(w.hasOwnProperty(a)){var k=w[a];a==="style"?Gt(e,k):a==="dangerouslySetInnerHTML"?(k=k?k.__html:void 0,k!=null&&go(e,k)):a==="children"?typeof k=="string"?(n!=="textarea"||k!=="")&&Xt(e,k):typeof k=="number"&&Xt(e,""+k):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(f.hasOwnProperty(a)?k!=null&&a==="onScroll"&&Le("scroll",e):k!=null&&se(e,a,k,u))}switch(n){case"input":bt(e),Yt(e,r,!1);break;case"textarea":bt(e),ho(e);break;case"option":r.value!=null&&e.setAttribute("value",""+be(r.value));break;case"select":e.multiple=!!r.multiple,a=r.value,a!=null?Mt(e,!!r.multiple,a,!1):r.defaultValue!=null&&Mt(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Bo)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return et(t),null;case 6:if(e&&t.stateNode!=null)Ic(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(l(166));if(n=Tn(eo.current),Tn($t.current),Xo(t)){if(r=t.stateNode,n=t.memoizedProps,r[Ut]=t,(a=r.nodeValue!==n)&&(e=pt,e!==null))switch(e.tag){case 3:Oo(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Oo(r.nodeValue,n,(e.mode&1)!==0)}a&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ut]=t,t.stateNode=r}return et(t),null;case 13:if(Ie(Oe),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Re&&ht!==null&&(t.mode&1)!==0&&(t.flags&128)===0)Ri(),cr(),t.flags|=98560,a=!1;else if(a=Xo(t),r!==null&&r.dehydrated!==null){if(e===null){if(!a)throw Error(l(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(l(317));a[Ut]=t}else cr(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;et(t),a=!1}else Et!==null&&(na(Et),Et=null),a=!0;if(!a)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(Oe.current&1)!==0?Ve===0&&(Ve=3):sa())),t.updateQueue!==null&&(t.flags|=4),et(t),null);case 4:return pr(),Yl(e,t),e===null&&Xr(t.stateNode.containerInfo),et(t),null;case 10:return vl(t.type._context),et(t),null;case 17:return at(t.type)&&$o(),et(t),null;case 19:if(Ie(Oe),a=t.memoizedState,a===null)return et(t),null;if(r=(t.flags&128)!==0,u=a.rendering,u===null)if(r)so(a,!1);else{if(Ve!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(u=qo(e),u!==null){for(t.flags|=128,so(a,!1),r=u.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)a=n,e=r,a.flags&=14680066,u=a.alternate,u===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=u.childLanes,a.lanes=u.lanes,a.child=u.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=u.memoizedProps,a.memoizedState=u.memoizedState,a.updateQueue=u.updateQueue,a.type=u.type,e=u.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Fe(Oe,Oe.current&1|2),t.child}e=e.sibling}a.tail!==null&&$e()>xr&&(t.flags|=128,r=!0,so(a,!1),t.lanes=4194304)}else{if(!r)if(e=qo(u),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),so(a,!0),a.tail===null&&a.tailMode==="hidden"&&!u.alternate&&!Re)return et(t),null}else 2*$e()-a.renderingStartTime>xr&&n!==1073741824&&(t.flags|=128,r=!0,so(a,!1),t.lanes=4194304);a.isBackwards?(u.sibling=t.child,t.child=u):(n=a.last,n!==null?n.sibling=u:t.child=u,a.last=u)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=$e(),t.sibling=null,n=Oe.current,Fe(Oe,r?n&1|2:n&1),t):(et(t),null);case 22:case 23:return oa(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&(t.mode&1)!==0?(gt&1073741824)!==0&&(et(t),t.subtreeFlags&6&&(t.flags|=8192)):et(t),null;case 24:return null;case 25:return null}throw Error(l(156,t.tag))}function of(e,t){switch(pl(t),t.tag){case 1:return at(t.type)&&$o(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return pr(),Ie(lt),Ie(Je),kl(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return Nl(t),null;case 13:if(Ie(Oe),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(l(340));cr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ie(Oe),null;case 4:return pr(),null;case 10:return vl(t.type._context),null;case 22:case 23:return oa(),null;case 24:return null;default:return null}}var is=!1,tt=!1,sf=typeof WeakSet=="function"?WeakSet:Set,ce=null;function gr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ue(e,t,r)}else n.current=null}function Vl(e,t,n){try{n()}catch(r){Ue(e,t,r)}}var Mc=!1;function lf(e,t){if(ol=Do,e=di(),Ks(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var u=0,w=-1,k=-1,R=0,q=0,ne=e,Z=null;t:for(;;){for(var ae;ne!==n||s!==0&&ne.nodeType!==3||(w=u+s),ne!==a||r!==0&&ne.nodeType!==3||(k=u+r),ne.nodeType===3&&(u+=ne.nodeValue.length),(ae=ne.firstChild)!==null;)Z=ne,ne=ae;for(;;){if(ne===e)break t;if(Z===n&&++R===s&&(w=u),Z===a&&++q===r&&(k=u),(ae=ne.nextSibling)!==null)break;ne=Z,Z=ne.parentNode}ne=ae}n=w===-1||k===-1?null:{start:w,end:k}}else n=null}n=n||{start:0,end:0}}else n=null;for(sl={focusedElem:e,selectionRange:n},Do=!1,ce=t;ce!==null;)if(t=ce,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ce=e;else for(;ce!==null;){t=ce;try{var de=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(de!==null){var fe=de.memoizedProps,He=de.memoizedState,L=t.stateNode,E=L.getSnapshotBeforeUpdate(t.elementType===t.type?fe:Dt(t.type,fe),He);L.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var _=t.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(l(163))}}catch(oe){Ue(t,t.return,oe)}if(e=t.sibling,e!==null){e.return=t.return,ce=e;break}ce=t.return}return de=Mc,Mc=!1,de}function lo(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&Vl(t,n,a)}s=s.next}while(s!==r)}}function cs(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Xl(e){var t=e.ref;if(t!==null){var n=e.stateNode;e.tag,e=n,typeof t=="function"?t(e):t.current=e}}function _c(e){var t=e.alternate;t!==null&&(e.alternate=null,_c(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ut],delete t[Zr],delete t[cl],delete t[$d],delete t[Hd])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Rc(e){return e.tag===5||e.tag===3||e.tag===4}function zc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Rc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Gl(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Bo));else if(r!==4&&(e=e.child,e!==null))for(Gl(e,t,n),e=e.sibling;e!==null;)Gl(e,t,n),e=e.sibling}function Zl(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Zl(e,t,n),e=e.sibling;e!==null;)Zl(e,t,n),e=e.sibling}var Ke=null,Pt=!1;function wn(e,t,n){for(n=n.child;n!==null;)Tc(e,t,n),n=n.sibling}function Tc(e,t,n){if(Bt&&typeof Bt.onCommitFiberUnmount=="function")try{Bt.onCommitFiberUnmount(So,n)}catch{}switch(n.tag){case 5:tt||gr(n,t);case 6:var r=Ke,s=Pt;Ke=null,wn(e,t,n),Ke=r,Pt=s,Ke!==null&&(Pt?(e=Ke,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Ke.removeChild(n.stateNode));break;case 18:Ke!==null&&(Pt?(e=Ke,n=n.stateNode,e.nodeType===8?il(e.parentNode,n):e.nodeType===1&&il(e,n),Ar(e)):il(Ke,n.stateNode));break;case 4:r=Ke,s=Pt,Ke=n.stateNode.containerInfo,Pt=!0,wn(e,t,n),Ke=r,Pt=s;break;case 0:case 11:case 14:case 15:if(!tt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var a=s,u=a.destroy;a=a.tag,u!==void 0&&((a&2)!==0||(a&4)!==0)&&Vl(n,t,u),s=s.next}while(s!==r)}wn(e,t,n);break;case 1:if(!tt&&(gr(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(w){Ue(n,t,w)}wn(e,t,n);break;case 21:wn(e,t,n);break;case 22:n.mode&1?(tt=(r=tt)||n.memoizedState!==null,wn(e,t,n),tt=r):wn(e,t,n);break;default:wn(e,t,n)}}function Ac(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new sf),t.forEach(function(r){var s=mf.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Ft(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var a=e,u=t,w=u;e:for(;w!==null;){switch(w.tag){case 5:Ke=w.stateNode,Pt=!1;break e;case 3:Ke=w.stateNode.containerInfo,Pt=!0;break e;case 4:Ke=w.stateNode.containerInfo,Pt=!0;break e}w=w.return}if(Ke===null)throw Error(l(160));Tc(a,u,s),Ke=null,Pt=!1;var k=s.alternate;k!==null&&(k.return=null),s.return=null}catch(R){Ue(s,t,R)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Oc(t,e),t=t.sibling}function Oc(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ft(t,e),Wt(e),r&4){try{lo(3,e,e.return),cs(3,e)}catch(fe){Ue(e,e.return,fe)}try{lo(5,e,e.return)}catch(fe){Ue(e,e.return,fe)}}break;case 1:Ft(t,e),Wt(e),r&512&&n!==null&&gr(n,n.return);break;case 5:if(Ft(t,e),Wt(e),r&512&&n!==null&&gr(n,n.return),e.flags&32){var s=e.stateNode;try{Xt(s,"")}catch(fe){Ue(e,e.return,fe)}}if(r&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,u=n!==null?n.memoizedProps:a,w=e.type,k=e.updateQueue;if(e.updateQueue=null,k!==null)try{w==="input"&&a.type==="radio"&&a.name!=null&&Te(s,a),Vn(w,u);var R=Vn(w,a);for(u=0;u<k.length;u+=2){var q=k[u],ne=k[u+1];q==="style"?Gt(s,ne):q==="dangerouslySetInnerHTML"?go(s,ne):q==="children"?Xt(s,ne):se(s,q,ne,R)}switch(w){case"input":br(s,a);break;case"textarea":Cr(s,a);break;case"select":var Z=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var ae=a.value;ae!=null?Mt(s,!!a.multiple,ae,!1):Z!==!!a.multiple&&(a.defaultValue!=null?Mt(s,!!a.multiple,a.defaultValue,!0):Mt(s,!!a.multiple,a.multiple?[]:"",!1))}s[Zr]=a}catch(fe){Ue(e,e.return,fe)}}break;case 6:if(Ft(t,e),Wt(e),r&4){if(e.stateNode===null)throw Error(l(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(fe){Ue(e,e.return,fe)}}break;case 3:if(Ft(t,e),Wt(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ar(t.containerInfo)}catch(fe){Ue(e,e.return,fe)}break;case 4:Ft(t,e),Wt(e);break;case 13:Ft(t,e),Wt(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Jl=$e())),r&4&&Ac(e);break;case 22:if(q=n!==null&&n.memoizedState!==null,e.mode&1?(tt=(R=tt)||q,Ft(t,e),tt=R):Ft(t,e),Wt(e),r&8192){if(R=e.memoizedState!==null,(e.stateNode.isHidden=R)&&!q&&(e.mode&1)!==0)for(ce=e,q=e.child;q!==null;){for(ne=ce=q;ce!==null;){switch(Z=ce,ae=Z.child,Z.tag){case 0:case 11:case 14:case 15:lo(4,Z,Z.return);break;case 1:gr(Z,Z.return);var de=Z.stateNode;if(typeof de.componentWillUnmount=="function"){r=Z,n=Z.return;try{t=r,de.props=t.memoizedProps,de.state=t.memoizedState,de.componentWillUnmount()}catch(fe){Ue(r,n,fe)}}break;case 5:gr(Z,Z.return);break;case 22:if(Z.memoizedState!==null){$c(ne);continue}}ae!==null?(ae.return=Z,ce=ae):$c(ne)}q=q.sibling}e:for(q=null,ne=e;;){if(ne.tag===5){if(q===null){q=ne;try{s=ne.stateNode,R?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(w=ne.stateNode,k=ne.memoizedProps.style,u=k!=null&&k.hasOwnProperty("display")?k.display:null,w.style.display=Dr("display",u))}catch(fe){Ue(e,e.return,fe)}}}else if(ne.tag===6){if(q===null)try{ne.stateNode.nodeValue=R?"":ne.memoizedProps}catch(fe){Ue(e,e.return,fe)}}else if((ne.tag!==22&&ne.tag!==23||ne.memoizedState===null||ne===e)&&ne.child!==null){ne.child.return=ne,ne=ne.child;continue}if(ne===e)break e;for(;ne.sibling===null;){if(ne.return===null||ne.return===e)break e;q===ne&&(q=null),ne=ne.return}q===ne&&(q=null),ne.sibling.return=ne.return,ne=ne.sibling}}break;case 19:Ft(t,e),Wt(e),r&4&&Ac(e);break;case 21:break;default:Ft(t,e),Wt(e)}}function Wt(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Rc(n)){var r=n;break e}n=n.return}throw Error(l(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Xt(s,""),r.flags&=-33);var a=zc(e);Zl(e,a,s);break;case 3:case 4:var u=r.stateNode.containerInfo,w=zc(e);Gl(e,w,u);break;default:throw Error(l(161))}}catch(k){Ue(e,e.return,k)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function af(e,t,n){ce=e,Bc(e)}function Bc(e,t,n){for(var r=(e.mode&1)!==0;ce!==null;){var s=ce,a=s.child;if(s.tag===22&&r){var u=s.memoizedState!==null||is;if(!u){var w=s.alternate,k=w!==null&&w.memoizedState!==null||tt;w=is;var R=tt;if(is=u,(tt=k)&&!R)for(ce=s;ce!==null;)u=ce,k=u.child,u.tag===22&&u.memoizedState!==null?Hc(s):k!==null?(k.return=u,ce=k):Hc(s);for(;a!==null;)ce=a,Bc(a),a=a.sibling;ce=s,is=w,tt=R}Uc(e)}else(s.subtreeFlags&8772)!==0&&a!==null?(a.return=s,ce=a):Uc(e)}}function Uc(e){for(;ce!==null;){var t=ce;if((t.flags&8772)!==0){var n=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:tt||cs(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!tt)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Dt(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&$i(t,a,r);break;case 3:var u=t.updateQueue;if(u!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}$i(t,u,n)}break;case 5:var w=t.stateNode;if(n===null&&t.flags&4){n=w;var k=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":k.autoFocus&&n.focus();break;case"img":k.src&&(n.src=k.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var R=t.alternate;if(R!==null){var q=R.memoizedState;if(q!==null){var ne=q.dehydrated;ne!==null&&Ar(ne)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(l(163))}tt||t.flags&512&&Xl(t)}catch(Z){Ue(t,t.return,Z)}}if(t===e){ce=null;break}if(n=t.sibling,n!==null){n.return=t.return,ce=n;break}ce=t.return}}function $c(e){for(;ce!==null;){var t=ce;if(t===e){ce=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ce=n;break}ce=t.return}}function Hc(e){for(;ce!==null;){var t=ce;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{cs(4,t)}catch(k){Ue(t,n,k)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(k){Ue(t,s,k)}}var a=t.return;try{Xl(t)}catch(k){Ue(t,a,k)}break;case 5:var u=t.return;try{Xl(t)}catch(k){Ue(t,u,k)}}}catch(k){Ue(t,t.return,k)}if(t===e){ce=null;break}var w=t.sibling;if(w!==null){w.return=t.return,ce=w;break}ce=t.return}}var cf=Math.ceil,us=Y.ReactCurrentDispatcher,Kl=Y.ReactCurrentOwner,jt=Y.ReactCurrentBatchConfig,Ce=0,Ge=null,We=null,Qe=0,gt=0,mr=gn(0),Ve=0,ao=null,On=0,ds=0,Ql=0,io=null,ct=null,Jl=0,xr=1/0,on=null,fs=!1,ql=null,jn=null,ps=!1,Sn=null,hs=0,co=0,ea=null,gs=-1,ms=0;function ot(){return(Ce&6)!==0?$e():gs!==-1?gs:gs=$e()}function bn(e){return(e.mode&1)===0?1:(Ce&2)!==0&&Qe!==0?Qe&-Qe:Yd.transition!==null?(ms===0&&(ms=za()),ms):(e=Pe,e!==0||(e=window.event,e=e===void 0?16:Ya(e.type)),e)}function Lt(e,t,n,r){if(50<co)throw co=0,ea=null,Error(l(185));Mr(e,n,r),((Ce&2)===0||e!==Ge)&&(e===Ge&&((Ce&2)===0&&(ds|=n),Ve===4&&Nn(e,Qe)),ut(e,r),n===1&&Ce===0&&(t.mode&1)===0&&(xr=$e()+500,Wo&&xn()))}function ut(e,t){var n=e.callbackNode;Yu(e,t);var r=Co(e,e===Ge?Qe:0);if(r===0)n!==null&&Ot(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Ot(n),t===1)e.tag===0?Wd(Yc.bind(null,e)):Fi(Yc.bind(null,e)),Bd(function(){(Ce&6)===0&&xn()}),n=null;else{switch(Ta(r)){case 1:n=Ms;break;case 4:n=_a;break;case 16:n=jo;break;case 536870912:n=Ra;break;default:n=jo}n=qc(n,Wc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Wc(e,t){if(gs=-1,ms=0,(Ce&6)!==0)throw Error(l(327));var n=e.callbackNode;if(yr()&&e.callbackNode!==n)return null;var r=Co(e,e===Ge?Qe:0);if(r===0)return null;if((r&30)!==0||(r&e.expiredLanes)!==0||t)t=xs(e,r);else{t=r;var s=Ce;Ce|=2;var a=Xc();(Ge!==e||Qe!==t)&&(on=null,xr=$e()+500,Un(e,t));do try{ff();break}catch(w){Vc(e,w)}while(!0);yl(),us.current=a,Ce=s,We!==null?t=0:(Ge=null,Qe=0,t=Ve)}if(t!==0){if(t===2&&(s=_s(e),s!==0&&(r=s,t=ta(e,s))),t===1)throw n=ao,Un(e,0),Nn(e,r),ut(e,$e()),n;if(t===6)Nn(e,r);else{if(s=e.current.alternate,(r&30)===0&&!uf(s)&&(t=xs(e,r),t===2&&(a=_s(e),a!==0&&(r=a,t=ta(e,a))),t===1))throw n=ao,Un(e,0),Nn(e,r),ut(e,$e()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(l(345));case 2:$n(e,ct,on);break;case 3:if(Nn(e,r),(r&130023424)===r&&(t=Jl+500-$e(),10<t)){if(Co(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){ot(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=al($n.bind(null,e,ct,on),t);break}$n(e,ct,on);break;case 4:if(Nn(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var u=31-Ct(r);a=1<<u,u=t[u],u>s&&(s=u),r&=~a}if(r=s,r=$e()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*cf(r/1960))-r,10<r){e.timeoutHandle=al($n.bind(null,e,ct,on),r);break}$n(e,ct,on);break;case 5:$n(e,ct,on);break;default:throw Error(l(329))}}}return ut(e,$e()),e.callbackNode===n?Wc.bind(null,e):null}function ta(e,t){var n=io;return e.current.memoizedState.isDehydrated&&(Un(e,t).flags|=256),e=xs(e,t),e!==2&&(t=ct,ct=n,t!==null&&na(t)),e}function na(e){ct===null?ct=e:ct.push.apply(ct,e)}function uf(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],a=s.getSnapshot;s=s.value;try{if(!kt(a(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Nn(e,t){for(t&=~Ql,t&=~ds,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Ct(t),r=1<<n;e[n]=-1,t&=~r}}function Yc(e){if((Ce&6)!==0)throw Error(l(327));yr();var t=Co(e,0);if((t&1)===0)return ut(e,$e()),null;var n=xs(e,t);if(e.tag!==0&&n===2){var r=_s(e);r!==0&&(t=r,n=ta(e,r))}if(n===1)throw n=ao,Un(e,0),Nn(e,t),ut(e,$e()),n;if(n===6)throw Error(l(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,$n(e,ct,on),ut(e,$e()),null}function ra(e,t){var n=Ce;Ce|=1;try{return e(t)}finally{Ce=n,Ce===0&&(xr=$e()+500,Wo&&xn())}}function Bn(e){Sn!==null&&Sn.tag===0&&(Ce&6)===0&&yr();var t=Ce;Ce|=1;var n=jt.transition,r=Pe;try{if(jt.transition=null,Pe=1,e)return e()}finally{Pe=r,jt.transition=n,Ce=t,(Ce&6)===0&&xn()}}function oa(){gt=mr.current,Ie(mr)}function Un(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Od(n)),We!==null)for(n=We.return;n!==null;){var r=n;switch(pl(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&$o();break;case 3:pr(),Ie(lt),Ie(Je),kl();break;case 5:Nl(r);break;case 4:pr();break;case 13:Ie(Oe);break;case 19:Ie(Oe);break;case 10:vl(r.type._context);break;case 22:case 23:oa()}n=n.return}if(Ge=e,We=e=Cn(e.current,null),Qe=gt=t,Ve=0,ao=null,Ql=ds=On=0,ct=io=null,zn!==null){for(t=0;t<zn.length;t++)if(n=zn[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,a=n.pending;if(a!==null){var u=a.next;a.next=s,r.next=u}n.pending=r}zn=null}return e}function Vc(e,t){do{var n=We;try{if(yl(),es.current=os,ts){for(var r=Be.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}ts=!1}if(An=0,Xe=Ye=Be=null,to=!1,no=0,Kl.current=null,n===null||n.return===null){Ve=1,ao=t,We=null;break}e:{var a=e,u=n.return,w=n,k=t;if(t=Qe,w.flags|=32768,k!==null&&typeof k=="object"&&typeof k.then=="function"){var R=k,q=w,ne=q.tag;if((q.mode&1)===0&&(ne===0||ne===11||ne===15)){var Z=q.alternate;Z?(q.updateQueue=Z.updateQueue,q.memoizedState=Z.memoizedState,q.lanes=Z.lanes):(q.updateQueue=null,q.memoizedState=null)}var ae=xc(u);if(ae!==null){ae.flags&=-257,yc(ae,u,w,a,t),ae.mode&1&&mc(a,R,t),t=ae,k=R;var de=t.updateQueue;if(de===null){var fe=new Set;fe.add(k),t.updateQueue=fe}else de.add(k);break e}else{if((t&1)===0){mc(a,R,t),sa();break e}k=Error(l(426))}}else if(Re&&w.mode&1){var He=xc(u);if(He!==null){(He.flags&65536)===0&&(He.flags|=256),yc(He,u,w,a,t),ml(hr(k,w));break e}}a=k=hr(k,w),Ve!==4&&(Ve=2),io===null?io=[a]:io.push(a),a=u;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var L=hc(a,k,t);Ui(a,L);break e;case 1:w=k;var E=a.type,_=a.stateNode;if((a.flags&128)===0&&(typeof E.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(jn===null||!jn.has(_)))){a.flags|=65536,t&=-t,a.lanes|=t;var oe=gc(a,w,t);Ui(a,oe);break e}}a=a.return}while(a!==null)}Zc(n)}catch(pe){t=pe,We===n&&n!==null&&(We=n=n.return);continue}break}while(!0)}function Xc(){var e=us.current;return us.current=os,e===null?os:e}function sa(){(Ve===0||Ve===3||Ve===2)&&(Ve=4),Ge===null||(On&268435455)===0&&(ds&268435455)===0||Nn(Ge,Qe)}function xs(e,t){var n=Ce;Ce|=2;var r=Xc();(Ge!==e||Qe!==t)&&(on=null,Un(e,t));do try{df();break}catch(s){Vc(e,s)}while(!0);if(yl(),Ce=n,us.current=r,We!==null)throw Error(l(261));return Ge=null,Qe=0,Ve}function df(){for(;We!==null;)Gc(We)}function ff(){for(;We!==null&&!Ma();)Gc(We)}function Gc(e){var t=Jc(e.alternate,e,gt);e.memoizedProps=e.pendingProps,t===null?Zc(e):We=t,Kl.current=null}function Zc(e){var t=e;do{var n=t.alternate;if(e=t.return,(t.flags&32768)===0){if(n=rf(n,t,gt),n!==null){We=n;return}}else{if(n=of(n,t),n!==null){n.flags&=32767,We=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ve=6,We=null;return}}if(t=t.sibling,t!==null){We=t;return}We=t=e}while(t!==null);Ve===0&&(Ve=5)}function $n(e,t,n){var r=Pe,s=jt.transition;try{jt.transition=null,Pe=1,pf(e,t,n,r)}finally{jt.transition=s,Pe=r}return null}function pf(e,t,n,r){do yr();while(Sn!==null);if((Ce&6)!==0)throw Error(l(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(l(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(Vu(e,a),e===Ge&&(We=Ge=null,Qe=0),(n.subtreeFlags&2064)===0&&(n.flags&2064)===0||ps||(ps=!0,qc(jo,function(){return yr(),null})),a=(n.flags&15990)!==0,(n.subtreeFlags&15990)!==0||a){a=jt.transition,jt.transition=null;var u=Pe;Pe=1;var w=Ce;Ce|=4,Kl.current=null,lf(e,n),Oc(n,e),Id(sl),Do=!!ol,sl=ol=null,e.current=n,af(n),wo(),Ce=w,Pe=u,jt.transition=a}else e.current=n;if(ps&&(ps=!1,Sn=e,hs=s),a=e.pendingLanes,a===0&&(jn=null),Bu(n.stateNode),ut(e,$e()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(fs)throw fs=!1,e=ql,ql=null,e;return(hs&1)!==0&&e.tag!==0&&yr(),a=e.pendingLanes,(a&1)!==0?e===ea?co++:(co=0,ea=e):co=0,xn(),null}function yr(){if(Sn!==null){var e=Ta(hs),t=jt.transition,n=Pe;try{if(jt.transition=null,Pe=16>e?16:e,Sn===null)var r=!1;else{if(e=Sn,Sn=null,hs=0,(Ce&6)!==0)throw Error(l(331));var s=Ce;for(Ce|=4,ce=e.current;ce!==null;){var a=ce,u=a.child;if((ce.flags&16)!==0){var w=a.deletions;if(w!==null){for(var k=0;k<w.length;k++){var R=w[k];for(ce=R;ce!==null;){var q=ce;switch(q.tag){case 0:case 11:case 15:lo(8,q,a)}var ne=q.child;if(ne!==null)ne.return=q,ce=ne;else for(;ce!==null;){q=ce;var Z=q.sibling,ae=q.return;if(_c(q),q===R){ce=null;break}if(Z!==null){Z.return=ae,ce=Z;break}ce=ae}}}var de=a.alternate;if(de!==null){var fe=de.child;if(fe!==null){de.child=null;do{var He=fe.sibling;fe.sibling=null,fe=He}while(fe!==null)}}ce=a}}if((a.subtreeFlags&2064)!==0&&u!==null)u.return=a,ce=u;else e:for(;ce!==null;){if(a=ce,(a.flags&2048)!==0)switch(a.tag){case 0:case 11:case 15:lo(9,a,a.return)}var L=a.sibling;if(L!==null){L.return=a.return,ce=L;break e}ce=a.return}}var E=e.current;for(ce=E;ce!==null;){u=ce;var _=u.child;if((u.subtreeFlags&2064)!==0&&_!==null)_.return=u,ce=_;else e:for(u=E;ce!==null;){if(w=ce,(w.flags&2048)!==0)try{switch(w.tag){case 0:case 11:case 15:cs(9,w)}}catch(pe){Ue(w,w.return,pe)}if(w===u){ce=null;break e}var oe=w.sibling;if(oe!==null){oe.return=w.return,ce=oe;break e}ce=w.return}}if(Ce=s,xn(),Bt&&typeof Bt.onPostCommitFiberRoot=="function")try{Bt.onPostCommitFiberRoot(So,e)}catch{}r=!0}return r}finally{Pe=n,jt.transition=t}}return!1}function Kc(e,t,n){t=hr(n,t),t=hc(e,t,1),e=vn(e,t,1),t=ot(),e!==null&&(Mr(e,1,t),ut(e,t))}function Ue(e,t,n){if(e.tag===3)Kc(e,e,n);else for(;t!==null;){if(t.tag===3){Kc(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(jn===null||!jn.has(r))){e=hr(n,e),e=gc(t,e,1),t=vn(t,e,1),e=ot(),t!==null&&(Mr(t,1,e),ut(t,e));break}}t=t.return}}function hf(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=ot(),e.pingedLanes|=e.suspendedLanes&n,Ge===e&&(Qe&n)===n&&(Ve===4||Ve===3&&(Qe&130023424)===Qe&&500>$e()-Jl?Un(e,0):Ql|=n),ut(e,t)}function Qc(e,t){t===0&&((e.mode&1)===0?t=1:(t=No,No<<=1,(No&130023424)===0&&(No=4194304)));var n=ot();e=tn(e,t),e!==null&&(Mr(e,t,n),ut(e,n))}function gf(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Qc(e,n)}function mf(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(l(314))}r!==null&&r.delete(t),Qc(e,n)}var Jc;Jc=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||lt.current)it=!0;else{if((e.lanes&n)===0&&(t.flags&128)===0)return it=!1,nf(e,t,n);it=(e.flags&131072)!==0}else it=!1,Re&&(t.flags&1048576)!==0&&Li(t,Vo,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;as(e,t),e=t.pendingProps;var s=lr(t,Je.current);fr(t,n),s=Pl(null,t,r,e,s,n);var a=Fl();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,at(r)?(a=!0,Ho(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Sl(t),s.updater=ss,t.stateNode=s,s._reactInternals=t,zl(t,r,e,n),t=Bl(null,t,r,!0,a,n)):(t.tag=0,Re&&a&&fl(t),rt(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(as(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=yf(r),e=Dt(r,e),s){case 0:t=Ol(null,t,r,e,n);break e;case 1:t=Nc(null,t,r,e,n);break e;case 11:t=vc(null,t,r,e,n);break e;case 14:t=wc(null,t,r,Dt(r.type,e),n);break e}throw Error(l(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Dt(r,s),Ol(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Dt(r,s),Nc(e,t,r,s,n);case 3:e:{if(Cc(t),e===null)throw Error(l(387));r=t.pendingProps,a=t.memoizedState,s=a.element,Bi(e,t),Jo(t,r,null,n);var u=t.memoizedState;if(r=u.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:u.cache,pendingSuspenseBoundaries:u.pendingSuspenseBoundaries,transitions:u.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=hr(Error(l(423)),t),t=kc(e,t,r,n,s);break e}else if(r!==s){s=hr(Error(l(424)),t),t=kc(e,t,r,n,s);break e}else for(ht=hn(t.stateNode.containerInfo.firstChild),pt=t,Re=!0,Et=null,n=Ai(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(cr(),r===s){t=rn(e,t,n);break e}rt(e,t,r,n)}t=t.child}return t;case 5:return Hi(t),e===null&&gl(t),r=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,u=s.children,ll(r,s)?u=null:a!==null&&ll(r,a)&&(t.flags|=32),bc(e,t),rt(e,t,u,n),t.child;case 6:return e===null&&gl(t),null;case 13:return Ec(e,t,n);case 4:return bl(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=ur(t,null,r,n):rt(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Dt(r,s),vc(e,t,r,s,n);case 7:return rt(e,t,t.pendingProps,n),t.child;case 8:return rt(e,t,t.pendingProps.children,n),t.child;case 12:return rt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,a=t.memoizedProps,u=s.value,Fe(Zo,r._currentValue),r._currentValue=u,a!==null)if(kt(a.value,u)){if(a.children===s.children&&!lt.current){t=rn(e,t,n);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var w=a.dependencies;if(w!==null){u=a.child;for(var k=w.firstContext;k!==null;){if(k.context===r){if(a.tag===1){k=nn(-1,n&-n),k.tag=2;var R=a.updateQueue;if(R!==null){R=R.shared;var q=R.pending;q===null?k.next=k:(k.next=q.next,q.next=k),R.pending=k}}a.lanes|=n,k=a.alternate,k!==null&&(k.lanes|=n),wl(a.return,n,t),w.lanes|=n;break}k=k.next}}else if(a.tag===10)u=a.type===t.type?null:a.child;else if(a.tag===18){if(u=a.return,u===null)throw Error(l(341));u.lanes|=n,w=u.alternate,w!==null&&(w.lanes|=n),wl(u,n,t),u=a.sibling}else u=a.child;if(u!==null)u.return=a;else for(u=a;u!==null;){if(u===t){u=null;break}if(a=u.sibling,a!==null){a.return=u.return,u=a;break}u=u.return}a=u}rt(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,fr(t,n),s=vt(s),r=r(s),t.flags|=1,rt(e,t,r,n),t.child;case 14:return r=t.type,s=Dt(r,t.pendingProps),s=Dt(r.type,s),wc(e,t,r,s,n);case 15:return jc(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Dt(r,s),as(e,t),t.tag=1,at(r)?(e=!0,Ho(t)):e=!1,fr(t,n),fc(t,r,s),zl(t,r,s,n),Bl(null,t,r,!0,e,n);case 19:return Pc(e,t,n);case 22:return Sc(e,t,n)}throw Error(l(156,t.tag))};function qc(e,t){return Nt(e,t)}function xf(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function St(e,t,n,r){return new xf(e,t,n,r)}function la(e){return e=e.prototype,!(!e||!e.isReactComponent)}function yf(e){if(typeof e=="function")return la(e)?1:0;if(e!=null){if(e=e.$$typeof,e===le)return 11;if(e===G)return 14}return 2}function Cn(e,t){var n=e.alternate;return n===null?(n=St(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ys(e,t,n,r,s,a){var u=2;if(r=e,typeof e=="function")la(e)&&(u=1);else if(typeof e=="string")u=5;else e:switch(e){case K:return Hn(n.children,s,a,t);case V:u=8,s|=8;break;case $:return e=St(12,n,t,s|2),e.elementType=$,e.lanes=a,e;case Q:return e=St(13,n,t,s),e.elementType=Q,e.lanes=a,e;case X:return e=St(19,n,t,s),e.elementType=X,e.lanes=a,e;case ie:return vs(n,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case O:u=10;break e;case re:u=9;break e;case le:u=11;break e;case G:u=14;break e;case H:u=16,r=null;break e}throw Error(l(130,e==null?e:typeof e,""))}return t=St(u,n,t,s),t.elementType=e,t.type=r,t.lanes=a,t}function Hn(e,t,n,r){return e=St(7,e,r,t),e.lanes=n,e}function vs(e,t,n,r){return e=St(22,e,r,t),e.elementType=ie,e.lanes=n,e.stateNode={isHidden:!1},e}function aa(e,t,n){return e=St(6,e,null,t),e.lanes=n,e}function ia(e,t,n){return t=St(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function vf(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Rs(0),this.expirationTimes=Rs(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rs(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function ca(e,t,n,r,s,a,u,w,k){return e=new vf(e,t,n,w,k),t===1?(t=1,a===!0&&(t|=8)):t=0,a=St(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Sl(a),e}function wf(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function eu(e){if(!e)return mn;e=e._reactInternals;e:{if(ge(e)!==e||e.tag!==1)throw Error(l(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(at(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(l(171))}if(e.tag===1){var n=e.type;if(at(n))return Di(e,n,t)}return t}function tu(e,t,n,r,s,a,u,w,k){return e=ca(n,r,!0,e,s,a,u,w,k),e.context=eu(null),n=e.current,r=ot(),s=bn(n),a=nn(r,s),a.callback=t??null,vn(n,a,s),e.current.lanes=s,Mr(e,s,r),ut(e,r),e}function ws(e,t,n,r){var s=t.current,a=ot(),u=bn(s);return n=eu(n),t.context===null?t.context=n:t.pendingContext=n,t=nn(a,u),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=vn(s,t,u),e!==null&&(Lt(e,s,u,a),Qo(e,s,u)),u}function js(e){return e=e.current,e.child?(e.child.tag===5,e.child.stateNode):null}function nu(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function ua(e,t){nu(e,t),(e=e.alternate)&&nu(e,t)}function jf(){return null}var ru=typeof reportError=="function"?reportError:function(e){console.error(e)};function da(e){this._internalRoot=e}Ss.prototype.render=da.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(l(409));ws(e,t,null,null)},Ss.prototype.unmount=da.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Bn(function(){ws(null,e,null,null)}),t[Qt]=null}};function Ss(e){this._internalRoot=e}Ss.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ba();e={blockedOn:null,target:e,priority:t};for(var n=0;n<dn.length&&t!==0&&t<dn[n].priority;n++);dn.splice(n,0,e),n===0&&Ha(e)}};function fa(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function bs(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ou(){}function Sf(e,t,n,r,s){if(s){if(typeof r=="function"){var a=r;r=function(){var R=js(u);a.call(R)}}var u=tu(t,r,e,0,null,!1,!1,"",ou);return e._reactRootContainer=u,e[Qt]=u.current,Xr(e.nodeType===8?e.parentNode:e),Bn(),u}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var w=r;r=function(){var R=js(k);w.call(R)}}var k=ca(e,0,!1,null,null,!1,!1,"",ou);return e._reactRootContainer=k,e[Qt]=k.current,Xr(e.nodeType===8?e.parentNode:e),Bn(function(){ws(t,k,n,r)}),k}function Ns(e,t,n,r,s){var a=n._reactRootContainer;if(a){var u=a;if(typeof s=="function"){var w=s;s=function(){var k=js(u);w.call(k)}}ws(t,u,e,s)}else u=Sf(n,t,e,s,r);return js(u)}Aa=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Ir(t.pendingLanes);n!==0&&(zs(t,n|1),ut(t,$e()),(Ce&6)===0&&(xr=$e()+500,xn()))}break;case 13:Bn(function(){var r=tn(e,1);if(r!==null){var s=ot();Lt(r,e,1,s)}}),ua(e,1)}},Ts=function(e){if(e.tag===13){var t=tn(e,134217728);if(t!==null){var n=ot();Lt(t,e,134217728,n)}ua(e,134217728)}},Oa=function(e){if(e.tag===13){var t=bn(e),n=tn(e,t);if(n!==null){var r=ot();Lt(n,e,t,r)}ua(e,t)}},Ba=function(){return Pe},Ua=function(e,t){var n=Pe;try{return Pe=e,t()}finally{Pe=n}},Pr=function(e,t,n){switch(t){case"input":if(br(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=Uo(r);if(!s)throw Error(l(90));sn(r),br(r,s)}}}break;case"textarea":Cr(e,n);break;case"select":t=n.value,t!=null&&Mt(e,!!n.multiple,t,!1)}},Xn=ra,yo=Bn;var bf={usingClientEntryPoint:!1,Events:[Kr,or,Uo,xo,At,ra]},uo={findFiberByHostInstance:In,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Nf={bundleType:uo.bundleType,version:uo.version,rendererPackageName:uo.rendererPackageName,rendererConfig:uo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Y.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=_e(e),e===null?null:e.stateNode},findFiberByHostInstance:uo.findFiberByHostInstance||jf,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cs=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cs.isDisabled&&Cs.supportsFiber)try{So=Cs.inject(Nf),Bt=Cs}catch{}}return dt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bf,dt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!fa(t))throw Error(l(200));return wf(e,t,null,n)},dt.createRoot=function(e,t){if(!fa(e))throw Error(l(299));var n=!1,r="",s=ru;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=ca(e,1,!1,null,null,n,!1,r,s),e[Qt]=t.current,Xr(e.nodeType===8?e.parentNode:e),new da(t)},dt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(l(188)):(e=Object.keys(e).join(","),Error(l(268,e)));return e=_e(t),e=e===null?null:e.stateNode,e},dt.flushSync=function(e){return Bn(e)},dt.hydrate=function(e,t,n){if(!bs(t))throw Error(l(200));return Ns(null,e,t,!0,n)},dt.hydrateRoot=function(e,t,n){if(!fa(e))throw Error(l(405));var r=n!=null&&n.hydratedSources||null,s=!1,a="",u=ru;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(u=n.onRecoverableError)),t=tu(t,null,e,1,n??null,s,!1,a,u),e[Qt]=t.current,Xr(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Ss(t)},dt.render=function(e,t,n){if(!bs(t))throw Error(l(200));return Ns(null,e,t,!1,n)},dt.unmountComponentAtNode=function(e){if(!bs(e))throw Error(l(40));return e._reactRootContainer?(Bn(function(){Ns(null,null,e,!1,function(){e._reactRootContainer=null,e[Qt]=null})}),!0):!1},dt.unstable_batchedUpdates=ra,dt.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!bs(n))throw Error(l(200));if(e==null||e._reactInternals===void 0)throw Error(l(38));return Ns(e,t,n,!1,r)},dt.version="18.3.1-next-f1338f8080-20240426",dt}var fu;function If(){if(fu)return ga.exports;fu=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(c){console.error(c)}}return i(),ga.exports=Lf(),ga.exports}var pu;function Mf(){if(pu)return ks;pu=1;var i=If();return ks.createRoot=i.createRoot,ks.hydrateRoot=i.hydrateRoot,ks}var _f=Mf();const Rf=Fa(_f),zf={},hu=i=>{let c;const l=new Set,d=(g,x)=>{const C=typeof g=="function"?g(c):g;if(!Object.is(C,c)){const D=c;c=x??(typeof C!="object"||C===null)?C:Object.assign({},c,C),l.forEach(v=>v(c,D))}},f=()=>c,h={setState:d,getState:f,getInitialState:()=>p,subscribe:g=>(l.add(g),()=>l.delete(g)),destroy:()=>{(zf?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),l.clear()}},p=c=i(d,f,h);return h},Tf=i=>i?hu(i):hu;var ya={exports:{}},va={},wa={exports:{}},ja={};var gu;function Af(){if(gu)return ja;gu=1;var i=po();function c(x,C){return x===C&&(x!==0||1/x===1/C)||x!==x&&C!==C}var l=typeof Object.is=="function"?Object.is:c,d=i.useState,f=i.useEffect,y=i.useLayoutEffect,m=i.useDebugValue;function b(x,C){var D=C(),v=d({inst:{value:D,getSnapshot:C}}),P=v[0].inst,F=v[1];return y(function(){P.value=D,P.getSnapshot=C,h(P)&&F({inst:P})},[x,D,C]),f(function(){return h(P)&&F({inst:P}),x(function(){h(P)&&F({inst:P})})},[x]),m(D),D}function h(x){var C=x.getSnapshot;x=x.value;try{var D=C();return!l(x,D)}catch{return!0}}function p(x,C){return C()}var g=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:b;return ja.useSyncExternalStore=i.useSyncExternalStore!==void 0?i.useSyncExternalStore:g,ja}var mu;function Of(){return mu||(mu=1,wa.exports=Af()),wa.exports}var xu;function Bf(){if(xu)return va;xu=1;var i=po(),c=Of();function l(p,g){return p===g&&(p!==0||1/p===1/g)||p!==p&&g!==g}var d=typeof Object.is=="function"?Object.is:l,f=c.useSyncExternalStore,y=i.useRef,m=i.useEffect,b=i.useMemo,h=i.useDebugValue;return va.useSyncExternalStoreWithSelector=function(p,g,x,C,D){var v=y(null);if(v.current===null){var P={hasValue:!1,value:null};v.current=P}else P=v.current;v=b(function(){function M(U){if(!B){if(B=!0,se=U,U=C(U),D!==void 0&&P.hasValue){var K=P.value;if(D(K,U))return Y=K}return Y=U}if(K=Y,d(se,U))return K;var V=C(U);return D!==void 0&&D(K,V)?(se=U,K):(se=U,Y=V)}var B=!1,se,Y,z=x===void 0?null:x;return[function(){return M(g())},z===null?void 0:function(){return M(z())}]},[g,x,C,D]);var F=f(p,v[0],v[1]);return m(function(){P.hasValue=!0,P.value=F},[F]),h(F),F},va}var yu;function Uf(){return yu||(yu=1,ya.exports=Bf()),ya.exports}var $f=Uf();const Hf=Fa($f),Pu={},{useDebugValue:Wf}=Du,{useSyncExternalStoreWithSelector:Yf}=Hf;let vu=!1;const Vf=i=>i;function Xf(i,c=Vf,l){(Pu?"production":void 0)!=="production"&&l&&!vu&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),vu=!0);const d=Yf(i.subscribe,i.getState,i.getServerState||i.getInitialState,c,l);return Wf(d),d}const Gf=i=>{(Pu?"production":void 0)!=="production"&&typeof i!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const c=typeof i=="function"?Tf(i):i,l=(d,f)=>Xf(c,d,f);return Object.assign(l,c),l},Zf=i=>Gf,Sa={BASE_URL:"/PixelConnect/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},Ea=new Map,Es=i=>{const c=Ea.get(i);return c?Object.fromEntries(Object.entries(c.stores).map(([l,d])=>[l,d.getState()])):{}},Kf=(i,c,l)=>{if(i===void 0)return{type:"untracked",connection:c.connect(l)};const d=Ea.get(l.name);if(d)return{type:"tracked",store:i,...d};const f={connection:c.connect(l),stores:{}};return Ea.set(l.name,f),{type:"tracked",store:i,...f}},Qf=(i,c={})=>(l,d,f)=>{const{enabled:y,anonymousActionType:m,store:b,...h}=c;let p;try{p=(y??(Sa?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!p)return(Sa?"production":void 0)!=="production"&&y&&console.warn("[zustand devtools middleware] Please install/enable Redux devtools extension"),i(l,d,f);const{connection:g,...x}=Kf(b,p,h);let C=!0;f.setState=(P,F,M)=>{const B=l(P,F);if(!C)return B;const se=M===void 0?{type:m||"anonymous"}:typeof M=="string"?{type:M}:M;return b===void 0?(g?.send(se,d()),B):(g?.send({...se,type:`${b}/${se.type}`},{...Es(h.name),[b]:f.getState()}),B)};const D=(...P)=>{const F=C;C=!1,l(...P),C=F},v=i(f.setState,d,f);if(x.type==="untracked"?g?.init(v):(x.stores[x.store]=f,g?.init(Object.fromEntries(Object.entries(x.stores).map(([P,F])=>[P,P===x.store?v:F.getState()])))),f.dispatchFromDevtools&&typeof f.dispatch=="function"){let P=!1;const F=f.dispatch;f.dispatch=(...M)=>{(Sa?"production":void 0)!=="production"&&M[0].type==="__setState"&&!P&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),P=!0),F(...M)}}return g.subscribe(P=>{var F;switch(P.type){case"ACTION":if(typeof P.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return ba(P.payload,M=>{if(M.type==="__setState"){if(b===void 0){D(M.state);return}Object.keys(M.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format. 
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const B=M.state[b];if(B==null)return;JSON.stringify(f.getState())!==JSON.stringify(B)&&D(B);return}f.dispatchFromDevtools&&typeof f.dispatch=="function"&&f.dispatch(M)});case"DISPATCH":switch(P.payload.type){case"RESET":return D(v),b===void 0?g?.init(f.getState()):g?.init(Es(h.name));case"COMMIT":if(b===void 0){g?.init(f.getState());return}return g?.init(Es(h.name));case"ROLLBACK":return ba(P.state,M=>{if(b===void 0){D(M),g?.init(f.getState());return}D(M[b]),g?.init(Es(h.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return ba(P.state,M=>{if(b===void 0){D(M);return}JSON.stringify(f.getState())!==JSON.stringify(M[b])&&D(M[b])});case"IMPORT_STATE":{const{nextLiftedState:M}=P.payload,B=(F=M.computedStates.slice(-1)[0])==null?void 0:F.state;if(!B)return;D(b===void 0?B:B[b]),g?.send(null,M);return}case"PAUSE_RECORDING":return C=!C}return}}),v},Jf=Qf,ba=(i,c)=>{let l;try{l=JSON.parse(i)}catch(d){console.error("[zustand devtools middleware] Could not parse the received json",d)}l!==void 0&&c(l)},qf=i=>{const c=i.data,l=new Map;for(let d=0;d<c.length;d+=4){const f=c[d],y=c[d+1],m=c[d+2];if(c[d+3]===255){const h=`#${(16777216+(f<<16)+(y<<8)+m).toString(16).slice(1).toUpperCase()}`;l.has(h)||l.set(h,{r:f,g:y,b:m})}}return l},ep=(i,c,l,d)=>{let f="#000000",y={r:0,g:0,b:0},m=1/0;for(const[b,h]of d){const p=Math.sqrt(Math.pow(i-h.r,2)+Math.pow(c-h.g,2)+Math.pow(l-h.b,2));p<m&&(m=p,f=b,y=h)}return{hex:f,...y}},wu=(i,c,l=!0)=>new Promise((d,f)=>{try{const y=new Image;y.onload=()=>{try{const m=document.createElement("canvas");m.width=y.width,m.height=y.height;const b=m.getContext("2d");if(!b){f(new Error("Could not get canvas context"));return}b.drawImage(y,0,0);const h=b.getImageData(0,0,m.width,m.height),p=h.data;let g=null;l&&(g=qf(h));for(let x=0;x<p.length;x+=4){const C=p[x+3];if(C!==0)if(C<c)p[x+3]=0;else{if(l&&g&&g.size>0&&C<255){const D=p[x],v=p[x+1],P=p[x+2],F=ep(D,v,P,g);p[x]=F.r,p[x+1]=F.g,p[x+2]=F.b}p[x+3]=255}}b.putImageData(h,0,0),d(m.toDataURL())}catch(m){console.error("Error processing image data:",m),f(m)}},y.onerror=m=>{console.error("Error loading image for processing:",m),f(new Error("Failed to load image"))},y.src=i}catch(y){console.error("Error initiating image processing:",y),f(y)}}),Fu=i=>new Promise((c,l)=>{const d=new FileReader;d.onload=f=>{const y=f.target?.result;c(y)},d.onerror=()=>{l(new Error("Failed to read blob"))},d.readAsDataURL(i)}),tp=i=>{const c=i.split(","),l=c[0].match(/:(.*?);/),d=l?l[1]:"image/png",f=atob(c[1]),y=f.length,m=new Uint8Array(y);for(let b=0;b<y;b++)m[b]=f.charCodeAt(b);return new Blob([m],{type:d})},ju=(i,c=30,l=!1)=>new Promise((d,f)=>{try{const y=new Image;y.crossOrigin="anonymous",y.onload=()=>{try{const m=y.naturalWidth,b=y.naturalHeight,h=document.createElement("canvas");h.width=m,h.height=b;const p=h.getContext("2d");if(!p){f(new Error("Could not get canvas context"));return}p.drawImage(y,0,0);const g=p.getImageData(0,0,m,b),x=g.data,C=new Uint8Array(m*b),D=new Uint8Array(m*b),v=(z,U)=>U*m+z,P=(z,U)=>{const K=(U*m+z)*4;return{r:x[K],g:x[K+1],b:x[K+2],a:x[K+3]}},F=(z,U)=>{const K=z.r-U.r,V=z.g-U.g,$=z.b-U.b;return Math.sqrt(K*K+V*V+$*$)},M=[],B=(z,U)=>{for(let K=Math.max(0,U-1);K<=Math.min(b-1,U+1);K++)for(let V=Math.max(0,z-1);V<=Math.min(m-1,z+1);V++)M.push({x:V,y:K})};B(0,0),B(m-1,0),B(0,b-1),B(m-1,b-1);const se=[];for(const z of M){const U=P(z.x,z.y);se.push({x:z.x,y:z.y,base:U})}const Y=(z,U)=>z>=0&&z<m&&U>=0&&U<b;for(;se.length>0;){const{x:z,y:U,base:K}=se.shift(),V=v(z,U);if(C[V])continue;C[V]=1;const $=P(z,U);if(F($,K)<=c){D[V]=1;const re=[{x:z+1,y:U},{x:z-1,y:U},{x:z,y:U+1},{x:z,y:U-1}];for(const le of re)if(Y(le.x,le.y)){const Q=v(le.x,le.y);C[Q]||se.push({x:le.x,y:le.y,base:K})}}}for(let z=0;z<b;z++)for(let U=0;U<m;U++){const K=(z*m+U)*4;D[v(U,z)]===1?x[K+3]=0:(l&&(x[K]=255,x[K+1]=0,x[K+2]=0),x[K+3]=255)}p.putImageData(g,0,0),d(h.toDataURL())}catch(m){console.error("removeBackground processing error:",m),f(m)}},y.onerror=m=>{console.error("removeBackground load error:",m),f(new Error("Failed to load image"))},y.src=i}catch(y){console.error("removeBackground init error:",y),f(y)}}),np=i=>new Promise((c,l)=>{if(i.length===0){l(new Error("No layers to composite"));return}let d=1/0,f=1/0,y=-1/0,m=-1/0;for(const D of i)d=Math.min(d,D.x),f=Math.min(f,D.y),y=Math.max(y,D.x+D.width),m=Math.max(m,D.y+D.height);const b=Math.ceil(y-d),h=Math.ceil(m-f),p=document.createElement("canvas");p.width=b,p.height=h;const g=p.getContext("2d",{willReadFrequently:!0});if(!g){l(new Error("Failed to get canvas context"));return}g.clearRect(0,0,b,h);let x=0,C=!1;for(const D of i){const v=new Image;v.onload=()=>{C||(g.globalAlpha=D.opacity,g.drawImage(v,D.x-d,D.y-f,D.width,D.height),x++,x===i.length&&(g.globalAlpha=1,p.toBlob(P=>{P?c(P):l(new Error("Failed to create blob from canvas"))},"image/png")))},v.onerror=()=>{C=!0,l(new Error(`Failed to load image for layer at (${D.x}, ${D.y})`))},v.src=D.imageData}}),Da=[{name:"Arial",value:"Arial, sans-serif",category:"system"},{name:"Times New Roman",value:'"Times New Roman", Times, serif',category:"system"},{name:"Courier New",value:'"Courier New", Courier, monospace',category:"system"},{name:"Georgia",value:"Georgia, serif",category:"system"},{name:"Verdana",value:"Verdana, sans-serif",category:"system"},{name:"Comic Sans MS",value:'"Comic Sans MS", "Comic Sans", cursive',category:"system"},{name:"Impact",value:"Impact, Charcoal, sans-serif",category:"system"},{name:"Trebuchet MS",value:'"Trebuchet MS", Helvetica, sans-serif',category:"system"},{name:"Jokerman",value:"Jokerman, fantasy",category:"system"}],rp=[{name:"Roboto",value:"Roboto, sans-serif",category:"google",googleFontName:"Roboto"},{name:"Open Sans",value:'"Open Sans", sans-serif',category:"google",googleFontName:"Open+Sans"},{name:"Lato",value:"Lato, sans-serif",category:"google",googleFontName:"Lato"},{name:"Montserrat",value:"Montserrat, sans-serif",category:"google",googleFontName:"Montserrat"},{name:"Poppins",value:"Poppins, sans-serif",category:"google",googleFontName:"Poppins"},{name:"Oswald",value:"Oswald, sans-serif",category:"google",googleFontName:"Oswald"},{name:"Raleway",value:"Raleway, sans-serif",category:"google",googleFontName:"Raleway"},{name:"Ubuntu",value:"Ubuntu, sans-serif",category:"google",googleFontName:"Ubuntu"},{name:"Nunito",value:"Nunito, sans-serif",category:"google",googleFontName:"Nunito"},{name:"PT Sans",value:'"PT Sans", sans-serif',category:"google",googleFontName:"PT+Sans"},{name:"Merriweather",value:"Merriweather, serif",category:"google",googleFontName:"Merriweather"},{name:"Playfair Display",value:'"Playfair Display", serif',category:"google",googleFontName:"Playfair+Display"},{name:"Lora",value:"Lora, serif",category:"google",googleFontName:"Lora"},{name:"PT Serif",value:'"PT Serif", serif',category:"google",googleFontName:"PT+Serif"},{name:"Crimson Text",value:'"Crimson Text", serif',category:"google",googleFontName:"Crimson+Text"},{name:"EB Garamond",value:'"EB Garamond", serif',category:"google",googleFontName:"EB+Garamond"},{name:"Libre Baskerville",value:'"Libre Baskerville", serif',category:"google",googleFontName:"Libre+Baskerville"},{name:"Cormorant",value:"Cormorant, serif",category:"google",googleFontName:"Cormorant"},{name:"Spectral",value:"Spectral, serif",category:"google",googleFontName:"Spectral"},{name:"Bitter",value:"Bitter, serif",category:"google",googleFontName:"Bitter"},{name:"Bebas Neue",value:'"Bebas Neue", cursive',category:"google",googleFontName:"Bebas+Neue"},{name:"Pacifico",value:"Pacifico, cursive",category:"google",googleFontName:"Pacifico"},{name:"Righteous",value:"Righteous, cursive",category:"google",googleFontName:"Righteous"},{name:"Bangers",value:"Bangers, cursive",category:"google",googleFontName:"Bangers"},{name:"Permanent Marker",value:'"Permanent Marker", cursive',category:"google",googleFontName:"Permanent+Marker"},{name:"Lobster",value:"Lobster, cursive",category:"google",googleFontName:"Lobster"},{name:"Press Start 2P",value:'"Press Start 2P", cursive',category:"google",googleFontName:"Press+Start+2P"},{name:"Fredoka One",value:'"Fredoka One", cursive',category:"google",googleFontName:"Fredoka+One"},{name:"Alfa Slab One",value:'"Alfa Slab One", cursive',category:"google",googleFontName:"Alfa+Slab+One"},{name:"Rubik Mono One",value:'"Rubik Mono One", sans-serif',category:"google",googleFontName:"Rubik+Mono+One"},{name:"Dancing Script",value:'"Dancing Script", cursive',category:"google",googleFontName:"Dancing+Script"},{name:"Caveat",value:"Caveat, cursive",category:"google",googleFontName:"Caveat"},{name:"Shadows Into Light",value:'"Shadows Into Light", cursive',category:"google",googleFontName:"Shadows+Into+Light"},{name:"Satisfy",value:"Satisfy, cursive",category:"google",googleFontName:"Satisfy"},{name:"Indie Flower",value:'"Indie Flower", cursive',category:"google",googleFontName:"Indie+Flower"},{name:"Architects Daughter",value:'"Architects Daughter", cursive',category:"google",googleFontName:"Architects+Daughter"},{name:"Kalam",value:"Kalam, cursive",category:"google",googleFontName:"Kalam"},{name:"Amatic SC",value:'"Amatic SC", cursive',category:"google",googleFontName:"Amatic+SC"},{name:"Patrick Hand",value:'"Patrick Hand", cursive',category:"google",googleFontName:"Patrick+Hand"},{name:"Courgette",value:"Courgette, cursive",category:"google",googleFontName:"Courgette"},{name:"Roboto Mono",value:'"Roboto Mono", monospace',category:"google",googleFontName:"Roboto+Mono"},{name:"Source Code Pro",value:'"Source Code Pro", monospace',category:"google",googleFontName:"Source+Code+Pro"},{name:"Fira Code",value:'"Fira Code", monospace',category:"google",googleFontName:"Fira+Code"},{name:"JetBrains Mono",value:'"JetBrains Mono", monospace',category:"google",googleFontName:"JetBrains+Mono"},{name:"Space Mono",value:'"Space Mono", monospace',category:"google",googleFontName:"Space+Mono"},{name:"Courier Prime",value:'"Courier Prime", monospace',category:"google",googleFontName:"Courier+Prime"},{name:"Inconsolata",value:"Inconsolata, monospace",category:"google",googleFontName:"Inconsolata"},{name:"IBM Plex Mono",value:'"IBM Plex Mono", monospace',category:"google",googleFontName:"IBM+Plex+Mono"},{name:"Anonymous Pro",value:'"Anonymous Pro", monospace',category:"google",googleFontName:"Anonymous+Pro"},{name:"Overpass Mono",value:'"Overpass Mono", monospace',category:"google",googleFontName:"Overpass+Mono"},{name:"Creepster",value:'"Creepster", cursive',category:"google",googleFontName:"Creepster"},{name:"Frijole",value:'"Frijole", cursive',category:"google",googleFontName:"Frijole"},{name:"Spicy Rice",value:'"Spicy Rice", cursive',category:"google",googleFontName:"Spicy+Rice"},{name:"Ranchers",value:'"Ranchers", cursive',category:"google",googleFontName:"Ranchers"},{name:"Chewy",value:'"Chewy", cursive',category:"google",googleFontName:"Chewy"}],Pa=[...Da,...rp],Su=new Set;async function op(i){return Su.has(i)?Promise.resolve():new Promise((c,l)=>{const d=document.createElement("link");d.rel="stylesheet",d.href=`https://fonts.googleapis.com/css2?family=${i}:wght@400;700&display=swap`,d.onload=()=>{Su.add(i),c()},d.onerror=()=>{console.error(`Failed to load Google Font: ${i}`),l(new Error(`Failed to load font: ${i}`))},document.head.appendChild(d)})}function sp(i){return Pa.find(c=>c.value===i)}const Lu=4;function lp(i,c,l,d,f,y=1.2,m=Lu,b=0,h="normal"){i.font=`${h} ${l*m}px ${d}`,typeof i.letterSpacing<"u"&&(i.letterSpacing=`${b*m}px`);const p=[],g=c.split(`
`);for(const v of g){if(!v.trim()){p.push("");continue}if(!f){p.push(v);continue}const P=v.split(" ");let F="";for(const M of P){const B=F?`${F} ${M}`:M;i.measureText(B).width/m>f&&F?(p.push(F),F=M):F=B}F&&p.push(F)}let x=0;for(const v of p){const F=i.measureText(v).width/m;x=Math.max(x,F)}const C=l*y,D=p.length*C;return{width:Math.ceil(x),height:Math.ceil(D),lines:p}}async function Ps(i){const{text:c,fontSize:l,fontFamily:d,color:f,textAlign:y="left",maxWidth:m,lineHeight:b=1.2,disableTransparency:h=!1,letterSpacing:p=0,fontWeight:g="normal"}=i,x=sp(d);if(x?.category==="google"&&x.googleFontName)try{await op(x.googleFontName),await new Promise(Q=>setTimeout(Q,100))}catch(Q){console.error("Failed to load Google Font, using fallback:",Q)}const D=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});if(!D)throw new Error("Failed to get canvas context");const v=h?1:Lu,{width:P,height:F,lines:M}=lp(D,c,l,d,m,b,v,p,g),B=10,se=B*v,Y=(P+B*2)*v,z=(F+B*2)*v,U=document.createElement("canvas");U.width=Y,U.height=z;const K=U.getContext("2d",{willReadFrequently:!0});if(!K)throw new Error("Failed to get canvas context");K.font=`${g} ${l*v}px ${d}`,typeof K.letterSpacing<"u"&&(K.letterSpacing=`${p*v}px`),K.fillStyle=f,K.textBaseline="top",K.imageSmoothingEnabled=!h,K.imageSmoothingQuality=h?"low":"high";const V=l*b*v;let $=se;for(const Q of M){if(!Q){$+=V;continue}let X=se;if(y==="center"){const G=K.measureText(Q).width;X=(Y-G)/2}else if(y==="right"){const G=K.measureText(Q).width;X=Y-G-se}K.fillText(Q,X,$),$+=V}if(h){const Q=K.getImageData(0,0,U.width,U.height),X=Q.data,G=parseInt(f.slice(1,3),16),H=parseInt(f.slice(3,5),16),ie=parseInt(f.slice(5,7),16);for(let j=0;j<X.length;j+=4)X[j+3]>=128?(X[j+3]=255,X[j]=G,X[j+1]=H,X[j+2]=ie):X[j+3]=0;K.putImageData(Q,0,0)}const O=document.createElement("canvas");O.width=P+B*2,O.height=F+B*2;const re=O.getContext("2d",{willReadFrequently:!0});if(!re)throw new Error("Failed to get final canvas context");return re.imageSmoothingEnabled=!h,re.imageSmoothingQuality=h?"low":"high",re.drawImage(U,0,0,Y,z,0,0,O.width,O.height),{dataUrl:O.toDataURL("image/png"),width:O.width,height:O.height}}function bu(i){return i.textContent!==void 0&&i.textContent!==null}function ap(i){return i.shapeType!==void 0&&i.shapeType!==null}const Nu={version:"1.0.0",projectName:"Untitled",created:new Date().toISOString(),modified:new Date().toISOString(),canvas:{width:3276,height:3276,backgroundColor:null,borderColor:"#000000",borderWidth:0,borderOpacity:1,borderEnabled:!0,shadowIntensity:.5,showCheckeredBackground:!1,dragInfoEnabled:!0},viewport:{zoom:100,panX:0,panY:0},grid:{enabled:!1,density:4},rulers:{enabled:!1,guides:[]},layers:[],metadata:{author:"",description:"",tags:[]}},Na={past:[],future:[],maxSteps:50},Ca={activeTool:"select",showRulers:!1,showSelectionBorders:!0,showSelectionTools:!0,selectionBorderAnimationSpeed:.1,clipboardLayers:[],isDraggingLayer:!1,dragLayerId:null,dragStartX:0,dragStartY:0,dragOffsetX:0,dragOffsetY:0},T=Zf()(Jf(i=>({project:Nu,selectedLayerIds:[],isDirty:!1,history:Na,ui:Ca,setProjectName:c=>{i(l=>({project:{...l.project,projectName:c,modified:new Date().toISOString()},isDirty:!0}))},setCanvasConfig:c=>{i(l=>({project:{...l.project,canvas:{...l.project.canvas,...c},modified:new Date().toISOString()},isDirty:!0}))},setViewport:c=>{i(l=>({project:{...l.project,viewport:{...l.project.viewport,...c}}}))},setProjectMetadata:c=>{i(l=>({project:{...l.project,metadata:{...l.project.metadata,...c},modified:new Date().toISOString()},isDirty:!0}))},addLayer:c=>{i(l=>({project:{...l.project,layers:[...l.project.layers,{...c,id:c.id||`layer_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}],modified:new Date().toISOString()},isDirty:!0}))},removeLayer:c=>{i(l=>({project:{...l.project,layers:l.project.layers.filter(d=>d.id!==c),modified:new Date().toISOString()},selectedLayerIds:l.selectedLayerIds.filter(d=>d!==c),isDirty:!0}))},updateLayer:(c,l)=>{i(d=>({project:{...d.project,layers:d.project.layers.map(f=>f.id===c?{...f,...l}:f),modified:new Date().toISOString()},isDirty:!0}))},duplicateLayer:c=>{i(l=>{const d=l.project.layers.find(y=>y.id===c);if(!d)return l;const f={...d,id:`layer_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:`${d.name} (copy)`,zIndex:Math.max(...l.project.layers.map(y=>y.zIndex),0)+1};return{project:{...l.project,layers:[...l.project.layers,f],modified:new Date().toISOString()},isDirty:!0}})},moveLayer:(c,l,d)=>{i(f=>{const y=T.getState(),m=[...y.history.past,y.project];return m.length>y.history.maxSteps&&m.shift(),{project:{...f.project,layers:f.project.layers.map(b=>{if(b.id===c&&!b.locked){const h=Math.floor(b.x+l),p=Math.floor(b.y+d);return{...b,x:h,y:p}}return b}),modified:new Date().toISOString()},history:{...y.history,past:m,future:[]},isDirty:!0}})},reorderLayer:(c,l)=>{i(d=>{const f=d.project.layers.find(p=>p.id===c)?.zIndex;if(f===void 0)return d;const y=d.project.layers.map(p=>p.zIndex).sort((p,g)=>p-g),m=y.indexOf(f);if(l==="up"&&m===y.length-1||l==="down"&&m===0)return d;const b=l==="up"?y[m+1]:y[m-1],h=d.project.layers.find(p=>p.zIndex===b)?.id;return h?{project:{...d.project,layers:d.project.layers.map(p=>p.id===c?{...p,zIndex:b}:p.id===h?{...p,zIndex:f}:p),modified:new Date().toISOString()},isDirty:!0}:d})},reorderSelectedLayers:c=>{i(l=>{if(l.selectedLayerIds.length===0)return l;const d=l.project.layers.map(b=>b.zIndex).sort((b,h)=>b-h),f=l.project.layers.filter(b=>l.selectedLayerIds.includes(b.id)).map(b=>b.zIndex).sort((b,h)=>b-h),y=Math.min(...f),m=Math.max(...f);if(c==="up"&&m===d[d.length-1]||c==="down"&&y===d[0])return l;if(c==="up"){const b=d.find(h=>h>m);return b===void 0?l:{project:{...l.project,layers:l.project.layers.map(h=>l.selectedLayerIds.includes(h.id)?{...h,zIndex:b}:h.zIndex===b?{...h,zIndex:m}:h),modified:new Date().toISOString()},isDirty:!0}}else{const b=[...d].reverse().find(h=>h<y);return b===void 0?l:{project:{...l.project,layers:l.project.layers.map(h=>l.selectedLayerIds.includes(h.id)?{...h,zIndex:b}:h.zIndex===b?{...h,zIndex:y}:h),modified:new Date().toISOString()},isDirty:!0}}})},bringLayerToFront:c=>{i(l=>{const d=Math.max(...l.project.layers.map(f=>f.zIndex),0);return{project:{...l.project,layers:l.project.layers.map(f=>f.id===c?{...f,zIndex:d+1}:f),modified:new Date().toISOString()},isDirty:!0}})},sendLayerToBack:c=>{i(l=>{const d=Math.min(...l.project.layers.map(f=>f.zIndex),0);return{project:{...l.project,layers:l.project.layers.map(f=>f.id===c?{...f,zIndex:d-1}:f),modified:new Date().toISOString()},isDirty:!0}})},selectLayer:(c,l=!1)=>{i(d=>l?{selectedLayerIds:d.selectedLayerIds.includes(c)?d.selectedLayerIds.filter(f=>f!==c):[...d.selectedLayerIds,c]}:{selectedLayerIds:[c]})},selectAllLayers:()=>{i(c=>({selectedLayerIds:c.project.layers.map(l=>l.id)}))},deselectAllLayers:()=>{i({selectedLayerIds:[]})},selectLayerRange:(c,l)=>{i(d=>{const f=d.project.layers.map(g=>g.id),y=f.indexOf(c),m=f.indexOf(l);if(y===-1||m===-1)return d;const[b,h]=y<m?[y,m]:[m,y];return{selectedLayerIds:f.slice(b,h+1)}})},moveSelectedLayers:(c,l)=>{i(d=>({project:{...d.project,layers:d.project.layers.map(f=>{if(d.selectedLayerIds.includes(f.id)&&!f.locked){const y=Math.floor(f.x+c),m=Math.floor(f.y+l);return{...f,x:y,y:m}}return f}),modified:new Date().toISOString()},isDirty:!0}))},deleteSelectedLayers:()=>{i(c=>({project:{...c.project,layers:c.project.layers.filter(l=>!c.selectedLayerIds.includes(l.id)),modified:new Date().toISOString()},selectedLayerIds:[],isDirty:!0}))},toggleVisibilitySelected:()=>{i(c=>{const l=c.selectedLayerIds.every(d=>c.project.layers.find(f=>f.id===d)?.visible);return{project:{...c.project,layers:c.project.layers.map(d=>c.selectedLayerIds.includes(d.id)?{...d,visible:!l}:d),modified:new Date().toISOString()},isDirty:!0}})},startDraggingLayer:(c,l,d)=>{i(f=>({ui:{...f.ui,isDraggingLayer:!0,dragLayerId:c,dragStartX:l,dragStartY:d}}))},updateDragPosition:(c,l)=>{i(d=>{if(!d.ui.isDraggingLayer)return d;let f=c-d.ui.dragStartX,y=l-d.ui.dragStartY;return f=Math.round(f),y=Math.round(y),{ui:{...d.ui,dragOffsetX:f,dragOffsetY:y}}})},stopDraggingLayer:()=>{i(c=>{if(!c.ui.isDraggingLayer||!c.ui.dragLayerId)return c;const l=c.selectedLayerIds.includes(c.ui.dragLayerId)?c.selectedLayerIds:[c.ui.dragLayerId],d=c.ui.dragOffsetX,f=c.ui.dragOffsetY,y=d!==0||f!==0,b={project:{...c.project,layers:c.project.layers.map(h=>l.includes(h.id)&&!h.locked?{...h,x:Math.floor(h.x+d),y:Math.floor(h.y+f)}:h),modified:new Date().toISOString()},ui:{...c.ui,isDraggingLayer:!1,dragLayerId:null,dragOffsetX:0,dragOffsetY:0},isDirty:!0};if(y){const h=T.getState(),{viewport:p,...g}=h.project,x=[...h.history.past,g];return x.length>h.history.maxSteps&&x.shift(),{...b,history:{...h.history,past:x,future:[]},_lastHistoryPushAt:Date.now()}}return b})},pushHistory:()=>{i(c=>{const{viewport:l,...d}=c.project,f=[...c.history.past,d];return f.length>c.history.maxSteps&&f.shift(),{history:{...c.history,past:f,future:[]},_lastHistoryPushAt:Date.now()}})},undo:()=>{i(c=>{if(c.history.past.length===0)return c;const l=[...c.history.past],d=l.pop();if(!d)return c;const{viewport:f,...y}=c.project,m=[y,...c.history.future];return{project:{...d,viewport:c.project.viewport},history:{...c.history,past:l,future:m},_lastHistoryPushAt:Date.now()}})},redo:()=>{i(c=>{if(c.history.future.length===0)return c;const l=[...c.history.future],d=l.shift(),{viewport:f,...y}=c.project,m=[...c.history.past,y];return d?{project:{...d,viewport:c.project.viewport},history:{...c.history,past:m,future:l},_lastHistoryPushAt:Date.now()}:c})},setActiveTool:c=>{i(l=>({ui:{...l.ui,activeTool:c}}))},toggleGrid:()=>{i(c=>({project:{...c.project,grid:{...c.project.grid,enabled:!c.project.grid.enabled},modified:new Date().toISOString()},isDirty:!0}))},setGridDensity:c=>{i(l=>({project:{...l.project,grid:{...l.project.grid,density:Math.max(1,Math.min(8,c))},modified:new Date().toISOString()},isDirty:!0}))},toggleRulers:()=>{i(c=>({project:{...c.project,rulers:{...c.project.rulers,enabled:!c.project.rulers.enabled},modified:new Date().toISOString()},isDirty:!0}))},toggleSelectionBorders:()=>{i(c=>({ui:{...c.ui,showSelectionBorders:!c.ui.showSelectionBorders}}))},toggleSelectionTools:()=>{i(c=>({ui:{...c.ui,showSelectionTools:!c.ui.showSelectionTools}}))},setSelectionBorderAnimationSpeed:c=>{i(l=>({ui:{...l.ui,selectionBorderAnimationSpeed:Math.max(0,Math.min(1,c))}}))},copySelectedLayers:()=>{i(c=>({ui:{...c.ui,clipboardLayers:c.project.layers.filter(l=>c.selectedLayerIds.includes(l.id))}}))},copySelectedLayersToClipboard:async()=>{try{const c=T.getState(),l=c.project.layers.filter(y=>c.selectedLayerIds.includes(y.id));if(l.length===0){console.warn("No layers selected to copy");return}let d;if(l.length===1)d=tp(l[0].imageData);else{const y=l.sort((m,b)=>m.zIndex-b.zIndex);d=await np(y)}const f=new ClipboardItem({"image/png":d});await navigator.clipboard.write([f])}catch(c){console.error("Failed to copy layers to clipboard:",c)}},pasteSelectedLayers:()=>{i(c=>{const l=Math.max(...c.project.layers.map(f=>f.zIndex),0),d=c.ui.clipboardLayers.map((f,y)=>({...f,id:`layer_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,x:f.x+10,y:f.y+10,zIndex:l+y+1}));return{project:{...c.project,layers:[...c.project.layers,...d],modified:new Date().toISOString()},selectedLayerIds:d.map(f=>f.id),isDirty:!0}})},pasteFromClipboard:async()=>{try{if(navigator.clipboard){try{const c=await navigator.clipboard.read();for(const l of c){const d=Array.from(l.types).filter(f=>f.startsWith("image/"));if(d.length>0){const f=d[0],y=await l.getType(f),m=await Fu(y),b=new Image;b.src=m,await new Promise((g,x)=>{b.onload=()=>g(),b.onerror=()=>x(new Error("Failed to load image"))});const h=T.getState(),p=Math.max(...h.project.layers.map(g=>g.zIndex),0);T.setState(g=>({project:{...g.project,layers:[...g.project.layers,{id:`layer_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:"Pasted Image",imageData:m,x:0,y:0,zIndex:p+1,visible:!0,locked:!1,opacity:1,width:b.naturalWidth,height:b.naturalHeight}],modified:new Date().toISOString()},isDirty:!0}));return}}}catch(c){console.debug("Image paste failed, trying text paste:",c)}try{const c=await navigator.clipboard.readText();if(c.trim()){const l=await Ps({text:c,fontSize:16,fontFamily:"Arial",color:"#000000",textAlign:"left",lineHeight:1.2}),d=T.getState(),f=Math.max(...d.project.layers.map(y=>y.zIndex),0);T.setState(y=>({project:{...y.project,layers:[...y.project.layers,{id:`layer_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:`Text: ${c.substring(0,20)}${c.length>20?"...":""}`,imageData:l.dataUrl,x:0,y:0,zIndex:f+1,visible:!0,locked:!1,opacity:1,width:l.width,height:l.height,textContent:c,fontSize:16,fontFamily:"Arial",fontColor:"#000000",textAlign:"left",lineHeight:1.2}],modified:new Date().toISOString()},isDirty:!0}))}}catch(c){console.debug("Text paste failed:",c)}}}catch(c){console.error("Clipboard paste error:",c)}},cropCanvasToLayers:()=>{i(c=>{if(c.project.layers.length===0)return console.warn("[DEBUG] No layers to crop to"),c;let l=1/0,d=1/0,f=-1/0,y=-1/0;c.project.layers.forEach(x=>{l=Math.min(l,x.x),d=Math.min(d,x.y),f=Math.max(f,x.x+x.width),y=Math.max(y,x.y+x.height)});const m=Math.ceil(f-l),b=Math.ceil(y-d),h=l,p=d;if(m<=0||b<=0)return console.warn("[DEBUG] Invalid bounds for crop"),c;console.log(`[DEBUG] Cropping canvas to layers: ${m}x${b} at offset (${h}, ${p})`);const g=c.project.layers.map(x=>({...x,x:x.x-h,y:x.y-p}));return{project:{...c.project,canvas:{...c.project.canvas,width:m,height:b},layers:g,modified:new Date().toISOString()},isDirty:!0}})},resetProject:()=>{i({project:Nu,selectedLayerIds:[],isDirty:!1,history:Na,ui:Ca})},loadProject:c=>{const l={...c,layers:c.layers.filter(d=>d.id!=="__text_canvas_preview__"&&d.id!=="__shape_canvas_preview__")};i({project:l,selectedLayerIds:[],isDirty:!1,history:Na,ui:Ca})},markDirty:()=>{i({isDirty:!0})},markClean:()=>{i({isDirty:!1})}}),{name:"CompositorStore",enabled:!0}));function ip({canvas:i,gridEnabled:c,viewport:l,canvasWidth:d,canvasHeight:f,gridDensity:y,canvasBorderEnabled:m}){const b=N.useRef(null),h=N.useRef(null);return N.useEffect(()=>{if(!b.current||!i||!h.current)return;const p=b.current,g=p.getContext("2d");if(!g)return;const x=50;if(!c||l.zoom<x){g.clearRect(0,0,p.width,p.height);return}const C=l.zoom/100;p.width=h.current.clientWidth,p.height=h.current.clientHeight,g.clearRect(0,0,p.width,p.height);let D=0;l.zoom<=x?D=0:l.zoom<150?D=(l.zoom-x)/100*.3:D=.4;let v=y;if(C<3){const j=9/(C*3);v=y*j}g.strokeStyle=`rgba(0, 0, 0, ${D})`,g.lineWidth=1;const P=i.getBoundingClientRect(),F=h.current.getBoundingClientRect();let M=P.left-F.left,B=P.top-F.top,se=P.width,Y=P.height;const z=m?1:0;M+=z,B+=z,se-=z*2,Y-=z*2,g.save(),g.beginPath(),g.rect(M,B,se,Y),g.clip();const U=p.width/2,K=p.height/2,V=d/2,$=f/2,O=0,re=0,le=V-(U-O)/C+l.panX,Q=$-(K-re)/C+l.panY,X=Math.floor(le/v)*v,G=Math.ceil((le+p.width/C)/v)*v;for(let j=X;j<=G;j+=v){const W=Math.round((j-le)*C);W>=0&&W<=p.width&&(g.beginPath(),g.moveTo(W,0),g.lineTo(W,p.height),g.stroke())}const H=Math.floor(Q/v)*v,ie=Math.ceil((Q+p.height/C)/v)*v;for(let j=H;j<=ie;j+=v){const W=Math.round((j-Q)*C);W>=0&&W<=p.height&&(g.beginPath(),g.moveTo(0,W),g.lineTo(p.width,W),g.stroke())}g.restore()},[c,l,d,f,i,y,m]),o.jsx("div",{ref:h,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",overflow:"hidden"},children:o.jsx("canvas",{ref:b,style:{position:"absolute",top:0,left:0,imageRendering:"pixelated"}})})}const cp=({offsetX:i,offsetY:c,mouseX:l,mouseY:d})=>o.jsx("div",{style:{position:"fixed",left:`${l+10}px`,top:`${d+10}px`,pointerEvents:"none",zIndex:1e3},children:o.jsxs("div",{className:"bg-panel-bg border border-border rounded px-2 py-1 text-xs text-gray-300 whitespace-nowrap shadow-lg",children:[o.jsxs("div",{children:["X: ",i>0?"+":"",i]}),o.jsxs("div",{children:["Y: ",c>0?"+":"",c]})]})});function up(){const i=N.useRef(null),c=N.useRef(null),l=T(j=>j.project),d=T(j=>j.selectedLayerIds),f=T(j=>j.ui.showSelectionBorders),y=T(j=>j.ui.showSelectionTools),m=T(j=>j.ui.selectionBorderAnimationSpeed),b=T(j=>j.ui.isDraggingLayer),h=T(j=>j.ui.dragLayerId),p=T(j=>j.ui.dragOffsetX),g=T(j=>j.ui.dragOffsetY),x=T(j=>j.selectLayer),C=T(j=>j.deselectAllLayers),D=T(j=>j.startDraggingLayer),v=T(j=>j.updateDragPosition),P=T(j=>j.stopDraggingLayer),F=T(j=>j.setViewport),M=T(j=>j.removeLayer),B=T(j=>j.updateLayer),[se,Y]=N.useState(new Map),[z,U]=N.useState(!1),[K,V]=N.useState({x:0,y:0}),[$,O]=N.useState(null),[re,le]=N.useState({x:0,y:0});N.useEffect(()=>{(async()=>{const W=new Map;for(const A of l.layers)if(!se.has(A.id)||se.get(A.id)?.src!==A.imageData)try{const S=new Image;S.src=A.imageData,await new Promise((I,ee)=>{S.onload=()=>I(),S.onerror=()=>ee(new Error(`Failed to load image for layer: ${A.name}`))}),W.set(A.id,S)}catch{}Y(A=>new Map([...A,...W]))})()},[l.layers]),N.useEffect(()=>{const j=c.current,W=i.current;if(!j||!W||l.viewport.zoom!==100||l.viewport.panX!==0||l.viewport.panY!==0)return;const A=j.clientWidth,S=j.clientHeight,I=l.canvas.width,ee=l.canvas.height,ue=A/I*100*.9,he=S/ee*100*.9,ye=Math.min(ue,he,100);F({zoom:Math.max(ye,10)})},[]),N.useEffect(()=>{const j=i.current;if(!j){console.warn("[DEBUG] Canvas element not found");return}const W=j.getContext("2d");if(!W){console.error("[DEBUG] Failed to get canvas context");return}if(W.imageSmoothingEnabled=!1,W.webkitImageSmoothingEnabled=!1,W.mozImageSmoothingEnabled=!1,j.width=l.canvas.width,j.height=l.canvas.height,W.clearRect(0,0,j.width,j.height),l.canvas.backgroundColor&&(W.fillStyle=l.canvas.backgroundColor,W.fillRect(0,0,j.width,j.height)),l.canvas.showCheckeredBackground&&!l.canvas.backgroundColor){const I=document.createElement("canvas");I.width=16,I.height=16;const ee=I.getContext("2d");if(ee){ee.fillStyle="#ffffff",ee.fillRect(0,0,16,16),ee.fillStyle="#cccccc",ee.fillRect(0,0,8,8),ee.fillRect(8,8,8,8);const ue=W.createPattern(I,"repeat");ue&&(W.fillStyle=ue,W.fillRect(0,0,j.width,j.height))}}if(l.canvas.borderWidth&&l.canvas.borderWidth>0){const S=l.canvas.borderWidth;W.strokeStyle=l.canvas.borderColor,W.globalAlpha=l.canvas.borderOpacity,W.lineWidth=S*2;const I=S/2;W.strokeRect(I,I,j.width-S,j.height-S),W.globalAlpha=1}const A=[...l.layers].filter(S=>S.visible).sort((S,I)=>S.zIndex-I.zIndex);for(const S of A){const I=se.get(S.id);if(!I){console.warn(`[DEBUG] Image not loaded for layer: ${S.name}`);continue}const ee=T.getState(),ue=ee.ui.isDraggingLayer&&(ee.ui.dragLayerId===S.id||ee.selectedLayerIds.includes(S.id)&&ee.selectedLayerIds.includes(ee.ui.dragLayerId));let he=Math.floor(S.x),ye=Math.floor(S.y);ue&&(he+=ee.ui.dragOffsetX,ye+=ee.ui.dragOffsetY);const je=W.globalAlpha;W.globalAlpha=S.opacity!==void 0?S.opacity:1,W.drawImage(I,he,ye),W.globalAlpha=je}},[l,se,b,h,p,g]);const Q=(j,W)=>{const A=c.current;if(!A)return{x:0,y:0};const S=A.getBoundingClientRect(),I=j-S.left-20,ee=W-S.top-20,ue=S.width-40,he=S.height-40,ye=ue/2,je=he/2,be=I-ye,Ne=ee-je,ze=l.viewport.zoom/100,bt=be/ze,sn=Ne/ze,te=l.canvas.width/2,Me=l.canvas.height/2,De=te+bt+l.viewport.panX,Te=Me+sn+l.viewport.panY;return{x:De,y:Te}},X=j=>{if(!i.current){console.warn("[DEBUG] Canvas ref not available");return}if(j.button===1){j.preventDefault(),U(!0),V({x:j.clientX,y:j.clientY});return}if(j.button!==0)return;const{x:A,y:S}=Q(j.clientX,j.clientY),I=[...l.layers].filter(ee=>ee.visible).sort((ee,ue)=>ue.zIndex-ee.zIndex);for(const ee of I)if(A>=ee.x&&A<ee.x+ee.width&&S>=ee.y&&S<ee.y+ee.height){if(ee.locked){x(ee.id,j.ctrlKey||j.metaKey);return}const ue=j.ctrlKey||j.metaKey;d.includes(ee.id)&&!ue||x(ee.id,ue),D(ee.id,A,S);return}C(),U(!0),V({x:j.clientX,y:j.clientY})},G=j=>{if(!i.current)return;le({x:j.clientX,y:j.clientY});const{x:A,y:S}=Q(j.clientX,j.clientY);if(O({x:Math.floor(A),y:Math.floor(S)}),z){const ee=l.viewport.zoom/100,ue=j.clientX-K.x,he=j.clientY-K.y,ye=l.viewport.panX-ue/ee,je=l.viewport.panY-he/ee;F({panX:ye,panY:je}),V({x:j.clientX,y:j.clientY});return}T.getState().ui.isDraggingLayer&&v(A,S)},H=()=>{U(!1),P()},ie=j=>{j.preventDefault();const W=j.deltaY>0?-1:1,A=l.viewport.zoom,S=[25,33,50,66,100,150,200,400,800,1600,3200];let I=A;W>0?I=S.find(ee=>ee>A)||S[S.length-1]:I=[...S].reverse().find(ee=>ee<A)||S[0],F({zoom:I})};return o.jsxs("div",{ref:c,className:"relative w-full h-full bg-canvas-bg overflow-hidden cursor-crosshair",style:{paddingTop:"20px",paddingLeft:"20px"},onMouseDown:X,onMouseMove:G,onMouseUp:H,onMouseLeave:H,onWheel:ie,children:[o.jsxs("div",{className:"w-full h-full flex items-center justify-center",style:{width:"calc(100% - 20px)",height:"calc(100% - 20px)",overflowX:"auto",overflowY:"auto"},children:[o.jsxs("div",{style:{transform:`translate(${-l.viewport.panX*(l.viewport.zoom/100)}px, ${-l.viewport.panY*(l.viewport.zoom/100)}px) scale(${l.viewport.zoom/100})`,transformOrigin:"center center",position:"absolute"},children:[o.jsx("canvas",{ref:i,style:{imageRendering:"pixelated",backfaceVisibility:"hidden",WebkitFontSmoothing:"antialiased",outline:l.canvas.borderEnabled?"1px solid rgb(75, 85, 99)":"none",outlineOffset:"0px",boxShadow:l.canvas.shadowIntensity>0?`0 10px 40px rgba(0, 0, 0, ${.5*l.canvas.shadowIntensity})`:"none"}}),f&&d.length>0&&o.jsxs("svg",{width:l.canvas.width,height:l.canvas.height,style:{position:"absolute",top:0,left:0,pointerEvents:"none",overflow:"visible",display:"block"},children:[l.layers.map(j=>{if(!d.includes(j.id))return null;const W=b&&(h===j.id||d.includes(h));let A=Math.floor(j.x),S=Math.floor(j.y);W&&(A+=p,S+=g);const I=j.textContent!==void 0,ee=j.shapeType!==void 0,ue=(I||ee)&&d.length===1;return o.jsxs("g",{children:[o.jsx("rect",{x:A-.12,y:S-.25,width:j.width+.3,height:j.height+.3,fill:"none",stroke:"#b0b0b0",strokeWidth:"0.25",strokeDasharray:"4,4",style:{animation:m>0?`marching-ants ${8/(.125*m)/1e3}s linear infinite`:"none"}}),o.jsx("rect",{x:A-.12,y:S-.25,width:j.width+.3,height:j.height+.3,fill:"none",stroke:"#505050",strokeWidth:"0.25",strokeDasharray:"4,4",strokeDashoffset:"2",style:{animation:m>0?`marching-ants ${8/(.125*m)/1e3}s linear infinite`:"none"}}),y&&d.includes(j.id)&&d.length===1&&o.jsxs("g",{className:"selection-tool-icon",transform:`translate(${A+4}, ${S-14})`,style:{cursor:"pointer",pointerEvents:"auto"},onClick:he=>{he.stopPropagation(),M(j.id)},onMouseDown:he=>he.stopPropagation(),children:[o.jsx("circle",{cx:"6",cy:"6",r:"5",fill:"none",stroke:"none",pointerEvents:"all"}),o.jsx("path",{d:"M4 4l16 16M20 4l-16 16",stroke:"#9ca3af",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",transform:"scale(0.4)",pointerEvents:"none"})]}),y&&d.includes(j.id)&&d.length===1&&o.jsxs("g",{className:"selection-tool-icon",transform:`translate(${A+14}, ${S-14})`,style:{cursor:"pointer",pointerEvents:"auto"},onClick:he=>{he.stopPropagation(),B(j.id,{visible:!j.visible})},onMouseDown:he=>he.stopPropagation(),children:[o.jsx("circle",{cx:"6",cy:"6",r:"5",fill:"none",stroke:"none",pointerEvents:"all"}),j.visible?o.jsx("path",{d:"M12 4.5C7.244 4.5 3.226 7.662 1.934 12c1.292 4.338 5.31 7.5 10.066 7.5s8.773-3.162 10.065-7.5c-1.292-4.338-5.31-7.5-10.065-7.5zm0 12a4.5 4.5 0 110-9 4.5 4.5 0 010 9z",fill:"#9ca3af",stroke:"#4b5563",strokeWidth:"0.5",transform:"scale(0.4)",pointerEvents:"none"}):o.jsxs("g",{pointerEvents:"none",children:[o.jsx("circle",{cx:"6",cy:"6",r:"4",fill:"none",stroke:"#9ca3af",strokeWidth:"0.5"}),o.jsx("line",{x1:"2",y1:"2",x2:"10",y2:"10",stroke:"#9ca3af",strokeWidth:"0.5"})]})]}),y&&ue&&o.jsxs("g",{className:"selection-tool-icon",transform:`translate(${A+24}, ${S-14})`,style:{cursor:"pointer",pointerEvents:"auto"},onClick:he=>{he.stopPropagation(),I?window.openTextLayerModal?.(j):ee&&window.openShapeModal?.(j)},onMouseDown:he=>he.stopPropagation(),children:[o.jsx("circle",{cx:"6",cy:"6",r:"5",fill:"none",stroke:"none",pointerEvents:"all"}),o.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z",fill:"#9ca3af",stroke:"#4b5563",strokeWidth:"0.5",transform:"scale(0.4)",pointerEvents:"none"})]})]},j.id)}),o.jsx("style",{children:`
                @keyframes marching-ants {
                  0% {
                    stroke-dashoffset: 0;
                  }
                  100% {
                    stroke-dashoffset: -8;
                  }
                }
                .selection-tool-icon {
                  opacity: 0.6;
                  transition: opacity 0.2s ease, filter 0.2s ease;
                }
                .selection-tool-icon:hover {
                  opacity: 1;
                  filter: drop-shadow(0 0 4px rgba(156, 163, 175, 0.8));
                }
              `})]})]}),o.jsx(ip,{canvas:i.current,gridEnabled:l.grid.enabled,viewport:l.viewport,canvasWidth:l.canvas.width,canvasHeight:l.canvas.height,gridDensity:l.grid.density,canvasBorderEnabled:l.canvas.borderEnabled})]}),o.jsxs("div",{className:"absolute bottom-4 right-4 bg-panel-bg border border-border rounded px-3 py-2 text-xs text-gray-400 space-y-1",children:[o.jsxs("div",{children:["Canvas: ",l.canvas.width,"x",l.canvas.height]}),o.jsxs("div",{children:["Zoom: ",l.viewport.zoom,"%"]}),o.jsxs("div",{children:["Layers: ",l.layers.length]}),$&&o.jsxs("div",{children:["Coords: (",$.x,", ",$.y,")"]}),o.jsx("div",{className:"text-gray-500 text-xs mt-2 pt-2 border-t border-border",children:"Middle-click to pan"})]}),d.length>0&&o.jsxs("div",{className:"absolute top-4 right-4 bg-panel-bg border border-blue-600 rounded px-3 py-2 text-xs text-blue-400",children:["Selected: ",d.length," layer",d.length!==1?"s":""]}),b&&l.canvas.dragInfoEnabled&&o.jsx(cp,{offsetX:p,offsetY:g,mouseX:re.x,mouseY:re.y})]})}const dp="1.0.0",Iu="1.0.0";function Mu(i){const c=i.layers.filter(d=>d.id!=="__text_canvas_preview__"&&d.id!=="__shape_canvas_preview__"),l={...i,layers:c,modified:new Date().toISOString()};return JSON.stringify(l,null,2)}async function La(i){try{const c=JSON.parse(i);if(!c.version)throw new Error("Invalid project file: missing version field");if(!fp(c.version))throw new Error(`Project version ${c.version} is not supported. Current version: ${dp}, minimum supported: ${Iu}`);return c.layers&&(c.layers=c.layers.filter(l=>l.id!=="__text_canvas_preview__"&&l.id!=="__shape_canvas_preview__")),pp(c),await hp(c.layers),c}catch(c){throw console.error("[DEBUG] Project deserialization failed:",c),c}}function fp(i){const[c,l]=i.split(".").map(Number),[d,f]=Iu.split(".").map(Number);return c>d||c<d?!1:l>=f}function pp(i){const c=["version","canvas","layers","viewport","grid","rulers"];for(const l of c)if(!(l in i))throw new Error(`Invalid project file: missing required field '${l}'`);if(typeof i.canvas.width!="number"||i.canvas.width<=0)throw new Error("Invalid project file: canvas width must be a positive number");if(typeof i.canvas.height!="number"||i.canvas.height<=0)throw new Error("Invalid project file: canvas height must be a positive number");if(!Array.isArray(i.layers))throw new Error("Invalid project file: layers must be an array");for(let l=0;l<i.layers.length;l++){const d=i.layers[l],f=["id","name","imageData","x","y","zIndex","visible","locked","width","height"];for(const y of f)if(!(y in d))throw new Error(`Invalid layer ${l}: missing required field '${y}'`);if(typeof d.x!="number"||typeof d.y!="number")throw new Error(`Invalid layer ${l}: x and y must be numbers`);if(!d.imageData.startsWith("data:image/"))throw new Error(`Invalid layer ${l}: imageData must be a valid data URL`)}}async function hp(i){for(let c=0;c<i.length;c++){const l=i[c];try{await _u(l.imageData)}catch(d){throw new Error(`Failed to load image for layer ${c} (${l.name}): ${d instanceof Error?d.message:"Unknown error"}`)}}}function _u(i){return new Promise((c,l)=>{const d=new Image,f=setTimeout(()=>{l(new Error("Image load timeout"))},5e3);d.onload=()=>{clearTimeout(f),c(d)},d.onerror=()=>{clearTimeout(f),l(new Error("Failed to load image"))},d.src=i})}async function gp(i,c,l,d=1,f=null){const y=document.createElement("canvas");y.width=c*d,y.height=l*d;const m=y.getContext("2d");if(!m)throw new Error("Failed to get canvas context");m.imageSmoothingEnabled=!1,m.webkitImageSmoothingEnabled=!1,m.mozImageSmoothingEnabled=!1,m.scale(d,d),f&&(m.fillStyle=f,m.fillRect(0,0,c,l));const b=[...i].filter(h=>h.visible).sort((h,p)=>h.zIndex-p.zIndex);for(const h of b)try{const p=await _u(h.imageData);m.drawImage(p,h.x,h.y)}catch(p){console.warn(`Failed to export layer ${h.name}:`,p)}return new Promise(h=>{y.toBlob(p=>{if(!p)throw new Error("Failed to create PNG blob");h(p)},"image/png")})}function mp(){const i=N.useRef(null),c=T(m=>m.addLayer),l=T(m=>m.loadProject),d=T(m=>m.markClean),f=async m=>{const b=m.currentTarget.files;if(!b){console.warn("[DEBUG] No files selected");return}for(const h of Array.from(b))try{if(h.name.toLowerCase().endsWith(".pixcomp"))try{const D=await h.text(),v=await La(D);l(v),d(),i.current&&(i.current.value="");return}catch(D){console.error("[DEBUG] Load project failed:",D),alert(`Error loading project: ${D instanceof Error?D.message:"Unknown error"}`);continue}if(!["image/png","image/gif","image/bmp","image/jpeg"].includes(h.type)){console.warn(`[DEBUG] Unsupported file type: ${h.type}`),alert(`Unsupported file type: ${h.type}. Please use .pixcomp, PNG, GIF, BMP, or JPEG.`);continue}const p=await new Promise((D,v)=>{const P=new FileReader;P.onload=F=>D(F.target?.result),P.onerror=()=>v(new Error("Failed to read file")),P.readAsDataURL(h)}),g=new Image;g.src=p,await new Promise((D,v)=>{g.onload=()=>D(),g.onerror=()=>v(new Error("Failed to load image"))});const x=g.naturalWidth,C=g.naturalHeight;c({name:h.name,imageData:p,x:0,y:0,zIndex:T.getState().project.layers.length,visible:!0,locked:!1,opacity:1,width:x,height:C})}catch(p){alert(`Error loading image ${h.name}: ${p instanceof Error?p.message:"Unknown error"}`)}i.current&&(i.current.value="")},y=async m=>{m.preventDefault();const b=m.clipboardData?.items;if(b){for(let h=0;h<b.length;h++){const p=b[h];if(p.type.startsWith("image/"))try{const g=p.getAsFile();if(!g)continue;const x=await Fu(g),C=new Image;C.src=x,await new Promise((v,P)=>{C.onload=()=>v(),C.onerror=()=>P(new Error("Failed to load image"))});const D=Math.max(...T.getState().project.layers.map(v=>v.zIndex),0);c({name:"Pasted Image",imageData:x,x:0,y:0,zIndex:D+1,visible:!0,locked:!1,opacity:1,width:C.naturalWidth,height:C.naturalHeight});break}catch(g){console.error("Error pasting image:",g)}}if(m.clipboardData?.types.includes("text/plain"))try{const h=m.clipboardData.getData("text/plain");if(h.trim()){const p=await Ps({text:h,fontSize:16,fontFamily:"Arial",color:"#000000",textAlign:"left",lineHeight:1.2}),g=Math.max(...T.getState().project.layers.map(x=>x.zIndex),0);c({id:`layer_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:`Text: ${h.substring(0,20)}${h.length>20?"...":""}`,imageData:p.dataUrl,x:0,y:0,zIndex:g+1,visible:!0,locked:!1,opacity:1,width:p.width,height:p.height,textContent:h,fontSize:16,fontFamily:"Arial",fontColor:"#000000",textAlign:"left",lineHeight:1.2})}}catch(h){console.error("Error pasting text:",h)}}};return o.jsxs("div",{className:"w-full h-full flex flex-col relative",onPaste:y,children:[o.jsx("div",{className:"flex-1 relative overflow-hidden","data-canvas-container":"true",children:o.jsx(up,{})}),T(m=>m.project.layers.length===0)&&o.jsx("div",{onClick:()=>i.current?.click(),className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-30 cursor-pointer hover:bg-opacity-40 transition-all z-10",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-4xl mb-4",children:""}),o.jsx("div",{className:"text-lg font-semibold text-white mb-2",children:"Click to upload images or drag & drop"}),o.jsx("div",{className:"text-sm text-gray-400",children:"Supported: .pixcomp, PNG, GIF, BMP, JPEG"})]})}),o.jsx("input",{ref:i,type:"file",multiple:!0,accept:".pixcomp,image/png,image/gif,image/bmp,image/jpeg",onChange:f,className:"hidden"})]})}let It=null;function xp({layer:i,isSelected:c}){const l=T(G=>G.selectLayer),d=T(G=>G.selectLayerRange),f=T(G=>G.updateLayer),y=T(G=>G.removeLayer),m=T(G=>G.reorderLayer),b=T(G=>G.bringLayerToFront),h=T(G=>G.sendLayerToBack),p=T(G=>G.duplicateLayer),[g,x]=N.useState(!1),[C,D]=N.useState(i.name),[v,P]=N.useState(!1),F=N.useRef(null);N.useEffect(()=>{const G=()=>{It&&(It=null,P(!1))};document.addEventListener("mouseup",G);const H=ie=>{(ie.clientY<0||ie.clientX<0||ie.clientX>window.innerWidth||ie.clientY>window.innerHeight)&&It&&(It=null,P(!1))};return document.addEventListener("mousemove",H),()=>{document.removeEventListener("mouseup",G),document.removeEventListener("mousemove",H)}},[]);const M=G=>{const H=G.ctrlKey||G.metaKey;if(G.shiftKey&&T.getState().selectedLayerIds.length>0){const j=T.getState().selectedLayerIds[T.getState().selectedLayerIds.length-1];d(j,i.id)}else l(i.id,H)},B=G=>{G.stopPropagation(),l(i.id,!0)},se=G=>{G.target.closest("button")||g||(It=i.id,c||l(i.id,!1))},Y=()=>{if(!It||It===i.id){P(!1);return}P(!0);const G=T.getState().project.layers.find(ie=>ie.id===It),H=G&&G.zIndex<i.zIndex?"up":"down";m(It,H)},z=()=>{P(!1)},U=()=>{It&&(It=null)},K=G=>{G.stopPropagation(),f(i.id,{visible:!i.visible})},V=G=>{G.stopPropagation(),f(i.id,{locked:!i.locked})},$=()=>{C.trim()?f(i.id,{name:C.trim()}):D(i.name),x(!1)},O=G=>{G.key==="Enter"?$():G.key==="Escape"&&(D(i.name),x(!1))},re=G=>{G.stopPropagation(),y(i.id)},le=G=>{G.stopPropagation(),p(i.id)},Q=G=>{G.stopPropagation(),b(i.id)},X=G=>{G.stopPropagation(),h(i.id)};return o.jsxs("div",{ref:F,onClick:M,onMouseDown:se,onMouseEnter:Y,onMouseLeave:z,onMouseUp:U,title:"Click to select  Ctrl/Cmd+Click for multi-select  Shift+Click for range select",className:`group p-2 rounded border transition-all cursor-pointer select-none ${v?"bg-green-900 border-green-400 scale-105":""} ${c?"bg-blue-900 border-blue-500 text-white":"bg-panel-bg border-border text-gray-300 hover:bg-gray-800"}`,children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("button",{onClick:B,onMouseDown:G=>G.stopPropagation(),className:`w-4 h-4 flex-shrink-0 rounded border-2 flex items-center justify-center transition-colors ${c?"bg-white border-white":"bg-gray-700 border-gray-600 hover:border-gray-500"}`,title:"Select/deselect this layer",children:c&&o.jsx("svg",{className:"w-3 h-3 text-black",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),o.jsxs("div",{className:"w-8 h-8 flex-shrink-0 bg-canvas-bg border border-gray-600 rounded overflow-hidden relative",children:[o.jsx("img",{src:i.imageData,alt:i.name,className:"w-full h-full object-contain",style:{imageRendering:"pixelated"}}),bu(i)&&o.jsx("div",{className:"absolute bottom-0 right-0 bg-blue-600 text-white text-[8px] font-bold px-1 rounded-tl",title:"Text Layer",children:"T"})]}),o.jsx("div",{className:"flex-1 min-w-0",children:g?o.jsx("input",{autoFocus:!0,type:"text",value:C,onChange:G=>D(G.target.value),onBlur:$,onKeyDown:O,onClick:G=>G.stopPropagation(),className:"w-full px-1 py-0 bg-canvas-bg border border-blue-400 rounded text-xs text-white focus:outline-none focus:ring-1 focus:ring-blue-300",placeholder:"Layer name..."}):o.jsx("span",{className:"text-xs font-medium truncate block",title:i.name,children:i.name})}),!g&&o.jsx("button",{onClick:G=>{G.stopPropagation(),D(i.name),x(!0)},className:"w-4 h-4 flex items-center justify-center flex-shrink-0 rounded transition-colors hover:bg-gray-600 opacity-0 group-hover:opacity-100",title:"Rename layer",children:o.jsx("svg",{className:"w-3 h-3 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})}),o.jsx("button",{onClick:K,className:"w-5 h-5 flex items-center justify-center flex-shrink-0 rounded transition-colors hover:bg-gray-600",title:i.visible?"Hide layer":"Show layer",children:i.visible?o.jsxs("svg",{className:"w-4 h-4 text-gray-300",fill:"currentColor",viewBox:"0 0 20 20",children:[o.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),o.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}):o.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-5.838 1.834l-2.455-2.541zM12.305 15.93A9.959 9.959 0 0110 15c-4.478 0-8.268-2.943-9.542-7a9.88 9.88 0 011.964-2.964l2.386 2.386c-.078.464-.12.94-.12 1.424 0 3.314 2.686 6 6 6a5.975 5.975 0 002.717-.632l2.472 2.472z",clipRule:"evenodd"})})}),o.jsx("button",{onClick:V,className:"w-5 h-5 flex items-center justify-center flex-shrink-0 rounded transition-colors hover:bg-gray-600",title:i.locked?"Unlock layer":"Lock layer",children:i.locked?o.jsx("svg",{className:"w-4 h-4 text-gray-300",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})}):o.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{d:"M10 2a5 5 0 00-5 5v2a2 2 0 00-2 2v5a2 2 0 002 2h10a2 2 0 002-2v-5a2 2 0 00-2-2V7a5 5 0 00-5-5zm0 2a3 3 0 013 3v2H7V7a3 3 0 013-3z"})})})]}),o.jsxs("div",{className:"text-xs text-gray-500 px-10 mb-2",children:[i.width,"",i.height,"  z:",i.zIndex]}),o.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[bu(i)&&o.jsx("button",{onClick:G=>{G.stopPropagation(),window.openTextLayerModal?.(i)},className:"flex-1 px-1 py-1 text-xs bg-blue-700 hover:bg-blue-600 rounded transition-colors flex items-center justify-center",title:"Edit text",children:o.jsx("span",{className:"font-bold text-sm",children:"T"})}),ap(i)&&o.jsx("button",{onClick:G=>{G.stopPropagation(),window.openShapeModal?.(i)},className:"flex-1 px-1 py-1 text-xs bg-purple-700 hover:bg-purple-600 rounded transition-colors flex items-center justify-center",title:"Edit shape",children:""}),o.jsx("button",{onClick:Q,className:"flex-1 px-1 py-1 text-xs bg-gray-700 hover:bg-gray-600 rounded transition-colors flex items-center justify-center",title:"Bring to front",children:o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 11l5-5m0 0l5 5m-5-5v12"})})}),o.jsx("button",{onClick:X,className:"flex-1 px-1 py-1 text-xs bg-gray-700 hover:bg-gray-600 rounded transition-colors flex items-center justify-center",title:"Send to back",children:o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 9l-5 5m0 0l-5-5m5 5V2"})})}),o.jsx("button",{onClick:le,className:"flex-1 px-1 py-1 text-xs bg-blue-700 hover:bg-blue-600 rounded transition-colors flex items-center justify-center",title:"Duplicate layer",children:o.jsxs("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:[o.jsx("path",{d:"M4 4a2 2 0 012-2h6a2 2 0 012 2v12a1 1 0 110 2h-6a2 2 0 01-2-2V4z"}),o.jsx("path",{d:"M14 4a2 2 0 00-2-2v12a2 2 0 002 2h2a2 2 0 002-2V4h-4z"})]})}),o.jsx("button",{onClick:re,className:"flex-1 px-1 py-1 text-xs bg-red-700 hover:bg-red-600 rounded transition-colors flex items-center justify-center",title:"Remove layer",children:o.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})]})}const Ru="pixelconnect-preferences";function Fs(){try{const i=localStorage.getItem(Ru);if(i)return JSON.parse(i)}catch(i){console.warn("[DEBUG] Failed to load preferences from localStorage:",i)}return{}}function Ia(i){try{localStorage.setItem(Ru,JSON.stringify(i))}catch(c){console.warn("[DEBUG] Failed to save preferences to localStorage:",c)}}function yp(){N.useEffect(()=>{const i=Fs();i.gridDensity!==void 0&&T.getState().setGridDensity(i.gridDensity),i.gridEnabled!==void 0&&T.getState().project.grid.enabled!==i.gridEnabled&&T.getState().toggleGrid(),i.showSelectionBorders!==void 0&&T.getState().ui.showSelectionBorders!==i.showSelectionBorders&&T.getState().toggleSelectionBorders(),i.selectionBorderAnimationSpeed!==void 0&&T.getState().setSelectionBorderAnimationSpeed(i.selectionBorderAnimationSpeed);const c={};i.canvasBorderColor!==void 0&&(c.borderColor=i.canvasBorderColor),i.canvasBorderWidth!==void 0&&(c.borderWidth=i.canvasBorderWidth),i.canvasBorderOpacity!==void 0&&(c.borderOpacity=i.canvasBorderOpacity),Object.keys(c).length>0&&T.getState().setCanvasConfig(c)},[])}function vp(){const i=T(v=>v.project.canvas),c=T(v=>v.project.layers),l=T(v=>v.setCanvasConfig),d=T(v=>v.cropCanvasToLayers),[f,y]=N.useState(!1),[m,b]=N.useState(String(i.width)),[h,p]=N.useState(String(i.height)),g=v=>{if(b(v),v!==""&&v!=="-"){const P=parseInt(v,10);!isNaN(P)&&P>0&&l({width:P})}},x=v=>{if(p(v),v!==""&&v!=="-"){const P=parseInt(v,10);!isNaN(P)&&P>0&&l({height:P})}};N.useEffect(()=>{b(String(i.width))},[i.width]),N.useEffect(()=>{p(String(i.height))},[i.height]),N.useEffect(()=>{const v=Fs();v.canvasBorderEnabled=i.borderEnabled,v.canvasShadowIntensity=i.shadowIntensity,Ia(v)},[i.borderEnabled,i.shadowIntensity]);const C=v=>{v==="transparent"?l({backgroundColor:null}):v.startsWith("#")&&l({backgroundColor:v})},D=v=>{const[P,F]=v.split("x").map(Number);!isNaN(P)&&!isNaN(F)&&P>0&&F>0&&l({width:P,height:F})};return o.jsxs("div",{className:"border-t border-border bg-gray-850",children:[o.jsxs("button",{onClick:()=>y(!f),className:"w-full px-3 py-2 flex items-center justify-between text-xs font-semibold text-gray-300 hover:bg-gray-800 transition-colors group",children:[o.jsx("span",{children:"Canvas"}),o.jsx("span",{className:`text-gray-400 transition-transform group-hover:drop-shadow-lg group-hover:text-gray-200 ${f?"":"rotate-180"}`,children:""})]}),!f&&o.jsxs("div",{className:"p-3 space-y-3 bg-gray-850",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Common Sizes"}),o.jsxs("select",{onChange:v=>D(v.target.value),className:"w-full px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-white focus:outline-none focus:ring-1 focus:ring-blue-400 cursor-pointer",defaultValue:"",children:[o.jsx("option",{value:"",children:"Select a size..."}),o.jsx("option",{value:"1024x1024",children:"1024x1024"}),o.jsx("option",{value:"2048x2048",children:"2048x2048"}),o.jsx("option",{value:"1920x1080",children:"1920x1080"}),o.jsx("option",{value:"3840x2160",children:"3840x2160 (4K)"}),o.jsx("option",{value:"4632x2316",children:"4632x2316"}),o.jsx("option",{value:"2316x4632",children:"2316x4632 (Vertical)"}),o.jsx("option",{value:"3276x3276",children:"3276x3276"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Width"}),o.jsx("input",{type:"text",inputMode:"numeric",value:m,onChange:v=>g(v.target.value),className:"w-full px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-white focus:outline-none focus:ring-1 focus:ring-blue-400",placeholder:"Width"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Height"}),o.jsx("input",{type:"text",inputMode:"numeric",value:h,onChange:v=>x(v.target.value),className:"w-full px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-white focus:outline-none focus:ring-1 focus:ring-blue-400",placeholder:"Height"})]})]}),o.jsx("button",{onClick:d,disabled:c.length===0,className:`w-full px-3 py-2 rounded transition-colors text-xs font-medium ${c.length===0?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-slate-700 text-white hover:bg-slate-600"}`,title:c.length===0?"Add layers first to crop canvas":"Crop canvas to layer bounds",children:"Crop Canvas to Layers"}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Background"}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("input",{type:"color",value:i.backgroundColor||"#ffffff",onChange:v=>C(v.target.value),className:"flex-1 h-8 rounded cursor-pointer border border-border",title:"Pick background color"}),o.jsx("button",{onClick:()=>C("transparent"),className:`flex-1 px-2 py-1 text-xs font-medium rounded transition-colors ${i.backgroundColor===null?"bg-blue-600 text-white":"bg-panel-bg text-gray-400 hover:text-gray-300"}`,title:"Set background to transparent",children:"Clear"})]})]}),o.jsxs("div",{className:"space-y-2 pt-2 border-t border-border",children:[o.jsx("div",{className:"text-xs font-semibold text-gray-300",children:"Border"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:"checkbox",id:"borderEnabled",checked:i.borderEnabled??!0,onChange:v=>l({borderEnabled:v.target.checked}),className:"w-4 h-4 rounded cursor-pointer",title:"Enable or disable canvas border"}),o.jsx("label",{htmlFor:"borderEnabled",className:"text-xs text-gray-400 cursor-pointer flex-1",children:"Show Border"})]})]}),o.jsxs("div",{className:"space-y-2 pt-2 border-t border-border",children:[o.jsx("div",{className:"text-xs font-semibold text-gray-300",children:"Shadow"}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Intensity"}),o.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:i.shadowIntensity??.5,onChange:v=>l({shadowIntensity:parseFloat(v.target.value)}),className:"w-full h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer",title:"Shadow intensity (0 = off, 1 = max)"}),o.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[Math.round((i.shadowIntensity??.5)*100),"%"]})]})]}),o.jsx("div",{className:"space-y-2 pt-2 border-t border-border",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:"checkbox",id:"checkerboardBg",checked:i.showCheckeredBackground??!1,onChange:v=>l({showCheckeredBackground:v.target.checked}),disabled:i.backgroundColor!==null,className:"w-4 h-4 rounded cursor-pointer disabled:opacity-50",title:"Show checkered pattern for transparency (only available when background is transparent)"}),o.jsx("label",{htmlFor:"checkerboardBg",className:`text-xs cursor-pointer flex-1 ${i.backgroundColor!==null?"text-gray-600":"text-gray-400"}`,children:"Checkered Background"})]})}),o.jsx("div",{className:"space-y-2 pt-2 border-t border-border",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:"checkbox",id:"dragInfoEnabled",checked:i.dragInfoEnabled??!0,onChange:v=>l({dragInfoEnabled:v.target.checked}),className:"w-4 h-4 rounded cursor-pointer",title:"Show drag translation info when dragging layers"}),o.jsx("label",{htmlFor:"dragInfoEnabled",className:"text-xs text-gray-400 cursor-pointer flex-1",children:"Show Drag Info"})]})})]})]})}function wp(){const i=N.useRef(null),c=T(g=>g.project),l=T(g=>g.selectedLayerIds),d=T(g=>g.selectAllLayers),f=T(g=>g.deselectAllLayers),y=T(g=>g.deleteSelectedLayers),m=T(g=>g.addLayer),b=[...c.layers].sort((g,x)=>x.zIndex-g.zIndex),h=()=>{if(l.length===0){console.warn("[DEBUG] No layers selected for deletion");return}window.confirm(`Delete ${l.length} layer${l.length!==1?"s":""}?`)&&y()},p=async g=>{const x=g.currentTarget.files;if(!x){console.warn("[DEBUG] No files selected");return}for(const C of Array.from(x))try{if(!["image/png","image/gif","image/bmp","image/jpeg"].includes(C.type)){console.warn(`[DEBUG] Unsupported file type: ${C.type}`),alert(`Unsupported file type: ${C.type}. Please use PNG, GIF, BMP, or JPEG.`);continue}const D=await new Promise((M,B)=>{const se=new FileReader;se.onload=Y=>M(Y.target?.result),se.onerror=()=>B(new Error("Failed to read file")),se.readAsDataURL(C)}),v=new Image;v.src=D,await new Promise((M,B)=>{v.onload=()=>M(),v.onerror=()=>B(new Error("Failed to load image"))});const P=v.naturalWidth,F=v.naturalHeight;m({name:C.name,imageData:D,x:0,y:0,zIndex:T.getState().project.layers.length,visible:!0,locked:!1,opacity:1,width:P,height:F})}catch(D){alert(`Error loading image ${C.name}: ${D instanceof Error?D.message:"Unknown error"}`)}i.current&&(i.current.value="")};return o.jsxs("div",{className:"h-full flex flex-col bg-canvas-bg",children:[o.jsxs("div",{className:"px-3 py-3 border-b border-border",children:[o.jsx("h2",{className:"text-sm font-semibold text-gray-300 mb-3",children:"Layers"}),o.jsxs("div",{className:"flex gap-1 flex-wrap",children:[o.jsx("button",{onClick:d,disabled:c.layers.length===0,className:"flex-1 min-w-16 px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-300 bg-panel-bg hover:bg-gray-700 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Select all layers (Ctrl+A)",children:"All"}),o.jsx("button",{onClick:f,disabled:l.length===0,className:"flex-1 min-w-16 px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-300 bg-panel-bg hover:bg-gray-700 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Deselect all layers (Ctrl+D)",children:"None"}),o.jsx("button",{onClick:h,disabled:l.length===0,className:"flex-1 min-w-16 px-2 py-1 text-xs font-medium text-red-400 hover:text-red-300 bg-panel-bg hover:bg-red-900 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Delete selected layers (Delete)",children:"Delete"}),o.jsx("button",{onClick:()=>window.openTextLayerModal?.(),className:"flex-1 min-w-16 px-2 py-1 text-xs font-medium text-blue-400 hover:text-blue-300 bg-panel-bg hover:bg-blue-900 rounded transition-colors flex items-center justify-center gap-1",title:"Create text layer",children:o.jsx("span",{className:"font-bold",children:"T"})}),o.jsx("button",{onClick:()=>window.openShapeModal?.(),className:"flex-1 min-w-16 px-2 py-1 text-xs font-medium text-purple-400 hover:text-purple-300 bg-panel-bg hover:bg-purple-900 rounded transition-colors",title:"Create shape layer",children:""}),o.jsx("button",{onClick:()=>i.current?.click(),className:"flex-1 min-w-16 px-2 py-1 text-xs font-medium text-green-400 hover:text-green-300 bg-panel-bg hover:bg-green-900 rounded transition-colors",title:"Upload additional images",children:"Add"})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:b.length===0?o.jsxs("div",{className:"px-3 py-8 text-center text-sm text-gray-500",children:[o.jsx("div",{className:"mb-2",children:"No layers yet"}),o.jsx("div",{className:"text-xs",children:"Upload images to get started"})]}):o.jsx("div",{className:"space-y-1 p-2",children:b.map(g=>o.jsx(xp,{layer:g,isSelected:l.includes(g.id)},g.id))})}),c.layers.length>0&&o.jsxs("div",{className:"px-3 py-2 border-t border-border text-xs text-gray-500",children:[c.layers.length," layer",c.layers.length!==1?"s":"",l.length>0&&`  ${l.length} selected`]}),o.jsx("div",{className:"border-t border-border px-3 py-2 bg-panel-bg",children:o.jsx(vp,{})}),o.jsx("input",{ref:i,type:"file",multiple:!0,accept:"image/png,image/gif,image/bmp,image/jpeg",onChange:p,className:"hidden"})]})}function jp({layer:i}){const c=T(M=>M.updateLayer),l=T(M=>M.pushHistory),d=T(M=>M.ui.isDraggingLayer),f=T(M=>M.ui.dragLayerId),y=T(M=>M.ui.dragOffsetX),m=T(M=>M.ui.dragOffsetY),[b,h]=N.useState(String(i.x)),[p,g]=N.useState(String(i.y)),x=d&&f===i.id,C=x?Math.floor(i.x+y):i.x,D=x?Math.floor(i.y+m):i.y;N.useEffect(()=>{h(String(C))},[C]),N.useEffect(()=>{g(String(D))},[D]);const v=M=>{if(h(M),M!==""&&M!=="-"){const B=parseInt(M,10);isNaN(B)||c(i.id,{x:B})}},P=M=>{if(g(M),M!==""&&M!=="-"){const B=parseInt(M,10);isNaN(B)||c(i.id,{y:B})}},F=()=>{l()};return o.jsxs("div",{className:"bg-panel-bg rounded p-3 space-y-3",children:[o.jsx("div",{className:"text-xs font-semibold text-gray-300",children:"Position"}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"X"}),o.jsx("input",{type:"text",inputMode:"numeric",value:b,onChange:M=>v(M.target.value),onBlur:F,className:"w-full px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-white focus:outline-none focus:ring-1 focus:ring-blue-400",placeholder:"X position"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Y"}),o.jsx("input",{type:"text",inputMode:"numeric",value:p,onChange:M=>P(M.target.value),onBlur:F,className:"w-full px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-white focus:outline-none focus:ring-1 focus:ring-blue-400",placeholder:"Y position"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-2 border-t border-border",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Width"}),o.jsx("div",{className:"px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-gray-500",children:i.width})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Height"}),o.jsx("div",{className:"px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-gray-500",children:i.height})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Z-Index"}),o.jsx("div",{className:"px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-gray-500",children:i.zIndex})]})]})}function Sp({layer:i}){const c=T(f=>f.updateLayer),l=f=>{const y=Math.max(0,Math.min(1,f/100));c(i.id,{opacity:y})},d=i.opacity!==void 0?i.opacity:1;return o.jsxs("div",{className:"bg-panel-bg rounded p-3 space-y-2",children:[o.jsx("div",{className:"text-xs font-semibold text-gray-300",children:"Opacity"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("input",{type:"range",min:"0",max:"100",value:d*100,onChange:f=>l(parseInt(f.target.value)),className:"w-full h-2 bg-canvas-bg rounded appearance-none cursor-pointer accent-blue-400"}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("span",{className:"text-xs text-gray-400",children:[(d*100).toFixed(0),"%"]}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:()=>l(50),className:"px-2 py-1 text-xs bg-canvas-bg hover:bg-border rounded transition",title:"50% opacity",children:"50%"}),o.jsx("button",{onClick:()=>l(100),className:"px-2 py-1 text-xs bg-canvas-bg hover:bg-border rounded transition",title:"100% opacity (fully opaque)",children:"100%"})]})]})]})]})}function bp({layer:i}){const[c,l]=N.useState(null),[d,f]=N.useState(null),[y,m]=N.useState(!1),[b,h]=N.useState(new Set),[p,g]=N.useState(new Set),x=N.useRef(null),C=N.useRef(null),D=N.useRef(28);N.useEffect(()=>{l(null),f(null),h(new Set),g(new Set)},[i.id]);const v=()=>{if(!x.current||!c)return;const Y=x.current,z=Y.scrollTop,U=Y.clientHeight,K=D.current,V=Math.max(0,Math.floor(z/K)-2),$=Math.min(c.length,Math.ceil((z+U)/K)+2),O=new Set;for(let re=V;re<$;re++)O.add(re);h(O)},P=()=>{if(!C.current||!d)return;const Y=C.current,z=Y.scrollTop,U=Y.clientHeight,K=D.current,V=Math.max(0,Math.floor(z/K)-2),$=Math.min(d.length,Math.ceil((z+U)/K)+2),O=new Set;for(let re=V;re<$;re++)O.add(re);g(O)};N.useEffect(()=>{const Y=x.current;if(Y)return Y.addEventListener("scroll",v),v(),()=>Y.removeEventListener("scroll",v)},[c]),N.useEffect(()=>{const Y=C.current;if(Y)return Y.addEventListener("scroll",P),P(),()=>Y.removeEventListener("scroll",P)},[d]);const F=async Y=>{m(!0);try{const z=new Image;z.onload=()=>{const U=document.createElement("canvas");U.width=z.width,U.height=z.height;const K=U.getContext("2d");if(!K){console.error("Failed to get canvas context"),m(!1);return}K.drawImage(z,0,0);const $=K.getImageData(0,0,U.width,U.height).data;if(Y){const O=new Map;let re=0;for(let Q=0;Q<$.length;Q+=4){const X=$[Q],G=$[Q+1],H=$[Q+2],ie=$[Q+3];if(ie===0)continue;re++;const W=`${`#${((1<<24)+(X<<16)+(G<<8)+H).toString(16).slice(1).toUpperCase()}`}${ie.toString(16).padStart(2,"0").toUpperCase()}`;O.set(W,(O.get(W)||0)+1)}re=Math.max(1,re);const le=Array.from(O.entries()).map(([Q,X])=>{const G=Q.substring(0,7),H=parseInt(Q.substring(7),16);return{hex:G,count:X,percent:X/re*100,hasAlpha:!0,alpha:H}}).filter(Q=>!(Q.hex==="#000000"&&Q.alpha===0)).sort((Q,X)=>X.count-Q.count);f(le),g(new Set)}else{const O=new Map;let re=0;for(let Q=0;Q<$.length;Q+=4){const X=$[Q],G=$[Q+1],H=$[Q+2];if($[Q+3]!==255)continue;re++;const j=`#${((1<<24)+(X<<16)+(G<<8)+H).toString(16).slice(1).toUpperCase()}`;O.set(j,(O.get(j)||0)+1)}re=Math.max(1,re);const le=Array.from(O.entries()).map(([Q,X])=>({hex:Q,count:X,percent:X/re*100,hasAlpha:!1,alpha:void 0})).sort((Q,X)=>X.count-Q.count);l(le),h(new Set)}},z.onerror=()=>{console.error("Failed to load image for color analysis"),m(!1)},z.src=i.imageData}finally{m(!1)}},M=Y=>{navigator.clipboard.writeText(Y).catch(()=>{console.error("Failed to copy to clipboard")})},B=(Y,z)=>{if(!Y||Y.length===0)return;const K=Y.map(V=>z&&V.alpha!==void 0?`${V.hex}${V.alpha.toString(16).toUpperCase().padStart(2,"0")}`:V.hex).join(`
`);M(K)},se=(Y,z,U)=>{if(!Y||Y.length===0)return o.jsx("p",{className:"text-xs text-gray-500 p-2",children:"No colors found"});const K=[],V=Array.from(z).sort((Q,X)=>Q-X);for(const Q of V){const X=Y[Q];X&&K.push(o.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 text-xs hover:bg-gray-700 border-b border-gray-700/50 last:border-b-0 transition-colors",style:{height:`${D.current}px`},children:[o.jsx("div",{className:"w-4 h-4 rounded border border-gray-600 flex-shrink-0",style:{backgroundColor:X.hex},title:X.hex}),o.jsx("span",{className:"font-mono text-gray-300 min-w-fit text-xs",children:X.hex}),X.hasAlpha&&X.alpha!==void 0&&o.jsxs("span",{className:"font-mono text-gray-500 text-xs",children:["",X.alpha.toString(16).toUpperCase().padStart(2,"0")]}),o.jsxs("div",{className:"ml-auto flex items-center gap-1 flex-shrink-0",children:[o.jsx("span",{className:"font-mono text-gray-400 text-xs",children:X.count}),o.jsxs("span",{className:"text-gray-600 text-xs",children:["(",X.percent.toFixed(2),"%)"]})]})]},`${X.hex}-${Q}`))}const $=z.size>0?Math.min(...z):0,O=z.size>0?Math.max(...z):0,re=Math.max(0,$)*D.current,le=Math.max(0,Y.length-(O+1))*D.current;return o.jsxs("div",{ref:U,className:"max-h-64 overflow-y-auto bg-gray-800/50 rounded border border-gray-700 text-xs",style:{height:"256px"},children:[o.jsx("div",{style:{height:re}}),K,o.jsx("div",{style:{height:le}})]})};return o.jsxs("div",{className:"bg-panel-bg rounded p-3 space-y-2",children:[o.jsx("div",{className:"text-xs font-semibold text-gray-300",children:"Analyze Colors"}),o.jsx("button",{onClick:()=>F(!1),disabled:y,className:"w-full px-3 py-1 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-700 disabled:cursor-not-allowed text-xs font-medium text-blue-400 rounded transition-colors",children:y?"Analyzing...":"Get Colors..."}),c&&o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[o.jsxs("span",{children:[c.length," colors (RGB)  ",Math.floor(c.reduce((Y,z)=>Y+z.count,0))," pixels"]}),o.jsx("button",{onClick:()=>B(c,!1),className:"p-1 text-gray-500 hover:text-gray-300 transition-colors flex-shrink-0",title:"Copy all colors to clipboard",children:o.jsxs("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:[o.jsx("path",{d:"M4 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V2z"}),o.jsx("path",{fillOpacity:"0.5",d:"M2 6a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-2h-2v2H2V8h2V6H2z"})]})})]}),se(c,b,x)]}),c&&o.jsx("div",{className:"my-2 border-t border-gray-700"}),o.jsx("button",{onClick:()=>F(!0),disabled:y,className:"w-full px-3 py-1 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-700 disabled:cursor-not-allowed text-xs font-medium text-purple-400 rounded transition-colors",children:y?"Analyzing...":"Get Colors (inc. transparent pixels)..."}),d&&o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[o.jsxs("span",{children:[d.length," colors (RGBA)  ",Math.floor(d.reduce((Y,z)=>Y+z.count,0))," pixels"]}),o.jsx("button",{onClick:()=>B(d,!0),className:"p-1 text-gray-500 hover:text-gray-300 transition-colors flex-shrink-0",title:"Copy all colors to clipboard",children:o.jsxs("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:[o.jsx("path",{d:"M4 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V2z"}),o.jsx("path",{fillOpacity:"0.5",d:"M2 6a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-2h-2v2H2V8h2V6H2z"})]})})]}),se(d,p,C)]})]})}function Np(i,c){const{shapeType:l,stretchX:d,stretchY:f}=i;let y=1/0,m=-1/0,b=1/0,h=-1/0;const p=(x,C)=>{y=Math.min(y,x),m=Math.max(m,x),b=Math.min(b,C),h=Math.max(h,C)};if(l==="rectangle"||l==="circle"){const x=c*2*d,C=c*2*f;return{minX:-x/2,maxX:x/2,minY:-C/2,maxY:C/2}}let g=3;if(l==="hexagon"&&(g=6),l==="octagon"&&(g=8),l==="star"){const C=c*d,D=c*.4*d,v=Math.PI*2/10;let P=-Math.PI/2;for(let F=0;F<10;F++){const M=P+v*F,se=F%2===0?C:D,Y=Math.cos(M)*se,z=Math.sin(M)*se*f;p(Y,z)}}else{const x=Math.PI*2/g;let C=-Math.PI/2;for(let D=0;D<g;D++){const v=C+x*D,P=Math.cos(v)*c,F=Math.sin(v)*c;p(P*d,F*f)}}return{minX:y,maxX:m,minY:b,maxY:h}}async function Wn(i){const{shapeType:c,size:l,stretchX:d,stretchY:f,color:y}=i,b=l*1/2,h=Np(i,b),p=h.maxX-h.minX,g=h.maxY-h.minY,x=0,C=Math.ceil(p+x*2),D=Math.ceil(g+x*2),v=document.createElement("canvas");v.width=C,v.height=D;const P=v.getContext("2d");if(!P)throw new Error("Failed to get canvas context");switch(P.imageSmoothingEnabled=!1,P.imageSmoothingQuality="low",P.fillStyle=y,P.translate(x-h.minX,x-h.minY),c){case"rectangle":Cp(P,0,0,b,d,f);break;case"circle":kp(P,0,0,b,d,f);break;case"triangle":ka(P,0,0,b,3,d,f);break;case"hexagon":ka(P,0,0,b,6,d,f);break;case"octagon":ka(P,0,0,b,8,d,f);break;case"star":Ep(P,0,0,b,d,f);break}const F=P.getImageData(0,0,v.width,v.height),M=F.data,B=parseInt(y.slice(1,3),16),se=parseInt(y.slice(3,5),16),Y=parseInt(y.slice(5,7),16);for(let U=0;U<M.length;U+=4)M[U+3]>=128?(M[U+3]=255,M[U]=B,M[U+1]=se,M[U+2]=Y):M[U+3]=0;return P.putImageData(F,0,0),{dataUrl:v.toDataURL("image/png"),width:C,height:D,offsetX:0,offsetY:0}}function Cp(i,c,l,d,f,y){const m=d*2*f,b=d*2*y;i.fillRect(c-m/2,l-b/2,m,b)}function kp(i,c,l,d,f,y){i.beginPath(),f===y?i.arc(c,l,d*f,0,Math.PI*2):i.ellipse(c,l,d*f,d*y,0,0,Math.PI*2),i.fill()}function ka(i,c,l,d,f,y,m){i.beginPath();const b=Math.PI*2/f;let h=-Math.PI/2;for(let p=0;p<f;p++){const g=h+b*p,x=c+Math.cos(g)*d*y,C=l+Math.sin(g)*d*m;p===0?i.moveTo(x,C):i.lineTo(x,C)}i.closePath(),i.fill()}function Ep(i,c,l,d,f,y){const b=d*f,h=d*.4*f;i.beginPath();const p=Math.PI*2/10;let g=-Math.PI/2;for(let x=0;x<10;x++){const C=g+p*x,v=x%2===0?b:h,P=c+Math.cos(C)*v,F=l+Math.sin(C)*v*y;x===0?i.moveTo(P,F):i.lineTo(P,F)}i.closePath(),i.fill()}function Dp({layer:i}){const c=T(h=>h.updateLayer);if(!i.shapeType)return null;const l=async h=>{if(h)try{const p=await Wn({shapeType:h,size:i.shapeSize||200,stretchX:i.shapeStretchX||1,stretchY:i.shapeStretchY||1,color:i.shapeColor||"#FFFFFF"});c(i.id,{imageData:p.dataUrl,width:p.width,height:p.height,x:i.x-p.offsetX,y:i.y-p.offsetY,shapeType:h})}catch(p){console.error("Failed to update shape type:",p)}},d=async h=>{try{if(!i.shapeType)return;const p=await Wn({shapeType:i.shapeType,size:h,stretchX:i.shapeStretchX||1,stretchY:i.shapeStretchY||1,color:i.shapeColor||"#FFFFFF"});c(i.id,{imageData:p.dataUrl,width:p.width,height:p.height,x:i.x-p.offsetX,y:i.y-p.offsetY,shapeSize:h})}catch(p){console.error("Failed to update shape size:",p)}},f=async h=>{try{if(!i.shapeType)return;const p=await Wn({shapeType:i.shapeType,size:i.shapeSize||200,stretchX:h,stretchY:i.shapeStretchY||1,color:i.shapeColor||"#FFFFFF"});c(i.id,{imageData:p.dataUrl,width:p.width,height:p.height,x:i.x-p.offsetX,y:i.y-p.offsetY,shapeStretchX:h})}catch(p){console.error("Failed to update shape stretch X:",p)}},y=async h=>{try{if(!i.shapeType)return;const p=await Wn({shapeType:i.shapeType,size:i.shapeSize||200,stretchX:i.shapeStretchX||1,stretchY:h,color:i.shapeColor||"#FFFFFF"});c(i.id,{imageData:p.dataUrl,width:p.width,height:p.height,x:i.x-p.offsetY,y:i.y-p.offsetY,shapeStretchY:h})}catch(p){console.error("Failed to update shape stretch Y:",p)}},m=async h=>{try{if(!i.shapeType)return;const p=await Wn({shapeType:i.shapeType,size:i.shapeSize||200,stretchX:i.shapeStretchX||1,stretchY:i.shapeStretchY||1,color:h});c(i.id,{imageData:p.dataUrl,width:p.width,height:p.height,x:i.x-p.offsetX,y:i.y-p.offsetY,shapeColor:h})}catch(p){console.error("Failed to update shape color:",p)}},b=["rectangle","circle","triangle","hexagon","octagon","star"];return o.jsxs("div",{className:"bg-panel-bg rounded p-3 space-y-3",children:[o.jsx("div",{className:"text-xs font-semibold text-gray-300",children:"Shape Properties"}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Type"}),o.jsx("select",{value:i.shapeType,onChange:h=>l(h.target.value),className:"w-full px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-white focus:outline-none focus:ring-1 focus:ring-blue-400",children:b.map(h=>o.jsx("option",{value:h,children:h.charAt(0).toUpperCase()+h.slice(1)},h))})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"text-xs text-gray-400 block mb-1",children:["Size: ",i.shapeSize||200,"px"]}),o.jsx("input",{type:"range",min:"10",max:"500",value:i.shapeSize||200,onChange:h=>d(Number(h.target.value)),className:"w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"text-xs text-gray-400 block mb-1",children:["Stretch X: ",(i.shapeStretchX||1).toFixed(2),"x"]}),o.jsx("input",{type:"range",min:"0.1",max:"20",step:"0.1",value:i.shapeStretchX||1,onChange:h=>f(Number(h.target.value)),className:"w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"text-xs text-gray-400 block mb-1",children:["Stretch Y: ",(i.shapeStretchY||1).toFixed(2),"x"]}),o.jsx("input",{type:"range",min:"0.1",max:"20",step:"0.1",value:i.shapeStretchY||1,onChange:h=>y(Number(h.target.value)),className:"w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Color"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"color",value:i.shapeColor||"#FFFFFF",onChange:h=>m(h.target.value),className:"w-12 h-8 rounded cursor-pointer border border-border"}),o.jsx("input",{type:"text",value:i.shapeColor||"#FFFFFF",onChange:h=>{/^#[0-9A-F]{6}$/i.test(h.target.value)&&m(h.target.value)},placeholder:"#FFFFFF",className:"flex-1 px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-white focus:outline-none focus:ring-1 focus:ring-blue-400"})]})]}),o.jsx("button",{onClick:()=>window.openShapeModal?.(i),className:"w-full px-3 py-2 bg-purple-600 hover:bg-purple-700 text-white text-xs font-medium rounded transition-colors",children:"Edit Shape"})]})}const Sr=({isOpen:i,onClose:c,title:l,children:d,initialPosition:f={x:100,y:100},noPadding:y=!1})=>{const[m,b]=N.useState(f),[h,p]=N.useState(!1),[g,x]=N.useState({width:1100,height:900}),[C,D]=N.useState(!1),v=N.useRef(null),P=N.useRef(null);N.useEffect(()=>{const M=se=>{if(h&&v.current){const Y=se.clientX-v.current.x,z=se.clientY-v.current.y;b(U=>({x:U.x+Y,y:U.y+z})),v.current={x:se.clientX,y:se.clientY}}},B=()=>{p(!1),v.current=null};return h&&(window.addEventListener("mousemove",M),window.addEventListener("mouseup",B)),()=>{window.removeEventListener("mousemove",M),window.removeEventListener("mouseup",B)}},[h]);const F=M=>{M.preventDefault(),M.stopPropagation(),D(!0),P.current={x:M.clientX,y:M.clientY,startWidth:g.width,startHeight:g.height}};return N.useEffect(()=>{const M=se=>{if(C&&P.current){const Y=se.clientX-P.current.x,z=se.clientY-P.current.y;x({width:Math.max(600,P.current.startWidth+Y),height:Math.max(400,P.current.startHeight+z)})}},B=()=>{D(!1),P.current=null};return C&&(window.addEventListener("mousemove",M),window.addEventListener("mouseup",B)),()=>{window.removeEventListener("mousemove",M),window.removeEventListener("mouseup",B)}},[C]),i?o.jsxs("div",{className:"fixed flex flex-col bg-panel-bg border border-border rounded shadow-lg overflow-hidden",style:{left:m.x,top:m.y,zIndex:50,width:`${g.width}px`,height:`${g.height}px`,position:"absolute"},children:[o.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-canvas-bg border-b border-border cursor-move select-none",onMouseDown:M=>{p(!0),v.current={x:M.clientX,y:M.clientY}},children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-200",children:l}),o.jsx("button",{onClick:c,className:"text-gray-400 hover:text-white focus:outline-none p-1 rounded hover:bg-gray-700 transition-colors","aria-label":"Close",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o.jsx("div",{className:`${y?"":"p-4"} text-gray-300 ${y?"overflow-hidden":"overflow-auto"} flex-1`,children:typeof d=="function"?d(g):d}),o.jsx("div",{onMouseDown:F,className:"absolute bottom-0 right-0 w-4 h-4 cursor-nwse-resize bg-gray-600 hover:bg-gray-500 transition-colors",style:{clipPath:"polygon(100% 0, 100% 100%, 0 100%)"}})]}):null},Pp=({isOpen:i,onClose:c,layer:l})=>{const[d,f]=N.useState(128),[y,m]=N.useState(null),[b,h]=N.useState(!1),[p,g]=N.useState(1),[x,C]=N.useState(null),[D,v]=N.useState(!0),[P,F]=N.useState(!1),M=N.useRef(null),B=N.useRef(null),se=T(O=>O.updateLayer);N.useEffect(()=>{if(!i||!l.imageData)return;const O=setTimeout(async()=>{h(!0);try{const re=await wu(l.imageData,d,!1);m(re)}catch(re){console.error("Failed to apply transparency mask:",re)}finally{h(!1)}},100);return F(!1),()=>clearTimeout(O)},[d,l.imageData,i]);const Y=async()=>{if(l.imageData)try{const O=await wu(l.imageData,d,D);se(l.id,{imageData:O}),c()}catch(O){console.error("Failed to apply transparency mask with palette reduction:",O)}},z=()=>{g(O=>Math.min(O+.25,3))},U=()=>{g(O=>Math.max(O-.25,.1))},K=(O,re)=>{if(!M.current)return 1;const le=M.current.clientWidth,Q=M.current.clientHeight;if(le<=0||Q<=0)return 1;const X=le/O,G=Q/re,H=Math.min(X,G);return Math.max(.1,H*.9)},V=()=>{g(x?K(x.width,x.height):1)},$=O=>{const re=O.currentTarget;C({width:re.naturalWidth,height:re.naturalHeight})};return N.useEffect(()=>{x&&M.current&&!P&&setTimeout(()=>{const O=K(x.width,x.height);g(O),F(!0)},100)},[x,P]),o.jsx(Sr,{isOpen:i,title:"Transparency Mask",onClose:c,children:o.jsxs("div",{className:"flex flex-col h-full p-4 gap-4 text-gray-200",children:[o.jsxs("div",{className:"flex-1 flex flex-col min-h-0 gap-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-sm font-medium",children:"Preview"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:U,disabled:p<=.1,className:"p-1 text-gray-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Zoom out",children:o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM13 10H7"})})}),o.jsxs("span",{className:"text-xs text-gray-400 min-w-[45px] text-center",children:[Math.round(p*100),"%"]}),o.jsx("button",{onClick:z,disabled:p>=3,className:"p-1 text-gray-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Zoom in",children:o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v6m3-3H7"})})}),o.jsx("button",{onClick:V,className:"text-xs px-2 py-1 text-gray-400 hover:text-white bg-gray-700 hover:bg-gray-600 rounded transition-colors",title:"Reset zoom",children:"Reset"})]})]}),o.jsxs("div",{ref:M,className:"flex-1 relative w-full bg-gray-900 rounded border border-gray-700 overflow-auto",children:[b&&o.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 z-10",children:o.jsx("span",{className:"text-white font-medium",children:"Processing..."})}),y?o.jsx("div",{style:{display:"inline-block",padding:"10px"},children:o.jsx("img",{ref:B,src:y,alt:"Preview",onLoad:$,style:{width:x?`${x.width*p}px`:"auto",height:x?`${x.height*p}px`:"auto",transition:"width 0.1s ease-out, height 0.1s ease-out",maxWidth:"none"}})}):o.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:o.jsx("div",{className:"text-gray-500",children:"No preview available"})})]})]}),o.jsxs("div",{className:"flex flex-col gap-4 pt-4 border-t border-gray-700",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("div",{className:"flex justify-between text-sm",children:o.jsxs("label",{htmlFor:"threshold-slider",children:["Mask Threshold: ",d]})}),o.jsx("input",{id:"threshold-slider",type:"range",min:"0",max:"255",value:d,onChange:O=>f(Number(O.target.value)),className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-blue-500"}),o.jsx("p",{className:"text-xs text-gray-400",children:"0=Opaque, 255=Transparent"})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{id:"use-template-colors",type:"checkbox",checked:D,onChange:O=>v(O.target.checked),className:"w-4 h-4 rounded bg-gray-700 border-gray-600 accent-blue-500 cursor-pointer"}),o.jsx("label",{htmlFor:"use-template-colors",className:"text-sm text-gray-300 cursor-pointer",children:"Use template colors"})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:c,className:"px-4 py-2 text-sm font-medium text-gray-300 bg-gray-700 rounded hover:bg-gray-600 transition-colors",children:"Cancel"}),o.jsx("button",{onClick:Y,disabled:!y||b,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Apply"})]})]})]})]})})},Fp=({isOpen:i,onClose:c,layer:l})=>{const d=T(V=>V.updateLayer),[f,y]=N.useState(30),[m,b]=N.useState(null),[h,p]=N.useState(!1),[g,x]=N.useState(1),[C,D]=N.useState(null),[v,P]=N.useState(!1),[F,M]=N.useState(!1),B=N.useRef(null),se=N.useRef(null),Y=N.useRef(null);N.useEffect(()=>{if(!(!i||!l?.imageData))return Y.current&&clearTimeout(Y.current),Y.current=window.setTimeout(async()=>{p(!0);try{const V=await ju(l.imageData,f,v);b(V)}catch(V){console.error("BG removal preview failed:",V)}finally{p(!1)}},120),()=>{Y.current&&(clearTimeout(Y.current),Y.current=null)}},[i,l?.imageData,f,v]);const z=async()=>{if(l?.imageData){p(!0);try{const V=await ju(l.imageData,f,!1);d(l.id,{imageData:V}),c()}catch(V){console.error("BG removal apply failed:",V),alert("Background removal failed. Please try again.")}finally{p(!1)}}},U=V=>{const $=V.currentTarget;D({width:$.naturalWidth,height:$.naturalHeight})},K=(V,$)=>{if(!B.current)return 1;const O=B.current.clientWidth,re=B.current.clientHeight;if(O<=0||re<=0)return 1;const le=O/V,Q=re/$,X=Math.min(le,Q);return Math.max(.1,X*.9)};return N.useEffect(()=>{C&&B.current&&!F&&setTimeout(()=>{const V=K(C.width,C.height);x(V),M(!0)},100)},[C,F]),o.jsx(Sr,{isOpen:i,title:"BG Removal",onClose:c,children:o.jsxs("div",{className:"flex flex-col h-full p-4 gap-4 text-gray-200",children:[o.jsxs("div",{className:"flex-1 flex flex-col min-h-0 gap-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-sm font-medium",children:"Preview"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:()=>x(V=>Math.max(V-.25,.1)),className:"p-1 text-gray-400 hover:text-white transition-colors",title:"Zoom out",children:""}),o.jsxs("span",{className:"text-xs text-gray-400 min-w-[45px] text-center",children:[Math.round(g*100),"%"]}),o.jsx("button",{onClick:()=>x(V=>Math.min(V+.25,3)),className:"p-1 text-gray-400 hover:text-white transition-colors",title:"Zoom in",children:"+"}),o.jsx("button",{onClick:()=>{C&&x(K(C.width,C.height))},className:"text-xs px-2 py-1 text-gray-400 hover:text-white bg-gray-700 hover:bg-gray-600 rounded transition-colors",title:"Reset zoom",children:"Reset"})]})]}),o.jsxs("div",{ref:B,className:"flex-1 relative w-full bg-gray-900 rounded border border-gray-700 overflow-auto",children:[h&&o.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 z-10",children:o.jsx("span",{className:"text-white font-medium",children:"Processing..."})}),m?o.jsx("div",{style:{display:"inline-block",padding:"10px"},children:o.jsx("img",{ref:se,src:m,alt:"Preview",onLoad:U,style:{width:C?`${C.width*g}px`:"auto",height:C?`${C.height*g}px`:"auto",transition:"width 0.1s ease-out, height 0.1s ease-out",maxWidth:"none"}})}):o.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:o.jsx("div",{className:"text-gray-500",children:"No preview available"})})]})]}),o.jsxs("div",{className:"flex flex-col gap-4 pt-4 border-t border-gray-700",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("div",{className:"flex justify-between text-sm",children:o.jsxs("label",{htmlFor:"tolerance-slider",children:["Tolerance: ",f]})}),o.jsx("input",{id:"tolerance-slider",type:"range",min:"0",max:"255",value:f,onChange:V=>y(Number(V.target.value)),className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-blue-500"}),o.jsx("p",{className:"text-xs text-gray-400",children:"Adjust color tolerance for background selection"})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{id:"make-heatmap",type:"checkbox",checked:v,onChange:V=>P(V.target.checked),className:"w-4 h-4 rounded bg-gray-700 border-gray-600 accent-blue-500 cursor-pointer"}),o.jsx("label",{htmlFor:"make-heatmap",className:"text-sm text-gray-300 cursor-pointer",children:"Show heatmap (red = kept pixels)"})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:c,className:"px-4 py-2 text-sm font-medium text-gray-300 bg-gray-700 rounded hover:bg-gray-600 transition-colors",children:"Cancel"}),o.jsx("button",{onClick:z,disabled:!m||h,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Apply"})]})]})]})]})})};function Lp(i){return new Worker("/PixelConnect/assets/pixelator.worker-C1wMxZux.js",{name:i?.name})}const Cu=["#FFFFFF","#F4F59F","#FFCA3A","#FF9F1C","#FF595E","#E71D36","#F3BBC2","#FF85A1","#BD637D","#CDB4DB","#6A4C93","#4D194D","#A8D0DC","#2EC4B6","#1A535C","#6D9DCD","#1982C4","#A1C181","#8AC926","#A0A0A0","#6B4226","#505050","#CFD078","#145A7A","#8B1D24","#C07F7A","#C49A6C","#5B7B1C","#000000"],Ip=["#000000","#3c3c3c","#787878","#aaaaaa","#d2d2d2","#ffffff","#600018","#a50e1e","#ed1c24","#fa8072","#e45c1a","#ff7f27","#f6aa09","#f9dd3b","#fffabc","#9c8431","#c5ad31","#e8d45f","#4a6b3a","#5a944a","#84c573","#0eb968","#13e67b","#87ff5e","#0c816e","#10aea6","#13e1be","#0f799f","#60f7f2","#bbfaf2","#28509e","#4093e4","#7dc7ff","#4d31b8","#6b50f6","#99b1fb","#4a4284","#7a71c4","#b5aef1","#780c99","#aa38b9","#e09ff9","#cb007a","#ec1f80","#f38da9","#9b5249","#d18078","#fab6a4","#684634","#95682a","#dba463","#7b6352","#9c846b","#d6b594","#d18051","#f8b277","#ffc5a5","#6d643f","#948c6b","#cdc59e","#333941","#6d758d","#b3b9d1"],Mp=[{value:"none",label:"None (Nearest Color)"},{value:"floyd-steinberg",label:"Floyd-Steinberg"},{value:"burkes",label:"Burkes"},{value:"stucki",label:"Stucki"},{value:"sierra-2",label:"Sierra-2"},{value:"sierra-lite",label:"Sierra Lite"},{value:"bayer-4x4",label:"Bayer 4x4"},{value:"bayer-8x8",label:"Bayer 8x8"},{value:"halftone-dot",label:"Halftone Dot"},{value:"diagonal-line",label:"Diagonal Line"},{value:"cross-hatch",label:"Cross Hatch"},{value:"grid",label:"Grid"}],ku=[64,100,128,150,200,250,256,300,350,400,450,500,512,550,600,650,700,750,800,850,900,950,1e3],_p=({isOpen:i,onClose:c,layer:l})=>{const d=T(J=>J.updateLayer),[f,y]=N.useState(128),[m,b]=N.useState(128),[h,p]=N.useState("bilinear"),[g,x]=N.useState("none"),[C,D]=N.useState(100),[v,P]=N.useState("none"),[F,M]=N.useState(50),[B,se]=N.useState("geopixels"),[Y,z]=N.useState(""),[U,K]=N.useState(null),[V,$]=N.useState(null),[O,re]=N.useState(!1),[le,Q]=N.useState(1),[X,G]=N.useState(null),[H,ie]=N.useState(String(f)),[j,W]=N.useState(!0),[A,S]=N.useState(!1),[I,ee]=N.useState(16),[ue,he]=N.useState([]),[ye,je]=N.useState(8),[be,Ne]=N.useState(!1),[ze,bt]=N.useState(!0),[sn,te]=N.useState(!1),[Me,De]=N.useState(!0),[Te,br]=N.useState(new Map),[Yt,Yn]=N.useState(null),[Vt,Mt]=N.useState(null),[En,Nr]=N.useState([]),[Cr,ho]=N.useState(!1),[kr,Er]=N.useState(!0),[_t,go]=N.useState(!1),[Xt,Dn]=N.useState(!1),[ln,Dr]=N.useState(0),[Gt,mo]=N.useState(0),[Rt,Vn]=N.useState(0),mt=N.useRef(null),Zt=N.useRef(null),Pr=N.useRef(null),zt=N.useRef(!1),Tt=N.useRef(B),st=N.useRef(750),xo=J=>{const ge=J.data,we=new Map;let ke=0;for(let _e=0;_e<ge.length;_e+=4){const nt=ge[_e],Nt=ge[_e+1],Ot=ge[_e+2];if(ge[_e+3]===0)continue;const wo=`#${((1<<24)+(nt<<16)+(Nt<<8)+Ot).toString(16).slice(1).toUpperCase()}`;we.set(wo,(we.get(wo)||0)+1),ke++}const Ae=new Map;we.forEach((_e,nt)=>{Ae.set(nt,{count:_e,percent:ke>0?_e/ke*100:0})}),br(Ae)};N.useEffect(()=>(mt.current=new Lp,mt.current&&(mt.current.onmessage=J=>{const{type:ge,imageData:we,message:ke,suggestions:Ae,generatedPalette:_e}=J.data;if(ge==="success"){const nt=document.createElement("canvas");nt.width=we.width,nt.height=we.height;const Nt=nt.getContext("2d");if(Nt){if(Nt.putImageData(we,0,0),G({width:we.width,height:we.height}),$({width:we.width,height:we.height}),kr){const Ot=Pn(we.width,we.height);Q(Ot)}K(nt.toDataURL()),xo(we),Nr(_e||[])}}else ge==="suggestions"?(he(Ae),Ne(!1)):(console.error("Pixelator Worker Error:",ke),Ne(!1));re(!1)}),()=>{mt.current?.terminate()}),[]),N.useEffect(()=>{ie(String(f))},[f]),N.useEffect(()=>{const J=localStorage.getItem("pixelator_custom_palette");J&&z(J)},[]),N.useEffect(()=>{if(i&&l.imageData){const J=new Image;J.onload=()=>{b(J.height),y(128)},J.src=l.imageData}},[i,l.imageData]),N.useEffect(()=>{Y.trim()&&localStorage.setItem("pixelator_custom_palette",Y)},[Y]);const At=N.useCallback(()=>{if(B==="none")return[];if(B==="geopixels")return Cu;if(B==="wplace")return Ip;const J=Y.trim();let ge=[];if(J&&(ge=J.split(/[\s,]+/).filter(ke=>ke.trim()!=="").map(ke=>{const Ae=ke.trim();if(/^\d+$/.test(Ae)){const _e=parseInt(Ae,10);if(_e>=0&&_e<=16777215)return"#"+_e.toString(16).padStart(6,"0").toUpperCase()}return/^#?[0-9A-F]{6}$/i.test(Ae)?Ae.startsWith("#")?Ae.toUpperCase():"#"+Ae.toUpperCase():null}).filter(ke=>ke!==null)),B==="custom")return ge;if(B==="geopixels+custom"){const we=[...Cu];for(const ke of ge)we.includes(ke.toUpperCase())||we.push(ke.toUpperCase());return we}return[]},[B,Y]);N.useEffect(()=>{Tt.current==="none"&&B!=="none"?A?(zt.current=!0,S(!1)):zt.current=!1:Tt.current!=="none"&&B==="none"?zt.current&&S(!0):B!=="none"&&A&&S(!1),Tt.current=B},[B,A]);const Xn=N.useCallback(()=>{if(!mt.current||!l.imageData)return;re(!0);const J=new Image;J.onload=()=>{const ge=document.createElement("canvas");ge.width=J.width,ge.height=J.height;const we=ge.getContext("2d");if(!we)return;we.drawImage(J,0,0);const ke=we.getImageData(0,0,J.width,J.height);te(Ln(ke));const Ae=At(),_e=J.width/J.height,nt=Math.round(f*_e);mt.current?.postMessage({imageData:ke,settings:{targetWidth:nt,targetHeight:f,ditherMethod:g,ditherStrength:C,palette:Ae,resamplingMethod:h,useKmeans:A,kmeansColors:I,brightness:ln,contrast:Gt,saturation:Rt,preprocessingMethod:v,preprocessingStrength:F,filterTrivialColors:_t,colorStats:_t?Array.from(Te.entries()).map(([Nt,Ot])=>({color:Nt,percent:Ot.percent})):[]}})},J.src=l.imageData},[l.imageData,f,g,C,At,h,A,I,ln,Gt,Rt,v,F,_t]);N.useEffect(()=>{if(!i||!Me)return;const J=setTimeout(()=>{Xn(),st.current=750},st.current);return()=>clearTimeout(J)},[i,Me,f,g,C,B,Y,h,A,I,ln,Gt,Rt,v,F,_t,Xn]);const yo=()=>{U&&V&&(d(l.id,{imageData:U,width:V.width,height:V.height}),c())},Pn=N.useCallback((J,ge)=>{if(!Zt.current)return 1;const we=Zt.current.clientWidth,ke=Zt.current.clientHeight,Ae=we-40,_e=ke-40;if(Ae<=0||_e<=0)return 1;const nt=Ae/J,Nt=_e/ge,Ot=Math.min(nt,Nt);return Math.max(.1,Ot)},[]),vo=()=>Q(J=>Math.min(J+.5,20)),Fn=()=>Q(J=>Math.max(J-.5,.5)),Fr=()=>Q(1),Kt=N.useCallback(()=>{X&&Q(Pn(X.width,X.height))},[X,Pn]);N.useEffect(()=>{X&&Zt.current&&(Cr||setTimeout(()=>{Kt(),ho(!0)},50))},[X,Cr,Kt]);const Ls=()=>y(m),Ln=J=>{const ge=J.data;for(let we=3;we<ge.length;we+=4){const ke=ge[we];if(ke>0&&ke<255)return!0}return!1},Gn=J=>{const ge=J.currentTarget;G({width:ge.naturalWidth,height:ge.naturalHeight})},Zn=N.useCallback(()=>{if(!mt.current||!l.imageData)return;if(At().length===0){alert("Please select a palette first to find missing colors.");return}Ne(!0);const ge=new Image;ge.onload=()=>{const we=document.createElement("canvas");we.width=ge.width,we.height=ge.height;const ke=we.getContext("2d");if(!ke)return;ke.drawImage(ge,0,0);const Ae=ke.getImageData(0,0,ge.width,ge.height);mt.current?.postMessage({type:"suggest",imageData:Ae,settings:{palette:At(),numSuggestions:ye,preferDistinct:ze}})},ge.src=l.imageData},[l.imageData,At,ye,ze]),Lr=()=>{const J=Y.trim(),ge=ue.join(", ");z(J===""?ge:`${J}, ${ge}`)},Kn=N.useMemo(()=>{let J=At();return B==="none"&&A&&En.length>0&&(J=En),Te.size===0?J:[...J].sort((ge,we)=>{const ke=Te.get(ge)?.count||0,Ae=Te.get(we)?.count||0;return ke!==Ae?Ae-ke:0})},[At,Te,En,B,A]),Is=()=>{Kn.length>0&&navigator.clipboard.writeText(Kn.join(", "))};return o.jsx(Sr,{isOpen:i,title:"Pixelator",onClose:c,noPadding:!0,children:()=>o.jsxs("div",{className:"flex text-gray-200 h-full w-full overflow-hidden",children:[o.jsxs("div",{className:"w-72 border-r border-gray-700 flex-shrink-0 flex flex-col overflow-hidden",children:[o.jsxs("div",{className:"overflow-y-auto flex-1 p-4 space-y-6 text-gray-200",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-semibold text-gray-400 uppercase",children:"Dimensions"}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex gap-2 items-end",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{className:"text-xs text-gray-500",children:"Height (px)"}),o.jsx("input",{type:"text",inputMode:"numeric",value:H,onChange:J=>{if(ie(J.target.value),J.target.value!==""&&J.target.value!=="-"){const ge=Number(J.target.value);!isNaN(ge)&&ge>0&&y(ge)}},className:"w-full bg-gray-800 border border-gray-600 rounded px-2 py-1 text-sm"})]}),o.jsxs("select",{className:"flex-1 bg-gray-800 border border-gray-600 rounded px-2 py-1 text-xs text-gray-400",onChange:J=>{J.target.value&&(st.current=100,y(Number(J.target.value)))},value:ku.includes(f)?f:"",children:[o.jsx("option",{value:"",disabled:!0,children:"common sizes"}),ku.map(J=>o.jsxs("option",{value:J,children:[J,"px"]},J))]}),o.jsx("button",{onClick:Ls,className:"text-xs px-2 py-1 text-gray-400 hover:text-white bg-gray-700 hover:bg-gray-600 rounded transition-colors whitespace-nowrap flex-shrink-0",title:"Reset height to default",children:"Reset"})]}),V&&o.jsxs("div",{className:"text-xs text-gray-400 bg-gray-800 px-2 py-1 rounded whitespace-nowrap",children:[V.width,"  ",V.height," ",o.jsx("span",{className:"text-gray-600 mx-1",children:"|"})," ",(V.width*V.height).toLocaleString()," px"]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-500",children:"Resampling"}),o.jsxs("select",{value:h,onChange:J=>p(J.target.value),className:"w-full bg-gray-800 border border-gray-600 rounded px-2 py-1 text-sm",children:[o.jsx("option",{value:"nearest",children:"Nearest Neighbor (Sharp)"}),o.jsx("option",{value:"bilinear",children:"Bilinear (Smooth)"}),o.jsx("option",{value:"lanczos",children:"Lanczos (High Quality)"})]})]})]}),sn&&o.jsxs("div",{className:"bg-yellow-900/30 border border-yellow-700 rounded p-3 flex gap-3",children:[o.jsx("div",{className:"text-yellow-500 text-xl flex-shrink-0",children:""}),o.jsxs("div",{className:"text-xs text-yellow-300",children:[o.jsx("p",{className:"font-semibold mb-1",children:"Semi-transparent pixels detected"}),o.jsx("p",{children:"Apply a transparency mask first for better results"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-xs font-semibold text-gray-400 uppercase",children:"Palette"}),B==="geopixels+custom"&&o.jsxs("div",{className:"group relative",children:[o.jsx("span",{className:"cursor-help text-xs text-blue-400",children:"Fun Fact?"}),o.jsxs("div",{className:"absolute bottom-full right-0 mb-2 w-64 p-2 bg-gray-900 border border-gray-600 rounded shadow-xl text-xs text-gray-300 hidden group-hover:block z-50",children:["If you play on Geopixels, you can export your palette by typing ",o.jsx("code",{className:"text-yellow-400",children:"userData.colors"})," in the browser console. Paste the result here!"]})]})]}),o.jsxs("div",{className:"flex flex-col space-y-1",children:[o.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"palette",checked:B==="geopixels",onChange:()=>{st.current=100,se("geopixels")}}),o.jsx("span",{className:"text-sm",children:"Geopixels Base"})]}),o.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"palette",checked:B==="wplace",onChange:()=>{st.current=100,se("wplace")}}),o.jsx("span",{className:"text-sm",children:"WPlace Base"})]}),o.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"palette",checked:B==="custom",onChange:()=>{st.current=100,se("custom")}}),o.jsx("span",{className:"text-sm",children:"Custom"})]}),o.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"palette",checked:B==="geopixels+custom",onChange:()=>{st.current=100,se("geopixels+custom")}}),o.jsx("span",{className:"text-sm",children:"Geopixels Base + Custom"})]}),o.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"palette",checked:B==="none",onChange:()=>{st.current=100,se("none")}}),o.jsx("span",{className:"text-sm",children:"No Recoloring (Resize Only)"})]})]}),(B==="custom"||B==="geopixels+custom")&&o.jsx("textarea",{value:Y,onChange:J=>z(J.target.value),placeholder:"#FFFFFF, #000000 or 16777215, 0",className:"w-full h-24 bg-gray-800 border border-gray-600 rounded p-2 text-xs font-mono"}),o.jsxs("div",{className:"border-t border-gray-700 pt-2",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("button",{onClick:()=>W(!j),className:"flex items-center text-xs text-gray-400 hover:text-gray-300",children:[o.jsx("span",{children:"Palette Preview"}),o.jsx("span",{className:"ml-1",children:j?"":""})]}),o.jsx("button",{onClick:Is,className:"text-gray-400 hover:text-white p-1 rounded hover:bg-gray-700",title:"Copy palette to clipboard",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m2 4h3a2 2 0 012 2v3m-3-3V5a2 2 0 012-2h3.071a2 2 0 011.414.586l1.414 1.414A2 2 0 0118 6.414V9m-3-3h3"})})})]}),j&&o.jsxs("div",{className:"space-y-2",children:[o.jsx("div",{className:"flex flex-wrap gap-0 bg-gray-900 p-1 rounded border border-gray-700",children:Kn.length>0?Kn.map((J,ge)=>o.jsx("div",{className:"w-4 h-4 cursor-crosshair hover:z-10 hover:scale-125 transition-transform duration-75 border border-transparent hover:border-white",style:{backgroundColor:J},onMouseEnter:we=>{Yn(J),Mt({x:we.clientX,y:we.clientY})},onMouseLeave:()=>{Yn(null),Mt(null)},onMouseMove:we=>{Mt({x:we.clientX,y:we.clientY})}},ge)):o.jsx("div",{className:"text-xs text-gray-500 p-2",children:"No palette selected"})}),Yt&&Vt&&o.jsxs("div",{style:{position:"fixed",left:Vt.x+15,top:Vt.y+15,zIndex:9999,pointerEvents:"none"},className:"bg-gray-900 border border-gray-600 rounded p-2 shadow-xl text-xs min-w-[120px]",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1 pb-1 border-b border-gray-700",children:[o.jsx("div",{className:"w-3 h-3 border border-gray-500",style:{backgroundColor:Yt}}),o.jsx("span",{className:"font-mono font-bold text-white",children:Yt})]}),Te.has(Yt)?o.jsxs("div",{className:"text-gray-300 space-y-0.5",children:[o.jsxs("div",{className:"flex justify-between gap-4",children:[o.jsx("span",{children:"Count:"}),o.jsx("span",{className:"text-white font-mono",children:Te.get(Yt)?.count.toLocaleString()})]}),o.jsxs("div",{className:"flex justify-between gap-4",children:[o.jsx("span",{children:"Usage:"}),o.jsxs("span",{className:"text-white font-mono",children:[Te.get(Yt)?.percent.toFixed(2),"%"]})]})]}):o.jsx("div",{className:"text-gray-500 italic",children:"Not used in preview"})]}),(B==="custom"||B==="geopixels+custom")&&o.jsxs("div",{className:"space-y-2 border-t border-gray-700 pt-2",children:[o.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:_t,onChange:J=>go(J.target.checked),className:"rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500 focus:ring-offset-gray-800",title:"Ignore colors below 0.1% usage during processing"}),o.jsx("span",{className:"text-xs text-gray-400",children:"Filter trivial colors (<0.1%)"})]}),o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsx("label",{className:"text-xs font-semibold text-gray-400 uppercase whitespace-nowrap",children:"Suggest Colors"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:"number",min:"1",max:"32",value:ye,onChange:J=>je(Math.max(1,Math.min(32,Number(J.target.value)))),className:"w-12 bg-gray-800 border border-gray-600 rounded px-1 py-0.5 text-xs text-center",title:"Number of colors to suggest"}),o.jsx("button",{onClick:Zn,disabled:be,className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 disabled:bg-gray-600 disabled:cursor-not-allowed text-white text-xs rounded transition-colors",children:be?"...":"Go"})]})]}),o.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:ze,onChange:J=>bt(J.target.checked),className:"rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500 focus:ring-offset-gray-800",title:"Prioritize colors that are distinct from each other"}),o.jsx("span",{className:"text-xs text-gray-400",children:"Prefer distinct color suggestions"})]}),ue.length>0&&o.jsxs("div",{className:"space-y-2",children:[o.jsx("div",{className:"flex flex-wrap gap-1 bg-gray-900 p-2 rounded border border-gray-700",children:ue.map((J,ge)=>o.jsx("div",{className:"w-8 h-8 rounded border border-gray-500 cursor-pointer hover:border-white",style:{backgroundColor:J},title:`${J} - Click to copy`,onClick:()=>{navigator.clipboard.writeText(J)}},ge))}),o.jsx("button",{onClick:Lr,className:"w-full px-2 py-1 bg-gray-700 hover:bg-gray-600 text-white text-xs rounded transition-colors",children:"Add to Custom Palette"})]}),o.jsx("p",{className:"text-xs text-gray-500",children:"Analyzes the image to find dominant colors missing from your palette."})]})]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-semibold text-gray-400 uppercase",children:"Dithering"}),o.jsx("select",{value:g,onChange:J=>{st.current=100,x(J.target.value)},className:"w-full bg-gray-800 border border-gray-600 rounded px-2 py-1 text-sm",children:Mp.map(J=>o.jsx("option",{value:J.value,children:J.label},J.value))}),g!=="none"&&o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[o.jsx("span",{children:"Strength"}),o.jsxs("span",{children:[C,"%"]})]}),o.jsx("input",{type:"range",min:"0",max:"100",value:C,onChange:J=>D(Number(J.target.value)),className:"w-full"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"group relative inline-block w-full",children:[o.jsxs("label",{className:`flex items-center space-x-2 ${B!=="none"?"cursor-not-allowed opacity-50":"cursor-pointer"}`,children:[o.jsx("input",{type:"checkbox",checked:A,onChange:J=>S(J.target.checked),disabled:B!=="none"}),o.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:"K-Means Color Reduction"})]}),B!=="none"&&o.jsx("div",{className:"absolute bottom-full left-0 mb-2 w-64 p-2 bg-gray-900 border border-gray-600 rounded shadow-xl text-xs text-gray-300 hidden group-hover:block z-50",children:`K-Means is only available when "No Recoloring" is selected. It's used to reduce the color space when you're not providing a specific palette.`})]}),A&&o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-500",children:"Number of Colors"}),o.jsx("input",{type:"number",min:"2",max:"256",value:I,onChange:J=>ee(Number(J.target.value)),className:"w-full bg-gray-800 border border-gray-600 rounded px-2 py-1 text-sm"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Reduces image to N dominant colors before applying palette/dithering."})]})]}),o.jsxs("div",{className:"space-y-2 border-t border-gray-700 pt-2",children:[o.jsxs("button",{onClick:()=>Dn(!Xt),className:"flex items-center justify-between w-full text-xs font-semibold text-gray-400 hover:text-gray-300 uppercase",children:[o.jsx("span",{children:"Extra Features"}),o.jsx("span",{children:Xt?"":""})]}),Xt&&o.jsxs("div",{className:"space-y-3 pt-2",children:[o.jsxs("div",{className:"border-b border-gray-700 pb-3",children:[o.jsx("label",{className:"text-xs font-semibold text-gray-400 uppercase mb-2 block",children:"Pre-processing (Experimental)"}),o.jsxs("select",{value:v,onChange:J=>{st.current=100,P(J.target.value)},className:"w-full bg-gray-800 border border-gray-600 rounded px-2 py-1 text-sm mb-2",title:"Apply filters before pixelation to improve results (may impact performance)",children:[o.jsx("option",{value:"none",children:"None"}),o.jsx("option",{value:"kuwahara",children:"Kuwahara (Oil Paint / Flatten)"}),o.jsx("option",{value:"median",children:"Median (De-noise / Smooth)"}),o.jsx("option",{value:"bilateral",children:"Bilateral (Soft Blur)"})]}),v!=="none"&&o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-2",children:[o.jsx("span",{children:"Intensity"}),o.jsxs("span",{children:[F,"%"]})]}),o.jsx("input",{type:"range",min:"0",max:"100",value:F,onChange:J=>{st.current=100,M(Number(J.target.value))},className:"w-full"}),o.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[v==="bilateral"&&"Smooths surfaces while keeping edges. Good for photographs.",v==="kuwahara"&&'Best for Pixel Art. Creates flat, "painted" clusters of color.',v==="median"&&"Removes noise and small details. Great for cleaning up JPEGs before pixelating."]})]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[o.jsx("span",{children:"Brightness"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{children:ln}),o.jsx("button",{onClick:()=>Dr(0),className:"text-gray-500 hover:text-white disabled:opacity-0 transition-opacity",title:"Reset Brightness",disabled:ln===0,children:""})]})]}),o.jsx("input",{type:"range",min:"-100",max:"100",value:ln,onChange:J=>Dr(Number(J.target.value)),className:"w-full"})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[o.jsx("span",{children:"Contrast"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{children:Gt}),o.jsx("button",{onClick:()=>mo(0),className:"text-gray-500 hover:text-white disabled:opacity-0 transition-opacity",title:"Reset Contrast",disabled:Gt===0,children:""})]})]}),o.jsx("input",{type:"range",min:"-100",max:"100",value:Gt,onChange:J=>mo(Number(J.target.value)),className:"w-full"})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[o.jsx("span",{children:"Saturation"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{children:Rt}),o.jsx("button",{onClick:()=>Vn(0),className:"text-gray-500 hover:text-white disabled:opacity-0 transition-opacity",title:"Reset Saturation",disabled:Rt===0,children:""})]})]}),o.jsx("input",{type:"range",min:"-100",max:"100",value:Rt,onChange:J=>Vn(Number(J.target.value)),className:"w-full"})]})]})]})]}),!Me&&o.jsx("div",{className:"p-4 border-t border-gray-700 bg-gray-800/30 flex-shrink-0",children:o.jsxs("button",{onClick:Xn,className:"w-full bg-green-600 hover:bg-green-500 text-white py-2 rounded font-semibold transition-colors flex items-center justify-center gap-2",children:[o.jsx("span",{children:""}),o.jsx("span",{children:"Execute"})]})})]}),o.jsxs("div",{className:"flex-1 bg-gray-900 relative overflow-hidden flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gray-800/50 border-b border-gray-700 flex-shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"text-xs text-gray-400",children:"Preview"}),o.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:Me,onChange:J=>De(J.target.checked),className:"rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500 focus:ring-offset-gray-800"}),o.jsx("span",{className:"text-xs text-gray-400 select-none",children:"Auto-update"})]}),o.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",title:"Always fit preview to screen",children:[o.jsx("input",{type:"checkbox",checked:kr,onChange:J=>Er(J.target.checked),className:"rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500 focus:ring-offset-gray-800"}),o.jsx("span",{className:"text-xs text-gray-400 select-none",children:"Pin Fit"})]})]}),o.jsxs("div",{className:"flex space-x-2 items-center",children:[o.jsx("button",{onClick:Fn,className:"bg-gray-700 p-1 rounded hover:bg-gray-600 text-sm font-bold",title:"Zoom out",children:""}),o.jsxs("span",{className:"bg-gray-700 px-2 py-1 rounded text-sm font-mono min-w-[50px] text-center",children:[Math.round(le*100),"%"]}),o.jsx("button",{onClick:vo,className:"bg-gray-700 p-1 rounded hover:bg-gray-600 text-sm font-bold",title:"Zoom in",children:"+"}),o.jsx("button",{onClick:Kt,className:"bg-gray-700 px-2 py-1 rounded hover:bg-gray-600 text-xs",title:"Fit to screen",children:"Fit"}),o.jsx("button",{onClick:Fr,className:"bg-gray-700 px-2 py-1 rounded hover:bg-gray-600 text-xs",title:"Reset zoom",children:"Reset"})]})]}),O&&o.jsx("div",{className:"absolute top-14 right-4 z-20 pointer-events-none",children:o.jsxs("div",{className:"bg-gray-900/90 border border-gray-700 text-gray-200 text-xs px-3 py-1.5 rounded shadow-lg flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),"Generating..."]})}),o.jsx("div",{ref:Zt,className:"flex-1 overflow-auto bg-gray-900",children:U?o.jsx("div",{style:{display:"inline-block",padding:"20px"},children:o.jsx("img",{ref:Pr,src:U,alt:"Preview",onLoad:Gn,style:{width:X?`${X.width*le}px`:"auto",height:X?`${X.height*le}px`:"auto",maxWidth:"none",imageRendering:"pixelated"}})}):o.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500",children:"Click Execute to generate preview"})}),o.jsx("div",{className:"px-4 py-3 bg-gray-800/50 border-t border-gray-700 flex-shrink-0",children:o.jsx("button",{onClick:yo,disabled:!U,className:"w-full bg-blue-600 hover:bg-blue-500 disabled:bg-gray-600 disabled:cursor-not-allowed text-white py-2 rounded font-semibold transition-colors",children:"Apply Pixelation"})})]})]})})},Ds=5,Rp=({isOpen:i,onClose:c,layer:l})=>{const d=T(O=>O.updateLayer),[f,y]=N.useState(null),[m,b]=N.useState(null),[h,p]=N.useState(1),[g,x]=N.useState(null),[C,D]=N.useState(!1),v=N.useRef(null),P=N.useRef(null),F=N.useRef(null),M=N.useRef({cropRect:null,zoom:1,imageDimensions:null,isDragging:!1});N.useEffect(()=>{M.current.cropRect=g,M.current.zoom=h,M.current.imageDimensions=m},[g,h,m]),N.useEffect(()=>{!i||!l.imageData||(y(l.imageData),p(1),x(null),D(!1))},[i,l.imageData]);const B=O=>{const re=O.currentTarget,le={width:re.naturalWidth,height:re.naturalHeight};b(le),x({x:0,y:0,width:le.width,height:le.height})},se=(O,re)=>{if(!F.current)return 1;const le=F.current.clientWidth,Q=F.current.clientHeight;if(le<=0||Q<=0)return 1;const X=le/O,G=Q/re,H=Math.min(X,G);return Math.max(.1,H*.9)};N.useEffect(()=>{m&&F.current&&!C&&setTimeout(()=>{const O=se(m.width,m.height);p(O),D(!0)},100)},[m,C]);const Y=(O,re)=>{if(O.preventDefault(),!P.current||!M.current.cropRect||!M.current.imageDimensions)return;M.current.isDragging=!0;const le=O.clientX,Q=O.clientY,X={...M.current.cropRect},G=M.current.zoom,H=M.current.imageDimensions,ie=W=>{if(!M.current.isDragging)return;const A=(W.clientX-le)/G,S=(W.clientY-Q)/G;let I={...X};re==="move"?(I.x=X.x+A,I.y=X.y+S):(re.includes("n")&&(I.y=X.y+S,I.height=X.height-S),re.includes("s")&&(I.height=X.height+S),re.includes("w")&&(I.x=X.x+A,I.width=X.width-A),re.includes("e")&&(I.width=X.width+A)),I.x=Math.max(0,Math.min(I.x,H.width-Ds)),I.y=Math.max(0,Math.min(I.y,H.height-Ds)),I.width=Math.max(Ds,Math.min(I.width,H.width-I.x)),I.height=Math.max(Ds,Math.min(I.height,H.height-I.y)),x(I),M.current.cropRect=I},j=()=>{M.current.isDragging=!1,document.removeEventListener("mousemove",ie),document.removeEventListener("mouseup",j)};document.addEventListener("mousemove",ie),document.addEventListener("mouseup",j)},z=()=>p(O=>Math.min(5,O+.25)),U=()=>p(O=>Math.max(.1,O-.25)),K=()=>{p(m?se(m.width,m.height):1)},V=async()=>{if(!f||!m)return;const O=new Image;O.src=f,await new Promise(A=>{O.onload=A,O.onerror=A});const re=document.createElement("canvas");re.width=m.width,re.height=m.height;const le=re.getContext("2d");if(!le)return;le.drawImage(O,0,0);const X=le.getImageData(0,0,m.width,m.height).data;let G=m.width,H=m.height,ie=-1,j=-1;for(let A=0;A<X.length;A+=4)if(X[A+3]>0){const I=A/4,ee=I%m.width,ue=Math.floor(I/m.width);G=Math.min(G,ee),H=Math.min(H,ue),ie=Math.max(ie,ee),j=Math.max(j,ue)}if(ie<G||j<H)return;const W={x:G,y:H,width:ie-G+1,height:j-H+1};x(W),M.current.cropRect=W},$=async()=>{if(!g||!m||!f)return;const O=new Image;O.src=f,await new Promise(X=>{O.onload=X,O.onerror=X});const re=document.createElement("canvas");re.width=Math.round(g.width),re.height=Math.round(g.height);const le=re.getContext("2d");if(!le)return;le.imageSmoothingQuality="high",le.drawImage(O,Math.round(g.x),Math.round(g.y),Math.round(g.width),Math.round(g.height),0,0,Math.round(g.width),Math.round(g.height));const Q=re.toDataURL();d(l.id,{imageData:Q,width:Math.round(g.width),height:Math.round(g.height)}),c()};return o.jsx(Sr,{isOpen:i,title:"Crop",onClose:c,children:o.jsxs("div",{className:"flex flex-col h-full p-4 gap-4 text-gray-200",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-sm font-medium",children:"Preview"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:U,disabled:h<=.1,className:"p-1 text-gray-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Zoom out",children:""}),o.jsxs("span",{className:"text-xs text-gray-400 min-w-[45px] text-center",children:[Math.round(h*100),"%"]}),o.jsx("button",{onClick:z,disabled:h>=5,className:"p-1 text-gray-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Zoom in",children:"+"}),o.jsx("button",{onClick:K,className:"text-xs px-2 py-1 text-gray-400 hover:text-white bg-gray-700 hover:bg-gray-600 rounded transition-colors",title:"Reset zoom",children:"Reset"}),o.jsx("button",{onClick:V,className:"text-xs px-2 py-1 text-cyan-200 bg-cyan-900 hover:bg-cyan-800 rounded transition-colors",title:"Auto-crop to remove transparent edges",children:"Auto"})]})]}),o.jsxs("div",{className:"flex gap-4 text-xs text-gray-400",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-500",children:"Original:"})," ",m?`${m.width}${m.height}`:""]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-500",children:"Crop:"})," ",g?`${Math.round(g.width)}${Math.round(g.height)}`:""]})]}),o.jsx("div",{className:"flex-1 relative w-full bg-gray-900 rounded border border-gray-700 overflow-auto",ref:F,children:f?o.jsxs("div",{ref:v,style:{display:"inline-block",padding:10,position:"relative"},children:[o.jsx("img",{ref:P,src:f,alt:"Preview",onLoad:B,style:{width:m?`${m.width*h}px`:"auto",height:m?`${m.height*h}px`:"auto",display:"block",maxWidth:"none",userSelect:"none"}}),m&&g&&o.jsxs("div",{style:{position:"absolute",left:10+g.x*h,top:10+g.y*h,width:Math.max(0,g.width*h),height:Math.max(0,g.height*h),boxSizing:"border-box",border:"2px dashed rgba(100,200,255,0.8)",pointerEvents:"none"},children:[o.jsx("div",{onMouseDown:O=>Y(O,"move"),style:{position:"absolute",inset:0,cursor:"move",pointerEvents:"auto",background:"rgba(100,200,255,0.05)"}}),[{type:"nw",left:-6,top:-6,cursorStyle:"nw-resize"},{type:"n",left:"50%",top:-6,transform:"translateX(-50%)",cursorStyle:"n-resize"},{type:"ne",right:-6,top:-6,cursorStyle:"ne-resize"},{type:"e",right:-6,top:"50%",transform:"translateY(-50%)",cursorStyle:"e-resize"},{type:"se",right:-6,bottom:-6,cursorStyle:"se-resize"},{type:"s",left:"50%",bottom:-6,transform:"translateX(-50%)",cursorStyle:"s-resize"},{type:"sw",left:-6,bottom:-6,cursorStyle:"sw-resize"},{type:"w",left:-6,top:"50%",transform:"translateY(-50%)",cursorStyle:"w-resize"}].map(({type:O,cursorStyle:re,...le})=>o.jsx("div",{onMouseDown:Q=>Y(Q,O),style:{position:"absolute",width:12,height:12,background:"#fff",border:"1px solid #000",borderRadius:2,cursor:re,pointerEvents:"auto",boxSizing:"border-box",...le}},O))]})]}):o.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:o.jsx("div",{className:"text-gray-500",children:"No preview available"})})}),o.jsxs("div",{className:"flex items-center justify-end gap-2 pt-4 border-t border-gray-700",children:[o.jsx("button",{onClick:c,className:"px-4 py-2 text-sm font-medium text-gray-300 bg-gray-700 rounded hover:bg-gray-600 transition-colors",children:"Cancel"}),o.jsx("button",{onClick:$,disabled:!g,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Apply"})]})]})})};function zp(){const i=T(D=>D.project),c=T(D=>D.selectedLayerIds),l=i.layers.filter(D=>c.includes(D.id)),[d,f]=N.useState(!1),[y,m]=N.useState(!1),[b,h]=N.useState(!1),[p,g]=N.useState(!1),[x,C]=N.useState(!1);return o.jsxs("div",{className:"h-full flex flex-col bg-canvas-bg overflow-hidden",children:[o.jsx("div",{className:"px-3 py-3 border-b border-border",children:o.jsx("h2",{className:"text-sm font-semibold text-gray-300",children:"Properties"})}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:c.length===0?o.jsxs("div",{className:"p-4 text-center text-sm text-gray-500",children:[o.jsx("div",{className:"mb-2",children:"No layer selected"}),o.jsx("div",{className:"text-xs",children:"Select a layer to edit properties"})]}):o.jsxs("div",{className:"p-3 space-y-4",children:[o.jsxs("div",{className:"bg-panel-bg rounded p-2 text-xs text-gray-400",children:[o.jsx("div",{className:"font-semibold text-gray-300 mb-1",children:"Selected"}),l.map(D=>o.jsx("div",{className:"truncate",children:D.name},D.id))]}),c.length===1&&l.length>0&&o.jsx(jp,{layer:l[0]}),c.length===1&&l.length>0&&o.jsx(Sp,{layer:l[0]}),c.length===1&&l.length>0&&o.jsx(bp,{layer:l[0]}),c.length===1&&l.length>0&&l[0].shapeType&&o.jsx(Dp,{layer:l[0]}),c.length===1&&l.length>0&&o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"text-xs font-semibold text-gray-300 mb-2",children:"Actions"}),o.jsxs("button",{onClick:()=>f(!d),className:"w-full px-3 py-2 bg-slate-700 hover:bg-slate-600 text-white text-xs rounded transition-colors flex justify-between items-center",children:[o.jsx("span",{children:"Modify..."}),o.jsx("span",{className:"text-[10px]",children:""})]}),d&&o.jsxs("div",{className:"absolute left-0 top-full mt-1 w-full bg-panel-bg border border-border rounded shadow-lg z-20",children:[o.jsx("button",{onClick:()=>{m(!0),f(!1)},className:"w-full text-left px-3 py-2 text-xs text-gray-300 hover:bg-slate-700 hover:text-white",children:"Transparency Masking"}),o.jsx("button",{onClick:()=>{h(!0),f(!1)},className:"w-full text-left px-3 py-2 text-xs text-gray-300 hover:bg-slate-700 hover:text-white",children:"Pixelator"}),o.jsx("button",{onClick:()=>{g(!0),f(!1)},className:"w-full text-left px-3 py-2 text-xs text-gray-300 hover:bg-slate-700 hover:text-white",children:"Crop"}),o.jsx("button",{onClick:()=>{C(!0),f(!1)},className:"w-full text-left px-3 py-2 text-xs text-gray-300 hover:bg-slate-700 hover:text-white",children:"BG Removal (Experimental)"})]})]}),c.length===1&&l.length>0&&o.jsx(Pp,{isOpen:y,onClose:()=>m(!1),layer:l[0]}),c.length===1&&l.length>0&&o.jsx(_p,{isOpen:b,onClose:()=>h(!1),layer:l[0]}),c.length===1&&l.length>0&&o.jsx(Fp,{isOpen:x,onClose:()=>C(!1),layer:l[0]}),c.length===1&&l.length>0&&o.jsx(Rp,{isOpen:p,onClose:()=>g(!1),layer:l[0]}),c.length>1&&o.jsx(Tp,{})]})})]})}function Tp(){const i=T(d=>d.moveSelectedLayers),c=T(d=>d.selectedLayerIds),l=(d,f)=>{console.log(`[DEBUG] Moving ${c.length} layers by (${d}, ${f})`),i(d,f)};return o.jsxs("div",{className:"bg-panel-bg rounded p-3 space-y-3",children:[o.jsx("div",{className:"text-xs font-semibold text-gray-300",children:"Move Selected"}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Offset X"}),o.jsx("input",{type:"number",defaultValue:0,onKeyDown:d=>{if(d.key==="Enter"){const f=parseInt(d.target.value)||0;l(f,0),d.target.value="0"}},className:"w-full px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-white focus:outline-none focus:ring-1 focus:ring-blue-400",placeholder:"Pixels"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Offset Y"}),o.jsx("input",{type:"number",defaultValue:0,onKeyDown:d=>{if(d.key==="Enter"){const f=parseInt(d.target.value)||0;l(0,f),d.target.value="0"}},className:"w-full px-2 py-1 bg-canvas-bg border border-border rounded text-xs text-white focus:outline-none focus:ring-1 focus:ring-blue-400",placeholder:"Pixels"})]})]}),o.jsxs("div",{className:"flex gap-1 text-xs",children:[o.jsx("button",{onClick:()=>l(-1,0),className:"flex-1 px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded transition-colors",title:"Move left 1px (Shift+)",children:""}),o.jsx("button",{onClick:()=>l(1,0),className:"flex-1 px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded transition-colors",title:"Move right 1px (Shift+)",children:""}),o.jsx("button",{onClick:()=>l(0,-1),className:"flex-1 px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded transition-colors",title:"Move up 1px (Shift+)",children:""}),o.jsx("button",{onClick:()=>l(0,1),className:"flex-1 px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded transition-colors",title:"Move down 1px (Shift+)",children:""})]})]})}function Ap(){const i=T(p=>p.project.viewport),c=T(p=>p.project.canvas),l=T(p=>p.setViewport),d=[25,33,50,66,100,150,200,400,800,1600,3200],f=()=>{const p=document.querySelector('[data-canvas-container="true"]');if(!p)return 100;const g=p.clientWidth,x=p.clientHeight;if(g<=0||x<=0||c.width<=0||c.height<=0)return 100;const C=g/c.width,D=x/c.height,v=Math.min(C,D)*100,P=d.reduce((B,se)=>Math.abs(se-v)<Math.abs(B-v)?se:B),F=d.indexOf(P);return F>0?d[F-1]:P},y=p=>{l({zoom:p})},m=()=>{const p=i.zoom,g=d.find(x=>x>p)||d[d.length-1];y(g)},b=()=>{const p=i.zoom,g=[...d].reverse().find(x=>x<p)||d[0];y(g)},h=()=>{const p=f();l({zoom:p,panX:0,panY:0})};return o.jsxs("div",{className:"flex items-center gap-2 bg-canvas-bg rounded px-2 py-1",children:[o.jsx("button",{onClick:b,className:"px-2 py-1 text-sm font-medium text-gray-300 hover:text-white bg-panel-bg hover:bg-gray-700 rounded transition-colors",title:"Zoom Out",children:""}),o.jsxs("div",{className:"relative group",children:[o.jsxs("button",{className:"px-3 py-1 text-sm font-medium text-gray-300 hover:text-white bg-panel-bg hover:bg-gray-700 rounded transition-colors min-w-16 text-right",title:"Click to select zoom level",children:[i.zoom,"%"]}),o.jsx("div",{className:"absolute right-0 mt-1 w-24 bg-panel-bg border border-border rounded shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50",children:d.map(p=>o.jsxs("button",{onClick:()=>y(p),className:`w-full text-left px-3 py-1 text-sm transition-colors ${i.zoom===p?"bg-blue-600 text-white":"text-gray-300 hover:text-white hover:bg-gray-700"}`,children:[p,"%"]},p))})]}),o.jsx("button",{onClick:m,className:"px-2 py-1 text-sm font-medium text-gray-300 hover:text-white bg-panel-bg hover:bg-gray-700 rounded transition-colors",title:"Zoom In",children:"+"}),o.jsx("div",{className:"w-px h-4 bg-border"}),o.jsx("button",{onClick:h,className:"px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-300 hover:bg-gray-700 rounded transition-colors",title:"Fit canvas to screen",children:"Reset"})]})}function Op(){const i=N.useRef(null),[c,l]=N.useState(1),d=T(x=>x.project),f=T(x=>x.resetProject),y=T(x=>x.loadProject),m=T(x=>x.markClean);N.useEffect(()=>{const x=C=>{const D=C.ctrlKey||C.metaKey;D&&C.key==="s"&&(C.preventDefault(),b()),D&&C.key==="o"&&(C.preventDefault(),i.current?.click())};return window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)},[d]);const b=async()=>{try{const x=Mu(d),C=new Blob([x],{type:"application/json"}),D=URL.createObjectURL(C),v=document.createElement("a");v.href=D,v.download=`${d.projectName||"untitled"}.pixcomp`,document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(D),m(),alert(`Project saved: ${v.download}`)}catch(x){console.error("[DEBUG] Save project failed:",x),alert(`Error saving project: ${x instanceof Error?x.message:"Unknown error"}`)}},h=async x=>{const C=x.target.files?.[0];if(!C){console.warn("[DEBUG] No file selected for loading");return}try{const D=await C.text(),v=await La(D);y(v),m(),alert(`Project loaded: ${C.name}`)}catch(D){console.error("[DEBUG] Load project failed:",D),alert(`Error loading project: ${D instanceof Error?D.message:"Unknown error"}`)}finally{i.current&&(i.current.value="")}},p=()=>{T.getState().isDirty&&!window.confirm("You have unsaved changes. Create new project anyway?")||f()},g=async()=>{try{const x=await gp(d.layers,d.canvas.width,d.canvas.height,c,d.canvas.backgroundColor),C=URL.createObjectURL(x),D=document.createElement("a");D.href=C,D.download=`${d.projectName||"composite"}_${c}x.png`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(C),alert(`PNG exported: ${D.download}`)}catch(x){console.error("[DEBUG] Export PNG failed:",x),alert(`Error exporting PNG: ${x instanceof Error?x.message:"Unknown error"}`)}};return o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:p,className:"px-3 py-1 text-sm font-medium text-gray-300 hover:text-white bg-panel-bg hover:bg-gray-700 rounded transition-colors",title:"New project",children:"New"}),o.jsx("button",{onClick:b,className:"px-3 py-1 text-sm font-medium text-gray-300 hover:text-white bg-panel-bg hover:bg-gray-700 rounded transition-colors",title:"Save project as .pixcomp file (Ctrl+S)",children:"Save"}),o.jsx("button",{onClick:()=>i.current?.click(),className:"px-3 py-1 text-sm font-medium text-gray-300 hover:text-white bg-panel-bg hover:bg-gray-700 rounded transition-colors",title:"Load project from .pixcomp file (Ctrl+O)",children:"Load"}),o.jsx("button",{onClick:g,className:"px-3 py-1 text-sm font-medium text-gray-300 hover:text-white bg-panel-bg hover:bg-gray-700 rounded transition-colors",title:"Export canvas as PNG",children:"Export"}),o.jsxs("div",{className:"relative group",children:[o.jsxs("button",{className:"px-2 py-1 text-xs font-medium text-gray-400 hover:text-gray-300 bg-panel-bg hover:bg-gray-700 rounded transition-colors opacity-0 group-hover:opacity-100",title:"Export scale",children:[c,"x"]}),o.jsx("div",{className:"absolute right-0 mt-1 w-16 bg-panel-bg border border-border rounded shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50",children:[1,2,4,8].map(x=>o.jsxs("button",{onClick:()=>{l(x)},className:`w-full text-left px-2 py-1 text-xs transition-colors ${c===x?"bg-blue-600 text-white":"text-gray-300 hover:text-white hover:bg-gray-700"}`,children:[x,"x"]},x))})]}),o.jsx("input",{ref:i,type:"file",accept:".pixcomp,.json",onChange:h,className:"hidden"})]})}function Bp(){const i=T(b=>b.history),c=T(b=>b.undo),l=T(b=>b.redo),d=i.past.length>0,f=i.future.length>0,y=()=>{c()},m=()=>{l()};return o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:y,disabled:!d,className:`px-3 py-1 text-sm font-medium rounded transition-colors ${d?"text-gray-300 hover:text-white bg-panel-bg hover:bg-gray-700":"text-gray-600 bg-panel-bg cursor-not-allowed opacity-50"}`,title:`Undo (${i.past.length} operation${i.past.length!==1?"s":""} available) - Ctrl+Z`,children:""}),o.jsx("button",{onClick:m,disabled:!f,className:`px-3 py-1 text-sm font-medium rounded transition-colors ${f?"text-gray-300 hover:text-white bg-panel-bg hover:bg-gray-700":"text-gray-600 bg-panel-bg cursor-not-allowed opacity-50"}`,title:`Redo (${i.future.length} operation${i.future.length!==1?"s":""} available) - Ctrl+Shift+Z`,children:""})]})}function Up(){const i=T(f=>f.project.grid.enabled),c=T(f=>f.project.grid.density),l=T(f=>f.toggleGrid),d=T(f=>f.setGridDensity);return N.useEffect(()=>{const f=Fs();f.gridEnabled=i,f.gridDensity=c,Ia(f)},[i,c]),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:l,className:`px-3 py-1 text-sm font-medium rounded transition-colors ${i?"bg-gray-600 text-white hover:bg-gray-500":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,title:"Toggle pixel grid (shows lines between pixels)",children:"Grid"}),i&&o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("label",{className:"text-xs text-gray-400",children:"Density:"}),o.jsx("input",{type:"range",min:"1",max:"8",value:c,onChange:f=>d(parseInt(f.target.value)),className:"w-24 h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer",title:`Grid density: every ${c} pixel(s)`}),o.jsx("span",{className:"text-xs text-gray-400 w-6",children:c})]})]})}function $p(){const i=T(v=>v.project),c=T(v=>v.setProjectName),l=T(v=>v.ui.showSelectionBorders),d=T(v=>v.toggleSelectionBorders),f=T(v=>v.ui.showSelectionTools),y=T(v=>v.toggleSelectionTools),m=T(v=>v.ui.selectionBorderAnimationSpeed),b=T(v=>v.setSelectionBorderAnimationSpeed),[h,p]=N.useState(!1),[g,x]=N.useState(i.projectName);N.useEffect(()=>{const v=Fs();v.showSelectionBorders=l,v.selectionBorderAnimationSpeed=m,Ia(v)},[l,m]);const C=()=>{g.trim()?c(g.trim()):x(i.projectName),p(!1)},D=v=>{v.key==="Enter"?C():v.key==="Escape"&&(x(i.projectName),p(!1))};return o.jsxs("div",{className:"h-16 bg-panel-bg border-b border-border flex items-center justify-between px-4 gap-4",children:[o.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0 max-w-xs",children:[o.jsxs("div",{className:"text-lg font-semibold whitespace-nowrap",children:[o.jsx("span",{className:"text-red-500",children:"Pixel"}),o.jsx("span",{className:"text-sky-400",children:"Connect"})]}),o.jsx("div",{className:"text-gray-500",children:"|"}),h?o.jsx("input",{autoFocus:!0,type:"text",value:g,onChange:v=>x(v.target.value),onBlur:C,onKeyDown:D,className:"flex-1 px-2 py-1 bg-canvas-bg border border-blue-500 rounded text-sm text-white focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"Project name..."}):o.jsx("button",{onClick:()=>{x(i.projectName),p(!0)},className:"flex-1 text-left px-2 py-1 text-gray-300 hover:text-white hover:bg-canvas-bg rounded transition-colors truncate",title:"Click to rename project",children:i.projectName})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Op,{}),o.jsx("div",{className:"w-px h-6 bg-border"}),o.jsx(Bp,{}),o.jsx("div",{className:"w-px h-6 bg-border"}),o.jsx(Up,{}),o.jsx("div",{className:"w-px h-6 bg-border"}),o.jsx("button",{onClick:d,title:l?"Hide selection borders":"Show selection borders",className:`px-3 py-1 rounded transition-colors text-sm font-medium ${l?"bg-gray-600 text-white hover:bg-gray-500":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"Borders"}),o.jsx("button",{onClick:y,title:f?"Hide selection tools":"Show selection tools",className:`px-3 py-1 rounded transition-colors text-sm font-medium ${f?"bg-gray-600 text-white hover:bg-gray-500":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"Tools"}),l&&o.jsxs("div",{className:"flex items-center gap-2 pl-2",children:[o.jsx("label",{className:"text-xs text-gray-400 whitespace-nowrap",children:"Speed:"}),o.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:m,onChange:v=>b(parseFloat(v.target.value)),className:"w-24 h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer",title:"Border animation speed (0 = static, 1 = max speed)"})]})]}),o.jsx("div",{className:"flex items-center gap-2 ml-auto",children:o.jsx(Ap,{})})]})}function Hp({isOpen:i,onClose:c}){const l=T(p=>p.history),d=T(p=>p.project),[f,y]=N.useState(null);if(!i)return null;const m=p=>`${p.projectName} | ${p.layers.length} layer(s) | Modified: ${new Date(p.modified).toLocaleTimeString()}`,b=(p,g)=>{const x=[];p.layers.length!==g.layers.length&&x.push(`Layer count: ${p.layers.length}  ${g.layers.length}`);for(let C=0;C<Math.max(p.layers.length,g.layers.length);C++){const D=p.layers[C],v=g.layers[C];D?v?(D.x!==v.x||D.y!==v.y||D.width!==v.width||D.height!==v.height)&&x.push(`${D.name}: (${D.x}, ${D.y})  (${v.x}, ${v.y})`):x.push(`Layer ${C}: added (${D.name})`):x.push(`Layer ${C}: removed`)}return x.length>0?x:["No layer changes"]},h=p=>{p.key==="Escape"&&c()};return o.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:c,onKeyDown:h,role:"dialog","aria-modal":"true","aria-label":"Debug History Modal",tabIndex:0,children:o.jsxs("div",{className:"bg-slate-900 border border-slate-700 rounded-lg shadow-2xl w-full max-w-2xl max-h-[80vh] flex flex-col",onClick:p=>p.stopPropagation(),children:[o.jsxs("div",{className:"bg-slate-800 px-6 py-4 border-b border-slate-700 flex justify-between items-center",children:[o.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[o.jsx("span",{className:"text-yellow-400",children:""}),"Debug History"]}),o.jsx("button",{onClick:c,className:"text-slate-400 hover:text-white transition-colors","aria-label":"Close debug menu",children:""})]}),o.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col",children:[o.jsxs("div",{className:"flex-1 overflow-auto p-4 space-y-2",children:[o.jsxs("div",{className:"bg-slate-800 rounded p-3 border border-slate-700 sticky top-0",children:[o.jsx("div",{className:"text-sm font-semibold text-cyan-400 mb-1",children:"Current State"}),o.jsx("div",{className:"text-xs text-slate-300",children:m(d)})]}),l.past.length===0&&l.future.length===0?o.jsx("div",{className:"text-center text-slate-400 py-8",children:o.jsx("p",{className:"text-sm",children:"No history entries yet"})}):o.jsxs(o.Fragment,{children:[l.past.length>0&&o.jsxs("div",{children:[o.jsxs("div",{className:"text-xs font-semibold text-green-400 mb-2 px-1",children:["UNDO STACK (",l.past.length,")"]}),o.jsx("div",{className:"space-y-1",children:l.past.map((p,g)=>o.jsxs("div",{children:[o.jsx("button",{onClick:()=>y(f===`past-${g}`?null:`past-${g}`),className:"w-full text-left bg-slate-800 hover:bg-slate-700 rounded px-3 py-2 text-xs transition-colors border border-slate-700 hover:border-slate-600",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-green-400",children:""}),o.jsx("span",{className:"text-slate-300 flex-1",children:m(p)}),o.jsx("span",{className:"text-slate-500",children:f===`past-${g}`?"":""})]})}),f===`past-${g}`&&o.jsx("div",{className:"bg-slate-800/50 border-l-2 border-green-400 ml-4 mt-1 p-2 rounded text-xs text-slate-300 space-y-1",children:b(l.past[g+1]||d,p).map((x,C)=>o.jsxs("div",{className:"text-slate-400",children:[" ",x]},C))})]},`past-${g}`))})]}),l.future.length>0&&o.jsxs("div",{children:[o.jsxs("div",{className:"text-xs font-semibold text-blue-400 mb-2 px-1 mt-4",children:["REDO STACK (",l.future.length,")"]}),o.jsx("div",{className:"space-y-1",children:l.future.map((p,g)=>o.jsxs("div",{children:[o.jsx("button",{onClick:()=>y(f===`future-${g}`?null:`future-${g}`),className:"w-full text-left bg-slate-800 hover:bg-slate-700 rounded px-3 py-2 text-xs transition-colors border border-slate-700 hover:border-slate-600",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-blue-400",children:""}),o.jsx("span",{className:"text-slate-300 flex-1",children:m(p)}),o.jsx("span",{className:"text-slate-500",children:f===`future-${g}`?"":""})]})}),f===`future-${g}`&&o.jsx("div",{className:"bg-slate-800/50 border-l-2 border-blue-400 ml-4 mt-1 p-2 rounded text-xs text-slate-300 space-y-1",children:b(d,p).map((x,C)=>o.jsxs("div",{className:"text-slate-400",children:[" ",x]},C))})]},`future-${g}`))})]})]})]}),o.jsxs("div",{className:"bg-slate-800 px-6 py-3 border-t border-slate-700 text-xs text-slate-400",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsxs("span",{children:["Stack size: ",l.past.length+l.future.length]}),o.jsxs("span",{children:["Max steps: ",l.maxSteps]})]}),o.jsx("div",{className:"text-slate-500 text-xs mt-1",children:"Press ESC or click overlay to close"})]})]})]})})}const vr="__text_canvas_preview__",Wp=({isOpen:i,onClose:c,existingLayer:l})=>{const d=T(te=>te.addLayer),f=T(te=>te.updateLayer),y=T(te=>te.removeLayer),[m,b]=N.useState("Enter your text here"),[h,p]=N.useState(48),[g,x]=N.useState(Da[0].value),[C,D]=N.useState("#FFCDD2"),[v,P]=N.useState("left"),[F,M]=N.useState(null),[B,se]=N.useState(!1),[Y,z]=N.useState(""),[U,K]=N.useState(!1),[V,$]=N.useState(!1),[O,re]=N.useState(!0),[le,Q]=N.useState(1.2),[X,G]=N.useState(0),[H,ie]=N.useState("normal"),[j,W]=N.useState(0),[A,S]=N.useState(0),I=N.useRef(null),ee=N.useRef(null),ue=N.useRef(!0);N.useEffect(()=>{l&&l.textContent!==void 0&&(b(l.textContent),p(l.fontSize||48),x(l.fontFamily||Da[0].value),D(l.fontColor||"#FFCDD2"),P(l.textAlign||"left"),re(l.disableTransparency||!1),Q(l.lineHeight||1.2),G(l.letterSpacing||0),ie(l.fontWeight||"normal"),W(l.x),S(l.y),ue.current=l.visible)},[l]),N.useEffect(()=>{!i||!m.trim()||he()},[m,h,g,C,v,O,le,X,H,i]),N.useEffect(()=>{if(V&&m.trim()&&F){if(l){const Me=T.getState().project.layers.find(De=>De.id===l.id);Me&&Me.visible&&f(l.id,{visible:!1})}ye()}else je()},[V,F,m,j,A]),N.useEffect(()=>{if(!V)return;const te=T.subscribe(Me=>{const De=Me.project.layers.find(Te=>Te.id===vr);De&&(Math.abs(De.x-j)>.1||Math.abs(De.y-A)>.1)&&(W(De.x),S(De.y))});return()=>{te()}},[V,j,A]),N.useEffect(()=>{i||je()},[i]),N.useEffect(()=>{const te=Me=>{I.current&&!I.current.contains(Me.target)&&K(!1)};return document.addEventListener("mousedown",te),()=>document.removeEventListener("mousedown",te)},[]);const he=async()=>{if(m.trim()){se(!0);try{const te=await Ps({text:m,fontSize:h,fontFamily:g,color:C,textAlign:v,lineHeight:le,disableTransparency:O,letterSpacing:X,fontWeight:H});M(te.dataUrl)}catch(te){console.error("Failed to generate text preview:",te)}finally{se(!1)}}},ye=()=>{!F||!V||(ee.current!==null&&clearTimeout(ee.current),ee.current=window.setTimeout(()=>{const te=new Image;te.src=F,te.onload=()=>{if(T.getState().project.layers.find(Te=>Te.id===vr))f(vr,{imageData:F,width:te.naturalWidth,height:te.naturalHeight,opacity:.7,x:j,y:A});else if(V){const Te={id:vr,name:" Canvas Preview (Temporary)",imageData:F,x:j,y:A,zIndex:Date.now()+1e6,visible:!0,locked:!1,opacity:.7,width:te.naturalWidth,height:te.naturalHeight};d(Te)}}},50))},je=()=>{ee.current!==null&&(clearTimeout(ee.current),ee.current=null);const te=T.getState().project.layers;if(te.find(De=>De.id===vr)&&y(vr),l){const De=te.find(Te=>Te.id===l.id);De&&!De.visible&&f(l.id,{visible:!0})}},be=async()=>{if(!m.trim()){alert("Please enter some text");return}se(!0);try{const te=await Ps({text:m,fontSize:h,fontFamily:g,color:C,textAlign:v,lineHeight:le,disableTransparency:O,letterSpacing:X,fontWeight:H}),Me=V?j:0,De=V?A:0;if(l)f(l.id,{imageData:te.dataUrl,width:te.width,height:te.height,x:Me,y:De,textContent:m,fontSize:h,fontFamily:g,fontColor:C,textAlign:v,disableTransparency:O,name:l.name,...le!==1.2&&{lineHeight:le},...X!==0&&{letterSpacing:X},...H!=="normal"&&{fontWeight:H}});else{const Te={id:crypto.randomUUID(),name:`Text: ${m.substring(0,20)}${m.length>20?"...":""}`,imageData:te.dataUrl,x:Me,y:De,zIndex:Date.now(),visible:!0,locked:!1,opacity:1,width:te.width,height:te.height,textContent:m,fontSize:h,fontFamily:g,fontColor:C,textAlign:v,disableTransparency:O,...le!==1.2&&{lineHeight:le},...X!==0&&{letterSpacing:X},...H!=="normal"&&{fontWeight:H}};d(Te)}je(),c()}catch(te){console.error("Failed to create text layer:",te),alert("Failed to create text layer. Please try again.")}finally{se(!1)}},Ne=Pa.filter(te=>te.name.toLowerCase().includes(Y.toLowerCase())),ze=Ne.filter(te=>te.category==="system"),bt=Ne.filter(te=>te.category==="google"),sn=Pa.find(te=>te.value===g);return o.jsx(Sr,{isOpen:i,onClose:c,title:l?"Edit Text Layer":"Create Text Layer",noPadding:!0,children:o.jsxs("div",{className:"flex text-gray-200 h-full w-full overflow-hidden",children:[o.jsxs("div",{className:"w-80 border-r border-gray-700 flex-shrink-0 flex flex-col overflow-hidden bg-gray-800",children:[o.jsxs("div",{className:"overflow-y-auto flex-1 p-4 space-y-5",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("label",{className:"text-xs font-semibold text-gray-400 uppercase",children:"Content"}),o.jsxs("span",{className:"text-xs text-gray-500",children:[m.length," chars"]})]}),o.jsx("textarea",{value:m,onChange:te=>b(te.target.value),placeholder:"Enter text...",className:"w-full h-20 px-3 py-2 bg-gray-900 border border-gray-600 rounded text-white text-sm resize-none focus:outline-none focus:ring-1 focus:ring-blue-500"}),o.jsx("button",{onClick:()=>navigator.clipboard.writeText(m),disabled:!m.trim(),className:"w-full py-1 text-xs text-gray-400 hover:text-white bg-gray-700 hover:bg-gray-600 rounded transition-colors",children:"Copy Text"})]}),o.jsxs("div",{className:"space-y-3 border-t border-gray-700 pt-3",children:[o.jsx("label",{className:"text-xs font-semibold text-gray-400 uppercase",children:"Typography"}),o.jsxs("div",{className:"relative",ref:I,children:[o.jsxs("button",{onClick:()=>K(!U),className:"w-full px-3 py-1.5 bg-gray-900 border border-gray-600 rounded text-white text-sm text-left flex items-center justify-between hover:bg-gray-700",children:[o.jsx("span",{className:"truncate",children:sn?.name||"Arial"}),o.jsx("span",{className:"text-gray-500 text-xs",children:""})]}),U&&o.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-gray-800 border border-gray-600 rounded shadow-xl z-50 max-h-60 overflow-y-auto",children:[o.jsx("div",{className:"p-2 sticky top-0 bg-gray-800 border-b border-gray-700",children:o.jsx("input",{type:"text",value:Y,onChange:te=>z(te.target.value),placeholder:"Search...",className:"w-full px-2 py-1 bg-gray-900 border border-gray-600 rounded text-white text-xs focus:outline-none focus:border-blue-500",onClick:te=>te.stopPropagation(),autoFocus:!0})}),ze.length>0&&o.jsxs("div",{children:[o.jsx("div",{className:"px-2 py-1 text-[10px] font-bold text-gray-500 uppercase bg-gray-800/50",children:"System"}),ze.map(te=>o.jsx("button",{onClick:()=>{x(te.value),K(!1),z("")},className:`w-full px-3 py-1.5 text-left text-sm hover:bg-blue-600 hover:text-white ${g===te.value?"bg-blue-600 text-white":"text-gray-300"}`,style:{fontFamily:te.value},children:te.name},te.value))]}),bt.length>0&&o.jsxs("div",{children:[o.jsx("div",{className:"px-2 py-1 text-[10px] font-bold text-gray-500 uppercase bg-gray-800/50 border-t border-gray-700",children:"Google Fonts"}),bt.map(te=>o.jsx("button",{onClick:()=>{x(te.value),K(!1),z("")},className:`w-full px-3 py-1.5 text-left text-sm hover:bg-blue-600 hover:text-white ${g===te.value?"bg-blue-600 text-white":"text-gray-300"}`,style:{fontFamily:te.value},children:te.name},te.value))]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] text-gray-500 mb-1 block",children:"Size"}),o.jsx("input",{type:"number",value:h,onChange:te=>p(Math.max(8,Math.min(2e3,parseInt(te.target.value)||48))),className:"w-full px-2 py-1 bg-gray-900 border border-gray-600 rounded text-white text-sm"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] text-gray-500 mb-1 block",children:"Weight"}),o.jsxs("select",{value:H,onChange:te=>ie(te.target.value),className:"w-full px-2 py-1 bg-gray-900 border border-gray-600 rounded text-white text-sm",children:[o.jsx("option",{value:"lighter",children:"Light"}),o.jsx("option",{value:"normal",children:"Normal"}),o.jsx("option",{value:"bold",children:"Bold"})]})]})]}),o.jsx("div",{className:"flex flex-wrap gap-1",children:[16,24,32,48,64,96].map(te=>o.jsx("button",{onClick:()=>p(te),className:`px-2 py-0.5 rounded text-[10px] border transition-colors ${h===te?"bg-blue-600 border-blue-500 text-white":"bg-gray-700 border-gray-600 text-gray-400 hover:bg-gray-600 hover:text-gray-200"}`,children:te},te))})]}),o.jsxs("div",{className:"space-y-3 border-t border-gray-700 pt-3",children:[o.jsx("label",{className:"text-xs font-semibold text-gray-400 uppercase",children:"Appearance"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"color",value:C,onChange:te=>D(te.target.value),className:"w-8 h-8 rounded cursor-pointer bg-transparent border-0 p-0"}),o.jsx("input",{type:"text",value:C,onChange:te=>D(te.target.value),className:"flex-1 px-2 py-1 bg-gray-900 border border-gray-600 rounded text-white text-sm font-mono uppercase"})]}),o.jsx("div",{className:"space-y-1",children:[["#FFFFFF","#E0E0E0","#C0C0C0","#A0A0A0","#808080","#606060","#404040","#202020","#000000"],["#FFCDD2","#EF9A9A","#E57373","#EF5350","#F44336","#E53935","#D32F2F","#C62828","#B71C1C"],["#FFE0B2","#FFCC80","#FFB74D","#FFA726","#FF9800","#FB8C00","#F57C00","#EF6C00","#E65100"],["#FFF9C4","#FFF59D","#FFF176","#FFEE58","#FFEB3B","#FDD835","#FBC02D","#F9A825","#F57F17"],["#C8E6C9","#A5D6A7","#81C784","#66BB6A","#4CAF50","#43A047","#388E3C","#2E7D32","#1B5E20"],["#B2EBF2","#80DEEA","#4DD0E1","#26C6DA","#00BCD4","#00ACC1","#0097A7","#00838F","#006064"],["#BBDEFB","#90CAF9","#64B5F6","#42A5F5","#2196F3","#1E88E5","#1976D2","#1565C0","#0D47A1"],["#E1BEE7","#CE93D8","#BA68C8","#AB47BC","#9C27B0","#8E24AA","#7B1FA2","#6A1B9A","#4A148C"],["#F8BBD0","#F48FB1","#F06292","#EC407A","#E91E63","#D81B60","#C2185B","#AD1457","#880E4F"]].map((te,Me)=>o.jsx("div",{className:"flex gap-1",children:te.map(De=>o.jsx("button",{onClick:()=>D(De),className:`flex-1 aspect-square rounded-sm border ${C===De?"border-white scale-110 z-10":"border-gray-600 hover:border-gray-400"}`,style:{backgroundColor:De},title:De},De))},Me))}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] text-gray-500 mb-1 block",children:"Alignment"}),o.jsx("div",{className:"bg-gray-900 rounded border border-gray-600 p-0.5 flex",children:["left","center","right"].map(te=>o.jsx("button",{onClick:()=>P(te),className:`flex-1 py-1 rounded text-xs capitalize ${v===te?"bg-gray-700 text-white shadow-sm":"text-gray-400 hover:text-gray-300"}`,title:`Align ${te}`,children:te},te))})]})]}),o.jsxs("div",{className:"space-y-3 border-t border-gray-700 pt-3",children:[o.jsx("label",{className:"text-xs font-semibold text-gray-400 uppercase",children:"Spacing"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between text-[10px] text-gray-500 mb-1",children:[o.jsx("span",{children:"Line Height"}),o.jsx("span",{children:le.toFixed(1)})]}),o.jsx("input",{type:"range",min:"0.8",max:"2.0",step:"0.1",value:le,onChange:te=>Q(parseFloat(te.target.value)),className:"w-full h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer"})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between text-[10px] text-gray-500 mb-1",children:[o.jsx("span",{children:"Letter Spacing"}),o.jsxs("span",{children:[X,"px"]})]}),o.jsx("input",{type:"range",min:"-5",max:"10",step:"0.5",value:X,onChange:te=>G(parseFloat(te.target.value)),className:"w-full h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer"})]})]})]}),o.jsx("div",{className:"pt-2",children:o.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-300 cursor-pointer hover:text-white select-none",children:[o.jsx("input",{type:"checkbox",checked:O,onChange:te=>re(te.target.checked),className:"rounded bg-gray-700 border-gray-600 text-blue-600 focus:ring-offset-gray-800"}),o.jsx("span",{children:"Pixel Perfect (No AA)"})]})})]}),o.jsx("div",{className:"p-4 border-t border-gray-700 bg-gray-800/50",children:o.jsx("button",{onClick:be,disabled:B||!m.trim(),className:"w-full py-2 bg-blue-600 hover:bg-blue-500 disabled:bg-gray-700 disabled:text-gray-500 rounded text-white font-semibold transition-colors text-sm",children:l?"Update Layer":"Create Layer"})})]}),o.jsxs("div",{className:"flex-1 bg-gray-900 relative flex flex-col min-w-0",children:[o.jsxs("div",{className:"h-10 border-b border-gray-700 flex items-center justify-between px-4 bg-gray-800/30",children:[o.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:"Preview"}),o.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-400 cursor-pointer hover:text-gray-200 select-none",children:[o.jsx("input",{type:"checkbox",checked:V,onChange:te=>$(te.target.checked),className:"rounded bg-gray-700 border-gray-600 text-blue-600 focus:ring-offset-gray-800"}),o.jsx("span",{children:"Show on Canvas"})]})]}),o.jsx("div",{className:"flex-1 overflow-auto flex items-center justify-center p-8 bg-[url('/grid-pattern.png')] bg-repeat",children:B?o.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm",children:[o.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),"Rendering..."]}):F?o.jsx("div",{className:"relative",children:o.jsx("img",{src:F,alt:"Text preview",className:"max-w-full max-h-full object-contain",style:{imageRendering:"pixelated"}})}):o.jsx("div",{className:"text-gray-600 text-sm italic",children:"Enter text to generate preview"})})]})]})})},wr="__shape_canvas_preview__",Yp=["rectangle","circle","triangle","hexagon","octagon","star"],Vp=({isOpen:i,onClose:c,existingLayer:l})=>{const d=T(H=>H.addLayer),f=T(H=>H.updateLayer),y=T(H=>H.removeLayer),[m,b]=N.useState("rectangle"),[h,p]=N.useState(200),[g,x]=N.useState(1),[C,D]=N.useState(1),[v,P]=N.useState("#FFFFFF"),[F,M]=N.useState(null),[B,se]=N.useState(!1),[Y,z]=N.useState(!0),[U,K]=N.useState(0),[V,$]=N.useState(0),O=N.useRef(null),re=N.useRef(!0);N.useEffect(()=>{l&&l.shapeType!==void 0&&(b(l.shapeType),p(l.shapeSize||200),x(l.shapeStretchX||1),D(l.shapeStretchY||1),P(l.shapeColor||"#FFFFFF"),K(l.x),$(l.y),re.current=l.visible)},[l]),N.useEffect(()=>{i&&le()},[m,h,g,C,v,i]),N.useEffect(()=>{if(Y&&F){if(l){const ie=T.getState().project.layers.find(j=>j.id===l.id);ie&&ie.visible&&f(l.id,{visible:!1})}Q()}else X()},[Y,F,U,V]),N.useEffect(()=>{if(!Y)return;const H=T.subscribe(ie=>{const j=ie.project.layers.find(W=>W.id===wr);j&&(Math.abs(j.x-U)>.1||Math.abs(j.y-V)>.1)&&(K(j.x),$(j.y))});return()=>{H()}},[Y,U,V]),N.useEffect(()=>{i||X()},[i]);const le=async()=>{se(!0);try{const H=await Wn({shapeType:m,size:h,stretchX:g,stretchY:C,color:v});M(H.dataUrl)}catch(H){console.error("Failed to generate shape preview:",H)}finally{se(!1)}},Q=()=>{!F||!Y||(O.current!==null&&clearTimeout(O.current),O.current=window.setTimeout(()=>{const H=new Image;H.src=F,H.onload=()=>{if(T.getState().project.layers.find(W=>W.id===wr))f(wr,{imageData:F,width:H.naturalWidth,height:H.naturalHeight,opacity:.7,x:U,y:V});else if(Y){const W={id:wr,name:" Canvas Preview (Temporary)",imageData:F,x:U,y:V,zIndex:Date.now()+1e6,visible:!0,locked:!1,opacity:.7,width:H.naturalWidth,height:H.naturalHeight};d(W)}}},50))},X=()=>{if(O.current!==null&&(clearTimeout(O.current),O.current=null),T.getState().project.layers.find(j=>j.id===wr)&&y(wr),l){const j=T.getState().project.layers.find(W=>W.id===l.id);j&&!j.visible&&f(l.id,{visible:re.current})}},G=async()=>{if(F){se(!0);try{const H=await Wn({shapeType:m,size:h,stretchX:g,stretchY:C,color:v}),ie=Y?U:-H.offsetX,j=Y?V:-H.offsetY;if(l)f(l.id,{imageData:H.dataUrl,width:H.width,height:H.height,x:ie,y:j,shapeType:m,shapeSize:h,shapeStretchX:g,shapeStretchY:C,shapeColor:v,name:l.name});else{const W={id:crypto.randomUUID(),name:`Shape: ${m}`,imageData:H.dataUrl,x:ie,y:j,zIndex:Date.now(),visible:!0,locked:!1,opacity:1,width:H.width,height:H.height,shapeType:m,shapeSize:h,shapeStretchX:g,shapeStretchY:C,shapeColor:v};d(W)}X(),c()}catch(H){console.error("Failed to create shape layer:",H),alert("Failed to create shape layer. Please try again.")}finally{se(!1)}}};return o.jsx(Sr,{isOpen:i,onClose:c,title:l?"Edit Shape Layer":"Create Shape Layer",noPadding:!0,children:o.jsxs("div",{className:"flex text-gray-200 h-full w-full overflow-hidden",children:[o.jsxs("div",{className:"w-80 border-r border-gray-700 flex-shrink-0 flex flex-col overflow-hidden bg-gray-800",children:[o.jsxs("div",{className:"overflow-y-auto flex-1 p-4 space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-semibold text-gray-400 uppercase",children:"Shape"}),o.jsx("div",{className:"grid grid-cols-3 gap-1",children:Yp.map(H=>o.jsx("button",{onClick:()=>b(H),className:`px-2 py-2 text-[10px] font-medium rounded transition-colors capitalize ${m===H?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:H},H))})]}),o.jsxs("div",{className:"space-y-2 border-t border-gray-700 pt-3",children:[o.jsx("label",{className:"text-xs font-semibold text-gray-400 uppercase",children:"Size"}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("input",{type:"range",min:"10",max:"500",value:h,onChange:H=>p(Number(H.target.value)),className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("span",{className:"text-xs text-gray-500",children:[h,"px"]}),o.jsx("input",{type:"number",value:h,onChange:H=>p(Math.max(10,Math.min(500,parseInt(H.target.value)||h))),className:"flex-1 px-2 py-1 bg-gray-900 border border-gray-600 rounded text-xs text-white"})]})]}),o.jsx("div",{className:"flex flex-wrap gap-1",children:[50,100,150,200,300,400].map(H=>o.jsx("button",{onClick:()=>p(H),className:`px-2 py-0.5 rounded text-[10px] border transition-colors ${h===H?"bg-blue-600 border-blue-500 text-white":"bg-gray-700 border-gray-600 text-gray-400 hover:bg-gray-600"}`,children:H},H))})]}),o.jsxs("div",{className:"space-y-2 border-t border-gray-700 pt-3",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("label",{className:"text-xs font-semibold text-gray-400 uppercase",children:"Stretch"}),o.jsx("button",{onClick:()=>{x(1),D(1)},className:"text-[10px] text-blue-400 hover:text-blue-300",children:"Reset"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"flex justify-between text-[10px] text-gray-500",children:[o.jsx("span",{children:"Horizontal"}),o.jsxs("span",{children:[g.toFixed(2),"x"]})]}),o.jsx("input",{type:"range",min:"0.1",max:"20",step:"0.1",value:g,onChange:H=>x(Number(H.target.value)),className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"flex justify-between text-[10px] text-gray-500",children:[o.jsx("span",{children:"Vertical"}),o.jsxs("span",{children:[C.toFixed(2),"x"]})]}),o.jsx("input",{type:"range",min:"0.1",max:"20",step:"0.1",value:C,onChange:H=>D(Number(H.target.value)),className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"})]})]}),o.jsxs("div",{className:"space-y-3 border-t border-gray-700 pt-3",children:[o.jsx("label",{className:"text-xs font-semibold text-gray-400 uppercase",children:"Appearance"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"color",value:v,onChange:H=>P(H.target.value),className:"w-8 h-8 rounded cursor-pointer bg-transparent border-0 p-0"}),o.jsx("input",{type:"text",value:v,onChange:H=>P(H.target.value),className:"flex-1 px-2 py-1 bg-gray-900 border border-gray-600 rounded text-white text-sm font-mono uppercase"})]}),o.jsx("div",{className:"space-y-1",children:[["#FFFFFF","#E0E0E0","#C0C0C0","#A0A0A0","#808080","#606060","#404040","#202020","#000000"],["#FFCDD2","#EF9A9A","#E57373","#EF5350","#F44336","#E53935","#D32F2F","#C62828","#B71C1C"],["#FFE0B2","#FFCC80","#FFB74D","#FFA726","#FF9800","#FB8C00","#F57C00","#EF6C00","#E65100"],["#FFF9C4","#FFF59D","#FFF176","#FFEE58","#FFEB3B","#FDD835","#FBC02D","#F9A825","#F57F17"],["#C8E6C9","#A5D6A7","#81C784","#66BB6A","#4CAF50","#43A047","#388E3C","#2E7D32","#1B5E20"],["#B2EBF2","#80DEEA","#4DD0E1","#26C6DA","#00BCD4","#00ACC1","#0097A7","#00838F","#006064"],["#BBDEFB","#90CAF9","#64B5F6","#42A5F5","#2196F3","#1E88E5","#1976D2","#1565C0","#0D47A1"],["#E1BEE7","#CE93D8","#BA68C8","#AB47BC","#9C27B0","#8E24AA","#7B1FA2","#6A1B9A","#4A148C"],["#F8BBD0","#F48FB1","#F06292","#EC407A","#E91E63","#D81B60","#C2185B","#AD1457","#880E4F"]].map((H,ie)=>o.jsx("div",{className:"flex gap-1",children:H.map(j=>o.jsx("button",{onClick:()=>P(j),className:`flex-1 aspect-square rounded-sm border ${v===j?"border-white scale-110 z-10":"border-gray-600 hover:border-gray-400"}`,style:{backgroundColor:j},title:j},j))},ie))})]}),o.jsx("div",{className:"space-y-2 border-t border-gray-700 pt-3",children:o.jsxs("label",{className:"flex items-center gap-2 text-xs font-semibold text-gray-400 uppercase cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:Y,onChange:H=>z(H.target.checked),className:"rounded cursor-pointer"}),"Preview on Canvas"]})})]}),o.jsxs("div",{className:"border-t border-gray-700 p-3 space-y-2",children:[o.jsx("button",{onClick:G,disabled:B,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-xs font-semibold rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed uppercase",children:B?"Processing...":l?"Update":"Create"}),o.jsx("button",{onClick:c,className:"w-full px-4 py-2 bg-gray-700 hover:bg-gray-600 text-gray-300 text-xs font-semibold rounded transition-colors uppercase",children:"Cancel"})]})]}),o.jsxs("div",{className:"flex-1 bg-gray-900 relative flex flex-col min-w-0",children:[o.jsxs("div",{className:"h-10 border-b border-gray-700 flex items-center justify-between px-4 bg-gray-800/30",children:[o.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase",children:"Preview"}),o.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-400 cursor-pointer hover:text-gray-200 select-none",children:[o.jsx("input",{type:"checkbox",checked:Y,onChange:H=>z(H.target.checked),className:"rounded bg-gray-700 border-gray-600 text-blue-600 focus:ring-offset-gray-800"}),o.jsx("span",{children:"Show on Canvas"})]})]}),o.jsx("div",{className:"flex-1 overflow-auto flex items-center justify-center p-8 bg-[url('/grid-pattern.png')] bg-repeat",children:B?o.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm",children:[o.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),"Rendering..."]}):F?o.jsx("div",{className:"relative",children:o.jsx("img",{src:F,alt:"Shape preview",className:"max-w-full max-h-full object-contain",style:{imageRendering:"pixelated"}})}):o.jsx("div",{className:"text-gray-600 text-sm italic",children:"Configure shape to generate preview"})})]})]})})};function Xp(){const i=T(z=>z.project),c=T(z=>z.selectedLayerIds),l=T(z=>z.selectAllLayers),d=T(z=>z.deselectAllLayers),f=T(z=>z.deleteSelectedLayers),y=T(z=>z.moveSelectedLayers),m=T(z=>z.setViewport),b=T(z=>z.undo),h=T(z=>z.redo),p=T(z=>z.copySelectedLayers),g=T(z=>z.copySelectedLayersToClipboard),x=T(z=>z.pasteSelectedLayers),C=T(z=>z.pasteFromClipboard),D=T(z=>z.reorderSelectedLayers),v=N.useRef(!1),P=N.useRef(0),F=N.useRef(0),M=N.useRef(new Set),B=N.useRef(null),se=()=>{B.current===null&&c.length!==0&&(B.current=window.setInterval(()=>{let z=0,U=0;const K={ArrowUp:[0,-1],ArrowDown:[0,1],ArrowLeft:[-1,0],ArrowRight:[1,0]};for(const[V,[$,O]]of Object.entries(K))M.current.has(V)&&(z+=$,U+=O);(M.current.has("ShiftLeft")||M.current.has("ShiftRight"))&&(z*=10,U*=10),(z!==0||U!==0)&&y(z,U)},50))},Y=()=>{B.current!==null&&(clearInterval(B.current),B.current=null)};N.useEffect(()=>{const z=$=>{if(($.target instanceof HTMLInputElement||$.target instanceof HTMLTextAreaElement)&&!(($.ctrlKey||$.metaKey)&&($.key==="s"||$.key==="o")))return;const O=$.ctrlKey||$.metaKey,re=$.shiftKey;if($.code==="Space"&&!$.repeat){$.preventDefault(),v.current=!0;return}if(re&&!O&&($.key==="ArrowUp"||$.key==="ArrowDown")){if(c.length>0){$.preventDefault();const le=$.key==="ArrowUp"?"up":"down";D(le)}return}if(!re&&["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes($.key)){$.preventDefault(),M.current.add($.key),(M.current.has("ShiftLeft")||M.current.has("ShiftRight"))&&M.current.add("ShiftLeft"),se();return}if($.key==="Shift"){M.current.add($.code);return}if(O&&$.key.toLowerCase()==="z"&&!re){$.preventDefault(),b();return}if(O&&$.key.toLowerCase()==="z"&&re){$.preventDefault(),h();return}if(O&&$.key.toLowerCase()==="y"){$.preventDefault(),h();return}if($.key==="Delete"||$.key==="Backspace"){c.length>0&&($.preventDefault(),window.confirm(`Delete ${c.length} layer${c.length!==1?"s":""}?`)&&f());return}if(O&&$.key==="a"){$.preventDefault(),i.layers.length>0&&l();return}if(O&&$.key==="d"){$.preventDefault(),d();return}if(O&&$.key==="c"){c.length>0&&($.preventDefault(),p(),g());return}if(O&&$.key==="v"){$.preventDefault(),C();return}if(($.key==="+"||$.key==="=")&&!O){$.preventDefault();const le=i.viewport.zoom,Q=[25,50,100,200,400,800,1600],X=Q.find(G=>G>le)||Q[Q.length-1];m({zoom:X});return}if($.key==="-"&&!O){$.preventDefault();const le=i.viewport.zoom,Q=[25,50,100,200,400,800,1600],X=[...Q].reverse().find(G=>G<le)||Q[0];m({zoom:X});return}if($.key==="0"){$.preventDefault(),m({zoom:100});return}},U=$=>{$.code==="Space"&&(v.current=!1),M.current.delete($.key),M.current.delete($.code),["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].some(re=>M.current.has(re))||Y()},K=$=>{v.current&&(P.current=$.clientX,F.current=$.clientY)},V=$=>{if(v.current&&($.buttons&1)===1){const O=$.clientX-P.current,re=$.clientY-F.current,le=i.viewport.zoom/100,Q=-O/le,X=-re/le;m({panX:i.viewport.panX+Q,panY:i.viewport.panY+X}),P.current=$.clientX,F.current=$.clientY}};return window.addEventListener("keydown",z),window.addEventListener("keyup",U),window.addEventListener("mousedown",K),window.addEventListener("mousemove",V),()=>{window.removeEventListener("keydown",z),window.removeEventListener("keyup",U),window.removeEventListener("mousedown",K),window.removeEventListener("mousemove",V),Y()}},[c,i,l,d,f,y,m,b,h,p,g,x,C,D])}function Eu(i){const{viewport:c,...l}=i;return l}function Gp(){const i=T(y=>y.project),c=T(y=>y.pushHistory),l=T(y=>y._lastHistoryPushAt),d=N.useRef(i),f=N.useRef(null);N.useEffect(()=>{f.current&&clearTimeout(f.current);const y=Eu(i),m=Eu(d.current);if(JSON.stringify(y)!==JSON.stringify(m)){if(l&&Date.now()-l<100){d.current=i;return}f.current=setTimeout(()=>{c(),d.current=i},500)}return()=>{f.current&&clearTimeout(f.current)}},[i,c,l])}function Zp(){const[i,c]=N.useState(!1);return N.useEffect(()=>{const l=d=>{(d.ctrlKey||d.metaKey)&&d.shiftKey&&d.key==="D"&&(d.preventDefault(),c(f=>!f))};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[]),{isOpen:i,setIsOpen:c,toggle:()=>c(l=>!l)}}const Kp="PixelConnectDB",jr="projects",zu="current_project",Qp=1,Tu=()=>new Promise((i,c)=>{const l=indexedDB.open(Kp,Qp);l.onerror=()=>c(l.error),l.onsuccess=()=>i(l.result),l.onupgradeneeded=d=>{const f=d.target.result;f.objectStoreNames.contains(jr)||f.createObjectStore(jr)}}),Jp=async i=>{try{const c=await Tu(),l=Mu(i);return new Promise((d,f)=>{const b=c.transaction(jr,"readwrite").objectStore(jr).put(l,zu);b.onsuccess=()=>d(),b.onerror=()=>f(b.error)})}catch(c){console.error("Failed to save to cache:",c)}},qp=async()=>{try{const i=await Tu();return new Promise((c,l)=>{const y=i.transaction(jr,"readonly").objectStore(jr).get(zu);y.onsuccess=async()=>{const m=y.result;if(m)try{const b=await La(m);c(b)}catch(b){l(b)}else c(null)},y.onerror=()=>l(y.error)})}catch(i){return console.error("Failed to load from cache:",i),null}},eh=2e3;function th(){const i=T(f=>f.project),c=T(f=>f.loadProject),l=N.useRef(),d=N.useRef(!1);N.useEffect(()=>{(async()=>{if(!d.current)try{const y=await qp();if(y){console.log("[AutoSave] Restoring cached project...");const m={...y,layers:y.layers.filter(b=>b.id!=="__text_canvas_preview__"&&b.id!=="__shape_canvas_preview__")};c(m)}}catch(y){console.error("[AutoSave] Failed to restore project:",y)}finally{d.current=!0}})()},[c]),N.useEffect(()=>{if(d.current)return l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{const f={...i,layers:i.layers.filter(y=>y.id!=="__text_canvas_preview__"&&y.id!=="__shape_canvas_preview__")};Jp(f)},eh),()=>{l.current&&clearTimeout(l.current)}},[i])}function nh(){const i=T(y=>y.project.layers),c=T(y=>y.project.canvas),l=T(y=>y.setViewport),d=N.useRef(!1),f=[25,33,50,66,100,150,200,400,800,1600,3200];N.useEffect(()=>{const y=i.length>0;if(y&&!d.current){d.current=!0;const m=setTimeout(()=>{const b=document.querySelector('[data-canvas-container="true"]');if(!b)return;const h=b.clientWidth,p=b.clientHeight;if(h<=0||p<=0||c.width<=0||c.height<=0)return;const g=h/c.width,x=p/c.height,C=Math.min(g,x)*100,D=f.reduce((F,M)=>Math.abs(M-C)<Math.abs(F-C)?M:F),v=f.indexOf(D),P=v>0?f[v-1]:D;l({zoom:P,panX:0,panY:0})},50);return()=>clearTimeout(m)}y||(d.current=!1)},[i.length,c.width,c.height,l])}function rh(){const i=T(F=>F.project),c=T(F=>F.isDirty),[l,d]=N.useState(!1),[f,y]=N.useState(void 0),[m,b]=N.useState(!1),[h,p]=N.useState(void 0);yp(),Xp(),Gp(),th(),nh();const{isOpen:g,setIsOpen:x}=Zp(),C=F=>{y(F),d(!0)},D=()=>{d(!1),y(void 0)},v=F=>{p(F),b(!0)},P=()=>{b(!1),p(void 0)};return N.useEffect(()=>(window.openTextLayerModal=C,()=>{delete window.openTextLayerModal}),[]),N.useEffect(()=>(window.openShapeModal=v,()=>{delete window.openShapeModal}),[]),N.useEffect(()=>{const F=M=>{c&&(M.preventDefault(),M.returnValue="",console.warn("[DEBUG] Unsaved changes detected - warning user before closing"))};return window.addEventListener("beforeunload",F),()=>window.removeEventListener("beforeunload",F)},[c]),N.useEffect(()=>{const F=c?` ${i.projectName} - PixelConnect`:`${i.projectName} - PixelConnect`;document.title=F},[i.projectName,c]),o.jsxs("div",{className:"h-screen flex flex-col bg-canvas-bg text-white overflow-hidden",children:[o.jsx($p,{}),o.jsxs("div",{className:"flex flex-1 gap-0 overflow-hidden",children:[o.jsx("div",{className:"w-64 border-r border-border overflow-hidden flex flex-col",children:o.jsx(wp,{})}),o.jsx("div",{className:"flex-1 overflow-hidden",children:o.jsx(mp,{})}),o.jsx("div",{className:"w-64 border-l border-border overflow-hidden flex flex-col",children:o.jsx(zp,{})})]}),o.jsx(Hp,{isOpen:g,onClose:()=>x(!1)}),o.jsx(Wp,{isOpen:l,onClose:D,existingLayer:f}),o.jsx(Vp,{isOpen:m,onClose:P,existingLayer:h})]})}Rf.createRoot(document.getElementById("root")).render(o.jsx(Du.StrictMode,{children:o.jsx(rh,{})}));
//# sourceMappingURL=index-Cx6NFRUf.js.map
